./mariadb/bin/mariadbd: One can only use the --user switch if running as root
2024-01-08 16:06:16 0 [Note] Starting MariaDB 10.11.2-MariaDB source revision cafba8761af55ae16cc69c9b53a341340a845b36 as process 84733
2024-01-08 16:06:16 0 [Note] InnoDB: Compressed tables use zlib 1.2.11
2024-01-08 16:06:16 0 [Note] InnoDB: Number of transaction pools: 1
2024-01-08 16:06:16 0 [Note] InnoDB: Using crc32 + pclmulqdq instructions
2024-01-08 16:06:16 0 [Note] InnoDB: Using Linux native AIO
2024-01-08 16:06:16 0 [Note] InnoDB: Initializing buffer pool, total size = 128.000MiB, chunk size = 2.000MiB
2024-01-08 16:06:16 0 [Note] InnoDB: Completed initialization of buffer pool
2024-01-08 16:06:16 0 [Note] InnoDB: Buffered log writes (block size=512 bytes)
2024-01-08 16:06:16 0 [Note] InnoDB: 128 rollback segments are active.
2024-01-08 16:06:16 0 [Note] InnoDB: Setting file './ibtmp1' size to 12.000MiB. Physically writing the file full; Please wait ...
2024-01-08 16:06:17 0 [Note] InnoDB: File './ibtmp1' size is now 12.000MiB.
2024-01-08 16:06:17 0 [Note] InnoDB: log sequence number 1993413988; transaction id 1577
2024-01-08 16:06:17 0 [Note] Plugin 'FEEDBACK' is disabled.
2024-01-08 16:06:17 0 [Note] InnoDB: Loading buffer pool(s) from /scratch/s8todick/dbbert-slurm/data/ib_buffer_pool
2024-01-08 16:06:17 0 [Note] InnoDB: Buffer pool(s) load completed at 240108 16:06:17
2024-01-08 16:06:17 0 [Note] Server socket created on IP: '0.0.0.0'.
2024-01-08 16:06:17 0 [Warning] 'user' entry '@falkenfelser' ignored in --skip-name-resolve mode.
2024-01-08 16:06:17 0 [Warning] 'proxies_priv' entry '@% root@falkenfelser' ignored in --skip-name-resolve mode.
2024-01-08 16:06:17 0 [Note] ./mariadb/bin/mariadbd: ready for connections.
Version: '10.11.2-MariaDB'  socket: '/tmp/mysql.sock'  port: 3306  Source distribution
1
1
server started
/scratch/s8todick/dbbert-slurm/venv/lib/python3.9/site-packages/torch/cuda/__init__.py:138: UserWarning: CUDA initialization: The NVIDIA driver on your system is too old (found version 11040). Please update your GPU driver by downloading and installing a new version from the URL: http://www.nvidia.com/Download/index.aspx Alternatively, go to: https://pytorch.org to install a PyTorch version that has been compiled with your version of the CUDA driver. (Triggered internally at ../c10/cuda/CUDAFunctions.cpp:108.)
  return torch._C._cuda_getDeviceCount() > 0
Some weights of the model checkpoint at bert-base-cased were not used when initializing BertModel: ['cls.predictions.decoder.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.bias', 'cls.predictions.transform.dense.bias', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.dense.weight', 'cls.seq_relationship.weight']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
/scratch/s8todick/dbbert-slurm/venv/lib/python3.9/site-packages/mariadb/connections.py:85: RuntimeWarning: MariaDB Connector/Python was build with MariaDB Connector/C version 3.3.4 but loaded Connector/C library has version 10.5.21
  super().__init__(*args, **kwargs)
Input arguments: Namespace(text_source_path='demo_docs/mariadb100', max_length=128, filter_params=1, use_implicit=1, hint_order=2, nr_frames=100000, timeout_s=1500, performance_scaling=0.1, assignment_scaling=1.0, nr_evaluations=2, nr_hints=20, min_batch_size=8, memory=10737418240, disk=53687091200, cores=4, dbms='md', db_name='tpch', db_user='kaltenec', db_pwd='PerformanceMeasurements', restart_cmd='bash /scratch/s8todick/dbbert-slurm/restart_server.sh', recover_cmd='echo "Reset database state!"; sleep 5', query_path='../client/TPC/TPC-H/dbgen/sql-queries/joined.sql', nr_runs=1, result_path_prefix='correct_disk_size')
Trying to connect to tpch with user kaltenec
Trying update set session max_execution_time = 1500000
Exception during update: Unknown system variable 'max_execution_time'
Global variables: ['analyze_sample_percentage', 'aria_block_size', 'aria_checkpoint_interval', 'aria_checkpoint_log_activity', 'aria_force_start_after_recovery_failures', 'aria_group_commit_interval', 'aria_log_file_size', 'aria_max_sort_file_size', 'aria_pagecache_age_threshold', 'aria_pagecache_buffer_size', 'aria_pagecache_division_limit', 'aria_pagecache_file_hash_size', 'aria_repair_threads', 'aria_sort_buffer_size', 'auto_increment_increment', 'auto_increment_offset', 'back_log', 'binlog_cache_size', 'binlog_commit_wait_count', 'binlog_commit_wait_usec', 'binlog_expire_logs_seconds', 'binlog_file_cache_size', 'binlog_stmt_cache_size', 'bulk_insert_buffer_size', 'column_compression_threshold', 'column_compression_zlib_level', 'connect_timeout', 'deadlock_search_depth_long', 'deadlock_search_depth_short', 'deadlock_timeout_long', 'deadlock_timeout_short', 'default_password_lifetime', 'default_week_format', 'delayed_insert_limit', 'delayed_insert_timeout', 'delayed_queue_size', 'div_precision_increment', 'eq_range_index_dive_limit', 'expensive_subquery_limit', 'expire_logs_days', 'extra_max_connections', 'extra_port', 'flush_time', 'ft_max_word_len', 'ft_min_word_len', 'ft_query_expansion_limit', 'group_concat_max_len', 'gtid_cleanup_batch_size', 'gtid_domain_id', 'histogram_size', 'host_cache_size', 'idle_readonly_transaction_timeout', 'idle_transaction_timeout', 'idle_write_transaction_timeout', 'in_predicate_conversion_threshold', 'innodb_adaptive_flushing_lwm', 'innodb_adaptive_hash_index_parts', 'innodb_autoextend_increment', 'innodb_autoinc_lock_mode', 'innodb_buf_dump_status_frequency', 'innodb_buffer_pool_chunk_size', 'innodb_buffer_pool_dump_pct', 'innodb_buffer_pool_size', 'innodb_change_buffer_max_size', 'innodb_compression_failure_threshold_pct', 'innodb_compression_level', 'innodb_compression_pad_pct_max', 'innodb_default_encryption_key_id', 'innodb_defragment_fill_factor', 'innodb_defragment_fill_factor_n_recs', 'innodb_defragment_frequency', 'innodb_defragment_n_pages', 'innodb_defragment_stats_accuracy', 'innodb_encryption_rotate_key_age', 'innodb_encryption_rotation_iops', 'innodb_encryption_threads', 'innodb_fast_shutdown', 'innodb_fatal_semaphore_wait_threshold', 'innodb_fill_factor', 'innodb_flush_log_at_timeout', 'innodb_flush_log_at_trx_commit', 'innodb_flush_neighbors', 'innodb_flushing_avg_loops', 'innodb_force_recovery', 'innodb_ft_cache_size', 'innodb_ft_max_token_size', 'innodb_ft_min_token_size', 'innodb_ft_num_word_optimize', 'innodb_ft_result_cache_limit', 'innodb_ft_sort_pll_degree', 'innodb_ft_total_cache_size', 'innodb_io_capacity', 'innodb_io_capacity_max', 'innodb_lock_wait_timeout', 'innodb_log_buffer_size', 'innodb_log_file_size', 'innodb_lru_flush_size', 'innodb_lru_scan_depth', 'innodb_max_dirty_pages_pct', 'innodb_max_dirty_pages_pct_lwm', 'innodb_max_purge_lag', 'innodb_max_purge_lag_delay', 'innodb_max_purge_lag_wait', 'innodb_max_undo_log_size', 'innodb_old_blocks_pct', 'innodb_old_blocks_time', 'innodb_online_alter_log_max_size', 'innodb_open_files', 'innodb_page_size', 'innodb_purge_batch_size', 'innodb_purge_rseg_truncate_frequency', 'innodb_purge_threads', 'innodb_read_ahead_threshold', 'innodb_read_io_threads', 'innodb_sort_buffer_size', 'innodb_spin_wait_delay', 'innodb_stats_modified_counter', 'innodb_stats_persistent_sample_pages', 'innodb_stats_transient_sample_pages', 'innodb_sync_spin_loops', 'innodb_undo_tablespaces', 'innodb_write_io_threads', 'interactive_timeout', 'join_buffer_size', 'join_buffer_space_limit', 'join_cache_level', 'key_buffer_size', 'key_cache_age_threshold', 'key_cache_block_size', 'key_cache_division_limit', 'key_cache_file_hash_size', 'key_cache_segments', 'large_page_size', 'lock_wait_timeout', 'log_bin_compress_min_len', 'log_slow_min_examined_row_limit', 'log_slow_query_time', 'log_slow_rate_limit', 'log_tc_size', 'log_warnings', 'long_query_time', 'lower_case_table_names', 'max_allowed_packet', 'max_binlog_cache_size', 'max_binlog_size', 'max_binlog_stmt_cache_size', 'max_connect_errors', 'max_connections', 'max_delayed_threads', 'max_digest_length', 'max_error_count', 'max_heap_table_size', 'max_insert_delayed_threads', 'max_join_size', 'max_length_for_sort_data', 'max_password_errors', 'max_prepared_stmt_count', 'max_recursive_iterations', 'max_relay_log_size', 'max_rowid_filter_size', 'max_seeks_for_key', 'max_session_mem_used', 'max_sort_length', 'max_sp_recursion_depth', 'max_statement_time', 'max_tmp_tables', 'max_user_connections', 'max_write_lock_count', 'metadata_locks_cache_size', 'metadata_locks_hash_instances', 'min_examined_row_limit', 'mrr_buffer_size', 'myisam_block_size', 'myisam_data_pointer_size', 'myisam_max_sort_file_size', 'myisam_mmap_size', 'myisam_repair_threads', 'myisam_sort_buffer_size', 'net_buffer_length', 'net_read_timeout', 'net_retry_count', 'net_write_timeout', 'open_files_limit', 'optimizer_extra_pruning_depth', 'optimizer_max_sel_arg_weight', 'optimizer_prune_level', 'optimizer_search_depth', 'optimizer_selectivity_sampling_limit', 'optimizer_trace_max_mem_size', 'optimizer_use_condition_selectivity', 'performance_schema_max_cond_classes', 'performance_schema_max_digest_length', 'performance_schema_max_file_classes', 'performance_schema_max_file_handles', 'performance_schema_max_memory_classes', 'performance_schema_max_mutex_classes', 'performance_schema_max_rwlock_classes', 'performance_schema_max_socket_classes', 'performance_schema_max_sql_text_length', 'performance_schema_max_stage_classes', 'performance_schema_max_statement_classes', 'performance_schema_max_statement_stack', 'performance_schema_max_thread_classes', 'port', 'preload_buffer_size', 'profiling_history_size', 'progress_report_time', 'protocol_version', 'query_alloc_block_size', 'query_cache_limit', 'query_cache_min_res_unit', 'query_cache_size', 'query_prealloc_size', 'range_alloc_block_size', 'read_binlog_speed_limit', 'read_buffer_size', 'read_rnd_buffer_size', 'relay_log_space_limit', 'report_port', 'rowid_merge_buff_size', 'rpl_semi_sync_master_timeout', 'rpl_semi_sync_master_trace_level', 'rpl_semi_sync_slave_kill_conn_timeout', 'rpl_semi_sync_slave_trace_level', 'server_id', 'slave_domain_parallel_threads', 'slave_max_allowed_packet', 'slave_max_statement_time', 'slave_net_timeout', 'slave_parallel_max_queued', 'slave_parallel_threads', 'slave_parallel_workers', 'slave_transaction_retries', 'slave_transaction_retry_interval', 'slow_launch_time', 'sort_buffer_size', 'sql_select_limit', 'sql_slave_skip_counter', 'stored_program_cache', 'sync_binlog', 'sync_master_info', 'sync_relay_log', 'sync_relay_log_info', 'table_definition_cache', 'table_open_cache', 'table_open_cache_instances', 'tcp_keepalive_interval', 'tcp_keepalive_probes', 'tcp_keepalive_time', 'thread_cache_size', 'thread_pool_idle_timeout', 'thread_pool_max_threads', 'thread_pool_oversubscribe', 'thread_pool_prio_kickup_timer', 'thread_pool_size', 'thread_pool_stall_limit', 'thread_stack', 'tmp_disk_table_size', 'tmp_memory_table_size', 'tmp_table_size', 'transaction_alloc_block_size', 'transaction_prealloc_size', 'wait_timeout', 'wsrep_gtid_domain_id', 'wsrep_ignore_apply_errors', 'wsrep_max_ws_rows', 'wsrep_max_ws_size', 'wsrep_mysql_replication_bundle', 'wsrep_retry_autocommit', 'wsrep_slave_threads', 'wsrep_sync_wait', 'wsrep_trx_fragment_size']
All parameters: ['analyze_sample_percentage', 'aria_block_size', 'aria_checkpoint_interval', 'aria_checkpoint_log_activity', 'aria_force_start_after_recovery_failures', 'aria_group_commit_interval', 'aria_log_file_size', 'aria_max_sort_file_size', 'aria_pagecache_age_threshold', 'aria_pagecache_buffer_size', 'aria_pagecache_division_limit', 'aria_pagecache_file_hash_size', 'aria_repair_threads', 'aria_sort_buffer_size', 'auto_increment_increment', 'auto_increment_offset', 'back_log', 'binlog_cache_size', 'binlog_commit_wait_count', 'binlog_commit_wait_usec', 'binlog_expire_logs_seconds', 'binlog_file_cache_size', 'binlog_stmt_cache_size', 'bulk_insert_buffer_size', 'column_compression_threshold', 'column_compression_zlib_level', 'connect_timeout', 'deadlock_search_depth_long', 'deadlock_search_depth_short', 'deadlock_timeout_long', 'deadlock_timeout_short', 'default_password_lifetime', 'default_week_format', 'delayed_insert_limit', 'delayed_insert_timeout', 'delayed_queue_size', 'div_precision_increment', 'eq_range_index_dive_limit', 'expensive_subquery_limit', 'expire_logs_days', 'extra_max_connections', 'extra_port', 'flush_time', 'ft_max_word_len', 'ft_min_word_len', 'ft_query_expansion_limit', 'group_concat_max_len', 'gtid_cleanup_batch_size', 'gtid_domain_id', 'histogram_size', 'host_cache_size', 'idle_readonly_transaction_timeout', 'idle_transaction_timeout', 'idle_write_transaction_timeout', 'in_predicate_conversion_threshold', 'innodb_adaptive_flushing_lwm', 'innodb_adaptive_hash_index_parts', 'innodb_autoextend_increment', 'innodb_autoinc_lock_mode', 'innodb_buf_dump_status_frequency', 'innodb_buffer_pool_chunk_size', 'innodb_buffer_pool_dump_pct', 'innodb_buffer_pool_size', 'innodb_change_buffer_max_size', 'innodb_compression_failure_threshold_pct', 'innodb_compression_level', 'innodb_compression_pad_pct_max', 'innodb_default_encryption_key_id', 'innodb_defragment_fill_factor', 'innodb_defragment_fill_factor_n_recs', 'innodb_defragment_frequency', 'innodb_defragment_n_pages', 'innodb_defragment_stats_accuracy', 'innodb_encryption_rotate_key_age', 'innodb_encryption_rotation_iops', 'innodb_encryption_threads', 'innodb_fast_shutdown', 'innodb_fatal_semaphore_wait_threshold', 'innodb_fill_factor', 'innodb_flush_log_at_timeout', 'innodb_flush_log_at_trx_commit', 'innodb_flush_neighbors', 'innodb_flushing_avg_loops', 'innodb_force_recovery', 'innodb_ft_cache_size', 'innodb_ft_max_token_size', 'innodb_ft_min_token_size', 'innodb_ft_num_word_optimize', 'innodb_ft_result_cache_limit', 'innodb_ft_sort_pll_degree', 'innodb_ft_total_cache_size', 'innodb_io_capacity', 'innodb_io_capacity_max', 'innodb_lock_wait_timeout', 'innodb_log_buffer_size', 'innodb_log_file_size', 'innodb_lru_flush_size', 'innodb_lru_scan_depth', 'innodb_max_dirty_pages_pct', 'innodb_max_dirty_pages_pct_lwm', 'innodb_max_purge_lag', 'innodb_max_purge_lag_delay', 'innodb_max_purge_lag_wait', 'innodb_max_undo_log_size', 'innodb_old_blocks_pct', 'innodb_old_blocks_time', 'innodb_online_alter_log_max_size', 'innodb_open_files', 'innodb_page_size', 'innodb_purge_batch_size', 'innodb_purge_rseg_truncate_frequency', 'innodb_purge_threads', 'innodb_read_ahead_threshold', 'innodb_read_io_threads', 'innodb_sort_buffer_size', 'innodb_spin_wait_delay', 'innodb_stats_modified_counter', 'innodb_stats_persistent_sample_pages', 'innodb_stats_transient_sample_pages', 'innodb_sync_spin_loops', 'innodb_undo_tablespaces', 'innodb_write_io_threads', 'interactive_timeout', 'join_buffer_size', 'join_buffer_space_limit', 'join_cache_level', 'key_buffer_size', 'key_cache_age_threshold', 'key_cache_block_size', 'key_cache_division_limit', 'key_cache_file_hash_size', 'key_cache_segments', 'large_page_size', 'lock_wait_timeout', 'log_bin_compress_min_len', 'log_slow_min_examined_row_limit', 'log_slow_query_time', 'log_slow_rate_limit', 'log_tc_size', 'log_warnings', 'long_query_time', 'lower_case_table_names', 'max_allowed_packet', 'max_binlog_cache_size', 'max_binlog_size', 'max_binlog_stmt_cache_size', 'max_connect_errors', 'max_connections', 'max_delayed_threads', 'max_digest_length', 'max_error_count', 'max_heap_table_size', 'max_insert_delayed_threads', 'max_join_size', 'max_length_for_sort_data', 'max_password_errors', 'max_prepared_stmt_count', 'max_recursive_iterations', 'max_relay_log_size', 'max_rowid_filter_size', 'max_seeks_for_key', 'max_session_mem_used', 'max_sort_length', 'max_sp_recursion_depth', 'max_statement_time', 'max_tmp_tables', 'max_user_connections', 'max_write_lock_count', 'metadata_locks_cache_size', 'metadata_locks_hash_instances', 'min_examined_row_limit', 'mrr_buffer_size', 'myisam_block_size', 'myisam_data_pointer_size', 'myisam_max_sort_file_size', 'myisam_mmap_size', 'myisam_repair_threads', 'myisam_sort_buffer_size', 'net_buffer_length', 'net_read_timeout', 'net_retry_count', 'net_write_timeout', 'open_files_limit', 'optimizer_extra_pruning_depth', 'optimizer_max_sel_arg_weight', 'optimizer_prune_level', 'optimizer_search_depth', 'optimizer_selectivity_sampling_limit', 'optimizer_trace_max_mem_size', 'optimizer_use_condition_selectivity', 'performance_schema_max_cond_classes', 'performance_schema_max_digest_length', 'performance_schema_max_file_classes', 'performance_schema_max_file_handles', 'performance_schema_max_memory_classes', 'performance_schema_max_mutex_classes', 'performance_schema_max_rwlock_classes', 'performance_schema_max_socket_classes', 'performance_schema_max_sql_text_length', 'performance_schema_max_stage_classes', 'performance_schema_max_statement_classes', 'performance_schema_max_statement_stack', 'performance_schema_max_thread_classes', 'port', 'preload_buffer_size', 'profiling_history_size', 'progress_report_time', 'protocol_version', 'query_alloc_block_size', 'query_cache_limit', 'query_cache_min_res_unit', 'query_cache_size', 'query_prealloc_size', 'range_alloc_block_size', 'read_binlog_speed_limit', 'read_buffer_size', 'read_rnd_buffer_size', 'relay_log_space_limit', 'report_port', 'rowid_merge_buff_size', 'rpl_semi_sync_master_timeout', 'rpl_semi_sync_master_trace_level', 'rpl_semi_sync_slave_kill_conn_timeout', 'rpl_semi_sync_slave_trace_level', 'server_id', 'slave_domain_parallel_threads', 'slave_max_allowed_packet', 'slave_max_statement_time', 'slave_net_timeout', 'slave_parallel_max_queued', 'slave_parallel_threads', 'slave_parallel_workers', 'slave_transaction_retries', 'slave_transaction_retry_interval', 'slow_launch_time', 'sort_buffer_size', 'sql_select_limit', 'sql_slave_skip_counter', 'stored_program_cache', 'sync_binlog', 'sync_master_info', 'sync_relay_log', 'sync_relay_log_info', 'table_definition_cache', 'table_open_cache', 'table_open_cache_instances', 'tcp_keepalive_interval', 'tcp_keepalive_probes', 'tcp_keepalive_time', 'thread_cache_size', 'thread_pool_idle_timeout', 'thread_pool_max_threads', 'thread_pool_oversubscribe', 'thread_pool_prio_kickup_timer', 'thread_pool_size', 'thread_pool_stall_limit', 'thread_stack', 'tmp_disk_table_size', 'tmp_memory_table_size', 'tmp_table_size', 'transaction_alloc_block_size', 'transaction_prealloc_size', 'wait_timeout', 'wsrep_gtid_domain_id', 'wsrep_ignore_apply_errors', 'w2024-01-08 16:07:17 0 [Note] ./mariadb/bin/mariadbd (initiated by: kaltenec[kaltenec] @  [127.0.0.1]): Normal shutdown
srep_max_ws_rows', 'wsrep_max_ws_size', 'wsrep_mysql_replication_bundle', 'wsrep_retry_autocommit', 'wsrep_slave_threads', 'wsrep_sync_wait', 'wsrep_trx_fragment_size']\n[Restart] MariaDB server shut down!
2024-01-08 16:07:17 0 [Note] InnoDB: FTS optimize thread exiting.
2024-01-08 16:07:17 0 [Note] InnoDB: Starting shutdown...
2024-01-08 16:07:17 0 [Note] InnoDB: Dumping buffer pool(s) to /scratch/s8todick/dbbert-slurm/data/ib_buffer_pool
2024-01-08 16:07:17 0 [Note] InnoDB: Buffer pool(s) dump completed at 240108 16:07:17
2024-01-08 16:07:17 0 [Note] InnoDB: Removed temporary tablespace data file: "./ibtmp1"
2024-01-08 16:07:17 0 [Note] InnoDB: Shutdown completed; log sequence number 1993413988; transaction id 1578
2024-01-08 16:07:17 0 [Note] ./mariadb/bin/mariadbd: Shutdown complete

[Restart] MariaDB server restarted!

Disconnecting ...
Trying to connect to tpch with user kaltenec
Trying update set session max_execution_time = 1500000
Exception during update: Unknown system variable 'max_execution_time'
Trying update update mariadb.server_cost set cost_value = NULL
Exception during update: Table 'mariadb.server_cost' doesn't exist
Trying update update mariadb.engine_cost set cost_value = NULL
Exception during update: Table 'mariadb.engine_cost' doesn't exist
Discard text passages without at least one explicit parameter reference: True (1)
Try to infer implicit parameter references: True (1)
Creating hints for document 0
Creating hints for document 1
Adding hint TuningHint(doc_id=1, param=<re.Match object; span=(0, 23), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 2), match='70'>, recommendation='70-80% of the available memory', passage='innodb_buffer_pool_size: Allocate more memory to the InnoDB buffer pool to reduce disk I/O. Typically, this value should be set to at least 70-80% of the available memory.\ninnodb_log_file_size: A larger log file size reduces the need for frequent log rotations, thus improving write performance. However, a log size that is too large might slow down the recovery process after a crash.\nTweak Query Cache Variables innodb_log_buffer_size ', float_val=70.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.22197222709655762
Adding hint TuningHint(doc_id=1, param=<re.Match object; span=(0, 23), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(3, 6), match='80%'>, recommendation='70-80% of the available memory', passage='innodb_buffer_pool_size: Allocate more memory to the InnoDB buffer pool to reduce disk I/O. Typically, this value should be set to at least 70-80% of the available memory.\ninnodb_log_file_size: A larger log file size reduces the need for frequent log rotations, thus improving write performance. However, a log size that is too large might slow down the recovery process after a crash.\nTweak Query Cache Variables innodb_log_buffer_size ', float_val=0.8, val_unit='', hint_type=<HintType.RAM_RATIO: 1>) with confidence 0.22197222709655762
Excluding recommendation "A larger log file size" for parameter "innodb_log_file_size" due to low confidence (0.0012472777161747217)
Excluding recommendation "Tweak Query Cache Variables" for parameter "innodb_log_buffer_size" due to low confidence (0.0019999146461486816)
Creating hints for document 2
Creating hints for document 3
Creating hints for document 4
Creating hints for document 5
Creating hints for document 6
Creating hints for document 7
Excluding recommendation "3 or a bigger" for parameter "query_alloc_block_size" due to low confidence (0.0010611190227791667)
Adding hint TuningHint(doc_id=7, param=<re.Match object; span=(94, 110), match='join_cache_level'>, value=<re.Match object; span=(0, 1), match='3'>, recommendation='3 or a bigger', passage='Hash Join\nMariaDB supports Block Hash Join. It is not enabled by default, one needs to set it join_cache_level to 3 or a bigger value to enable it.\nBefore MDEV-30812, Query optimization for Block Hash Join would work as described in the above example: It would assume that the join operation is a cross join. query_alloc_block_size ', float_val=3.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.6593636870384216
Creating hints for document 8
Creating hints for document 9
Creating hints for document 10
Creating hints for document 11
Excluding recommendation "36M" for parameter "query_cache_size" due to low confidence (0.03708851337432861)
Adding hint TuningHint(doc_id=11, param=<re.Match object; span=(343, 367), match='query_cache_min_res_unit'>, value=<re.Match object; span=(0, 2), match='2K'>, recommendation='2K. max_binlog_stmt_cache_size', passage='If you are able, the MySQLTuner tool can be run against your MySQL server and will calculate appropriate configuration values for most of the following settings based on your current load, status and variables automatically.\nEnable the query cache with\nquery_cache_type = 1.\nFor most Moodle installs, set the following:\nquery_cache_size = 36M\nquery_cache_min_res_unit = 2K. max_binlog_stmt_cache_size ', float_val=2.0, val_unit='K', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.34248530864715576
Excluding recommendation "query_cache_min_res_unit = 2K" for parameter "max_binlog_stmt_cache_size" due to low confidence (0.0034338016994297504)
Excluding recommendation "256" for parameter "table_open_cache" due to low confidence (0.015539689920842648)
Excluding recommendation "Moodle 1.7" for parameter "table_open_cache_instances" due to low confidence (0.011224223300814629)
Excluding recommendation "opened_tables > 3 * table_cache" for parameter "table_open_cache" due to low confidence (0.031007280573248863)
Adding hint TuningHint(doc_id=11, param=<re.Match object; span=(245, 260), match='key_buffer_size'>, value=<re.Match object; span=(0, 3), match='32M'>, recommendation='32M', passage="The key buffer can improve the access speed to Moodle's SELECT queries. The correct size depends on the size of the index files (.myi) and in Moodle 1.6 or later (without any additional modules and plugins), the recommendation for this value is key_buffer_size = 32M. Ideally you want the database to be reading once from the disk for every 100 requests so monitor that the value is suitable for your install by adjusting the value of key_buffer_size so that the following formulas are true:\nkey_read / key_read_requests < 0.01\nkey_write / key_write_requests <= 1.0 key_buffer_size ", float_val=32.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.4329495131969452
Creating hints for document 12
Excluding recommendation "increasing" for parameter "query_cache_size" due to low confidence (0.0024058916606009007)
Excluding recommendation "Increase" for parameter "table_open_cache" due to low confidence (0.005121991969645023)
Excluding recommendation "iPhone Tips" for parameter "wsrep_mysql_replication_bundle" due to low confidence (0.004094171803444624)
Creating hints for document 13
Creating hints for document 14
Creating hints for document 15
Adding hint TuningHint(doc_id=15, param=<re.Match object; span=(326, 342), match='table_open_cache'>, value=<re.Match object; span=(0, 3), match='512'>, recommendation='512', passage="Adjusting key_buffer_size, and reducing this if you're not using MyISAM Tables, (It's only relevant to have a large key_buffer_size if you're using MyISAM Tables, which by default MariaDB uses InnoDB. General consensus is InnoDB offers better performance as well, so really only use MyISAM if you have a reason to).\nAdjusting table_open_cache (previously called table_cache) - in Performance recommendations under MySQL, it recommends having this as 512 for most Moodle Installations, but I left it at the default MariaDB setting of 2000. lower_case_table_names ", float_val=512.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.6304436326026917
Excluding recommendation "2000" for parameter "lower_case_table_names" due to low confidence (0.0011850566370412707)
Excluding recommendation "512" for parameter "key_buffer_size" due to low confidence (0.0003556927549652755)
Adding hint TuningHint(doc_id=15, param=<re.Match object; span=(360, 376), match='query_cache_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16 or so', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.09738962352275848
Adding hint TuningHint(doc_id=15, param=<re.Match object; span=(568, 585), match='thread_cache_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16 or so', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.5331082344055176
Adding hint TuningHint(doc_id=15, param=<re.Match object; span=(497, 521), match='query_cache_min_res_unit'>, value=<re.Match object; span=(0, 4), match='4096'>, recommendation='4096 (4KB).', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=4096.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.21204784512519836
Adding hint TuningHint(doc_id=15, param=<re.Match object; span=(497, 521), match='query_cache_min_res_unit'>, value=<re.Match object; span=(6, 9), match='4KB'>, recommendation='4096 (4KB).', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=4.0, val_unit='KB', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.21204784512519836
Adding hint TuningHint(doc_id=15, param=<re.Match object; span=(380, 394), match='tmp_table_size'>, value=<re.Match object; span=(0, 1), match='5'>, recommendation='5', passage="Adjusting Swappiness - Swappiness is how aggressively the OS will swap to and from RAM to disk - useful for applications you're using and then quickly switching, not so much for databasing where the buffer_pool could then be swapped out to disk, defeating the purpose of the buffer_pool. I set this to the recommended value of 5.\nOther Adjustments from the Inter-webs:\nI adjusted tmp_table_size to 64MB, seems to be recommended a lot over the internet, and I figured it couldn't hurt due to the amount of RAM we have available (default is 16MB for this). thread_cache_size ", float_val=5.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.0640445426106453
Excluding recommendation "5" for parameter "thread_cache_size" due to low confidence (0.009071498177945614)
Adding hint TuningHint(doc_id=15, param=<re.Match object; span=(16, 35), match='max_heap_table_size'>, value=<re.Match object; span=(0, 4), match='64MB'>, recommendation='64MB', passage="I also adjusted max_heap_table_size to 64MB again, on the recommendation of the internet. Looking at the information as to what it does, I figured it couldn't hurt - default is again 16MB. max_heap_table_size ", float_val=64.0, val_unit='MB', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.46483081579208374
Adding hint TuningHint(doc_id=15, param=<re.Match object; span=(57, 87), match='innodb_flush_log_at_trx_commit'>, value=<re.Match object; span=(0, 1), match='0'>, recommendation='0', passage="Following the GitHub suggestion linked above, I also set innodb_flush_log_at_trx_commit to 0 - this means the database will no longer flush the to disk every time a transaction is performed, meaning it no longer conforms with ACID Principles, but however giving you a noticeable performance boost. This does mean if you lose power, you will lose the last second of transactions, but I'd prefer to have a UPS installed with Auto-Shutdown configured instead, or if in a datacenter some sort of failover and redundancy there. If you are turning this off though, make sure you have some sort of alternative to have those transactions written to disk in place - the last thing you want is to corrupt your Moodle Installation! (Hence why you have a Site backup of course).\nI also changed the log_slow_query_time to 1, meaning that anything taking longer than 1 second to process is considered a slow query. Seems quick to the naked eye, but bear in mind usually MariaDB/MySQL connections last milliseconds. innodb_flush_log_at_timeout ", float_val=0.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.6084534525871277
Excluding recommendation "0" for parameter "innodb_flush_log_at_timeout" due to low confidence (0.027296574786305428)
Adding hint TuningHint(doc_id=15, param=<re.Match object; span=(786, 805), match='log_slow_query_time'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1', passage="Following the GitHub suggestion linked above, I also set innodb_flush_log_at_trx_commit to 0 - this means the database will no longer flush the to disk every time a transaction is performed, meaning it no longer conforms with ACID Principles, but however giving you a noticeable performance boost. This does mean if you lose power, you will lose the last second of transactions, but I'd prefer to have a UPS installed with Auto-Shutdown configured instead, or if in a datacenter some sort of failover and redundancy there. If you are turning this off though, make sure you have some sort of alternative to have those transactions written to disk in place - the last thing you want is to corrupt your Moodle Installation! (Hence why you have a Site backup of course).\nI also changed the log_slow_query_time to 1, meaning that anything taking longer than 1 second to process is considered a slow query. Seems quick to the naked eye, but bear in mind usually MariaDB/MySQL connections last milliseconds. innodb_flush_log_at_timeout ", float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.5708844661712646
Creating hints for document 16
Creating hints for document 17
Creating hints for document 18
Creating hints for document 19
Creating hints for document 20
Excluding recommendation "Adjust InnoDB settings" for parameter "innodb_change_buffer_max_size" due to low confidence (0.002744893776252866)
Excluding recommendation "log retention" for parameter "expire_logs_days" due to low confidence (0.03931700438261032)
Excluding recommendation "Disable DNS Reverse Lookups" for parameter "binlog_file_cache_size" due to low confidence (0.00035856006434187293)
Creating hints for document 21
Creating hints for document 22
Creating hints for document 23
Creating hints for document 24
Creating hints for document 25
Excluding recommendation "25769803776" for parameter "innodb_log_file_size" due to low confidence (0.007881158962845802)
Creating hints for document 26
Creating hints for document 27
Creating hints for document 28
Creating hints for document 29
Excluding recommendation "innodb_buffer_pool_size, and max_connections" for parameter "sync_relay_log_info" due to low confidence (0.044712793081998825)
Excluding recommendation "innodb_buffer_pool_size" for parameter "max_connections" due to low confidence (0.0013505558017641306)
Creating hints for document 30
Creating hints for document 31
Adding hint TuningHint(doc_id=31, param=<re.Match object; span=(183, 199), match='expire_logs_days'>, value=<re.Match object; span=(0, 2), match='10'>, recommendation='10 max_relay_log_size', passage='#log-bin=mysql-bin\n#binlog_format=mixed\nOr, if you want to keep these logs but keep their size in check and old logs deleted, you can set these limits then restart:\nlog-bin=mysql-bin\nexpire_logs_days = 10 max_relay_log_size ', float_val=10.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.3221101462841034
Adding hint TuningHint(doc_id=31, param=<re.Match object; span=(205, 223), match='max_relay_log_size'>, value=<re.Match object; span=(19, 21), match='10'>, recommendation='expire_logs_days = 10', passage='#log-bin=mysql-bin\n#binlog_format=mixed\nOr, if you want to keep these logs but keep their size in check and old logs deleted, you can set these limits then restart:\nlog-bin=mysql-bin\nexpire_logs_days = 10 max_relay_log_size ', float_val=10.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.07910381257534027
Adding hint TuningHint(doc_id=31, param=<re.Match object; span=(0, 15), match='max_binlog_size'>, value=<re.Match object; span=(0, 4), match='100M'>, recommendation='100M', passage='max_binlog_size\n= 100M\nAlternatively, there exists a MariaDB command to manually purge logs older than a specific one. For example, you may see a file named mysql-bin.000023 and want to delete every log older than it. As long as the log-bin=mysql-bin setting is in effect, you would run: log_bin_compress_min_len ', float_val=100.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.5616846680641174
Creating hints for document 32
Creating hints for document 33
Creating hints for document 34
Creating hints for document 35
Creating hints for document 36
Creating hints for document 37
Creating hints for document 38
Excluding recommendation "256KB and 2MB" for parameter "max_heap_table_size" due to low confidence (0.0019503909861668944)
Adding hint TuningHint(doc_id=38, param=<re.Match object; span=(1999, 2014), match='max_connections'>, value=<re.Match object; span=(0, 3), match='200'>, recommendation='200', passage='hayden_james@linux\xa0aboutarticlesservicesfeedbacksponsorscontactforumsMySQL Database Performance: Avoid this common mistake March 21, 2023 by Hayden James, in Blog LinuxOne frequent topic of support request emails I receive is MySQL database performance. Clients complain about MySQL using too much server memory, too many MySQL slow queries, the famous Mysql server has gone away errors, and many other MySQL performance-related issues. As such, I wanted to share solutions to some common MySQL configuration mistakes.If you are a DBA, feel free to share your experiences or suggestions in the comments section. I’m referring to four MySQL config variables. These four my.cnf config lines are often responsible for poor MySQL database performance and scaling due to insufficient server memory for incoming connections. This article also applies to MariaDB and Percona drop-in replacements for MySQL.Note: This is an update and follow-up to this article. I’ve added some relevant and more up-to-date information and links, as well as a new section that covers some additional my.cnf performance config tips.\xa0Avoid arbitrarily increasing MySQL per-connection buffers Excerpt of my.cnf edits for a client. (some lines were removed and some blurred to avoid misuse)Who knows where or when this bad practice started. I frequently encounter instances where I log into production servers for the first time and find that the values of virtually every my.cnf variable have been arbitrarily increased without sound reasoning behind the changes.This is never a good practice, especially for four my.cnf variables discussed below. Although increasing the value of some variables can improve performance, these four will almost always degrade MySQL server performance and capacity when increased.The four buffers in question are the\xa0join_buffer_size,\xa0sort_buffer_size,\xa0read_buffer_size and read_rnd_buffer_size.These four buffers are\xa0allocated per connection. For example, a setting of join_buffer_size=1M\xa0with\xa0max_connections=200 will configure MySQL to allocate an additional 1M per connection (1M x 200). The same goes for the other three buffers. Again, all are per connection.A good rule of thumb is that if you can’t provide a valid reason to increase any of these buffers, keep them set to the default values.In nearly all cases, it’s best to keep the defaults by removing or commenting out these four config lines. As connections increase with traffic, queries that need more space than what’s available due to larger buffer settings may trigger paging those buffers to disk. This dramatically slows down your DB server and creates a bottleneck.I’ve often seen significantly improved MySQL performance by simply reverting these buffers to their defaults. Also, read Analyzing Linux server performance with atop.The above screenshot shows MySQL status output two weeks after I made the first my.cnf optimization pass. Now, let’s take a closer look at each of these buffers.\xa0MySQL join_buffer_sizeThe join_buffer_size is allocated for each full join between two tables. From MySQL’s documentation the join_buffer_size is described as: “The minimum size of the buffer that is used for plain index scans, range index scans, and joins that do not use indexes and thus perform full table scans.”MySQL’s documentation goes on to say: “Memory allocation time can cause substantial performance drops if the global size is larger than needed by most queries that use it.” The join buffer is allocated to cache table rows when the join can’t use an index.If your database suffers from many joins performed without indexes, it cannot be solved by increasing join_buffer_size. The problem is “joins performed without indexes.” Thus, the solution for faster joins is to add indexes.\xa0MySQL sort_buffer_sizeUnless you have data indicating otherwise, you should avoid arbitrarily increasing the\xa0sort_buffer_size. Memory here is also assigned per connection!MySQL’s documentation warns: “On Linux, there are thresholds of 256KB and 2MB where larger values may significantly slow down memory allocation, so you should consider staying below one of those values.”Avoid increasing sort_buffer_size above 2M since there is a performance penalty that will eliminate benefits.\xa0MySQL read_buffer_size & read_rnd_buffer_sizeUpdate: Some of you still use MyISAM over InnoDB. MyISAM is based on the old ISAM storage engine. It has many useful extensions, as discussed here. You should consider converting your MySQL tables to the InnoDB storage engine.InnoDB is the default storage engine of MySQL 5.7 and MySQL 8.0. InnoDB features improved performance, rollback and crash-recovery capabilities to protect data. read_buffer_size\xa0Applies generally to MyISAM.Each request that performs a sequential table scan allocates a read buffer. The read_buffer_size\xa0system variable determines the buffer size.Starting from MySQL 8.0.22, the value of select_into_buffer_size overrides the value of read_buffer_size when performing SELECT INTO DUMPFILE and SELECT INTO OUTFILE statements. read_buffer_size\xa0is used for the I/O cache buffer size in all other cases.The read_rnd_buffer_size variable is also used mainly for\xa0MyISAM reads from tables. Again, consider InnoDB or MariaDB’s Aria storage engines. For the past decade, the default values of these buffers have remained the same.\xa0Additional my.cnf Performance config tipsMonitor the appropriate MySQL status variable_name(s) to assist you in tuning the below config lines. An example of viewing the status of MySQL runtime variables. (So I increased max_connections)max_connectionsA MySQL configuration parameter that sets the maximum number of concurrent connections the server can handle. A value that is too large can allocate too much server memory and lead to performance issues, while a low value can result in connection rejections.To tune this parameter, monitor the max_used_connections status variable; try to set this to ~ 2x to 3x your max used connections after a few days of uptime. However, if your MySQL max connections are more than 200 then make sure to have at least 100 extra connections available. So if max_used_connections is 300 then set max_connections to at least 400. Watch memory usage!!thread_cache_sizeDetermines the number of threads that can be cached and reused by the server. Properly tuning this parameter can help improve the performance of your MySQL server by reducing the overhead of creating new threads and freeing up system resources.To tune this parameter, you can monitor the threads_created and threads_cached status variables and set the value to a reasonable number based on the number of expected concurrent connections. As a general rule, a value of 16 is a good starting point. Then increase gradually until it’s at least 50% of max_connections. For example, if the threads_cached value is 16 and the max_used_connections value is 40 then increase this from 16 to 32. At the same time, as per above advice, if max_used_connections is 40 then your max_connections should be at least 80.table_definition_cacheA MySQL configuration parameter that sets the number of table definitions (metadata) that can be stored in the cache. A high value of table_definition_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of reading the table definition from disk.To tune this parameter, monitor the opened_table_definitions and open_table_definitionsstatus variables, set table_definition_cache to ~ 2x the number of open table definitions and adjust as needed. Consider other factors, such as system memory and query complexity when tuning. .table_open_cacheA MySQL configuration parameter that sets the number of open table objects that can be stored in the cache. A high value of table_open_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of opening tables from disk.To tune this parameter, monitor the opened_tables and open_tables status variables, set table_open_cache to ~ 2x the number of open tables, and adjust as needed. Consider other factors such as memory and query complexity when tuning. Generally table_open_cache and table_definition_cache are set to the same value. The number of open table objects and table definitions are directly related, so setting these two parameters to the same value can ensure that the metadata and open table objects are stored in the cache in a consistent and efficient manner.wait_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on a non-interactive connection before closing it. A high value of wait_timeout can result in increased memory usage and increased # of connections, while a low value can result in frequent disconnections for long-running queries.To tune this parameter, set wait_timeout to the lowest resonable expected duration of non-interactive connections, and adjust as needed. The default value is 28800 seconds. This is way to high in most cases and will consume a lot of system memory by keeping many connections open. I set most of my configs to 30 seconds or less.connect_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for a successful connection to be established before timing out. A high value of connect_timeout can result in increased wait time for clients and increase in max_connections. A low value can result in connection failures for slow or heavily loaded servers.To tune this parameter, set connect_timeout to a reasonable value based on the expected response time of the server. Consider other factors such as network latency, mobile users, and server load when tuning. I set most of my configs to 15 seconds or less. For example, this blog’s mysql connection timeout is set to 5 seconds.interactive_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on an interactive connection before closing it. A high value of interactive_timeout can result in increased memory usage and increased concurrent connetions. A low value can result in frequent disconnections for long-running queries.To tune this parameter, set interactive_timeout to a reasonable value based on the expected duration of your longest-running requests.tmp_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables used by the server. When a query creates a temporary table that exceeds the value of tmp_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set tmp_table_size to a reasonable value based on the available memory and the value of the created_tmp_disk_table variable.max_heap_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables created with the MEMORY storage engine. When a query creates a temporary table that exceeds the value of max_heap_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set max_heap_table_size to the same value as tmp_table_size.Want more tips?For example, Innodb tuning tips, setting open_files_limit, etc. Let me know your interests in the comments section below, or hire me for MySQL optimization.\xa0Additional MySQL performance related articlesMySQL Performance Tuning: Tips, Scripts and Tools.MySQL Performance: Stop hoarding. Drop unused MySQL databases.“MySQL server has gone away” error – Solution(s).Could not increase number of max_open_files to more than… (Solution).Linux server performance: Is disk I/O slowing your application?Tuning MySQL my.cnf? Avoid this common pitfall!\xa0ConclusionIn conclusion, we discussed some common issues with MySQL performance often raised in support requests. The focus was on four specific my.cnf variables frequently responsible for poor database performance and scaling due to a shortage of server memory.It was emphasized that arbitrarily increasing these variables can lead to a decline in MySQL server performance and capacity and that it is important to keep these buffers set to their default values unless there is a specific reason to increase them. Then we covered tuning some additional MySQL performance config lines.A good rule of thumb: if you can’t provide a valid reason for increasing these buffers, keep them set to the default values. This also applies less strictly to all of MySQL’s variables. Be careful when making changes, don’t overwrite your entire my.cnf all at once. Back up everything first, make one or two changes per restart and test for 24 to 48 hours before making another pass. wsrep_mysql_replication_bundle ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.10689657926559448
Excluding recommendation "28800 seconds" for parameter "wait_timeout" due to low confidence (0.02380937896668911)
Excluding recommendation "256KB and 2MB" for parameter "thread_cache_size" due to low confidence (0.0014922419795766473)
Excluding recommendation "high" for parameter "table_open_cache" due to low confidence (0.029525967314839363)
Excluding recommendation "default" for parameter "read_rnd_buffer_size" due to low confidence (0.0074069919064641)
Excluding recommendation "default values" for parameter "wsrep_mysql_replication_bundle" due to low confidence (0.017830735072493553)
Excluding recommendation "high" for parameter "table_definition_cache" due to low confidence (0.028836792334914207)
Excluding recommendation "read_rnd_buffer_size" for parameter "read_buffer_size" due to low confidence (0.02243052050471306)
Excluding recommendation "high" for parameter "connect_timeout" due to low confidence (0.006237507332116365)
Excluding recommendation "256KB and 2MB" for parameter "interactive_timeout" due to low confidence (0.0019634573254734278)
Excluding recommendation "default values" for parameter "join_buffer_size" due to low confidence (0.014004350639879704)
Excluding recommendation "default values" for parameter "sort_buffer_size" due to low confidence (0.016000131145119667)
Excluding recommendation "256KB and 2MB" for parameter "open_files_limit" due to low confidence (0.0021805413998663425)
Creating hints for document 39
Creating hints for document 40
Excluding recommendation "●" for parameter "innodb_read_io_threads" due to low confidence (0.0003352722560521215)
Excluding recommendation "
● innodb_undo_tablespaces" for parameter "innodb_log_file_size" due to low confidence (0.011883324943482876)
Excluding recommendation "
● innodb_log_file_size
●" for parameter "innodb_undo_tablespaces" due to low confidence (0.001494703465141356)
Excluding recommendation "●" for parameter "innodb_change_buffer_max_size" due to low confidence (1.0287464647262823e-05)
Excluding recommendation "
dynamically" for parameter "innodb_buffer_pool_chunk_size" due to low confidence (0.001686143223196268)
Creating hints for document 41
Excluding recommendation "1-2 ms" for parameter "max_binlog_stmt_cache_size" due to low confidence (0.002863735891878605)
Excluding recommendation "Options Autoload Size" for parameter "query_cache_limit" due to low confidence (0.009057896211743355)
Creating hints for document 42
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(118, 135), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.5484864711761475
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(47, 62), match='key_buffer_size'>, value=<re.Match object; span=(0, 3), match='64M'>, recommendation='64M', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=64.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.16080217063426971
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(95, 110), match='max_connections'>, value=<re.Match object; span=(0, 4), match='1250'>, recommendation='1250', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=1250.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.5035439133644104
Excluding recommendation "max_allowed_packet = 64M" for parameter "thread_pool_max_threads" due to low confidence (0.01849702000617981)
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(140, 158), match='max_allowed_packet'>, value=<re.Match object; span=(0, 3), match='64M'>, recommendation='64M thread_pool_max_threads', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=64.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.13796083629131317
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(140, 162), match='innodb_old_blocks_time'>, value=<re.Match object; span=(0, 4), match='1000'>, recommendation='1000', passage='# InnoDB Configuration\ninnodb-log-file-size = 128M\ninnodb-log-buffer-size = 128M\ninnodb-file-per-table = 1\ninnodb_buffer_pool_instances = 8\ninnodb_old_blocks_time = 1000 innodb_log_file_size ', float_val=1000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.8573803901672363
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(170, 190), match='innodb_log_file_size'>, value=<re.Match object; span=(0, 4), match='128M'>, recommendation='128M', passage='# InnoDB Configuration\ninnodb-log-file-size = 128M\ninnodb-log-buffer-size = 128M\ninnodb-file-per-table = 1\ninnodb_buffer_pool_instances = 8\ninnodb_old_blocks_time = 1000 innodb_log_file_size ', float_val=128.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.6019849181175232
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(127, 149), match='innodb_read_io_threads'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='innodb_stats_on_metadata = off\ninnodb-flush-method = O_DIRECT\ninnodb-flush-log-at-trx-commit = 2\ninnodb_buffer_pool_size = 23G\ninnodb_read_io_threads = 32 innodb_flush_log_at_trx_commit ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.8269670605659485
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(97, 120), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 3), match='23G'>, recommendation='23G', passage='innodb_stats_on_metadata = off\ninnodb-flush-method = O_DIRECT\ninnodb-flush-log-at-trx-commit = 2\ninnodb_buffer_pool_size = 23G\ninnodb_read_io_threads = 32 innodb_flush_log_at_trx_commit ', float_val=23.0, val_unit='G', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.6728203296661377
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(155, 185), match='innodb_flush_log_at_trx_commit'>, value=<re.Match object; span=(0, 1), match='2'>, recommendation='2', passage='innodb_stats_on_metadata = off\ninnodb-flush-method = O_DIRECT\ninnodb-flush-log-at-trx-commit = 2\ninnodb_buffer_pool_size = 23G\ninnodb_read_io_threads = 32 innodb_flush_log_at_trx_commit ', float_val=2.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.5459200143814087
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(96, 111), match='connect_timeout'>, value=<re.Match object; span=(0, 3), match='300'>, recommendation='300', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=300.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.8066571354866028
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(29, 47), match='innodb_io_capacity'>, value=<re.Match object; span=(0, 4), match='4000'>, recommendation='4000', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=4000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.5133910179138184
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(118, 130), match='wait_timeout'>, value=<re.Match object; span=(0, 5), match='30000'>, recommendation='30000', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=30000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.7701088786125183
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(55, 77), match='innodb_io_capacity_max'>, value=<re.Match object; span=(0, 4), match='6000'>, recommendation='6000', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=6000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.74219810962677
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(0, 23), match='innodb_write_io_threads'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.49680811166763306
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(82, 100), match='max_connect_errors'>, value=<re.Match object; span=(0, 7), match='1000000'>, recommendation='1000000', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=1000000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.9474750757217407
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(0, 16), match='table_open_cache'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.536579430103302
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(0, 26), match='table_open_cache_instances'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.6042623519897461
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(57, 73), match='open_files_limit'>, value=<re.Match object; span=(0, 5), match='65535'>, recommendation='65535', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=65535.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.878506600856781
Excluding recommendation "'{s+=$2} END {print s+150}'" for parameter "max_password_errors" due to low confidence (0.006320311222225428)
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(149, 164), match='max_connections'>, value=<re.Match object; span=(65, 68), match='150'>, recommendation='larger than the total number of all Zabbix server processes plus 150', passage='Later, we will go through every configuration parameter with our ChatGPT friend, but first, there are two things to remember!Configuration parameter\xa0max_connections\xa0must be larger than the total number of all Zabbix server processes plus 150. You can use the command below to automatically check the number of Zabbix processes and add 150 to that number:egrep "^Start.+=[0-9]" /etc/zabbix/zabbix_server.conf | awk -F "=" \'{s+=$2} END {print s+150}\' max_password_errors ', float_val=150.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.34523195028305054
Excluding recommendation "2/10/31536000" for parameter "wait_timeout" due to low confidence (0.016953475773334503)
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(3130, 3152), match='innodb_old_blocks_time'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1/8/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.602656364440918
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(3130, 3152), match='innodb_old_blocks_time'>, value=<re.Match object; span=(2, 3), match='8'>, recommendation='1/8/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.602656364440918
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(3130, 3152), match='innodb_old_blocks_time'>, value=<re.Match object; span=(4, 6), match='64'>, recommendation='1/8/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.602656364440918
Excluding recommendation "1/151/100000" for parameter "thread_cache_size" due to low confidence (0.008895078673958778)
Excluding recommendation "how many items (metrics" for parameter "binlog_stmt_cache_size" due to low confidence (0.00015156275185290724)
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(1789, 1804), match='key_buffer_size'>, value=<re.Match object; span=(0, 2), match='8M'>, recommendation='8M/128M/No limit', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=8.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.05302645266056061
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(1789, 1804), match='key_buffer_size'>, value=<re.Match object; span=(3, 7), match='128M'>, recommendation='8M/128M/No limit', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=128.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.05302645266056061
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.18275338411331177
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(2, 3), match='1'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.18275338411331177
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(4, 6), match='64'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.18275338411331177
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(0, 3), match='100'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=100.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.055468734353780746
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(4, 7), match='200'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.055468734353780746
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(8, 9), match='2'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=2.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.055468734353780746
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(11, 13), match='64'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.055468734353780746
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(14, 15), match='1'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.055468734353780746
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(2259, 2277), match='max_allowed_packet'>, value=<re.Match object; span=(0, 1), match='0'>, recommendation='0/9/100000', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=0.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.3748006522655487
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(2259, 2277), match='max_allowed_packet'>, value=<re.Match object; span=(2, 3), match='9'>, recommendation='0/9/100000', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=9.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.3748006522655487
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(2259, 2277), match='max_allowed_packet'>, value=<re.Match object; span=(4, 10), match='100000'>, recommendation='0/9/100000', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=100000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.3748006522655487
Excluding recommendation "Min/Default/Max Value: 0/1/2" for parameter "innodb_buffer_pool_size" due to low confidence (0.020894749090075493)
Excluding recommendation "1/4/64" for parameter "innodb_write_io_threads" due to low confidence (0.024243425577878952)
Excluding recommendation "Min/Default/Max Value: 1/4/64" for parameter "innodb_io_capacity" due to low confidence (0.02527867816388607)
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(5291, 5307), match='open_files_limit'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1/4000/524288', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.1302594095468521
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(5291, 5307), match='open_files_limit'>, value=<re.Match object; span=(2, 6), match='4000'>, recommendation='1/4000/524288', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=4000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.1302594095468521
Adding hint TuningHint(doc_id=42, param=<re.Match object; span=(5291, 5307), match='open_files_limit'>, value=<re.Match object; span=(7, 13), match='524288'>, recommendation='1/4000/524288', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=524288.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.1302594095468521
Excluding recommendation "Min/Default/Max Value: 128M/128M/Unlimited" for parameter "innodb_read_io_threads" due to low confidence (0.0006047008791938424)
Creating hints for document 43
Creating hints for document 44
Creating hints for document 45
Creating hints for document 46
Creating hints for document 47
Creating hints for document 48
Creating hints for document 49
Creating hints for document 50
Creating hints for document 51
Creating hints for document 52
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(125, 141), match='sort_buffer_size'>, value=<re.Match object; span=(0, 4), match='2048'>, recommendation='2048', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=2048.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.4928762912750244
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(97, 119), match='innodb_log_buffer_size'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.5541036128997803
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(0, 15), match='key_buffer_size'>, value=<re.Match object; span=(0, 4), match='1200'>, recommendation='1200', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=1200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.47275298833847046
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(66, 89), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 4), match='4096'>, recommendation='4096', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=4096.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.7548506855964661
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(23, 39), match='query_cache_size'>, value=<re.Match object; span=(0, 2), match='50'>, recommendation='50', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=50.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.5515155792236328
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(45, 59), match='tmp_table_size'>, value=<re.Match object; span=(0, 3), match='128'>, recommendation='128', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=128.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.5614595413208008
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(149, 165), match='read_buffer_size'>, value=<re.Match object; span=(0, 3), match='256'>, recommendation='256', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=256.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.7236456871032715
Excluding recommendation "16" for parameter "thread_cache_size" due to low confidence (0.013519098982214928)
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(51, 63), match='thread_stack'>, value=<re.Match object; span=(0, 3), match='512'>, recommendation='512', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=512.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.10890164226293564
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(27, 43), match='join_buffer_size'>, value=<re.Match object; span=(0, 4), match='2048'>, recommendation='2048', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=2048.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.45778581500053406
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(0, 20), match='read_rnd_buffer_size'>, value=<re.Match object; span=(0, 3), match='512'>, recommendation='512', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=512.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.13814711570739746
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(116, 132), match='table_open_cache'>, value=<re.Match object; span=(0, 4), match='2048'>, recommendation='2048', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=2048.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.08759050816297531
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(140, 155), match='max_connections'>, value=<re.Match object; span=(0, 3), match='200'>, recommendation='200', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.12766718864440918
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(70, 87), match='binlog_cache_size'>, value=<re.Match object; span=(0, 2), match='64'>, recommendation='64', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.32278764247894287
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(223, 239), match='query_cache_size'>, value=<re.Match object; span=(0, 1), match='0'>, recommendation='0', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=0.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.13969171047210693
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(244, 258), match='tmp_table_size'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.08301977068185806
Excluding recommendation "
tmp_table_size = 32" for parameter "thread_cache_size" due to low confidence (0.005013360176235437)
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(202, 217), match='key_buffer_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.16145384311676025
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(57, 73), match='sort_buffer_size'>, value=<re.Match object; span=(0, 4), match='1024'>, recommendation='1024', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=1024.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.4854225814342499
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(30, 52), match='innodb_log_buffer_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.2453717291355133
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(157, 169), match='thread_stack'>, value=<re.Match object; span=(0, 3), match='192'>, recommendation='192', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=192.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.5315266847610474
Excluding recommendation "512" for parameter "innodb_buffer_pool_size" due to low confidence (0.008560613729059696)
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(133, 149), match='join_buffer_size'>, value=<re.Match object; span=(0, 4), match='1024'>, recommendation='1024', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=1024.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.5388768911361694
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(105, 125), match='read_rnd_buffer_size'>, value=<re.Match object; span=(0, 4), match='4096'>, recommendation='4096', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=4096.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.5270856022834778
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(81, 97), match='read_buffer_size'>, value=<re.Match object; span=(0, 4), match='1024'>, recommendation='1024', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=1024.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.6475849151611328
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(23, 40), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.4959188997745514
Excluding recommendation "32" for parameter "binlog_stmt_cache_size" due to low confidence (0.007479107938706875)
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(45, 61), match='table_open_cache'>, value=<re.Match object; span=(0, 2), match='64'>, recommendation='64', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.5262244343757629
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(67, 82), match='max_connections'>, value=<re.Match object; span=(0, 2), match='20'>, recommendation='20', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=20.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.30618762969970703
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(0, 17), match='binlog_cache_size'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.13831159472465515
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(38, 61), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 4), match='180M'>, recommendation='180M', passage="Mysql need's by default 512MB of RAM.\ninnodb_buffer_pool_size = 180M with this settings you can limit the RAM ussage, a high value is pointless\nMysql is runing on a local server so if you have a ssd on it the access is pretty fast there is no point to use your ram for nothing. sql_slave_skip_counter ", float_val=180.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.0715036541223526
Excluding recommendation "high" for parameter "sql_slave_skip_counter" due to low confidence (8.26978612167295e-06)
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(23, 39), match='read_buffer_size'>, value=<re.Match object; span=(0, 4), match='8192'>, recommendation='8192 minimum value', passage="sort_buffer_size = 10M\nread_buffer_size = 10M ( always on mysql configuration use M (MB) because if you use 1024 is translated to bytes and the sort_buffer_size have a minimum value of 32768 bytes so that's being said, 1024 is a useless number used two times in the above configuration, read_buffer_size have a 8192 minimum value) read_buffer_size ", float_val=8192.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.12364183366298676
Adding hint TuningHint(doc_id=52, param=<re.Match object; span=(0, 16), match='sort_buffer_size'>, value=<re.Match object; span=(0, 3), match='10M'>, recommendation='10M', passage="sort_buffer_size = 10M\nread_buffer_size = 10M ( always on mysql configuration use M (MB) because if you use 1024 is translated to bytes and the sort_buffer_size have a minimum value of 32768 bytes so that's being said, 1024 is a useless number used two times in the above configuration, read_buffer_size have a 8192 minimum value) read_buffer_size ", float_val=10.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.08533438295125961
Creating hints for document 53
Creating hints for document 54
Excluding recommendation "standard schema plus server_id field" for parameter "server_id" due to low confidence (0.0003102655173279345)
Excluding recommendation "standard schema plus server_id field" for parameter "wsrep_mysql_replication_bundle" due to low confidence (6.38053024886176e-05)
Creating hints for document 55
Creating hints for document 56
Creating hints for document 57
Creating hints for document 58
Creating hints for document 59
Creating hints for document 60
Creating hints for document 61
Creating hints for document 62
Creating hints for document 63
Adding hint TuningHint(doc_id=63, param=<re.Match object; span=(66, 83), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8\n', passage='key_buffer\t\t= 2000M\nmax_allowed_packet\t= 16M\nthread_stack\t\t= 128K\nthread_cache_size\t= 8\n# This replaces the startup script and checks MyISAM tables if needed\n# the first time they are touched\nmyisam-recover\t\t= BACKUP table_open_cache_instances ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.5002349019050598
Excluding recommendation "thread_cache_size	= 8
" for parameter "table_open_cache_instances" due to low confidence (0.0009486422641202807)
Adding hint TuningHint(doc_id=63, param=<re.Match object; span=(45, 57), match='thread_stack'>, value=<re.Match object; span=(0, 4), match='128K'>, recommendation='128K', passage='key_buffer\t\t= 2000M\nmax_allowed_packet\t= 16M\nthread_stack\t\t= 128K\nthread_cache_size\t= 8\n# This replaces the startup script and checks MyISAM tables if needed\n# the first time they are touched\nmyisam-recover\t\t= BACKUP table_open_cache_instances ', float_val=128.0, val_unit='K', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.18956421315670013
Adding hint TuningHint(doc_id=63, param=<re.Match object; span=(20, 38), match='max_allowed_packet'>, value=<re.Match object; span=(0, 3), match='16M'>, recommendation='16M', passage='key_buffer\t\t= 2000M\nmax_allowed_packet\t= 16M\nthread_stack\t\t= 128K\nthread_cache_size\t= 8\n# This replaces the startup script and checks MyISAM tables if needed\n# the first time they are touched\nmyisam-recover\t\t= BACKUP table_open_cache_instances ', float_val=16.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.4253525137901306
Excluding recommendation "#innodb_force_recovery =6" for parameter "max_binlog_stmt_cache_size" due to low confidence (0.008007392287254333)
Adding hint TuningHint(doc_id=63, param=<re.Match object; span=(112, 128), match='open_files_limit'>, value=<re.Match object; span=(0, 5), match='65000'>, recommendation='65000', passage='max_connections\n= 500\nmax_user_connections\n= 500\n#table_cache\n= 64\nthread_concurrency\n= 300\ntable_cache\n= 30000\nopen_files_limit\n= 65000\n#innodb_force_recovery =6 max_binlog_stmt_cache_size ', float_val=65000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.42629656195640564
Adding hint TuningHint(doc_id=63, param=<re.Match object; span=(0, 15), match='max_connections'>, value=<re.Match object; span=(0, 3), match='500'>, recommendation='500', passage='max_connections\n= 500\nmax_user_connections\n= 500\n#table_cache\n= 64\nthread_concurrency\n= 300\ntable_cache\n= 30000\nopen_files_limit\n= 65000\n#innodb_force_recovery =6 max_binlog_stmt_cache_size ', float_val=500.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.06019275635480881
Excluding recommendation "500" for parameter "max_user_connections" due to low confidence (0.022531524300575256)
Adding hint TuningHint(doc_id=63, param=<re.Match object; span=(138, 159), match='innodb_force_recovery'>, value=<re.Match object; span=(0, 1), match='6'>, recommendation='6', passage='max_connections\n= 500\nmax_user_connections\n= 500\n#table_cache\n= 64\nthread_concurrency\n= 300\ntable_cache\n= 30000\nopen_files_limit\n= 65000\n#innodb_force_recovery =6 max_binlog_stmt_cache_size ', float_val=6.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.10540053993463516
Adding hint TuningHint(doc_id=63, param=<re.Match object; span=(54, 70), match='query_cache_size'>, value=<re.Match object; span=(0, 4), match='300M'>, recommendation='300M', passage='# * Query Cache Configuration\nquery_cache_limit\n= 50M\nquery_cache_size\n= 300M\n# * Logging and Replication\n# * InnoDB\n# InnoDB is enabled by default with a 10MB datafile in /var/lib/mysql/. query_cache_limit ', float_val=300.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.5528660416603088
Adding hint TuningHint(doc_id=63, param=<re.Match object; span=(30, 47), match='query_cache_limit'>, value=<re.Match object; span=(0, 3), match='50M'>, recommendation='50M', passage='# * Query Cache Configuration\nquery_cache_limit\n= 50M\nquery_cache_size\n= 300M\n# * Logging and Replication\n# * InnoDB\n# InnoDB is enabled by default with a 10MB datafile in /var/lib/mysql/. query_cache_limit ', float_val=50.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>) with confidence 0.13803055882453918
Creating hints for document 64
Creating hints for document 65
Creating hints for document 66
Creating hints for document 67
Creating hints for document 68
Creating hints for document 69
Creating hints for document 70
Excluding recommendation "max_heap_table_size" for parameter "tmp_disk_table_size" due to low confidence (0.0008299084147438407)
Excluding recommendation "set them equal" for parameter "max_heap_table_size" due to low confidence (0.002527830423787236)
Excluding recommendation "tmp_table_size or max_heap_table_size" for parameter "thread_stack" due to low confidence (4.356447789177764e-06)
Excluding recommendation "tmp_table_size or max_heap_table_size" for parameter "max_connections" due to low confidence (0.00037335685919970274)
Excluding recommendation "max_heap_table_size" for parameter "tmp_table_size" due to low confidence (0.007560277823358774)
Creating hints for document 71
Creating hints for document 72
Creating hints for document 73
Creating hints for document 74
Creating hints for document 75
Creating hints for document 76
Creating hints for document 77
Creating hints for document 78
Creating hints for document 79
Creating hints for document 80
Creating hints for document 81
Creating hints for document 82
Creating hints for document 83
Creating hints for document 84
Creating hints for document 85
Creating hints for document 86
Creating hints for document 87
Creating hints for document 88
Creating hints for document 89
Creating hints for document 90
Creating hints for document 91
Creating hints for document 92
Creating hints for document 93
Creating hints for document 94
Creating hints for document 95
Creating hints for document 96
Creating hints for document 97
Creating hints for document 98
Initializing documents from file demo_docs/mariadb100 ...
Sample of tuning hints:
      filenr                    sentence
2211      29  store intermediate results
Nr. documents read: 99
Nr. passages by doc: [0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 4, 1, 0, 0, 5, 0, 0, 0, 0, 2, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2, 0, 0, 0, 0, 0, 0, 1, 0, 2, 1, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
Nr. mentions per assignment: [(('thread_cache_size', '8'), 3), (('max_connections', '200'), 2), (('table_open_cache', '64'), 2), (('innodb_buffer_pool_size', '80%'), 1), (('innodb_buffer_pool_size', '70'), 1), (('join_cache_level', '3'), 1), (('key_buffer_size', '32M'), 1), (('query_cache_min_res_unit', '2K'), 1), (('table_open_cache', '512'), 1), (('max_heap_table_size', '64MB'), 1), (('thread_cache_size', '16'), 1), (('tmp_table_size', '5'), 1), (('query_cache_size', '16'), 1), (('query_cache_min_res_unit', '4096'), 1), (('query_cache_min_res_unit', '4KB'), 1), (('innodb_flush_log_at_trx_commit', '0'), 1), (('log_slow_query_time', '1'), 1), (('expire_logs_days', '10'), 1), (('max_binlog_size', '100M'), 1), (('max_relay_log_size', '10'), 1), (('innodb_io_capacity_max', '200'), 1), (('innodb_flush_log_at_trx_commit', '2'), 1), (('innodb_io_capacity_max', '6000'), 1), (('max_allowed_packet', '64M'), 1), (('key_buffer_size', '8M'), 1), (('innodb_read_io_threads', '32'), 1), (('innodb_old_blocks_time', '1'), 1), (('innodb_io_capacity_max', '2'), 1), (('max_allowed_packet', '9'), 1), (('table_open_cache', '1'), 1), (('innodb_io_capacity_max', '100'), 1), (('open_files_limit', '1'), 1), (('innodb_log_file_size', '128M'), 1), (('max_connect_errors', '1000000'), 1), (('open_files_limit', '4000'), 1), (('innodb_buffer_pool_size', '23G'), 1), (('innodb_io_capacity_max', '1'), 1), (('innodb_old_blocks_time', '64'), 1), (('open_files_limit', '524288'), 1), (('innodb_old_blocks_time', '1000'), 1), (('wait_timeout', '30000'), 1), (('innodb_io_capacity_max', '64'), 1), (('open_files_limit', '65535'), 1), (('key_buffer_size', '64M'), 1), (('innodb_io_capacity', '4000'), 1), (('table_open_cache', '16'), 1), (('max_allowed_packet', '100000'), 1), (('max_connections', '150'), 1), (('max_connections', '1250'), 1), (('innodb_old_blocks_time', '8'), 1), (('connect_timeout', '300'), 1), (('key_buffer_size', '128M'), 1), (('max_allowed_packet', '0'), 1), (('innodb_write_io_threads', '32'), 1), (('table_open_cache_instances', '16'), 1), (('tmp_table_size', '32'), 1), (('thread_stack', '192'), 1), (('join_buffer_size', '1024'), 1), (('query_cache_size', '50'), 1), (('sort_buffer_size', '2048'), 1), (('read_buffer_size', '8192'), 1), (('query_cache_size', '0'), 1), (('table_open_cache', '2048'), 1), (('innodb_buffer_pool_size', '4096'), 1), (('thread_stack', '512'), 1), (('sort_buffer_size', '1024'), 1), (('binlog_cache_size', '32'), 1), (('key_buffer_size', '1200'), 1), (('tmp_table_size', '128'), 1), (('read_rnd_buffer_size', '512'), 1), (('sort_buffer_size', '10M'), 1), (('read_buffer_size', '256'), 1), (('read_buffer_size', '1024'), 1), (('innodb_buffer_pool_size', '180M'), 1), (('join_buffer_size', '2048'), 1), (('max_connections', '20'), 1), (('innodb_log_buffer_size', '8'), 1), (('key_buffer_size', '16'), 1), (('read_rnd_buffer_size', '4096'), 1), (('innodb_log_buffer_size', '32'), 1), (('binlog_cache_size', '64'), 1), (('max_connections', '500'), 1), (('open_files_limit', '65000'), 1), (('thread_stack', '128K'), 1), (('query_cache_size', '300M'), 1), (('query_cache_limit', '50M'), 1), (('max_allowed_packet', '16M'), 1), (('innodb_force_recovery', '6'), 1)]\n[Restart] MariaDB server shut down!
[Restart] MariaDB server restarted!
/scratch/s8todick/dbbert-slurm/venv/lib/python3.9/site-packages/mariadb/connections.py:85: RuntimeWarning: MariaDB Connector/Python was build with MariaDB Connector/C version 3.3.4 but loaded Connector/C library has version 10.5.21
  super().__init__(*args, **kwargs)

Nr. documents per parameter: [('thread_cache_size', 4), ('max_connections', 4), ('innodb_buffer_pool_size', 3), ('key_buffer_size', 3), ('table_open_cache', 3), ('query_cache_size', 3), ('query_cache_min_res_unit', 2), ('tmp_table_size', 2), ('innodb_flush_log_at_trx_commit', 2), ('open_files_limit', 2), ('max_allowed_packet', 2), ('thread_stack', 2), ('join_cache_level', 1), ('max_heap_table_size', 1), ('log_slow_query_time', 1), ('max_relay_log_size', 1), ('expire_logs_days', 1), ('max_binlog_size', 1), ('innodb_log_file_size', 1), ('table_open_cache_instances', 1), ('connect_timeout', 1), ('innodb_io_capacity', 1), ('wait_timeout', 1), ('innodb_io_capacity_max', 1), ('max_connect_errors', 1), ('innodb_read_io_threads', 1), ('innodb_write_io_threads', 1), ('innodb_old_blocks_time', 1), ('sort_buffer_size', 1), ('innodb_log_buffer_size', 1), ('join_buffer_size', 1), ('read_rnd_buffer_size', 1), ('read_buffer_size', 1), ('binlog_cache_size', 1), ('query_cache_limit', 1), ('innodb_force_recovery', 1)]
Disconnecting ...
Trying to connect to tpch with user kaltenec
Trying update set session max_execution_time = 1500000
Exception during update: Unknown system variable 'max_execution_time'
Trying update update mariadb.server_cost set cost_value = NULL
Exception during update: Table 'mariadb.server_cost' doesn't exist
Trying update update mariadb.engine_cost set cost_value = NULL
Exception during update: Table 'mariadb.engine_cost' doesn't exist
--- Tuning Updates ---
Minimal time (ms): inf
Achieved with configuration: {}
Maximal time (ms): 0
Achieved with configuration: {}
All hints considered for multi-doc tuning:
Hint 0: thread_cache_size -> 16
Hint 1: thread_cache_size -> 8
Hint 2: thread_cache_size -> 8
Hint 3: thread_cache_size -> 8
Hint 4: max_connections -> 200
Hint 5: max_connections -> 1250
Hint 6: max_connections -> 150
Hint 7: max_connections -> 200
Hint 8: max_connections -> 20
Hint 9: max_connections -> 500
Hint 10: innodb_buffer_pool_size -> 70
Hint 11: innodb_buffer_pool_size -> 80%
Hint 12: innodb_buffer_pool_size -> 23G
Hint 13: innodb_buffer_pool_size -> 4096
Hint 14: innodb_buffer_pool_size -> 180M
Hint 15: key_buffer_size -> 32M
Hint 16: key_buffer_size -> 64M
Hint 17: key_buffer_size -> 8M
Hint 18: key_buffer_size -> 128M
Hint 19: key_buffer_size -> 1200
Hint 20: key_buffer_size -> 16
Hint 21: table_open_cache -> 512
Hint 22: table_open_cache -> 16
Hint 23: table_open_cache -> 1
Hint 24: table_open_cache -> 1
Hint 25: table_open_cache -> 64
Hint 26: table_open_cache -> 2048
Hint 27: table_open_cache -> 64
Hint 28: query_cache_size -> 16
Hint 29: query_cache_size -> 50
Hint 30: query_cache_size -> 0
Hint 31: query_cache_size -> 300M
Hint 32: query_cache_min_res_unit -> 2K
Hint 33: query_cache_min_res_unit -> 4096
Hint 34: query_cache_min_res_unit -> 4KB
Hint 35: tmp_table_size -> 5
Hint 36: tmp_table_size -> 128
Hint 37: tmp_table_size -> 32
Hint 38: innodb_flush_log_at_trx_commit -> 0
Hint 39: innodb_flush_log_at_trx_commit -> 2
Hint 40: open_files_limit -> 65535
Hint 41: open_files_limit -> 1
Hint 42: open_files_limit -> 4000
Hint 43: open_files_limit -> 524288
Hint 44: open_files_limit -> 65000
Hint 45: max_allowed_packet -> 64M
Hint 46: max_allowed_packet -> 0
Hint 47: max_allowed_packet -> 9
Hint 48: max_allowed_packet -> 100000
Hint 49: max_allowed_packet -> 16M
Hint 50: thread_stack -> 512
Hint 51: thread_stack -> 192
Hint 52: thread_stack -> 128K
Hint 53: join_cache_level -> 3
Hint 54: max_heap_table_size -> 64MB
Hint 55: log_slow_query_time -> 1
Hint 56: max_relay_log_size -> 10
Hint 57: expire_logs_days -> 10
Hint 58: max_binlog_size -> 100M
Hint 59: innodb_log_file_size -> 128M
Hint 60: table_open_cache_instances -> 16
Hint 61: connect_timeout -> 300
Hint 62: innodb_io_capacity -> 4000
Hint 63: wait_timeout -> 30000
Hint 64: innodb_io_capacity_max -> 6000
Hint 65: innodb_io_capacity_max -> 100
Hint 66: innodb_io_capacity_max -> 200
Hint 67: innodb_io_capacity_max -> 2
Hint 68: innodb_io_capacity_max -> 64
Hint 69: innodb_io_capacity_max -> 1
Hint 70: max_connect_errors -> 1000000
Hint 71: innodb_read_io_threads -> 32
Hint 72: innodb_write_io_threads -> 32
Hint 73: innodb_old_blocks_time -> 1000
Hint 74: innodb_old_blocks_time -> 1
Hint 75: innodb_old_blocks_time -> 8
Hint 76: innodb_old_blocks_time -> 64
Hint 77: sort_buffer_size -> 2048
Hint 78: sort_buffer_size -> 1024
Hint 79: sort_buffer_size -> 10M
Hint 80: innodb_log_buffer_size -> 32
Hint 81: innodb_log_buffer_size -> 8
Hint 82: join_buffer_size -> 2048
Hint 83: join_buffer_size -> 1024
Hint 84: read_rnd_buffer_size -> 512
Hint 85: read_rnd_buffer_size -> 4096
Hint 86: read_buffer_size -> 256
Hint 87: read_buffer_size -> 1024
Hint 88: read_buffer_size -> 8192
Hint 89: binlog_cache_size -> 64
Hint 90: binlog_cache_size -> 32
Hint 91: query_cache_limit -> 50M
Hint 92: innodb_force_recovery -> 6
--- Tuning Updates ---
Minimal time (ms): 59182.109375
Achieved with configuration: {}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
No warmup - hint counter: 0
{'sequence': '16 or so', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation', 'Decrease recommendation strongly', 'Increase recommendation'], 'scores': [0.28911828994750977, 0.18617865443229675, 0.1852453649044037, 0.18521332740783691, 0.15424436330795288]}
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(568, 585), match='thread_cache_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16 or so', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18521332740783691, 0.1852453649044037, 0.28911828994750977, 0.15424436330795288, 0.18617865443229675]
Using cpu device
Wrapping the env with a `Monitor` wrapper
Wrapping the env in a DummyVecEnv.
--- Tuning Updates ---
Minimal time (ms): 59182.109375
Achieved with configuration: {}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(568, 585), match='thread_cache_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16 or so', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18521332740783691, 0.1852453649044037, 0.28911828994750977, 0.15424436330795288, 0.18617865443229675]
Choice: 1
Done flag: False
No warmup - hint counter: 0
{'sequence': '16 or so', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.50733482837677, 0.1963784247636795, 0.14746752381324768, 0.12025613337755203, 0.028563059866428375]}
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(568, 585), match='thread_cache_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16 or so', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.028563059866428375, 0.50733482837677, 0.1963784247636795, 0.14746752381324768, 0.12025613337755203]
Choice: 3
Trying update set global thread_cache_size=8
Trying update set global thread_cache_size=100
Trying assigning thread_cache_size to 8
Adding assignment ('thread_cache_size', '8') with weight 8
Assignment ('thread_cache_size', '8') extracted from "Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).
Adjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size "
Hint counter: 1
Episode hint counter before: 0
Episode hint counter: 1
Hints per episode: 20
Done flag: False
No warmup - hint counter: 1
{'sequence': '8', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Increase recommendation', 'Decrease recommendation'], 'scores': [0.266186386346817, 0.2173980474472046, 0.1844906359910965, 0.17978301644325256, 0.15214183926582336]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(118, 135), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1844906359910965, 0.15214183926582336, 0.266186386346817, 0.17978301644325256, 0.2173980474472046]
Choice: 0
Done flag: False
No warmup - hint counter: 1
{'sequence': '8', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.46210938692092896, 0.20298469066619873, 0.1625889241695404, 0.145525261759758, 0.026791756972670555]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(118, 135), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.026791756972670555, 0.46210938692092896, 0.20298469066619873, 0.1625889241695404, 0.145525261759758]
Choice: 0
Trying update set global thread_cache_size=2
Trying update set global thread_cache_size=100
Trying assigning thread_cache_size to 2
Adding assignment ('thread_cache_size', '2') with weight 1
Assignment ('thread_cache_size', '2') extracted from "tmp-table-size = 96M
max-heap-table-size = 96M
key_buffer_size = 64M
# Connections and Threads
max_connections = 1250
thread_cache_size = 8
max_allowed_packet = 64M thread_pool_max_threads "
Hint counter: 2
Episode hint counter before: 1
Episode hint counter: 2
Hints per episode: 20
Done flag: False
No warmup - hint counter: 2
{'sequence': '8', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Increase recommendation', 'Decrease recommendation'], 'scores': [0.266186386346817, 0.2173980474472046, 0.1844906359910965, 0.17978301644325256, 0.15214183926582336]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(23, 40), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1844906359910965, 0.15214183926582336, 0.266186386346817, 0.17978301644325256, 0.2173980474472046]
Choice: 4
Done flag: False
No warmup - hint counter: 2
{'sequence': '8', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.46210938692092896, 0.20298469066619873, 0.1625889241695404, 0.145525261759758, 0.026791756972670555]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(23, 40), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.026791756972670555, 0.46210938692092896, 0.20298469066619873, 0.1625889241695404, 0.145525261759758]
--- Tuning Updates ---
Minimal time (ms): 59182.109375
Achieved with configuration: {}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(23, 40), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1844906359910965, 0.15214183926582336, 0.266186386346817, 0.17978301644325256, 0.2173980474472046]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(23, 40), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.026791756972670555, 0.46210938692092896, 0.20298469066619873, 0.1625889241695404, 0.145525261759758]
Choice: 1
Trying update set global thread_cache_size=8
Trying update set global thread_cache_size=100
Trying assigning thread_cache_size to 8
Adding assignment ('thread_cache_size', '8') with weight 2
Assignment ('thread_cache_size', '8') extracted from "binlog_cache_size = 32
thread_cache_size = 8
table_open_cache = 64
max_connections = 20
PHP:
max_children = 10
start_servers = 2
min_spare_servers = 1
max_spare_servers = 3 binlog_stmt_cache_size "
Hint counter: 3
Episode hint counter before: 2
Episode hint counter: 3
Hints per episode: 20
Done flag: False
No warmup - hint counter: 3
{'sequence': '8\n', 'labels': ['Use recommendation', 'Decrease recommendation', 'Decrease recommendation strongly', 'Increase recommendation', 'Increase recommendation strongly'], 'scores': [0.28335413336753845, 0.22041219472885132, 0.18013985455036163, 0.17767491936683655, 0.13841883838176727]}
Decision: Deciding adaption of TuningHint(doc_id=63, param=<re.Match object; span=(66, 83), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8\n', passage='key_buffer\t\t= 2000M\nmax_allowed_packet\t= 16M\nthread_stack\t\t= 128K\nthread_cache_size\t= 8\n# This replaces the startup script and checks MyISAM tables if needed\n# the first time they are touched\nmyisam-recover\t\t= BACKUP table_open_cache_instances ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18013985455036163, 0.22041219472885132, 0.28335413336753845, 0.17767491936683655, 0.13841883838176727]
Choice: 4
Done flag: False
No warmup - hint counter: 3
{'sequence': '8\n', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.46155181527137756, 0.19460640847682953, 0.1654755026102066, 0.15352493524551392, 0.02484126389026642]}
Decision: Deciding weight of TuningHint(doc_id=63, param=<re.Match object; span=(66, 83), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8\n', passage='key_buffer\t\t= 2000M\nmax_allowed_packet\t= 16M\nthread_stack\t\t= 128K\nthread_cache_size\t= 8\n# This replaces the startup script and checks MyISAM tables if needed\n# the first time they are touched\nmyisam-recover\t\t= BACKUP table_open_cache_instances ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02484126389026642, 0.46155181527137756, 0.19460640847682953, 0.1654755026102066, 0.15352493524551392]
Choice: 1
Trying update set global thread_cache_size=32
Trying update set global thread_cache_size=100
Trying assigning thread_cache_size to 32
Adding assignment ('thread_cache_size', '32') with weight 2
Assignment ('thread_cache_size', '32') extracted from "key_buffer		= 2000M
max_allowed_packet	= 16M
thread_stack		= 128K
thread_cache_size	= 8
# This replaces the startup script and checks MyISAM tables if needed
# the first time they are touched
myisam-recover		= BACKUP table_open_cache_instances "
Hint counter: 4
Episode hint counter before: 3
Episode hint counter: 4
Hints per episode: 20
Done flag: False
No warmup - hint counter: 4
{'sequence': '200', 'labels': ['Use recommendation', 'Decrease recommendation', 'Decrease recommendation strongly', 'Increase recommendation', 'Increase recommendation strongly'], 'scores': [0.24968837201595306, 0.20679712295532227, 0.20448258519172668, 0.1696714460849762, 0.16936053335666656]}
Decision: Deciding adaption of TuningHint(doc_id=38, param=<re.Match object; span=(1999, 2014), match='max_connections'>, value=<re.Match object; span=(0, 3), match='200'>, recommendation='200', passage='hayden_james@linux\xa0aboutarticlesservicesfeedbacksponsorscontactforumsMySQL Database Performance: Avoid this common mistake March 21, 2023 by Hayden James, in Blog LinuxOne frequent topic of support request emails I receive is MySQL database performance. Clients complain about MySQL using too much server memory, too many MySQL slow queries, the famous Mysql server has gone away errors, and many other MySQL performance-related issues. As such, I wanted to share solutions to some common MySQL configuration mistakes.If you are a DBA, feel free to share your experiences or suggestions in the comments section. I’m referring to four MySQL config variables. These four my.cnf config lines are often responsible for poor MySQL database performance and scaling due to insufficient server memory for incoming connections. This article also applies to MariaDB and Percona drop-in replacements for MySQL.Note: This is an update and follow-up to this article. I’ve added some relevant and more up-to-date information and links, as well as a new section that covers some additional my.cnf performance config tips.\xa0Avoid arbitrarily increasing MySQL per-connection buffers Excerpt of my.cnf edits for a client. (some lines were removed and some blurred to avoid misuse)Who knows where or when this bad practice started. I frequently encounter instances where I log into production servers for the first time and find that the values of virtually every my.cnf variable have been arbitrarily increased without sound reasoning behind the changes.This is never a good practice, especially for four my.cnf variables discussed below. Although increasing the value of some variables can improve performance, these four will almost always degrade MySQL server performance and capacity when increased.The four buffers in question are the\xa0join_buffer_size,\xa0sort_buffer_size,\xa0read_buffer_size and read_rnd_buffer_size.These four buffers are\xa0allocated per connection. For example, a setting of join_buffer_size=1M\xa0with\xa0max_connections=200 will configure MySQL to allocate an additional 1M per connection (1M x 200). The same goes for the other three buffers. Again, all are per connection.A good rule of thumb is that if you can’t provide a valid reason to increase any of these buffers, keep them set to the default values.In nearly all cases, it’s best to keep the defaults by removing or commenting out these four config lines. As connections increase with traffic, queries that need more space than what’s available due to larger buffer settings may trigger paging those buffers to disk. This dramatically slows down your DB server and creates a bottleneck.I’ve often seen significantly improved MySQL performance by simply reverting these buffers to their defaults. Also, read Analyzing Linux server performance with atop.The above screenshot shows MySQL status output two weeks after I made the first my.cnf optimization pass. Now, let’s take a closer look at each of these buffers.\xa0MySQL join_buffer_sizeThe join_buffer_size is allocated for each full join between two tables. From MySQL’s documentation the join_buffer_size is described as: “The minimum size of the buffer that is used for plain index scans, range index scans, and joins that do not use indexes and thus perform full table scans.”MySQL’s documentation goes on to say: “Memory allocation time can cause substantial performance drops if the global size is larger than needed by most queries that use it.” The join buffer is allocated to cache table rows when the join can’t use an index.If your database suffers from many joins performed without indexes, it cannot be solved by increasing join_buffer_size. The problem is “joins performed without indexes.” Thus, the solution for faster joins is to add indexes.\xa0MySQL sort_buffer_sizeUnless you have data indicating otherwise, you should avoid arbitrarily increasing the\xa0sort_buffer_size. Memory here is also assigned per connection!MySQL’s documentation warns: “On Linux, there are thresholds of 256KB and 2MB where larger values may significantly slow down memory allocation, so you should consider staying below one of those values.”Avoid increasing sort_buffer_size above 2M since there is a performance penalty that will eliminate benefits.\xa0MySQL read_buffer_size & read_rnd_buffer_sizeUpdate: Some of you still use MyISAM over InnoDB. MyISAM is based on the old ISAM storage engine. It has many useful extensions, as discussed here. You should consider converting your MySQL tables to the InnoDB storage engine.InnoDB is the default storage engine of MySQL 5.7 and MySQL 8.0. InnoDB features improved performance, rollback and crash-recovery capabilities to protect data. read_buffer_size\xa0Applies generally to MyISAM.Each request that performs a sequential table scan allocates a read buffer. The read_buffer_size\xa0system variable determines the buffer size.Starting from MySQL 8.0.22, the value of select_into_buffer_size overrides the value of read_buffer_size when performing SELECT INTO DUMPFILE and SELECT INTO OUTFILE statements. read_buffer_size\xa0is used for the I/O cache buffer size in all other cases.The read_rnd_buffer_size variable is also used mainly for\xa0MyISAM reads from tables. Again, consider InnoDB or MariaDB’s Aria storage engines. For the past decade, the default values of these buffers have remained the same.\xa0Additional my.cnf Performance config tipsMonitor the appropriate MySQL status variable_name(s) to assist you in tuning the below config lines. An example of viewing the status of MySQL runtime variables. (So I increased max_connections)max_connectionsA MySQL configuration parameter that sets the maximum number of concurrent connections the server can handle. A value that is too large can allocate too much server memory and lead to performance issues, while a low value can result in connection rejections.To tune this parameter, monitor the max_used_connections status variable; try to set this to ~ 2x to 3x your max used connections after a few days of uptime. However, if your MySQL max connections are more than 200 then make sure to have at least 100 extra connections available. So if max_used_connections is 300 then set max_connections to at least 400. Watch memory usage!!thread_cache_sizeDetermines the number of threads that can be cached and reused by the server. Properly tuning this parameter can help improve the performance of your MySQL server by reducing the overhead of creating new threads and freeing up system resources.To tune this parameter, you can monitor the threads_created and threads_cached status variables and set the value to a reasonable number based on the number of expected concurrent connections. As a general rule, a value of 16 is a good starting point. Then increase gradually until it’s at least 50% of max_connections. For example, if the threads_cached value is 16 and the max_used_connections value is 40 then increase this from 16 to 32. At the same time, as per above advice, if max_used_connections is 40 then your max_connections should be at least 80.table_definition_cacheA MySQL configuration parameter that sets the number of table definitions (metadata) that can be stored in the cache. A high value of table_definition_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of reading the table definition from disk.To tune this parameter, monitor the opened_table_definitions and open_table_definitionsstatus variables, set table_definition_cache to ~ 2x the number of open table definitions and adjust as needed. Consider other factors, such as system memory and query complexity when tuning. .table_open_cacheA MySQL configuration parameter that sets the number of open table objects that can be stored in the cache. A high value of table_open_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of opening tables from disk.To tune this parameter, monitor the opened_tables and open_tables status variables, set table_open_cache to ~ 2x the number of open tables, and adjust as needed. Consider other factors such as memory and query complexity when tuning. Generally table_open_cache and table_definition_cache are set to the same value. The number of open table objects and table definitions are directly related, so setting these two parameters to the same value can ensure that the metadata and open table objects are stored in the cache in a consistent and efficient manner.wait_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on a non-interactive connection before closing it. A high value of wait_timeout can result in increased memory usage and increased # of connections, while a low value can result in frequent disconnections for long-running queries.To tune this parameter, set wait_timeout to the lowest resonable expected duration of non-interactive connections, and adjust as needed. The default value is 28800 seconds. This is way to high in most cases and will consume a lot of system memory by keeping many connections open. I set most of my configs to 30 seconds or less.connect_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for a successful connection to be established before timing out. A high value of connect_timeout can result in increased wait time for clients and increase in max_connections. A low value can result in connection failures for slow or heavily loaded servers.To tune this parameter, set connect_timeout to a reasonable value based on the expected response time of the server. Consider other factors such as network latency, mobile users, and server load when tuning. I set most of my configs to 15 seconds or less. For example, this blog’s mysql connection timeout is set to 5 seconds.interactive_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on an interactive connection before closing it. A high value of interactive_timeout can result in increased memory usage and increased concurrent connetions. A low value can result in frequent disconnections for long-running queries.To tune this parameter, set interactive_timeout to a reasonable value based on the expected duration of your longest-running requests.tmp_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables used by the server. When a query creates a temporary table that exceeds the value of tmp_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set tmp_table_size to a reasonable value based on the available memory and the value of the created_tmp_disk_table variable.max_heap_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables created with the MEMORY storage engine. When a query creates a temporary table that exceeds the value of max_heap_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set max_heap_table_size to the same value as tmp_table_size.Want more tips?For example, Innodb tuning tips, setting open_files_limit, etc. Let me know your interests in the comments section below, or hire me for MySQL optimization.\xa0Additional MySQL performance related articlesMySQL Performance Tuning: Tips, Scripts and Tools.MySQL Performance: Stop hoarding. Drop unused MySQL databases.“MySQL server has gone away” error – Solution(s).Could not increase number of max_open_files to more than… (Solution).Linux server performance: Is disk I/O slowing your application?Tuning MySQL my.cnf? Avoid this common pitfall!\xa0ConclusionIn conclusion, we discussed some common issues with MySQL performance often raised in support requests. The focus was on four specific my.cnf variables frequently responsible for poor database performance and scaling due to a shortage of server memory.It was emphasized that arbitrarily increasing these variables can lead to a decline in MySQL server performance and capacity and that it is important to keep these buffers set to their default values unless there is a specific reason to increase them. Then we covered tuning some additional MySQL performance config lines.A good rule of thumb: if you can’t provide a valid reason for increasing these buffers, keep them set to the default values. This also applies less strictly to all of MySQL’s variables. Be careful when making changes, don’t overwrite your entire my.cnf all at once. Back up everything first, make one or two changes per restart and test for 24 to 48 hours before making another pass. wsrep_mysql_replication_bundle ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20448258519172668, 0.20679712295532227, 0.24968837201595306, 0.1696714460849762, 0.16936053335666656]
Choice: 2
Done flag: False
No warmup - hint counter: 4
{'sequence': '200', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4574962556362152, 0.20133262872695923, 0.16734036803245544, 0.14990268647670746, 0.023928122594952583]}
Decision: Deciding weight of TuningHint(doc_id=38, param=<re.Match object; span=(1999, 2014), match='max_connections'>, value=<re.Match object; span=(0, 3), match='200'>, recommendation='200', passage='hayden_james@linux\xa0aboutarticlesservicesfeedbacksponsorscontactforumsMySQL Database Performance: Avoid this common mistake March 21, 2023 by Hayden James, in Blog LinuxOne frequent topic of support request emails I receive is MySQL database performance. Clients complain about MySQL using too much server memory, too many MySQL slow queries, the famous Mysql server has gone away errors, and many other MySQL performance-related issues. As such, I wanted to share solutions to some common MySQL configuration mistakes.If you are a DBA, feel free to share your experiences or suggestions in the comments section. I’m referring to four MySQL config variables. These four my.cnf config lines are often responsible for poor MySQL database performance and scaling due to insufficient server memory for incoming connections. This article also applies to MariaDB and Percona drop-in replacements for MySQL.Note: This is an update and follow-up to this article. I’ve added some relevant and more up-to-date information and links, as well as a new section that covers some additional my.cnf performance config tips.\xa0Avoid arbitrarily increasing MySQL per-connection buffers Excerpt of my.cnf edits for a client. (some lines were removed and some blurred to avoid misuse)Who knows where or when this bad practice started. I frequently encounter instances where I log into production servers for the first time and find that the values of virtually every my.cnf variable have been arbitrarily increased without sound reasoning behind the changes.This is never a good practice, especially for four my.cnf variables discussed below. Although increasing the value of some variables can improve performance, these four will almost always degrade MySQL server performance and capacity when increased.The four buffers in question are the\xa0join_buffer_size,\xa0sort_buffer_size,\xa0read_buffer_size and read_rnd_buffer_size.These four buffers are\xa0allocated per connection. For example, a setting of join_buffer_size=1M\xa0with\xa0max_connections=200 will configure MySQL to allocate an additional 1M per connection (1M x 200). The same goes for the other three buffers. Again, all are per connection.A good rule of thumb is that if you can’t provide a valid reason to increase any of these buffers, keep them set to the default values.In nearly all cases, it’s best to keep the defaults by removing or commenting out these four config lines. As connections increase with traffic, queries that need more space than what’s available due to larger buffer settings may trigger paging those buffers to disk. This dramatically slows down your DB server and creates a bottleneck.I’ve often seen significantly improved MySQL performance by simply reverting these buffers to their defaults. Also, read Analyzing Linux server performance with atop.The above screenshot shows MySQL status output two weeks after I made the first my.cnf optimization pass. Now, let’s take a closer look at each of these buffers.\xa0MySQL join_buffer_sizeThe join_buffer_size is allocated for each full join between two tables. From MySQL’s documentation the join_buffer_size is described as: “The minimum size of the buffer that is used for plain index scans, range index scans, and joins that do not use indexes and thus perform full table scans.”MySQL’s documentation goes on to say: “Memory allocation time can cause substantial performance drops if the global size is larger than needed by most queries that use it.” The join buffer is allocated to cache table rows when the join can’t use an index.If your database suffers from many joins performed without indexes, it cannot be solved by increasing join_buffer_size. The problem is “joins performed without indexes.” Thus, the solution for faster joins is to add indexes.\xa0MySQL sort_buffer_sizeUnless you have data indicating otherwise, you should avoid arbitrarily increasing the\xa0sort_buffer_size. Memory here is also assigned per connection!MySQL’s documentation warns: “On Linux, there are thresholds of 256KB and 2MB where larger values may significantly slow down memory allocation, so you should consider staying below one of those values.”Avoid increasing sort_buffer_size above 2M since there is a performance penalty that will eliminate benefits.\xa0MySQL read_buffer_size & read_rnd_buffer_sizeUpdate: Some of you still use MyISAM over InnoDB. MyISAM is based on the old ISAM storage engine. It has many useful extensions, as discussed here. You should consider converting your MySQL tables to the InnoDB storage engine.InnoDB is the default storage engine of MySQL 5.7 and MySQL 8.0. InnoDB features improved performance, rollback and crash-recovery capabilities to protect data. read_buffer_size\xa0Applies generally to MyISAM.Each request that performs a sequential table scan allocates a read buffer. The read_buffer_size\xa0system variable determines the buffer size.Starting from MySQL 8.0.22, the value of select_into_buffer_size overrides the value of read_buffer_size when performing SELECT INTO DUMPFILE and SELECT INTO OUTFILE statements. read_buffer_size\xa0is used for the I/O cache buffer size in all other cases.The read_rnd_buffer_size variable is also used mainly for\xa0MyISAM reads from tables. Again, consider InnoDB or MariaDB’s Aria storage engines. For the past decade, the default values of these buffers have remained the same.\xa0Additional my.cnf Performance config tipsMonitor the appropriate MySQL status variable_name(s) to assist you in tuning the below config lines. An example of viewing the status of MySQL runtime variables. (So I increased max_connections)max_connectionsA MySQL configuration parameter that sets the maximum number of concurrent connections the server can handle. A value that is too large can allocate too much server memory and lead to performance issues, while a low value can result in connection rejections.To tune this parameter, monitor the max_used_connections status variable; try to set this to ~ 2x to 3x your max used connections after a few days of uptime. However, if your MySQL max connections are more than 200 then make sure to have at least 100 extra connections available. So if max_used_connections is 300 then set max_connections to at least 400. Watch memory usage!!thread_cache_sizeDetermines the number of threads that can be cached and reused by the server. Properly tuning this parameter can help improve the performance of your MySQL server by reducing the overhead of creating new threads and freeing up system resources.To tune this parameter, you can monitor the threads_created and threads_cached status variables and set the value to a reasonable number based on the number of expected concurrent connections. As a general rule, a value of 16 is a good starting point. Then increase gradually until it’s at least 50% of max_connections. For example, if the threads_cached value is 16 and the max_used_connections value is 40 then increase this from 16 to 32. At the same time, as per above advice, if max_used_connections is 40 then your max_connections should be at least 80.table_definition_cacheA MySQL configuration parameter that sets the number of table definitions (metadata) that can be stored in the cache. A high value of table_definition_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of reading the table definition from disk.To tune this parameter, monitor the opened_table_definitions and open_table_definitionsstatus variables, set table_definition_cache to ~ 2x the number of open table definitions and adjust as needed. Consider other factors, such as system memory and query complexity when tuning. .table_open_cacheA MySQL configuration parameter that sets the number of open table objects that can be stored in the cache. A high value of table_open_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of opening tables from disk.To tune this parameter, monitor the opened_tables and open_tables status variables, set table_open_cache to ~ 2x the number of open tables, and adjust as needed. Consider other factors such as memory and query complexity when tuning. Generally table_open_cache and table_definition_cache are set to the same value. The number of open table objects and table definitions are directly related, so setting these two parameters to the same value can ensure that the metadata and open table objects are stored in the cache in a consistent and efficient manner.wait_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on a non-interactive connection before closing it. A high value of wait_timeout can result in increased memory usage and increased # of connections, while a low value can result in frequent disconnections for long-running queries.To tune this parameter, set wait_timeout to the lowest resonable expected duration of non-interactive connections, and adjust as needed. The default value is 28800 seconds. This is way to high in most cases and will consume a lot of system memory by keeping many connections open. I set most of my configs to 30 seconds or less.connect_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for a successful connection to be established before timing out. A high value of connect_timeout can result in increased wait time for clients and increase in max_connections. A low value can result in connection failures for slow or heavily loaded servers.To tune this parameter, set connect_timeout to a reasonable value based on the expected response time of the server. Consider other factors such as network latency, mobile users, and server load when tuning. I set most of my configs to 15 seconds or less. For example, this blog’s mysql connection timeout is set to 5 seconds.interactive_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on an interactive connection before closing it. A high value of interactive_timeout can result in increased memory usage and increased concurrent connetions. A low value can result in frequent disconnections for long-running queries.To tune this parameter, set interactive_timeout to a reasonable value based on the expected duration of your longest-running requests.tmp_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables used by the server. When a query creates a temporary table that exceeds the value of tmp_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set tmp_table_size to a reasonable value based on the available memory and the value of the created_tmp_disk_table variable.max_heap_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables created with the MEMORY storage engine. When a query creates a temporary table that exceeds the value of max_heap_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set max_heap_table_size to the same value as tmp_table_size.Want more tips?For example, Innodb tuning tips, setting open_files_limit, etc. Let me know your interests in the comments section below, or hire me for MySQL optimization.\xa0Additional MySQL performance related articlesMySQL Performance Tuning: Tips, Scripts and Tools.MySQL Performance: Stop hoarding. Drop unused MySQL databases.“MySQL server has gone away” error – Solution(s).Could not increase number of max_open_files to more than… (Solution).Linux server performance: Is disk I/O slowing your application?Tuning MySQL my.cnf? Avoid this common pitfall!\xa0ConclusionIn conclusion, we discussed some common issues with MySQL performance often raised in support requests. The focus was on four specific my.cnf variables frequently responsible for poor database performance and scaling due to a shortage of server memory.It was emphasized that arbitrarily increasing these variables can lead to a decline in MySQL server performance and capacity and that it is important to keep these buffers set to their default values unless there is a specific reason to increase them. Then we covered tuning some additional MySQL performance config lines.A good rule of thumb: if you can’t provide a valid reason for increasing these buffers, keep them set to the default values. This also applies less strictly to all of MySQL’s variables. Be careful when making changes, don’t overwrite your entire my.cnf all at once. Back up everything first, make one or two changes per restart and test for 24 to 48 hours before making another pass. wsrep_mysql_replication_bundle ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.023928122594952583, 0.4574962556362152, 0.20133262872695923, 0.16734036803245544, 0.14990268647670746]
--- Tuning Updates ---
Minimal time (ms): 59182.109375
Achieved with configuration: {}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=38, param=<re.Match object; span=(1999, 2014), match='max_connections'>, value=<re.Match object; span=(0, 3), match='200'>, recommendation='200', passage='hayden_james@linux\xa0aboutarticlesservicesfeedbacksponsorscontactforumsMySQL Database Performance: Avoid this common mistake March 21, 2023 by Hayden James, in Blog LinuxOne frequent topic of support request emails I receive is MySQL database performance. Clients complain about MySQL using too much server memory, too many MySQL slow queries, the famous Mysql server has gone away errors, and many other MySQL performance-related issues. As such, I wanted to share solutions to some common MySQL configuration mistakes.If you are a DBA, feel free to share your experiences or suggestions in the comments section. I’m referring to four MySQL config variables. These four my.cnf config lines are often responsible for poor MySQL database performance and scaling due to insufficient server memory for incoming connections. This article also applies to MariaDB and Percona drop-in replacements for MySQL.Note: This is an update and follow-up to this article. I’ve added some relevant and more up-to-date information and links, as well as a new section that covers some additional my.cnf performance config tips.\xa0Avoid arbitrarily increasing MySQL per-connection buffers Excerpt of my.cnf edits for a client. (some lines were removed and some blurred to avoid misuse)Who knows where or when this bad practice started. I frequently encounter instances where I log into production servers for the first time and find that the values of virtually every my.cnf variable have been arbitrarily increased without sound reasoning behind the changes.This is never a good practice, especially for four my.cnf variables discussed below. Although increasing the value of some variables can improve performance, these four will almost always degrade MySQL server performance and capacity when increased.The four buffers in question are the\xa0join_buffer_size,\xa0sort_buffer_size,\xa0read_buffer_size and read_rnd_buffer_size.These four buffers are\xa0allocated per connection. For example, a setting of join_buffer_size=1M\xa0with\xa0max_connections=200 will configure MySQL to allocate an additional 1M per connection (1M x 200). The same goes for the other three buffers. Again, all are per connection.A good rule of thumb is that if you can’t provide a valid reason to increase any of these buffers, keep them set to the default values.In nearly all cases, it’s best to keep the defaults by removing or commenting out these four config lines. As connections increase with traffic, queries that need more space than what’s available due to larger buffer settings may trigger paging those buffers to disk. This dramatically slows down your DB server and creates a bottleneck.I’ve often seen significantly improved MySQL performance by simply reverting these buffers to their defaults. Also, read Analyzing Linux server performance with atop.The above screenshot shows MySQL status output two weeks after I made the first my.cnf optimization pass. Now, let’s take a closer look at each of these buffers.\xa0MySQL join_buffer_sizeThe join_buffer_size is allocated for each full join between two tables. From MySQL’s documentation the join_buffer_size is described as: “The minimum size of the buffer that is used for plain index scans, range index scans, and joins that do not use indexes and thus perform full table scans.”MySQL’s documentation goes on to say: “Memory allocation time can cause substantial performance drops if the global size is larger than needed by most queries that use it.” The join buffer is allocated to cache table rows when the join can’t use an index.If your database suffers from many joins performed without indexes, it cannot be solved by increasing join_buffer_size. The problem is “joins performed without indexes.” Thus, the solution for faster joins is to add indexes.\xa0MySQL sort_buffer_sizeUnless you have data indicating otherwise, you should avoid arbitrarily increasing the\xa0sort_buffer_size. Memory here is also assigned per connection!MySQL’s documentation warns: “On Linux, there are thresholds of 256KB and 2MB where larger values may significantly slow down memory allocation, so you should consider staying below one of those values.”Avoid increasing sort_buffer_size above 2M since there is a performance penalty that will eliminate benefits.\xa0MySQL read_buffer_size & read_rnd_buffer_sizeUpdate: Some of you still use MyISAM over InnoDB. MyISAM is based on the old ISAM storage engine. It has many useful extensions, as discussed here. You should consider converting your MySQL tables to the InnoDB storage engine.InnoDB is the default storage engine of MySQL 5.7 and MySQL 8.0. InnoDB features improved performance, rollback and crash-recovery capabilities to protect data. read_buffer_size\xa0Applies generally to MyISAM.Each request that performs a sequential table scan allocates a read buffer. The read_buffer_size\xa0system variable determines the buffer size.Starting from MySQL 8.0.22, the value of select_into_buffer_size overrides the value of read_buffer_size when performing SELECT INTO DUMPFILE and SELECT INTO OUTFILE statements. read_buffer_size\xa0is used for the I/O cache buffer size in all other cases.The read_rnd_buffer_size variable is also used mainly for\xa0MyISAM reads from tables. Again, consider InnoDB or MariaDB’s Aria storage engines. For the past decade, the default values of these buffers have remained the same.\xa0Additional my.cnf Performance config tipsMonitor the appropriate MySQL status variable_name(s) to assist you in tuning the below config lines. An example of viewing the status of MySQL runtime variables. (So I increased max_connections)max_connectionsA MySQL configuration parameter that sets the maximum number of concurrent connections the server can handle. A value that is too large can allocate too much server memory and lead to performance issues, while a low value can result in connection rejections.To tune this parameter, monitor the max_used_connections status variable; try to set this to ~ 2x to 3x your max used connections after a few days of uptime. However, if your MySQL max connections are more than 200 then make sure to have at least 100 extra connections available. So if max_used_connections is 300 then set max_connections to at least 400. Watch memory usage!!thread_cache_sizeDetermines the number of threads that can be cached and reused by the server. Properly tuning this parameter can help improve the performance of your MySQL server by reducing the overhead of creating new threads and freeing up system resources.To tune this parameter, you can monitor the threads_created and threads_cached status variables and set the value to a reasonable number based on the number of expected concurrent connections. As a general rule, a value of 16 is a good starting point. Then increase gradually until it’s at least 50% of max_connections. For example, if the threads_cached value is 16 and the max_used_connections value is 40 then increase this from 16 to 32. At the same time, as per above advice, if max_used_connections is 40 then your max_connections should be at least 80.table_definition_cacheA MySQL configuration parameter that sets the number of table definitions (metadata) that can be stored in the cache. A high value of table_definition_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of reading the table definition from disk.To tune this parameter, monitor the opened_table_definitions and open_table_definitionsstatus variables, set table_definition_cache to ~ 2x the number of open table definitions and adjust as needed. Consider other factors, such as system memory and query complexity when tuning. .table_open_cacheA MySQL configuration parameter that sets the number of open table objects that can be stored in the cache. A high value of table_open_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of opening tables from disk.To tune this parameter, monitor the opened_tables and open_tables status variables, set table_open_cache to ~ 2x the number of open tables, and adjust as needed. Consider other factors such as memory and query complexity when tuning. Generally table_open_cache and table_definition_cache are set to the same value. The number of open table objects and table definitions are directly related, so setting these two parameters to the same value can ensure that the metadata and open table objects are stored in the cache in a consistent and efficient manner.wait_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on a non-interactive connection before closing it. A high value of wait_timeout can result in increased memory usage and increased # of connections, while a low value can result in frequent disconnections for long-running queries.To tune this parameter, set wait_timeout to the lowest resonable expected duration of non-interactive connections, and adjust as needed. The default value is 28800 seconds. This is way to high in most cases and will consume a lot of system memory by keeping many connections open. I set most of my configs to 30 seconds or less.connect_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for a successful connection to be established before timing out. A high value of connect_timeout can result in increased wait time for clients and increase in max_connections. A low value can result in connection failures for slow or heavily loaded servers.To tune this parameter, set connect_timeout to a reasonable value based on the expected response time of the server. Consider other factors such as network latency, mobile users, and server load when tuning. I set most of my configs to 15 seconds or less. For example, this blog’s mysql connection timeout is set to 5 seconds.interactive_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on an interactive connection before closing it. A high value of interactive_timeout can result in increased memory usage and increased concurrent connetions. A low value can result in frequent disconnections for long-running queries.To tune this parameter, set interactive_timeout to a reasonable value based on the expected duration of your longest-running requests.tmp_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables used by the server. When a query creates a temporary table that exceeds the value of tmp_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set tmp_table_size to a reasonable value based on the available memory and the value of the created_tmp_disk_table variable.max_heap_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables created with the MEMORY storage engine. When a query creates a temporary table that exceeds the value of max_heap_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set max_heap_table_size to the same value as tmp_table_size.Want more tips?For example, Innodb tuning tips, setting open_files_limit, etc. Let me know your interests in the comments section below, or hire me for MySQL optimization.\xa0Additional MySQL performance related articlesMySQL Performance Tuning: Tips, Scripts and Tools.MySQL Performance: Stop hoarding. Drop unused MySQL databases.“MySQL server has gone away” error – Solution(s).Could not increase number of max_open_files to more than… (Solution).Linux server performance: Is disk I/O slowing your application?Tuning MySQL my.cnf? Avoid this common pitfall!\xa0ConclusionIn conclusion, we discussed some common issues with MySQL performance often raised in support requests. The focus was on four specific my.cnf variables frequently responsible for poor database performance and scaling due to a shortage of server memory.It was emphasized that arbitrarily increasing these variables can lead to a decline in MySQL server performance and capacity and that it is important to keep these buffers set to their default values unless there is a specific reason to increase them. Then we covered tuning some additional MySQL performance config lines.A good rule of thumb: if you can’t provide a valid reason for increasing these buffers, keep them set to the default values. This also applies less strictly to all of MySQL’s variables. Be careful when making changes, don’t overwrite your entire my.cnf all at once. Back up everything first, make one or two changes per restart and test for 24 to 48 hours before making another pass. wsrep_mysql_replication_bundle ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20448258519172668, 0.20679712295532227, 0.24968837201595306, 0.1696714460849762, 0.16936053335666656]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=38, param=<re.Match object; span=(1999, 2014), match='max_connections'>, value=<re.Match object; span=(0, 3), match='200'>, recommendation='200', passage='hayden_james@linux\xa0aboutarticlesservicesfeedbacksponsorscontactforumsMySQL Database Performance: Avoid this common mistake March 21, 2023 by Hayden James, in Blog LinuxOne frequent topic of support request emails I receive is MySQL database performance. Clients complain about MySQL using too much server memory, too many MySQL slow queries, the famous Mysql server has gone away errors, and many other MySQL performance-related issues. As such, I wanted to share solutions to some common MySQL configuration mistakes.If you are a DBA, feel free to share your experiences or suggestions in the comments section. I’m referring to four MySQL config variables. These four my.cnf config lines are often responsible for poor MySQL database performance and scaling due to insufficient server memory for incoming connections. This article also applies to MariaDB and Percona drop-in replacements for MySQL.Note: This is an update and follow-up to this article. I’ve added some relevant and more up-to-date information and links, as well as a new section that covers some additional my.cnf performance config tips.\xa0Avoid arbitrarily increasing MySQL per-connection buffers Excerpt of my.cnf edits for a client. (some lines were removed and some blurred to avoid misuse)Who knows where or when this bad practice started. I frequently encounter instances where I log into production servers for the first time and find that the values of virtually every my.cnf variable have been arbitrarily increased without sound reasoning behind the changes.This is never a good practice, especially for four my.cnf variables discussed below. Although increasing the value of some variables can improve performance, these four will almost always degrade MySQL server performance and capacity when increased.The four buffers in question are the\xa0join_buffer_size,\xa0sort_buffer_size,\xa0read_buffer_size and read_rnd_buffer_size.These four buffers are\xa0allocated per connection. For example, a setting of join_buffer_size=1M\xa0with\xa0max_connections=200 will configure MySQL to allocate an additional 1M per connection (1M x 200). The same goes for the other three buffers. Again, all are per connection.A good rule of thumb is that if you can’t provide a valid reason to increase any of these buffers, keep them set to the default values.In nearly all cases, it’s best to keep the defaults by removing or commenting out these four config lines. As connections increase with traffic, queries that need more space than what’s available due to larger buffer settings may trigger paging those buffers to disk. This dramatically slows down your DB server and creates a bottleneck.I’ve often seen significantly improved MySQL performance by simply reverting these buffers to their defaults. Also, read Analyzing Linux server performance with atop.The above screenshot shows MySQL status output two weeks after I made the first my.cnf optimization pass. Now, let’s take a closer look at each of these buffers.\xa0MySQL join_buffer_sizeThe join_buffer_size is allocated for each full join between two tables. From MySQL’s documentation the join_buffer_size is described as: “The minimum size of the buffer that is used for plain index scans, range index scans, and joins that do not use indexes and thus perform full table scans.”MySQL’s documentation goes on to say: “Memory allocation time can cause substantial performance drops if the global size is larger than needed by most queries that use it.” The join buffer is allocated to cache table rows when the join can’t use an index.If your database suffers from many joins performed without indexes, it cannot be solved by increasing join_buffer_size. The problem is “joins performed without indexes.” Thus, the solution for faster joins is to add indexes.\xa0MySQL sort_buffer_sizeUnless you have data indicating otherwise, you should avoid arbitrarily increasing the\xa0sort_buffer_size. Memory here is also assigned per connection!MySQL’s documentation warns: “On Linux, there are thresholds of 256KB and 2MB where larger values may significantly slow down memory allocation, so you should consider staying below one of those values.”Avoid increasing sort_buffer_size above 2M since there is a performance penalty that will eliminate benefits.\xa0MySQL read_buffer_size & read_rnd_buffer_sizeUpdate: Some of you still use MyISAM over InnoDB. MyISAM is based on the old ISAM storage engine. It has many useful extensions, as discussed here. You should consider converting your MySQL tables to the InnoDB storage engine.InnoDB is the default storage engine of MySQL 5.7 and MySQL 8.0. InnoDB features improved performance, rollback and crash-recovery capabilities to protect data. read_buffer_size\xa0Applies generally to MyISAM.Each request that performs a sequential table scan allocates a read buffer. The read_buffer_size\xa0system variable determines the buffer size.Starting from MySQL 8.0.22, the value of select_into_buffer_size overrides the value of read_buffer_size when performing SELECT INTO DUMPFILE and SELECT INTO OUTFILE statements. read_buffer_size\xa0is used for the I/O cache buffer size in all other cases.The read_rnd_buffer_size variable is also used mainly for\xa0MyISAM reads from tables. Again, consider InnoDB or MariaDB’s Aria storage engines. For the past decade, the default values of these buffers have remained the same.\xa0Additional my.cnf Performance config tipsMonitor the appropriate MySQL status variable_name(s) to assist you in tuning the below config lines. An example of viewing the status of MySQL runtime variables. (So I increased max_connections)max_connectionsA MySQL configuration parameter that sets the maximum number of concurrent connections the server can handle. A value that is too large can allocate too much server memory and lead to performance issues, while a low value can result in connection rejections.To tune this parameter, monitor the max_used_connections status variable; try to set this to ~ 2x to 3x your max used connections after a few days of uptime. However, if your MySQL max connections are more than 200 then make sure to have at least 100 extra connections available. So if max_used_connections is 300 then set max_connections to at least 400. Watch memory usage!!thread_cache_sizeDetermines the number of threads that can be cached and reused by the server. Properly tuning this parameter can help improve the performance of your MySQL server by reducing the overhead of creating new threads and freeing up system resources.To tune this parameter, you can monitor the threads_created and threads_cached status variables and set the value to a reasonable number based on the number of expected concurrent connections. As a general rule, a value of 16 is a good starting point. Then increase gradually until it’s at least 50% of max_connections. For example, if the threads_cached value is 16 and the max_used_connections value is 40 then increase this from 16 to 32. At the same time, as per above advice, if max_used_connections is 40 then your max_connections should be at least 80.table_definition_cacheA MySQL configuration parameter that sets the number of table definitions (metadata) that can be stored in the cache. A high value of table_definition_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of reading the table definition from disk.To tune this parameter, monitor the opened_table_definitions and open_table_definitionsstatus variables, set table_definition_cache to ~ 2x the number of open table definitions and adjust as needed. Consider other factors, such as system memory and query complexity when tuning. .table_open_cacheA MySQL configuration parameter that sets the number of open table objects that can be stored in the cache. A high value of table_open_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of opening tables from disk.To tune this parameter, monitor the opened_tables and open_tables status variables, set table_open_cache to ~ 2x the number of open tables, and adjust as needed. Consider other factors such as memory and query complexity when tuning. Generally table_open_cache and table_definition_cache are set to the same value. The number of open table objects and table definitions are directly related, so setting these two parameters to the same value can ensure that the metadata and open table objects are stored in the cache in a consistent and efficient manner.wait_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on a non-interactive connection before closing it. A high value of wait_timeout can result in increased memory usage and increased # of connections, while a low value can result in frequent disconnections for long-running queries.To tune this parameter, set wait_timeout to the lowest resonable expected duration of non-interactive connections, and adjust as needed. The default value is 28800 seconds. This is way to high in most cases and will consume a lot of system memory by keeping many connections open. I set most of my configs to 30 seconds or less.connect_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for a successful connection to be established before timing out. A high value of connect_timeout can result in increased wait time for clients and increase in max_connections. A low value can result in connection failures for slow or heavily loaded servers.To tune this parameter, set connect_timeout to a reasonable value based on the expected response time of the server. Consider other factors such as network latency, mobile users, and server load when tuning. I set most of my configs to 15 seconds or less. For example, this blog’s mysql connection timeout is set to 5 seconds.interactive_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on an interactive connection before closing it. A high value of interactive_timeout can result in increased memory usage and increased concurrent connetions. A low value can result in frequent disconnections for long-running queries.To tune this parameter, set interactive_timeout to a reasonable value based on the expected duration of your longest-running requests.tmp_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables used by the server. When a query creates a temporary table that exceeds the value of tmp_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set tmp_table_size to a reasonable value based on the available memory and the value of the created_tmp_disk_table variable.max_heap_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables created with the MEMORY storage engine. When a query creates a temporary table that exceeds the value of max_heap_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set max_heap_table_size to the same value as tmp_table_size.Want more tips?For example, Innodb tuning tips, setting open_files_limit, etc. Let me know your interests in the comments section below, or hire me for MySQL optimization.\xa0Additional MySQL performance related articlesMySQL Performance Tuning: Tips, Scripts and Tools.MySQL Performance: Stop hoarding. Drop unused MySQL databases.“MySQL server has gone away” error – Solution(s).Could not increase number of max_open_files to more than… (Solution).Linux server performance: Is disk I/O slowing your application?Tuning MySQL my.cnf? Avoid this common pitfall!\xa0ConclusionIn conclusion, we discussed some common issues with MySQL performance often raised in support requests. The focus was on four specific my.cnf variables frequently responsible for poor database performance and scaling due to a shortage of server memory.It was emphasized that arbitrarily increasing these variables can lead to a decline in MySQL server performance and capacity and that it is important to keep these buffers set to their default values unless there is a specific reason to increase them. Then we covered tuning some additional MySQL performance config lines.A good rule of thumb: if you can’t provide a valid reason for increasing these buffers, keep them set to the default values. This also applies less strictly to all of MySQL’s variables. Be careful when making changes, don’t overwrite your entire my.cnf all at once. Back up everything first, make one or two changes per restart and test for 24 to 48 hours before making another pass. wsrep_mysql_replication_bundle ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.023928122594952583, 0.4574962556362152, 0.20133262872695923, 0.16734036803245544, 0.14990268647670746]
Choice: 0
Trying update set global max_connections=50
Trying update set global max_connections=100
Trying assigning max_connections to 50
Adding assignment ('max_connections', '50') with weight 1
Assignment ('max_connections', '50') extracted from "hayden_james@linux aboutarticlesservicesfeedbacksponsorscontactforumsMySQL Database Performance: Avoid this common mistake March 21, 2023 by Hayden James, in Blog LinuxOne frequent topic of support request emails I receive is MySQL database performance. Clients complain about MySQL using too much server memory, too many MySQL slow queries, the famous Mysql server has gone away errors, and many other MySQL performance-related issues. As such, I wanted to share solutions to some common MySQL configuration mistakes.If you are a DBA, feel free to share your experiences or suggestions in the comments section. I’m referring to four MySQL config variables. These four my.cnf config lines are often responsible for poor MySQL database performance and scaling due to insufficient server memory for incoming connections. This article also applies to MariaDB and Percona drop-in replacements for MySQL.Note: This is an update and follow-up to this article. I’ve added some relevant and more up-to-date information and links, as well as a new section that covers some additional my.cnf performance config tips. Avoid arbitrarily increasing MySQL per-connection buffers Excerpt of my.cnf edits for a client. (some lines were removed and some blurred to avoid misuse)Who knows where or when this bad practice started. I frequently encounter instances where I log into production servers for the first time and find that the values of virtually every my.cnf variable have been arbitrarily increased without sound reasoning behind the changes.This is never a good practice, especially for four my.cnf variables discussed below. Although increasing the value of some variables can improve performance, these four will almost always degrade MySQL server performance and capacity when increased.The four buffers in question are the join_buffer_size, sort_buffer_size, read_buffer_size and read_rnd_buffer_size.These four buffers are allocated per connection. For example, a setting of join_buffer_size=1M with max_connections=200 will configure MySQL to allocate an additional 1M per connection (1M x 200). The same goes for the other three buffers. Again, all are per connection.A good rule of thumb is that if you can’t provide a valid reason to increase any of these buffers, keep them set to the default values.In nearly all cases, it’s best to keep the defaults by removing or commenting out these four config lines. As connections increase with traffic, queries that need more space than what’s available due to larger buffer settings may trigger paging those buffers to disk. This dramatically slows down your DB server and creates a bottleneck.I’ve often seen significantly improved MySQL performance by simply reverting these buffers to their defaults. Also, read Analyzing Linux server performance with atop.The above screenshot shows MySQL status output two weeks after I made the first my.cnf optimization pass. Now, let’s take a closer look at each of these buffers. MySQL join_buffer_sizeThe join_buffer_size is allocated for each full join between two tables. From MySQL’s documentation the join_buffer_size is described as: “The minimum size of the buffer that is used for plain index scans, range index scans, and joins that do not use indexes and thus perform full table scans.”MySQL’s documentation goes on to say: “Memory allocation time can cause substantial performance drops if the global size is larger than needed by most queries that use it.” The join buffer is allocated to cache table rows when the join can’t use an index.If your database suffers from many joins performed without indexes, it cannot be solved by increasing join_buffer_size. The problem is “joins performed without indexes.” Thus, the solution for faster joins is to add indexes. MySQL sort_buffer_sizeUnless you have data indicating otherwise, you should avoid arbitrarily increasing the sort_buffer_size. Memory here is also assigned per connection!MySQL’s documentation warns: “On Linux, there are thresholds of 256KB and 2MB where larger values may significantly slow down memory allocation, so you should consider staying below one of those values.”Avoid increasing sort_buffer_size above 2M since there is a performance penalty that will eliminate benefits. MySQL read_buffer_size & read_rnd_buffer_sizeUpdate: Some of you still use MyISAM over InnoDB. MyISAM is based on the old ISAM storage engine. It has many useful extensions, as discussed here. You should consider converting your MySQL tables to the InnoDB storage engine.InnoDB is the default storage engine of MySQL 5.7 and MySQL 8.0. InnoDB features improved performance, rollback and crash-recovery capabilities to protect data. read_buffer_size Applies generally to MyISAM.Each request that performs a sequential table scan allocates a read buffer. The read_buffer_size system variable determines the buffer size.Starting from MySQL 8.0.22, the value of select_into_buffer_size overrides the value of read_buffer_size when performing SELECT INTO DUMPFILE and SELECT INTO OUTFILE statements. read_buffer_size is used for the I/O cache buffer size in all other cases.The read_rnd_buffer_size variable is also used mainly for MyISAM reads from tables. Again, consider InnoDB or MariaDB’s Aria storage engines. For the past decade, the default values of these buffers have remained the same. Additional my.cnf Performance config tipsMonitor the appropriate MySQL status variable_name(s) to assist you in tuning the below config lines. An example of viewing the status of MySQL runtime variables. (So I increased max_connections)max_connectionsA MySQL configuration parameter that sets the maximum number of concurrent connections the server can handle. A value that is too large can allocate too much server memory and lead to performance issues, while a low value can result in connection rejections.To tune this parameter, monitor the max_used_connections status variable; try to set this to ~ 2x to 3x your max used connections after a few days of uptime. However, if your MySQL max connections are more than 200 then make sure to have at least 100 extra connections available. So if max_used_connections is 300 then set max_connections to at least 400. Watch memory usage!!thread_cache_sizeDetermines the number of threads that can be cached and reused by the server. Properly tuning this parameter can help improve the performance of your MySQL server by reducing the overhead of creating new threads and freeing up system resources.To tune this parameter, you can monitor the threads_created and threads_cached status variables and set the value to a reasonable number based on the number of expected concurrent connections. As a general rule, a value of 16 is a good starting point. Then increase gradually until it’s at least 50% of max_connections. For example, if the threads_cached value is 16 and the max_used_connections value is 40 then increase this from 16 to 32. At the same time, as per above advice, if max_used_connections is 40 then your max_connections should be at least 80.table_definition_cacheA MySQL configuration parameter that sets the number of table definitions (metadata) that can be stored in the cache. A high value of table_definition_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of reading the table definition from disk.To tune this parameter, monitor the opened_table_definitions and open_table_definitionsstatus variables, set table_definition_cache to ~ 2x the number of open table definitions and adjust as needed. Consider other factors, such as system memory and query complexity when tuning. .table_open_cacheA MySQL configuration parameter that sets the number of open table objects that can be stored in the cache. A high value of table_open_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of opening tables from disk.To tune this parameter, monitor the opened_tables and open_tables status variables, set table_open_cache to ~ 2x the number of open tables, and adjust as needed. Consider other factors such as memory and query complexity when tuning. Generally table_open_cache and table_definition_cache are set to the same value. The number of open table objects and table definitions are directly related, so setting these two parameters to the same value can ensure that the metadata and open table objects are stored in the cache in a consistent and efficient manner.wait_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on a non-interactive connection before closing it. A high value of wait_timeout can result in increased memory usage and increased # of connections, while a low value can result in frequent disconnections for long-running queries.To tune this parameter, set wait_timeout to the lowest resonable expected duration of non-interactive connections, and adjust as needed. The default value is 28800 seconds. This is way to high in most cases and will consume a lot of system memory by keeping many connections open. I set most of my configs to 30 seconds or less.connect_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for a successful connection to be established before timing out. A high value of connect_timeout can result in increased wait time for clients and increase in max_connections. A low value can result in connection failures for slow or heavily loaded servers.To tune this parameter, set connect_timeout to a reasonable value based on the expected response time of the server. Consider other factors such as network latency, mobile users, and server load when tuning. I set most of my configs to 15 seconds or less. For example, this blog’s mysql connection timeout is set to 5 seconds.interactive_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on an interactive connection before closing it. A high value of interactive_timeout can result in increased memory usage and increased concurrent connetions. A low value can result in frequent disconnections for long-running queries.To tune this parameter, set interactive_timeout to a reasonable value based on the expected duration of your longest-running requests.tmp_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables used by the server. When a query creates a temporary table that exceeds the value of tmp_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set tmp_table_size to a reasonable value based on the available memory and the value of the created_tmp_disk_table variable.max_heap_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables created with the MEMORY storage engine. When a query creates a temporary table that exceeds the value of max_heap_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set max_heap_table_size to the same value as tmp_table_size.Want more tips?For example, Innodb tuning tips, setting open_files_limit, etc. Let me know your interests in the comments section below, or hire me for MySQL optimization. Additional MySQL performance related articlesMySQL Performance Tuning: Tips, Scripts and Tools.MySQL Performance: Stop hoarding. Drop unused MySQL databases.“MySQL server has gone away” error – Solution(s).Could not increase number of max_open_files to more than… (Solution).Linux server performance: Is disk I/O slowing your application?Tuning MySQL my.cnf? Avoid this common pitfall! ConclusionIn conclusion, we discussed some common issues with MySQL performance often raised in support requests. The focus was on four specific my.cnf variables frequently responsible for poor database performance and scaling due to a shortage of server memory.It was emphasized that arbitrarily increasing these variables can lead to a decline in MySQL server performance and capacity and that it is important to keep these buffers set to their default values unless there is a specific reason to increase them. Then we covered tuning some additional MySQL performance config lines.A good rule of thumb: if you can’t provide a valid reason for increasing these buffers, keep them set to the default values. This also applies less strictly to all of MySQL’s variables. Be careful when making changes, don’t overwrite your entire my.cnf all at once. Back up everything first, make one or two changes per restart and test for 24 to 48 hours before making another pass. wsrep_mysql_replication_bundle "
Hint counter: 5
Episode hint counter before: 4
Episode hint counter: 5
Hints per episode: 20
Done flag: False
No warmup - hint counter: 5
{'sequence': '1250', 'labels': ['Use recommendation', 'Decrease recommendation', 'Decrease recommendation strongly', 'Increase recommendation strongly', 'Increase recommendation'], 'scores': [0.2442580908536911, 0.23470382392406464, 0.20277561247348785, 0.15915419161319733, 0.15910832583904266]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(95, 110), match='max_connections'>, value=<re.Match object; span=(0, 4), match='1250'>, recommendation='1250', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=1250.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20277561247348785, 0.23470382392406464, 0.2442580908536911, 0.15910832583904266, 0.15915419161319733]
Choice: 4
Done flag: False
No warmup - hint counter: 5
{'sequence': '1250', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4868924915790558, 0.19467118382453918, 0.1581139713525772, 0.13819433748722076, 0.022127989679574966]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(95, 110), match='max_connections'>, value=<re.Match object; span=(0, 4), match='1250'>, recommendation='1250', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=1250.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.022127989679574966, 0.4868924915790558, 0.19467118382453918, 0.1581139713525772, 0.13819433748722076]
Choice: 1
Trying update set global max_connections=5000
Trying update set global max_connections=100
Trying assigning max_connections to 5000
Adding assignment ('max_connections', '5000') with weight 2
Assignment ('max_connections', '5000') extracted from "tmp-table-size = 96M
max-heap-table-size = 96M
key_buffer_size = 64M
# Connections and Threads
max_connections = 1250
thread_cache_size = 8
max_allowed_packet = 64M thread_pool_max_threads "
Hint counter: 6
Episode hint counter before: 5
Episode hint counter: 6
Hints per episode: 20
Done flag: False
No warmup - hint counter: 6
{'sequence': 'larger than the total number of all Zabbix server processes plus 150', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Increase recommendation', 'Decrease recommendation strongly', 'Decrease recommendation'], 'scores': [0.3626527190208435, 0.27075114846229553, 0.16154444217681885, 0.1274421215057373, 0.07760956138372421]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(149, 164), match='max_connections'>, value=<re.Match object; span=(65, 68), match='150'>, recommendation='larger than the total number of all Zabbix server processes plus 150', passage='Later, we will go through every configuration parameter with our ChatGPT friend, but first, there are two things to remember!Configuration parameter\xa0max_connections\xa0must be larger than the total number of all Zabbix server processes plus 150. You can use the command below to automatically check the number of Zabbix processes and add 150 to that number:egrep "^Start.+=[0-9]" /etc/zabbix/zabbix_server.conf | awk -F "=" \'{s+=$2} END {print s+150}\' max_password_errors ', float_val=150.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1274421215057373, 0.07760956138372421, 0.3626527190208435, 0.16154444217681885, 0.27075114846229553]
Choice: 4
Done flag: False
No warmup - hint counter: 6
{'sequence': 'larger than the total number of all Zabbix server processes plus 150', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.5690935850143433, 0.1851271241903305, 0.12315736711025238, 0.11001989245414734, 0.012601979076862335]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(149, 164), match='max_connections'>, value=<re.Match object; span=(65, 68), match='150'>, recommendation='larger than the total number of all Zabbix server processes plus 150', passage='Later, we will go through every configuration parameter with our ChatGPT friend, but first, there are two things to remember!Configuration parameter\xa0max_connections\xa0must be larger than the total number of all Zabbix server processes plus 150. You can use the command below to automatically check the number of Zabbix processes and add 150 to that number:egrep "^Start.+=[0-9]" /etc/zabbix/zabbix_server.conf | awk -F "=" \'{s+=$2} END {print s+150}\' max_password_errors ', float_val=150.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.012601979076862335, 0.5690935850143433, 0.1851271241903305, 0.12315736711025238, 0.11001989245414734]
--- Tuning Updates ---
Minimal time (ms): 59182.109375
Achieved with configuration: {}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(149, 164), match='max_connections'>, value=<re.Match object; span=(65, 68), match='150'>, recommendation='larger than the total number of all Zabbix server processes plus 150', passage='Later, we will go through every configuration parameter with our ChatGPT friend, but first, there are two things to remember!Configuration parameter\xa0max_connections\xa0must be larger than the total number of all Zabbix server processes plus 150. You can use the command below to automatically check the number of Zabbix processes and add 150 to that number:egrep "^Start.+=[0-9]" /etc/zabbix/zabbix_server.conf | awk -F "=" \'{s+=$2} END {print s+150}\' max_password_errors ', float_val=150.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1274421215057373, 0.07760956138372421, 0.3626527190208435, 0.16154444217681885, 0.27075114846229553]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(149, 164), match='max_connections'>, value=<re.Match object; span=(65, 68), match='150'>, recommendation='larger than the total number of all Zabbix server processes plus 150', passage='Later, we will go through every configuration parameter with our ChatGPT friend, but first, there are two things to remember!Configuration parameter\xa0max_connections\xa0must be larger than the total number of all Zabbix server processes plus 150. You can use the command below to automatically check the number of Zabbix processes and add 150 to that number:egrep "^Start.+=[0-9]" /etc/zabbix/zabbix_server.conf | awk -F "=" \'{s+=$2} END {print s+150}\' max_password_errors ', float_val=150.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.012601979076862335, 0.5690935850143433, 0.1851271241903305, 0.12315736711025238, 0.11001989245414734]
Choice: 3
Trying update set global max_connections=300
Trying update set global max_connections=100
Trying assigning max_connections to 300
Adding assignment ('max_connections', '300') with weight 8
Assignment ('max_connections', '300') extracted from "Later, we will go through every configuration parameter with our ChatGPT friend, but first, there are two things to remember!Configuration parameter max_connections must be larger than the total number of all Zabbix server processes plus 150. You can use the command below to automatically check the number of Zabbix processes and add 150 to that number:egrep "^Start.+=[0-9]" /etc/zabbix/zabbix_server.conf | awk -F "=" '{s+=$2} END {print s+150}' max_password_errors "
Hint counter: 7
Episode hint counter before: 6
Episode hint counter: 7
Hints per episode: 20
Done flag: False
No warmup - hint counter: 7
{'sequence': '200', 'labels': ['Use recommendation', 'Decrease recommendation', 'Decrease recommendation strongly', 'Increase recommendation', 'Increase recommendation strongly'], 'scores': [0.24968837201595306, 0.20679712295532227, 0.20448258519172668, 0.1696714460849762, 0.16936053335666656]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(140, 155), match='max_connections'>, value=<re.Match object; span=(0, 3), match='200'>, recommendation='200', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20448258519172668, 0.20679712295532227, 0.24968837201595306, 0.1696714460849762, 0.16936053335666656]
Choice: 3
Done flag: False
No warmup - hint counter: 7
{'sequence': '200', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4574962556362152, 0.20133262872695923, 0.16734036803245544, 0.14990268647670746, 0.023928122594952583]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(140, 155), match='max_connections'>, value=<re.Match object; span=(0, 3), match='200'>, recommendation='200', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.023928122594952583, 0.4574962556362152, 0.20133262872695923, 0.16734036803245544, 0.14990268647670746]
Choice: 1
Trying update set global max_connections=400
Trying update set global max_connections=100
Trying assigning max_connections to 400
Adding assignment ('max_connections', '400') with weight 2
Assignment ('max_connections', '400') extracted from "read_rnd_buffer_size = 512
join_buffer_size = 2048
thread_stack = 512
binlog_cache_size = 64
thread_cache_size = 16
table_open_cache = 2048
max_connections = 200
PHP:
max_children = 4 thread_cache_size "
Hint counter: 8
Episode hint counter before: 7
Episode hint counter: 8
Hints per episode: 20
Done flag: False
No warmup - hint counter: 8
{'sequence': '20', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation', 'Decrease recommendation strongly', 'Increase recommendation'], 'scores': [0.25157612562179565, 0.19944924116134644, 0.19193889200687408, 0.18651802837848663, 0.1705176830291748]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(67, 82), match='max_connections'>, value=<re.Match object; span=(0, 2), match='20'>, recommendation='20', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=20.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18651802837848663, 0.19193889200687408, 0.25157612562179565, 0.1705176830291748, 0.19944924116134644]
Choice: 2
Done flag: False
No warmup - hint counter: 8
{'sequence': '20', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4811500310897827, 0.19708628952503204, 0.1599201112985611, 0.1373344212770462, 0.024509061127901077]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(67, 82), match='max_connections'>, value=<re.Match object; span=(0, 2), match='20'>, recommendation='20', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=20.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.024509061127901077, 0.4811500310897827, 0.19708628952503204, 0.1599201112985611, 0.1373344212770462]
--- Tuning Updates ---
Minimal time (ms): 59182.109375
Achieved with configuration: {}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(67, 82), match='max_connections'>, value=<re.Match object; span=(0, 2), match='20'>, recommendation='20', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=20.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18651802837848663, 0.19193889200687408, 0.25157612562179565, 0.1705176830291748, 0.19944924116134644]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(67, 82), match='max_connections'>, value=<re.Match object; span=(0, 2), match='20'>, recommendation='20', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=20.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.024509061127901077, 0.4811500310897827, 0.19708628952503204, 0.1599201112985611, 0.1373344212770462]
Choice: 2
Trying update set global max_connections=10
Trying update set global max_connections=100
Trying assigning max_connections to 10
Adding assignment ('max_connections', '10') with weight 4
Assignment ('max_connections', '10') extracted from "binlog_cache_size = 32
thread_cache_size = 8
table_open_cache = 64
max_connections = 20
PHP:
max_children = 10
start_servers = 2
min_spare_servers = 1
max_spare_servers = 3 binlog_stmt_cache_size "
Hint counter: 9
Episode hint counter before: 8
Episode hint counter: 9
Hints per episode: 20
Done flag: False
No warmup - hint counter: 9
{'sequence': '500', 'labels': ['Use recommendation', 'Decrease recommendation strongly', 'Decrease recommendation', 'Increase recommendation', 'Increase recommendation strongly'], 'scores': [0.25007033348083496, 0.2242766171693802, 0.18561743199825287, 0.17030423879623413, 0.16973133385181427]}
Decision: Deciding adaption of TuningHint(doc_id=63, param=<re.Match object; span=(0, 15), match='max_connections'>, value=<re.Match object; span=(0, 3), match='500'>, recommendation='500', passage='max_connections\n= 500\nmax_user_connections\n= 500\n#table_cache\n= 64\nthread_concurrency\n= 300\ntable_cache\n= 30000\nopen_files_limit\n= 65000\n#innodb_force_recovery =6 max_binlog_stmt_cache_size ', float_val=500.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.2242766171693802, 0.18561743199825287, 0.25007033348083496, 0.17030423879623413, 0.16973133385181427]
Choice: 3
Done flag: False
No warmup - hint counter: 9
{'sequence': '500', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.46374940872192383, 0.2040889710187912, 0.16545264422893524, 0.1439269781112671, 0.022781977429986]}
Decision: Deciding weight of TuningHint(doc_id=63, param=<re.Match object; span=(0, 15), match='max_connections'>, value=<re.Match object; span=(0, 3), match='500'>, recommendation='500', passage='max_connections\n= 500\nmax_user_connections\n= 500\n#table_cache\n= 64\nthread_concurrency\n= 300\ntable_cache\n= 30000\nopen_files_limit\n= 65000\n#innodb_force_recovery =6 max_binlog_stmt_cache_size ', float_val=500.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.022781977429986, 0.46374940872192383, 0.2040889710187912, 0.16545264422893524, 0.1439269781112671]
Choice: 0
Trying update set global max_connections=1000
Trying update set global max_connections=100
Trying assigning max_connections to 1000
Adding assignment ('max_connections', '1000') with weight 1
Assignment ('max_connections', '1000') extracted from "max_connections
= 500
max_user_connections
= 500
#table_cache
= 64
thread_concurrency
= 300
table_cache
= 30000
open_files_limit
= 65000
#innodb_force_recovery =6 max_binlog_stmt_cache_size "
Hint counter: 10
Episode hint counter before: 9
Episode hint counter: 10
Hints per episode: 20
Done flag: False
No warmup - hint counter: 10
{'sequence': '70-80% of the available memory', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation', 'Increase recommendation', 'Decrease recommendation strongly'], 'scores': [0.3688836991786957, 0.20956619083881378, 0.1557127982378006, 0.1453220099210739, 0.12051532417535782]}
Decision: Deciding adaption of TuningHint(doc_id=1, param=<re.Match object; span=(0, 23), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 2), match='70'>, recommendation='70-80% of the available memory', passage='innodb_buffer_pool_size: Allocate more memory to the InnoDB buffer pool to reduce disk I/O. Typically, this value should be set to at least 70-80% of the available memory.\ninnodb_log_file_size: A larger log file size reduces the need for frequent log rotations, thus improving write performance. However, a log size that is too large might slow down the recovery process after a crash.\nTweak Query Cache Variables innodb_log_buffer_size ', float_val=70.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.12051532417535782, 0.1557127982378006, 0.3688836991786957, 0.1453220099210739, 0.20956619083881378]
Choice: 0
Done flag: False
No warmup - hint counter: 10
{'sequence': '70-80% of the available memory', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.5487614274024963, 0.17386455833911896, 0.14200177788734436, 0.11392877995967865, 0.021443508565425873]}
Decision: Deciding weight of TuningHint(doc_id=1, param=<re.Match object; span=(0, 23), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 2), match='70'>, recommendation='70-80% of the available memory', passage='innodb_buffer_pool_size: Allocate more memory to the InnoDB buffer pool to reduce disk I/O. Typically, this value should be set to at least 70-80% of the available memory.\ninnodb_log_file_size: A larger log file size reduces the need for frequent log rotations, thus improving write performance. However, a log size that is too large might slow down the recovery process after a crash.\nTweak Query Cache Variables innodb_log_buffer_size ', float_val=70.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.021443508565425873, 0.5487614274024963, 0.17386455833911896, 0.14200177788734436, 0.11392877995967865]
--- Tuning Updates ---
Minimal time (ms): 59182.109375
Achieved with configuration: {}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=1, param=<re.Match object; span=(0, 23), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 2), match='70'>, recommendation='70-80% of the available memory', passage='innodb_buffer_pool_size: Allocate more memory to the InnoDB buffer pool to reduce disk I/O. Typically, this value should be set to at least 70-80% of the available memory.\ninnodb_log_file_size: A larger log file size reduces the need for frequent log rotations, thus improving write performance. However, a log size that is too large might slow down the recovery process after a crash.\nTweak Query Cache Variables innodb_log_buffer_size ', float_val=70.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.12051532417535782, 0.1557127982378006, 0.3688836991786957, 0.1453220099210739, 0.20956619083881378]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=1, param=<re.Match object; span=(0, 23), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 2), match='70'>, recommendation='70-80% of the available memory', passage='innodb_buffer_pool_size: Allocate more memory to the InnoDB buffer pool to reduce disk I/O. Typically, this value should be set to at least 70-80% of the available memory.\ninnodb_log_file_size: A larger log file size reduces the need for frequent log rotations, thus improving write performance. However, a log size that is too large might slow down the recovery process after a crash.\nTweak Query Cache Variables innodb_log_buffer_size ', float_val=70.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.021443508565425873, 0.5487614274024963, 0.17386455833911896, 0.14200177788734436, 0.11392877995967865]
Choice: 3
Trying update set global innodb_buffer_pool_size=140
Exception during update: Variable 'innodb_buffer_pool_size' can't be set to the value of '140'
Trying update set global innodb_buffer_pool_size=134217728
Trying assigning innodb_buffer_pool_size to 140
Assignment ('innodb_buffer_pool_size', '140') was rejected
Hint counter: 11
Episode hint counter before: 10
Episode hint counter: 11
Hints per episode: 20
Done flag: False
No warmup - hint counter: 11
{'sequence': '70-80% of the available memory', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation', 'Increase recommendation', 'Decrease recommendation strongly'], 'scores': [0.3688836991786957, 0.20956619083881378, 0.1557127982378006, 0.1453220099210739, 0.12051532417535782]}
Decision: Deciding adaption of TuningHint(doc_id=1, param=<re.Match object; span=(0, 23), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(3, 6), match='80%'>, recommendation='70-80% of the available memory', passage='innodb_buffer_pool_size: Allocate more memory to the InnoDB buffer pool to reduce disk I/O. Typically, this value should be set to at least 70-80% of the available memory.\ninnodb_log_file_size: A larger log file size reduces the need for frequent log rotations, thus improving write performance. However, a log size that is too large might slow down the recovery process after a crash.\nTweak Query Cache Variables innodb_log_buffer_size ', float_val=0.8, val_unit='', hint_type=<HintType.RAM_RATIO: 1>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.12051532417535782, 0.1557127982378006, 0.3688836991786957, 0.1453220099210739, 0.20956619083881378]
Choice: 1
Done flag: False
No warmup - hint counter: 11
{'sequence': '70-80% of the available memory', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.5487614274024963, 0.17386455833911896, 0.14200177788734436, 0.11392877995967865, 0.021443508565425873]}
Decision: Deciding weight of TuningHint(doc_id=1, param=<re.Match object; span=(0, 23), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(3, 6), match='80%'>, recommendation='70-80% of the available memory', passage='innodb_buffer_pool_size: Allocate more memory to the InnoDB buffer pool to reduce disk I/O. Typically, this value should be set to at least 70-80% of the available memory.\ninnodb_log_file_size: A larger log file size reduces the need for frequent log rotations, thus improving write performance. However, a log size that is too large might slow down the recovery process after a crash.\nTweak Query Cache Variables innodb_log_buffer_size ', float_val=0.8, val_unit='', hint_type=<HintType.RAM_RATIO: 1>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.021443508565425873, 0.5487614274024963, 0.17386455833911896, 0.14200177788734436, 0.11392877995967865]
Choice: 4
Trying update set global innodb_buffer_pool_size=4294967296
Trying update set global innodb_buffer_pool_size=134217728
Exception during update: Another buffer pool resize is already in progress.
Trying assigning innodb_buffer_pool_size to 4294967296
Adding assignment ('innodb_buffer_pool_size', '4294967296') with weight 16
Assignment ('innodb_buffer_pool_size', '4294967296') extracted from "innodb_buffer_pool_size: Allocate more memory to the InnoDB buffer pool to reduce disk I/O. Typically, this value should be set to at least 70-80% of the available memory.
innodb_log_file_size: A larger log file size reduces the need for frequent log rotations, thus improving write performance. However, a log size that is too large might slow down the recovery process after a crash.
Tweak Query Cache Variables innodb_log_buffer_size "
Hint counter: 12
Episode hint counter before: 11
Episode hint counter: 12
Hints per episode: 20
Done flag: False
No warmup - hint counter: 12
{'sequence': '23G', 'labels': ['Use recommendation', 'Increase recommendation', 'Decrease recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly'], 'scores': [0.23072713613510132, 0.20386049151420593, 0.19943229854106903, 0.18499886989593506, 0.18098114430904388]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(97, 120), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 3), match='23G'>, recommendation='23G', passage='innodb_stats_on_metadata = off\ninnodb-flush-method = O_DIRECT\ninnodb-flush-log-at-trx-commit = 2\ninnodb_buffer_pool_size = 23G\ninnodb_read_io_threads = 32 innodb_flush_log_at_trx_commit ', float_val=23.0, val_unit='G', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18098114430904388, 0.19943229854106903, 0.23072713613510132, 0.20386049151420593, 0.18499886989593506]
Choice: 3
Done flag: False
No warmup - hint counter: 12
{'sequence': '23G', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4707958996295929, 0.1976868361234665, 0.166013702750206, 0.1462538093328476, 0.01924968883395195]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(97, 120), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 3), match='23G'>, recommendation='23G', passage='innodb_stats_on_metadata = off\ninnodb-flush-method = O_DIRECT\ninnodb-flush-log-at-trx-commit = 2\ninnodb_buffer_pool_size = 23G\ninnodb_read_io_threads = 32 innodb_flush_log_at_trx_commit ', float_val=23.0, val_unit='G', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.01924968883395195, 0.4707958996295929, 0.1976868361234665, 0.166013702750206, 0.1462538093328476]
--- Tuning Updates ---
Minimal time (ms): 59182.109375
Achieved with configuration: {}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(97, 120), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 3), match='23G'>, recommendation='23G', passage='innodb_stats_on_metadata = off\ninnodb-flush-method = O_DIRECT\ninnodb-flush-log-at-trx-commit = 2\ninnodb_buffer_pool_size = 23G\ninnodb_read_io_threads = 32 innodb_flush_log_at_trx_commit ', float_val=23.0, val_unit='G', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18098114430904388, 0.19943229854106903, 0.23072713613510132, 0.20386049151420593, 0.18499886989593506]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(97, 120), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 3), match='23G'>, recommendation='23G', passage='innodb_stats_on_metadata = off\ninnodb-flush-method = O_DIRECT\ninnodb-flush-log-at-trx-commit = 2\ninnodb_buffer_pool_size = 23G\ninnodb_read_io_threads = 32 innodb_flush_log_at_trx_commit ', float_val=23.0, val_unit='G', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.01924968883395195, 0.4707958996295929, 0.1976868361234665, 0.166013702750206, 0.1462538093328476]
Choice: 3
Trying update set global innodb_buffer_pool_size=5368709120
Trying update set global innodb_buffer_pool_size=4294967296
Exception during update: Another buffer pool resize is already in progress.
Trying assigning innodb_buffer_pool_size to 5G
Adding assignment ('innodb_buffer_pool_size', '5G') with weight 8
Assignment ('innodb_buffer_pool_size', '5G') extracted from "innodb_stats_on_metadata = off
innodb-flush-method = O_DIRECT
innodb-flush-log-at-trx-commit = 2
innodb_buffer_pool_size = 23G
innodb_read_io_threads = 32 innodb_flush_log_at_trx_commit "
Hint counter: 13
Episode hint counter before: 12
Episode hint counter: 13
Hints per episode: 20
Done flag: False
No warmup - hint counter: 13
{'sequence': '4096', 'labels': ['Use recommendation', 'Decrease recommendation', 'Decrease recommendation strongly', 'Increase recommendation strongly', 'Increase recommendation'], 'scores': [0.27467942237854004, 0.20756587386131287, 0.1929043084383011, 0.16955099999904633, 0.1552993506193161]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(66, 89), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 4), match='4096'>, recommendation='4096', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=4096.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1929043084383011, 0.20756587386131287, 0.27467942237854004, 0.1552993506193161, 0.16955099999904633]
Choice: 2
Done flag: False
No warmup - hint counter: 13
{'sequence': '4096', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4537006616592407, 0.2012118697166443, 0.17119792103767395, 0.14479291439056396, 0.029096694663167]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(66, 89), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 4), match='4096'>, recommendation='4096', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=4096.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.029096694663167, 0.4537006616592407, 0.2012118697166443, 0.17119792103767395, 0.14479291439056396]
Choice: 4
Trying update set global innodb_buffer_pool_size=4096
Exception during update: Variable 'innodb_buffer_pool_size' can't be set to the value of '4096'
Trying update set global innodb_buffer_pool_size=5368709120
Trying assigning innodb_buffer_pool_size to 4096
Assignment ('innodb_buffer_pool_size', '4096') was rejected
Hint counter: 14
Episode hint counter before: 13
Episode hint counter: 14
Hints per episode: 20
Done flag: False
No warmup - hint counter: 14
{'sequence': '180M', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Decrease recommendation', 'Increase recommendation'], 'scores': [0.2364121675491333, 0.20964983105659485, 0.20210203528404236, 0.19127501547336578, 0.1605609506368637]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(38, 61), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 4), match='180M'>, recommendation='180M', passage="Mysql need's by default 512MB of RAM.\ninnodb_buffer_pool_size = 180M with this settings you can limit the RAM ussage, a high value is pointless\nMysql is runing on a local server so if you have a ssd on it the access is pretty fast there is no point to use your ram for nothing. sql_slave_skip_counter ", float_val=180.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20210203528404236, 0.19127501547336578, 0.2364121675491333, 0.1605609506368637, 0.20964983105659485]
Choice: 1
Done flag: False
No warmup - hint counter: 14
{'sequence': '180M', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.43662428855895996, 0.20483645796775818, 0.17478047311306, 0.1636047512292862, 0.020154068246483803]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(38, 61), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 4), match='180M'>, recommendation='180M', passage="Mysql need's by default 512MB of RAM.\ninnodb_buffer_pool_size = 180M with this settings you can limit the RAM ussage, a high value is pointless\nMysql is runing on a local server so if you have a ssd on it the access is pretty fast there is no point to use your ram for nothing. sql_slave_skip_counter ", float_val=180.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.020154068246483803, 0.43662428855895996, 0.20483645796775818, 0.17478047311306, 0.1636047512292862]
--- Tuning Updates ---
Minimal time (ms): 59182.109375
Achieved with configuration: {}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(38, 61), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 4), match='180M'>, recommendation='180M', passage="Mysql need's by default 512MB of RAM.\ninnodb_buffer_pool_size = 180M with this settings you can limit the RAM ussage, a high value is pointless\nMysql is runing on a local server so if you have a ssd on it the access is pretty fast there is no point to use your ram for nothing. sql_slave_skip_counter ", float_val=180.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20210203528404236, 0.19127501547336578, 0.2364121675491333, 0.1605609506368637, 0.20964983105659485]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(38, 61), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 4), match='180M'>, recommendation='180M', passage="Mysql need's by default 512MB of RAM.\ninnodb_buffer_pool_size = 180M with this settings you can limit the RAM ussage, a high value is pointless\nMysql is runing on a local server so if you have a ssd on it the access is pretty fast there is no point to use your ram for nothing. sql_slave_skip_counter ", float_val=180.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.020154068246483803, 0.43662428855895996, 0.20483645796775818, 0.17478047311306, 0.1636047512292862]
Choice: 0
Trying update set global innodb_buffer_pool_size=47185920
Trying update set global innodb_buffer_pool_size=5368709120
Exception during update: Another buffer pool resize is already in progress.
Trying assigning innodb_buffer_pool_size to 45M
Adding assignment ('innodb_buffer_pool_size', '45M') with weight 1
Assignment ('innodb_buffer_pool_size', '45M') extracted from "Mysql need's by default 512MB of RAM.
innodb_buffer_pool_size = 180M with this settings you can limit the RAM ussage, a high value is pointless
Mysql is runing on a local server so if you have a ssd on it the access is pretty fast there is no point to use your ram for nothing. sql_slave_skip_counter "
Hint counter: 15
Episode hint counter before: 14
Episode hint counter: 15
Hints per episode: 20
Done flag: False
No warmup - hint counter: 15
{'sequence': '32M', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Decrease recommendation', 'Increase recommendation'], 'scores': [0.30023810267448425, 0.19544251263141632, 0.18291717767715454, 0.17137980461120605, 0.15002238750457764]}
Decision: Deciding adaption of TuningHint(doc_id=11, param=<re.Match object; span=(245, 260), match='key_buffer_size'>, value=<re.Match object; span=(0, 3), match='32M'>, recommendation='32M', passage="The key buffer can improve the access speed to Moodle's SELECT queries. The correct size depends on the size of the index files (.myi) and in Moodle 1.6 or later (without any additional modules and plugins), the recommendation for this value is key_buffer_size = 32M. Ideally you want the database to be reading once from the disk for every 100 requests so monitor that the value is suitable for your install by adjusting the value of key_buffer_size so that the following formulas are true:\nkey_read / key_read_requests < 0.01\nkey_write / key_write_requests <= 1.0 key_buffer_size ", float_val=32.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18291717767715454, 0.17137980461120605, 0.30023810267448425, 0.15002238750457764, 0.19544251263141632]
Choice: 1
Done flag: False
No warmup - hint counter: 15
{'sequence': '32M', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4591565728187561, 0.2058204859495163, 0.16968268156051636, 0.14287708699703217, 0.02246321365237236]}
Decision: Deciding weight of TuningHint(doc_id=11, param=<re.Match object; span=(245, 260), match='key_buffer_size'>, value=<re.Match object; span=(0, 3), match='32M'>, recommendation='32M', passage="The key buffer can improve the access speed to Moodle's SELECT queries. The correct size depends on the size of the index files (.myi) and in Moodle 1.6 or later (without any additional modules and plugins), the recommendation for this value is key_buffer_size = 32M. Ideally you want the database to be reading once from the disk for every 100 requests so monitor that the value is suitable for your install by adjusting the value of key_buffer_size so that the following formulas are true:\nkey_read / key_read_requests < 0.01\nkey_write / key_write_requests <= 1.0 key_buffer_size ", float_val=32.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02246321365237236, 0.4591565728187561, 0.2058204859495163, 0.16968268156051636, 0.14287708699703217]
Choice: 4
Trying update set global key_buffer_size=16777216
Trying update set global key_buffer_size=134217728
Trying assigning key_buffer_size to 16M
Adding assignment ('key_buffer_size', '16M') with weight 16
Assignment ('key_buffer_size', '16M') extracted from "The key buffer can improve the access speed to Moodle's SELECT queries. The correct size depends on the size of the index files (.myi) and in Moodle 1.6 or later (without any additional modules and plugins), the recommendation for this value is key_buffer_size = 32M. Ideally you want the database to be reading once from the disk for every 100 requests so monitor that the value is suitable for your install by adjusting the value of key_buffer_size so that the following formulas are true:
key_read / key_read_requests < 0.01
key_write / key_write_requests <= 1.0 key_buffer_size "
Hint counter: 16
Episode hint counter before: 15
Episode hint counter: 16
Hints per episode: 20
Done flag: False
No warmup - hint counter: 16
{'sequence': '64M', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Decrease recommendation', 'Increase recommendation'], 'scores': [0.2871057093143463, 0.21063925325870514, 0.19450999796390533, 0.15914979577064514, 0.14859525859355927]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(47, 62), match='key_buffer_size'>, value=<re.Match object; span=(0, 3), match='64M'>, recommendation='64M', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=64.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19450999796390533, 0.15914979577064514, 0.2871057093143463, 0.14859525859355927, 0.21063925325870514]
Choice: 3
Done flag: False
No warmup - hint counter: 16
{'sequence': '64M', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.44100087881088257, 0.21198078989982605, 0.1755017787218094, 0.14777542650699615, 0.023741085082292557]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(47, 62), match='key_buffer_size'>, value=<re.Match object; span=(0, 3), match='64M'>, recommendation='64M', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=64.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.023741085082292557, 0.44100087881088257, 0.21198078989982605, 0.1755017787218094, 0.14777542650699615]
--- Tuning Updates ---
Minimal time (ms): 59182.109375
Achieved with configuration: {}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(47, 62), match='key_buffer_size'>, value=<re.Match object; span=(0, 3), match='64M'>, recommendation='64M', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=64.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19450999796390533, 0.15914979577064514, 0.2871057093143463, 0.14859525859355927, 0.21063925325870514]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(47, 62), match='key_buffer_size'>, value=<re.Match object; span=(0, 3), match='64M'>, recommendation='64M', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=64.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.023741085082292557, 0.44100087881088257, 0.21198078989982605, 0.1755017787218094, 0.14777542650699615]
Choice: 2
Trying update set global key_buffer_size=134217728
Trying update set global key_buffer_size=134217728
Trying assigning key_buffer_size to 128M
Adding assignment ('key_buffer_size', '128M') with weight 4
Assignment ('key_buffer_size', '128M') extracted from "tmp-table-size = 96M
max-heap-table-size = 96M
key_buffer_size = 64M
# Connections and Threads
max_connections = 1250
thread_cache_size = 8
max_allowed_packet = 64M thread_pool_max_threads "
Hint counter: 17
Episode hint counter before: 16
Episode hint counter: 17
Hints per episode: 20
Done flag: False
No warmup - hint counter: 17
{'sequence': '8M/128M/No limit', 'labels': ['Use recommendation', 'Decrease recommendation', 'Increase recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly'], 'scores': [0.28674599528312683, 0.2145470678806305, 0.18182188272476196, 0.17758767306804657, 0.13929742574691772]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(1789, 1804), match='key_buffer_size'>, value=<re.Match object; span=(0, 2), match='8M'>, recommendation='8M/128M/No limit', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=8.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.13929742574691772, 0.2145470678806305, 0.28674599528312683, 0.18182188272476196, 0.17758767306804657]
Choice: 2
Done flag: False
No warmup - hint counter: 17
{'sequence': '8M/128M/No limit', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4005581736564636, 0.20327132940292358, 0.16120778024196625, 0.13472256064414978, 0.10024014115333557]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(1789, 1804), match='key_buffer_size'>, value=<re.Match object; span=(0, 2), match='8M'>, recommendation='8M/128M/No limit', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=8.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.10024014115333557, 0.4005581736564636, 0.20327132940292358, 0.16120778024196625, 0.13472256064414978]
Choice: 4
Trying update set global key_buffer_size=8388608
Trying update set global key_buffer_size=134217728
Trying assigning key_buffer_size to 8M
Adding assignment ('key_buffer_size', '8M') with weight 16
Assignment ('key_buffer_size', '8M') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 18
Episode hint counter before: 17
Episode hint counter: 18
Hints per episode: 20
Done flag: False
No warmup - hint counter: 18
{'sequence': '8M/128M/No limit', 'labels': ['Use recommendation', 'Decrease recommendation', 'Increase recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly'], 'scores': [0.28674599528312683, 0.2145470678806305, 0.18182188272476196, 0.17758767306804657, 0.13929742574691772]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(1789, 1804), match='key_buffer_size'>, value=<re.Match object; span=(3, 7), match='128M'>, recommendation='8M/128M/No limit', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=128.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.13929742574691772, 0.2145470678806305, 0.28674599528312683, 0.18182188272476196, 0.17758767306804657]
Choice: 3
Done flag: False
No warmup - hint counter: 18
{'sequence': '8M/128M/No limit', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4005581736564636, 0.20327132940292358, 0.16120778024196625, 0.13472256064414978, 0.10024014115333557]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(1789, 1804), match='key_buffer_size'>, value=<re.Match object; span=(3, 7), match='128M'>, recommendation='8M/128M/No limit', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=128.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.10024014115333557, 0.4005581736564636, 0.20327132940292358, 0.16120778024196625, 0.13472256064414978]
--- Tuning Updates ---
Minimal time (ms): 59182.109375
Achieved with configuration: {}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(1789, 1804), match='key_buffer_size'>, value=<re.Match object; span=(3, 7), match='128M'>, recommendation='8M/128M/No limit', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=128.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.13929742574691772, 0.2145470678806305, 0.28674599528312683, 0.18182188272476196, 0.17758767306804657]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(1789, 1804), match='key_buffer_size'>, value=<re.Match object; span=(3, 7), match='128M'>, recommendation='8M/128M/No limit', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=128.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.10024014115333557, 0.4005581736564636, 0.20327132940292358, 0.16120778024196625, 0.13472256064414978]
Choice: 1
Trying update set global key_buffer_size=536870912
Trying update set global key_buffer_size=134217728
Trying assigning key_buffer_size to 512M
Adding assignment ('key_buffer_size', '512M') with weight 2
Assignment ('key_buffer_size', '512M') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "\n[Restart] MariaDB server shut down!
[Restart] MariaDB server restarted!
/scratch/s8todick/dbbert-slurm/venv/lib/python3.9/site-packages/mariadb/connections.py:85: RuntimeWarning: MariaDB Connector/Python was build with MariaDB Connector/C version 3.3.4 but loaded Connector/C library has version 10.5.21
  super().__init__(*args, **kwargs)
\n[Restart] MariaDB server shut down!
[Restart] MariaDB server restarted!

Hint counter: 19
Episode hint counter before: 18
Episode hint counter: 19
Hints per episode: 20
Done flag: False
No warmup - hint counter: 19
{'sequence': '1200', 'labels': ['Use recommendation', 'Decrease recommendation', 'Increase recommendation', 'Decrease recommendation strongly', 'Increase recommendation strongly'], 'scores': [0.25001347064971924, 0.19854989647865295, 0.1852368712425232, 0.18510159850120544, 0.18109816312789917]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(0, 15), match='key_buffer_size'>, value=<re.Match object; span=(0, 4), match='1200'>, recommendation='1200', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=1200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18510159850120544, 0.19854989647865295, 0.25001347064971924, 0.1852368712425232, 0.18109816312789917]
Choice: 1
Done flag: False
No warmup - hint counter: 19
{'sequence': '1200', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4516242742538452, 0.19539159536361694, 0.16862988471984863, 0.168478325009346, 0.01587599329650402]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(0, 15), match='key_buffer_size'>, value=<re.Match object; span=(0, 4), match='1200'>, recommendation='1200', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=1200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.01587599329650402, 0.4516242742538452, 0.19539159536361694, 0.16862988471984863, 0.168478325009346]
Choice: 2
Trying update set global key_buffer_size=600
Exception during update: Cannot drop default keycache
Trying update set global key_buffer_size=134217728
Trying assigning key_buffer_size to 600
Assignment ('key_buffer_size', '600') was rejected
Hint counter: 20
Episode hint counter before: 19
Episode hint counter: 20
Hints per episode: 20
Episode finished!
Done flag: True
Finalizing episode!
Weighted hints: defaultdict(<function NlpTuningEnv.__init__.<locals>.<lambda> at 0x7f876a43a790>, {('thread_cache_size', '8'): 10, ('thread_cache_size', '2'): 1, ('thread_cache_size', '32'): 2, ('max_connections', '50'): 1, ('max_connections', '5000'): 2, ('max_connections', '300'): 8, ('max_connections', '400'): 2, ('max_connections', '10'): 4, ('max_connections', '1000'): 1, ('innodb_buffer_pool_size', '4294967296'): 16, ('innodb_buffer_pool_size', '5G'): 8, ('innodb_buffer_pool_size', '45M'): 1, ('key_buffer_size', '16M'): 16, ('key_buffer_size', '128M'): 4, ('key_buffer_size', '8M'): 16, ('key_buffer_size', '512M'): 2})
Selected configurations: [{'thread_cache_size': '8', 'max_connections': '1000', 'innodb_buffer_pool_size': '4294967296', 'key_buffer_size': '16M'}, {'thread_cache_size': '32', 'max_connections': '5000', 'innodb_buffer_pool_size': '5G', 'key_buffer_size': '512M'}]
Disconnecting ...
Trying to connect to tpch with user kaltenec
Trying update set session max_execution_time = 1500000
Exception during update: Unknown system variable 'max_execution_time'
Trying update update mariadb.server_cost set cost_value = NULL
Exception during update: Table 'mariadb.server_cost' doesn't exist
Trying update update mariadb.engine_cost set cost_value = NULL
Exception during update: Table 'mariadb.engine_cost' doesn't exist
Trying configuration: {'thread_cache_size': '8', 'max_connections': '1000', 'innodb_buffer_pool_size': '4294967296', 'key_buffer_size': '16M'}
Trying update set global thread_cache_size=8
Trying update set global max_connections=1000
Trying update set global innodb_buffer_pool_size=4294967296
Trying update set global key_buffer_size=16777216
--- Tuning Updates ---
Minimal time (ms): 59182.109375
Achieved with configuration: {}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Reward 43980.917236328125 with {'thread_cache_size': '8', 'max_connections': '1000', 'innodb_buffer_pool_size': '4294967296', 'key_buffer_size': '16M'}
Disconnecting ...
Trying to connect to tpch with user kaltenec
Trying update set session max_execution_time = 1500000
Exception during update: Unknown system variable 'max_execution_time'
Trying update update mariadb.server_cost set cost_value = NULL
Exception during update: Table 'mariadb.server_cost' doesn't exist
Trying update update mariadb.engine_cost set cost_value = NULL
Exception during update: Table 'mariadb.engine_cost' doesn't exist
Trying configuration: {'thread_cache_size': '32', 'max_connections': '5000', 'innodb_buffer_pool_size': '5G', 'key_buffer_size': '512M'}
Trying update set global thread_cache_size=32
Trying update set global max_connections=5000
Trying update set global innodb_buffer_pool_size=5368709120
Trying update set global key_buffer_size=536870912
--- Tuning Updates ---
Minimal time (ms): 15201.192138671875
Achieved with configuration: {'thread_cache_size': 8, 'max_connections': 1000, 'innodb_buffer_pool_size': 4294967296, 'key_buffer_size': 16777216}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Reward 46984.392578125 with {'thread_cache_size': '32', 'max_connections': '5000', 'innodb_buffer_pool_size': '5G', 'key_buffer_size': '512M'}
Obtained 46984.392578125 by configuration {'thread_cache_size': '32', 'max_connections': '5000', 'innodb_buffer_pool_size': '5G', 'key_buffer_size': '512M'}
Achieved unscaled reward of 46984.392578125 using {'thread_cache_size': '32', 'max_connections': '5000', 'innodb_buffer_pool_size': '5G', 'key_buffer_size': '512M'}.
No warmup - hint counter: 20
{'sequence': '16', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Increase recommendation', 'Decrease recommendation'], 'scores': [0.2578245997428894, 0.21941344439983368, 0.18871235847473145, 0.17040672898292542, 0.16364289820194244]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(202, 217), match='key_buffer_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18871235847473145, 0.16364289820194244, 0.2578245997428894, 0.17040672898292542, 0.21941344439983368]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(202, 217), match='key_buffer_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18871235847473145, 0.16364289820194244, 0.2578245997428894, 0.17040672898292542, 0.21941344439983368]
Choice: 0
Done flag: False
No warmup - hint counter: 20
{'sequence': '16', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4661506414413452, 0.19984710216522217, 0.16229088604450226, 0.1465105265378952, 0.025200868025422096]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(202, 217), match='key_buffer_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.025200868025422096, 0.4661506414413452, 0.19984710216522217, 0.16229088604450226, 0.1465105265378952]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(202, 217), match='key_buffer_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18871235847473145, 0.16364289820194244, 0.2578245997428894, 0.17040672898292542, 0.21941344439983368]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(202, 217), match='key_buffer_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.025200868025422096, 0.4661506414413452, 0.19984710216522217, 0.16229088604450226, 0.1465105265378952]
Choice: 0
Trying update set global key_buffer_size=64
Exception during update: Cannot drop default keycache
Trying update set global key_buffer_size=536870912
Trying assigning key_buffer_size to 64
Assignment ('key_buffer_size', '64') was rejected
Hint counter: 21
Episode hint counter before: 0
Episode hint counter: 1
Hints per episode: 20
Done flag: False
No warmup - hint counter: 21
{'sequence': '512', 'labels': ['Use recommendation', 'Increase recommendation', 'Decrease recommendation strongly', 'Increase recommendation strongly', 'Decrease recommendation'], 'scores': [0.2637619078159332, 0.19082817435264587, 0.18853892385959625, 0.18315310776233673, 0.17371782660484314]}
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(326, 342), match='table_open_cache'>, value=<re.Match object; span=(0, 3), match='512'>, recommendation='512', passage="Adjusting key_buffer_size, and reducing this if you're not using MyISAM Tables, (It's only relevant to have a large key_buffer_size if you're using MyISAM Tables, which by default MariaDB uses InnoDB. General consensus is InnoDB offers better performance as well, so really only use MyISAM if you have a reason to).\nAdjusting table_open_cache (previously called table_cache) - in Performance recommendations under MySQL, it recommends having this as 512 for most Moodle Installations, but I left it at the default MariaDB setting of 2000. lower_case_table_names ", float_val=512.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18853892385959625, 0.17371782660484314, 0.2637619078159332, 0.19082817435264587, 0.18315310776233673]
Choice: 2
Done flag: False
No warmup - hint counter: 21
{'sequence': '512', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.45673248171806335, 0.20234665274620056, 0.1712857037782669, 0.14736124873161316, 0.022273913025856018]}
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(326, 342), match='table_open_cache'>, value=<re.Match object; span=(0, 3), match='512'>, recommendation='512', passage="Adjusting key_buffer_size, and reducing this if you're not using MyISAM Tables, (It's only relevant to have a large key_buffer_size if you're using MyISAM Tables, which by default MariaDB uses InnoDB. General consensus is InnoDB offers better performance as well, so really only use MyISAM if you have a reason to).\nAdjusting table_open_cache (previously called table_cache) - in Performance recommendations under MySQL, it recommends having this as 512 for most Moodle Installations, but I left it at the default MariaDB setting of 2000. lower_case_table_names ", float_val=512.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.022273913025856018, 0.45673248171806335, 0.20234665274620056, 0.1712857037782669, 0.14736124873161316]
Choice: 2
Trying update set global table_open_cache=512
Trying update set global table_open_cache=2000
Trying assigning table_open_cache to 512
Adding assignment ('table_open_cache', '512') with weight 4
Assignment ('table_open_cache', '512') extracted from "Adjusting key_buffer_size, and reducing this if you're not using MyISAM Tables, (It's only relevant to have a large key_buffer_size if you're using MyISAM Tables, which by default MariaDB uses InnoDB. General consensus is InnoDB offers better performance as well, so really only use MyISAM if you have a reason to).
Adjusting table_open_cache (previously called table_cache) - in Performance recommendations under MySQL, it recommends having this as 512 for most Moodle Installations, but I left it at the default MariaDB setting of 2000. lower_case_table_names "
Hint counter: 22
Episode hint counter before: 1
Episode hint counter: 2
Hints per episode: 20
Done flag: False
No warmup - hint counter: 22
{'sequence': '16', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Increase recommendation', 'Decrease recommendation'], 'scores': [0.2578245997428894, 0.21941344439983368, 0.18871235847473145, 0.17040672898292542, 0.16364289820194244]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(0, 16), match='table_open_cache'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18871235847473145, 0.16364289820194244, 0.2578245997428894, 0.17040672898292542, 0.21941344439983368]
Choice: 3
Done flag: False
No warmup - hint counter: 22
{'sequence': '16', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4661506414413452, 0.19984710216522217, 0.16229088604450226, 0.1465105265378952, 0.025200868025422096]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(0, 16), match='table_open_cache'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.025200868025422096, 0.4661506414413452, 0.19984710216522217, 0.16229088604450226, 0.1465105265378952]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(0, 16), match='table_open_cache'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18871235847473145, 0.16364289820194244, 0.2578245997428894, 0.17040672898292542, 0.21941344439983368]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(0, 16), match='table_open_cache'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.025200868025422096, 0.4661506414413452, 0.19984710216522217, 0.16229088604450226, 0.1465105265378952]
Choice: 1
Trying update set global table_open_cache=8
Trying update set global table_open_cache=2000
Trying assigning table_open_cache to 8
Adding assignment ('table_open_cache', '8') with weight 2
Assignment ('table_open_cache', '8') extracted from "table_open_cache_instances = 16
table_open_cache
= 32012
open_files_limit = 65535
max_connect_errors = 1000000
[client]
# MySQL Client Configuration
# Client Socket table_open_cache_instances "
Hint counter: 23
Episode hint counter before: 2
Episode hint counter: 3
Hints per episode: 20
Done flag: False
No warmup - hint counter: 23
{'sequence': '1/1/64', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Increase recommendation', 'Decrease recommendation'], 'scores': [0.2996373772621155, 0.22072190046310425, 0.18495632708072662, 0.15297187864780426, 0.14171242713928223]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18495632708072662, 0.14171242713928223, 0.2996373772621155, 0.15297187864780426, 0.22072190046310425]
Choice: 0
Done flag: False
No warmup - hint counter: 23
{'sequence': '1/1/64', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4701266586780548, 0.20297597348690033, 0.16598810255527496, 0.13189274072647095, 0.02901652827858925]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02901652827858925, 0.4701266586780548, 0.20297597348690033, 0.16598810255527496, 0.13189274072647095]
Choice: 2
Trying update set global table_open_cache=0
Trying update set global table_open_cache=2000
Trying assigning table_open_cache to 0
Adding assignment ('table_open_cache', '0') with weight 4
Assignment ('table_open_cache', '0') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 24
Episode hint counter before: 3
Episode hint counter: 4
Hints per episode: 20
Done flag: False
No warmup - hint counter: 24
{'sequence': '1/1/64', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Increase recommendation', 'Decrease recommendation'], 'scores': [0.2996373772621155, 0.22072190046310425, 0.18495632708072662, 0.15297187864780426, 0.14171242713928223]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(2, 3), match='1'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18495632708072662, 0.14171242713928223, 0.2996373772621155, 0.15297187864780426, 0.22072190046310425]
Choice: 0
Done flag: False
No warmup - hint counter: 24
{'sequence': '1/1/64', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4701266586780548, 0.20297597348690033, 0.16598810255527496, 0.13189274072647095, 0.02901652827858925]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(2, 3), match='1'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02901652827858925, 0.4701266586780548, 0.20297597348690033, 0.16598810255527496, 0.13189274072647095]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(2, 3), match='1'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18495632708072662, 0.14171242713928223, 0.2996373772621155, 0.15297187864780426, 0.22072190046310425]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(2, 3), match='1'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02901652827858925, 0.4701266586780548, 0.20297597348690033, 0.16598810255527496, 0.13189274072647095]
Choice: 1
Trying update set global table_open_cache=2
Trying update set global table_open_cache=2000
Trying assigning table_open_cache to 2
Adding assignment ('table_open_cache', '2') with weight 2
Assignment ('table_open_cache', '2') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 25
Episode hint counter before: 4
Episode hint counter: 5
Hints per episode: 20
Done flag: False
No warmup - hint counter: 25
{'sequence': '1/1/64', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Increase recommendation', 'Decrease recommendation'], 'scores': [0.2996373772621155, 0.22072190046310425, 0.18495632708072662, 0.15297187864780426, 0.14171242713928223]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(4, 6), match='64'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18495632708072662, 0.14171242713928223, 0.2996373772621155, 0.15297187864780426, 0.22072190046310425]
Choice: 4
Done flag: False
No warmup - hint counter: 25
{'sequence': '1/1/64', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4701266586780548, 0.20297597348690033, 0.16598810255527496, 0.13189274072647095, 0.02901652827858925]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(4, 6), match='64'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02901652827858925, 0.4701266586780548, 0.20297597348690033, 0.16598810255527496, 0.13189274072647095]
Choice: 3
Trying update set global table_open_cache=256
Trying update set global table_open_cache=2000
Trying assigning table_open_cache to 256
Adding assignment ('table_open_cache', '256') with weight 8
Assignment ('table_open_cache', '256') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 26
Episode hint counter before: 5
Episode hint counter: 6
Hints per episode: 20
Done flag: False
No warmup - hint counter: 26
{'sequence': '2048', 'labels': ['Use recommendation', 'Decrease recommendation', 'Decrease recommendation strongly', 'Increase recommendation', 'Increase recommendation strongly'], 'scores': [0.2764931619167328, 0.20450188219547272, 0.17999409139156342, 0.1695912778377533, 0.1694195717573166]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(116, 132), match='table_open_cache'>, value=<re.Match object; span=(0, 4), match='2048'>, recommendation='2048', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=2048.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.17999409139156342, 0.20450188219547272, 0.2764931619167328, 0.1695912778377533, 0.1694195717573166]
Choice: 0
Done flag: False
No warmup - hint counter: 26
{'sequence': '2048', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.44854864478111267, 0.20763951539993286, 0.17194095253944397, 0.14623866975307465, 0.025632193312048912]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(116, 132), match='table_open_cache'>, value=<re.Match object; span=(0, 4), match='2048'>, recommendation='2048', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=2048.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.025632193312048912, 0.44854864478111267, 0.20763951539993286, 0.17194095253944397, 0.14623866975307465]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(116, 132), match='table_open_cache'>, value=<re.Match object; span=(0, 4), match='2048'>, recommendation='2048', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=2048.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.17999409139156342, 0.20450188219547272, 0.2764931619167328, 0.1695912778377533, 0.1694195717573166]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(116, 132), match='table_open_cache'>, value=<re.Match object; span=(0, 4), match='2048'>, recommendation='2048', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=2048.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.025632193312048912, 0.44854864478111267, 0.20763951539993286, 0.17194095253944397, 0.14623866975307465]
Choice: 3
Trying update set global table_open_cache=1024
Trying update set global table_open_cache=2000
Trying assigning table_open_cache to 1024
Adding assignment ('table_open_cache', '1024') with weight 8
Assignment ('table_open_cache', '1024') extracted from "read_rnd_buffer_size = 512
join_buffer_size = 2048
thread_stack = 512
binlog_cache_size = 64
thread_cache_size = 16
table_open_cache = 2048
max_connections = 200
PHP:
max_children = 4 thread_cache_size "
Hint counter: 27
Episode hint counter before: 6
Episode hint counter: 7
Hints per episode: 20
Done flag: False
No warmup - hint counter: 27
{'sequence': '64', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Decrease recommendation', 'Increase recommendation'], 'scores': [0.2561816871166229, 0.20899151265621185, 0.20224447548389435, 0.18172581493854523, 0.15085653960704803]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(45, 61), match='table_open_cache'>, value=<re.Match object; span=(0, 2), match='64'>, recommendation='64', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20224447548389435, 0.18172581493854523, 0.2561816871166229, 0.15085653960704803, 0.20899151265621185]
Choice: 3
Done flag: False
No warmup - hint counter: 27
{'sequence': '64', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.460867315530777, 0.20801353454589844, 0.16750642657279968, 0.13584065437316895, 0.027772024273872375]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(45, 61), match='table_open_cache'>, value=<re.Match object; span=(0, 2), match='64'>, recommendation='64', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.027772024273872375, 0.460867315530777, 0.20801353454589844, 0.16750642657279968, 0.13584065437316895]
Choice: 3
Trying update set global table_open_cache=128
Trying update set global table_open_cache=2000
Trying assigning table_open_cache to 128
Adding assignment ('table_open_cache', '128') with weight 8
Assignment ('table_open_cache', '128') extracted from "binlog_cache_size = 32
thread_cache_size = 8
table_open_cache = 64
max_connections = 20
PHP:
max_children = 10
start_servers = 2
min_spare_servers = 1
max_spare_servers = 3 binlog_stmt_cache_size "
Hint counter: 28
Episode hint counter before: 7
Episode hint counter: 8
Hints per episode: 20
Done flag: False
No warmup - hint counter: 28
{'sequence': '16 or so', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation', 'Decrease recommendation strongly', 'Increase recommendation'], 'scores': [0.28911828994750977, 0.18617865443229675, 0.1852453649044037, 0.18521332740783691, 0.15424436330795288]}
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(360, 376), match='query_cache_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16 or so', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18521332740783691, 0.1852453649044037, 0.28911828994750977, 0.15424436330795288, 0.18617865443229675]
Choice: 3
Done flag: False
No warmup - hint counter: 28
{'sequence': '16 or so', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.50733482837677, 0.1963784247636795, 0.14746752381324768, 0.12025613337755203, 0.028563059866428375]}
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(360, 376), match='query_cache_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16 or so', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.028563059866428375, 0.50733482837677, 0.1963784247636795, 0.14746752381324768, 0.12025613337755203]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(360, 376), match='query_cache_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16 or so', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18521332740783691, 0.1852453649044037, 0.28911828994750977, 0.15424436330795288, 0.18617865443229675]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(360, 376), match='query_cache_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16 or so', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.028563059866428375, 0.50733482837677, 0.1963784247636795, 0.14746752381324768, 0.12025613337755203]
Choice: 4
Trying update set global query_cache_size=4
Trying update set global query_cache_size=1048576
Trying assigning query_cache_size to 4
Adding assignment ('query_cache_size', '4') with weight 16
Assignment ('query_cache_size', '4') extracted from "Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).
Adjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size "
Hint counter: 29
Episode hint counter before: 8
Episode hint counter: 9
Hints per episode: 20
Done flag: False
No warmup - hint counter: 29
{'sequence': '50', 'labels': ['Use recommendation', 'Decrease recommendation', 'Decrease recommendation strongly', 'Increase recommendation', 'Increase recommendation strongly'], 'scores': [0.2630220055580139, 0.21986037492752075, 0.19981148838996887, 0.16092373430728912, 0.15638239681720734]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(23, 39), match='query_cache_size'>, value=<re.Match object; span=(0, 2), match='50'>, recommendation='50', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=50.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19981148838996887, 0.21986037492752075, 0.2630220055580139, 0.16092373430728912, 0.15638239681720734]
Choice: 3
Done flag: False
No warmup - hint counter: 29
{'sequence': '50', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4847303330898285, 0.1944613754749298, 0.1586245894432068, 0.1296287328004837, 0.03255493938922882]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(23, 39), match='query_cache_size'>, value=<re.Match object; span=(0, 2), match='50'>, recommendation='50', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=50.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.03255493938922882, 0.4847303330898285, 0.1944613754749298, 0.1586245894432068, 0.1296287328004837]
Choice: 4
Trying update set global query_cache_size=100
Trying update set global query_cache_size=1048576
Trying assigning query_cache_size to 100
Adding assignment ('query_cache_size', '100') with weight 16
Assignment ('query_cache_size', '100') extracted from "key_buffer_size = 1200
query_cache_size = 50
tmp_table_size = 128
innodb_buffer_pool_size = 4096
innodb_log_buffer_size = 32
sort_buffer_size = 2048
read_buffer_size = 256 key_buffer_size "
Hint counter: 30
Episode hint counter before: 9
Episode hint counter: 10
Hints per episode: 20
Done flag: False
No warmup - hint counter: 30
{'sequence': '0', 'labels': ['Use recommendation', 'Decrease recommendation strongly', 'Decrease recommendation', 'Increase recommendation', 'Increase recommendation strongly'], 'scores': [0.27009207010269165, 0.20856523513793945, 0.2019384503364563, 0.17301714420318604, 0.14638707041740417]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(223, 239), match='query_cache_size'>, value=<re.Match object; span=(0, 1), match='0'>, recommendation='0', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=0.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20856523513793945, 0.2019384503364563, 0.27009207010269165, 0.17301714420318604, 0.14638707041740417]
Choice: 4
Done flag: False
No warmup - hint counter: 30
{'sequence': '0', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.44440340995788574, 0.20087464153766632, 0.16065354645252228, 0.14993849396705627, 0.04412984102964401]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(223, 239), match='query_cache_size'>, value=<re.Match object; span=(0, 1), match='0'>, recommendation='0', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=0.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.04412984102964401, 0.44440340995788574, 0.20087464153766632, 0.16065354645252228, 0.14993849396705627]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(223, 239), match='query_cache_size'>, value=<re.Match object; span=(0, 1), match='0'>, recommendation='0', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=0.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20856523513793945, 0.2019384503364563, 0.27009207010269165, 0.17301714420318604, 0.14638707041740417]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(223, 239), match='query_cache_size'>, value=<re.Match object; span=(0, 1), match='0'>, recommendation='0', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=0.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.04412984102964401, 0.44440340995788574, 0.20087464153766632, 0.16065354645252228, 0.14993849396705627]
Choice: 0
Trying update set global query_cache_size=0
Trying update set global query_cache_size=1048576
Trying assigning query_cache_size to 0
Adding assignment ('query_cache_size', '0') with weight 1
Assignment ('query_cache_size', '0') extracted from "The whole problem is the number of cores. I advise you to install at least 2 CPU cores.
Given the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.
MySQL:
key_buffer_size = 16
query_cache_size = 0
tmp_table_size = 32 thread_cache_size "
Hint counter: 31
Episode hint counter before: 10
Episode hint counter: 11
Hints per episode: 20
Done flag: False
No warmup - hint counter: 31
{'sequence': '300M', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Increase recommendation', 'Decrease recommendation strongly', 'Decrease recommendation'], 'scores': [0.28496333956718445, 0.2031497359275818, 0.17855490744113922, 0.16972294449806213, 0.1636090725660324]}
Decision: Deciding adaption of TuningHint(doc_id=63, param=<re.Match object; span=(54, 70), match='query_cache_size'>, value=<re.Match object; span=(0, 4), match='300M'>, recommendation='300M', passage='# * Query Cache Configuration\nquery_cache_limit\n= 50M\nquery_cache_size\n= 300M\n# * Logging and Replication\n# * InnoDB\n# InnoDB is enabled by default with a 10MB datafile in /var/lib/mysql/. query_cache_limit ', float_val=300.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.16972294449806213, 0.1636090725660324, 0.28496333956718445, 0.17855490744113922, 0.2031497359275818]
Choice: 3
Done flag: False
No warmup - hint counter: 31
{'sequence': '300M', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.43009284138679504, 0.20850959420204163, 0.18484938144683838, 0.15883034467697144, 0.01771782524883747]}
Decision: Deciding weight of TuningHint(doc_id=63, param=<re.Match object; span=(54, 70), match='query_cache_size'>, value=<re.Match object; span=(0, 4), match='300M'>, recommendation='300M', passage='# * Query Cache Configuration\nquery_cache_limit\n= 50M\nquery_cache_size\n= 300M\n# * Logging and Replication\n# * InnoDB\n# InnoDB is enabled by default with a 10MB datafile in /var/lib/mysql/. query_cache_limit ', float_val=300.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.01771782524883747, 0.43009284138679504, 0.20850959420204163, 0.18484938144683838, 0.15883034467697144]
Choice: 4
Trying update set global query_cache_size=629145600
Trying update set global query_cache_size=1048576
Trying assigning query_cache_size to 600M
Adding assignment ('query_cache_size', '600M') with weight 16
Assignment ('query_cache_size', '600M') extracted from "# * Query Cache Configuration
query_cache_limit
= 50M
query_cache_size
= 300M
# * Logging and Replication
# * InnoDB
# InnoDB is enabled by default with a 10MB datafile in /var/lib/mysql/. query_cache_limit "
Hint counter: 32
Episode hint counter before: 11
Episode hint counter: 12
Hints per episode: 20
Done flag: False
No warmup - hint counter: 32
{'sequence': '2K. max_binlog_stmt_cache_size', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Increase recommendation', 'Decrease recommendation strongly', 'Decrease recommendation'], 'scores': [0.37586623430252075, 0.21611016988754272, 0.2043144553899765, 0.1023973599076271, 0.10131178051233292]}
Decision: Deciding adaption of TuningHint(doc_id=11, param=<re.Match object; span=(343, 367), match='query_cache_min_res_unit'>, value=<re.Match object; span=(0, 2), match='2K'>, recommendation='2K. max_binlog_stmt_cache_size', passage='If you are able, the MySQLTuner tool can be run against your MySQL server and will calculate appropriate configuration values for most of the following settings based on your current load, status and variables automatically.\nEnable the query cache with\nquery_cache_type = 1.\nFor most Moodle installs, set the following:\nquery_cache_size = 36M\nquery_cache_min_res_unit = 2K. max_binlog_stmt_cache_size ', float_val=2.0, val_unit='K', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1023973599076271, 0.10131178051233292, 0.37586623430252075, 0.2043144553899765, 0.21611016988754272]
Choice: 2
Done flag: False
No warmup - hint counter: 32
{'sequence': '2K. max_binlog_stmt_cache_size', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.5477354526519775, 0.17416539788246155, 0.14326906204223633, 0.11934469640254974, 0.01548533234745264]}
Decision: Deciding weight of TuningHint(doc_id=11, param=<re.Match object; span=(343, 367), match='query_cache_min_res_unit'>, value=<re.Match object; span=(0, 2), match='2K'>, recommendation='2K. max_binlog_stmt_cache_size', passage='If you are able, the MySQLTuner tool can be run against your MySQL server and will calculate appropriate configuration values for most of the following settings based on your current load, status and variables automatically.\nEnable the query cache with\nquery_cache_type = 1.\nFor most Moodle installs, set the following:\nquery_cache_size = 36M\nquery_cache_min_res_unit = 2K. max_binlog_stmt_cache_size ', float_val=2.0, val_unit='K', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.01548533234745264, 0.5477354526519775, 0.17416539788246155, 0.14326906204223633, 0.11934469640254974]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=11, param=<re.Match object; span=(343, 367), match='query_cache_min_res_unit'>, value=<re.Match object; span=(0, 2), match='2K'>, recommendation='2K. max_binlog_stmt_cache_size', passage='If you are able, the MySQLTuner tool can be run against your MySQL server and will calculate appropriate configuration values for most of the following settings based on your current load, status and variables automatically.\nEnable the query cache with\nquery_cache_type = 1.\nFor most Moodle installs, set the following:\nquery_cache_size = 36M\nquery_cache_min_res_unit = 2K. max_binlog_stmt_cache_size ', float_val=2.0, val_unit='K', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1023973599076271, 0.10131178051233292, 0.37586623430252075, 0.2043144553899765, 0.21611016988754272]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=11, param=<re.Match object; span=(343, 367), match='query_cache_min_res_unit'>, value=<re.Match object; span=(0, 2), match='2K'>, recommendation='2K. max_binlog_stmt_cache_size', passage='If you are able, the MySQLTuner tool can be run against your MySQL server and will calculate appropriate configuration values for most of the following settings based on your current load, status and variables automatically.\nEnable the query cache with\nquery_cache_type = 1.\nFor most Moodle installs, set the following:\nquery_cache_size = 36M\nquery_cache_min_res_unit = 2K. max_binlog_stmt_cache_size ', float_val=2.0, val_unit='K', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.01548533234745264, 0.5477354526519775, 0.17416539788246155, 0.14326906204223633, 0.11934469640254974]
Choice: 1
Trying update set global query_cache_min_res_unit=1024
Trying update set global query_cache_min_res_unit=4096
Trying assigning query_cache_min_res_unit to 1K
Adding assignment ('query_cache_min_res_unit', '1K') with weight 2
Assignment ('query_cache_min_res_unit', '1K') extracted from "If you are able, the MySQLTuner tool can be run against your MySQL server and will calculate appropriate configuration values for most of the following settings based on your current load, status and variables automatically.
Enable the query cache with
query_cache_type = 1.
For most Moodle installs, set the following:
query_cache_size = 36M
query_cache_min_res_unit = 2K. max_binlog_stmt_cache_size "
Hint counter: 33
Episode hint counter before: 12
Episode hint counter: 13
Hints per episode: 20
Done flag: False
No warmup - hint counter: 33
{'sequence': '4096 (4KB).', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Increase recommendation', 'Decrease recommendation'], 'scores': [0.3037382960319519, 0.23038634657859802, 0.1934792846441269, 0.15213847160339355, 0.12025752663612366]}
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(497, 521), match='query_cache_min_res_unit'>, value=<re.Match object; span=(0, 4), match='4096'>, recommendation='4096 (4KB).', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=4096.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1934792846441269, 0.12025752663612366, 0.3037382960319519, 0.15213847160339355, 0.23038634657859802]
Choice: 0
Done flag: False
No warmup - hint counter: 33
{'sequence': '4096 (4KB).', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4735428988933563, 0.2037220150232315, 0.16191641986370087, 0.13186153769493103, 0.028957035392522812]}
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(497, 521), match='query_cache_min_res_unit'>, value=<re.Match object; span=(0, 4), match='4096'>, recommendation='4096 (4KB).', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=4096.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.028957035392522812, 0.4735428988933563, 0.2037220150232315, 0.16191641986370087, 0.13186153769493103]
Choice: 2
Trying update set global query_cache_min_res_unit=1024
Trying update set global query_cache_min_res_unit=4096
Trying assigning query_cache_min_res_unit to 1024
Adding assignment ('query_cache_min_res_unit', '1024') with weight 4
Assignment ('query_cache_min_res_unit', '1024') extracted from "Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).
Adjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size "
Hint counter: 34
Episode hint counter before: 13
Episode hint counter: 14
Hints per episode: 20
Done flag: False
No warmup - hint counter: 34
{'sequence': '4096 (4KB).', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Increase recommendation', 'Decrease recommendation'], 'scores': [0.3037382960319519, 0.23038634657859802, 0.1934792846441269, 0.15213847160339355, 0.12025752663612366]}
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(497, 521), match='query_cache_min_res_unit'>, value=<re.Match object; span=(6, 9), match='4KB'>, recommendation='4096 (4KB).', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=4.0, val_unit='KB', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1934792846441269, 0.12025752663612366, 0.3037382960319519, 0.15213847160339355, 0.23038634657859802]
Choice: 0
Done flag: False
No warmup - hint counter: 34
{'sequence': '4096 (4KB).', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4735428988933563, 0.2037220150232315, 0.16191641986370087, 0.13186153769493103, 0.028957035392522812]}
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(497, 521), match='query_cache_min_res_unit'>, value=<re.Match object; span=(6, 9), match='4KB'>, recommendation='4096 (4KB).', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=4.0, val_unit='KB', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.028957035392522812, 0.4735428988933563, 0.2037220150232315, 0.16191641986370087, 0.13186153769493103]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(497, 521), match='query_cache_min_res_unit'>, value=<re.Match object; span=(6, 9), match='4KB'>, recommendation='4096 (4KB).', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=4.0, val_unit='KB', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1934792846441269, 0.12025752663612366, 0.3037382960319519, 0.15213847160339355, 0.23038634657859802]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(497, 521), match='query_cache_min_res_unit'>, value=<re.Match object; span=(6, 9), match='4KB'>, recommendation='4096 (4KB).', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=4.0, val_unit='KB', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.028957035392522812, 0.4735428988933563, 0.2037220150232315, 0.16191641986370087, 0.13186153769493103]
Choice: 2
Trying update set global query_cache_min_res_unit=2048
Trying update set global query_cache_min_res_unit=4096
Trying assigning query_cache_min_res_unit to 2KB
Adding assignment ('query_cache_min_res_unit', '2KB') with weight 4
Assignment ('query_cache_min_res_unit', '2KB') extracted from "Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).
Adjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size "
Hint counter: 35
Episode hint counter before: 14
Episode hint counter: 15
Hints per episode: 20
Done flag: False
No warmup - hint counter: 35
{'sequence': '5', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Increase recommendation', 'Decrease recommendation'], 'scores': [0.2528528869152069, 0.2206595540046692, 0.19026686251163483, 0.18311728537082672, 0.15310339629650116]}
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(380, 394), match='tmp_table_size'>, value=<re.Match object; span=(0, 1), match='5'>, recommendation='5', passage="Adjusting Swappiness - Swappiness is how aggressively the OS will swap to and from RAM to disk - useful for applications you're using and then quickly switching, not so much for databasing where the buffer_pool could then be swapped out to disk, defeating the purpose of the buffer_pool. I set this to the recommended value of 5.\nOther Adjustments from the Inter-webs:\nI adjusted tmp_table_size to 64MB, seems to be recommended a lot over the internet, and I figured it couldn't hurt due to the amount of RAM we have available (default is 16MB for this). thread_cache_size ", float_val=5.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19026686251163483, 0.15310339629650116, 0.2528528869152069, 0.18311728537082672, 0.2206595540046692]
Choice: 1
Done flag: False
No warmup - hint counter: 35
{'sequence': '5', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.47899532318115234, 0.1991700381040573, 0.1566268354654312, 0.13406425714492798, 0.031143534928560257]}
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(380, 394), match='tmp_table_size'>, value=<re.Match object; span=(0, 1), match='5'>, recommendation='5', passage="Adjusting Swappiness - Swappiness is how aggressively the OS will swap to and from RAM to disk - useful for applications you're using and then quickly switching, not so much for databasing where the buffer_pool could then be swapped out to disk, defeating the purpose of the buffer_pool. I set this to the recommended value of 5.\nOther Adjustments from the Inter-webs:\nI adjusted tmp_table_size to 64MB, seems to be recommended a lot over the internet, and I figured it couldn't hurt due to the amount of RAM we have available (default is 16MB for this). thread_cache_size ", float_val=5.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.031143534928560257, 0.47899532318115234, 0.1991700381040573, 0.1566268354654312, 0.13406425714492798]
Choice: 4
Trying update set global tmp_table_size=2
Trying update set global tmp_table_size=16777216
Trying assigning tmp_table_size to 2
Adding assignment ('tmp_table_size', '2') with weight 16
Assignment ('tmp_table_size', '2') extracted from "Adjusting Swappiness - Swappiness is how aggressively the OS will swap to and from RAM to disk - useful for applications you're using and then quickly switching, not so much for databasing where the buffer_pool could then be swapped out to disk, defeating the purpose of the buffer_pool. I set this to the recommended value of 5.
Other Adjustments from the Inter-webs:
I adjusted tmp_table_size to 64MB, seems to be recommended a lot over the internet, and I figured it couldn't hurt due to the amount of RAM we have available (default is 16MB for this). thread_cache_size "
Hint counter: 36
Episode hint counter before: 15
Episode hint counter: 16
Hints per episode: 20
Done flag: False
No warmup - hint counter: 36
{'sequence': '128', 'labels': ['Use recommendation', 'Decrease recommendation strongly', 'Increase recommendation strongly', 'Decrease recommendation', 'Increase recommendation'], 'scores': [0.2555597424507141, 0.19846782088279724, 0.19749031960964203, 0.18246710300445557, 0.16601499915122986]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(45, 59), match='tmp_table_size'>, value=<re.Match object; span=(0, 3), match='128'>, recommendation='128', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=128.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19846782088279724, 0.18246710300445557, 0.2555597424507141, 0.16601499915122986, 0.19749031960964203]
Choice: 3
Done flag: False
No warmup - hint counter: 36
{'sequence': '128', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4462120532989502, 0.20742511749267578, 0.17375534772872925, 0.14886371791362762, 0.023743821308016777]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(45, 59), match='tmp_table_size'>, value=<re.Match object; span=(0, 3), match='128'>, recommendation='128', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=128.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.023743821308016777, 0.4462120532989502, 0.20742511749267578, 0.17375534772872925, 0.14886371791362762]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(45, 59), match='tmp_table_size'>, value=<re.Match object; span=(0, 3), match='128'>, recommendation='128', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=128.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19846782088279724, 0.18246710300445557, 0.2555597424507141, 0.16601499915122986, 0.19749031960964203]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(45, 59), match='tmp_table_size'>, value=<re.Match object; span=(0, 3), match='128'>, recommendation='128', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=128.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.023743821308016777, 0.4462120532989502, 0.20742511749267578, 0.17375534772872925, 0.14886371791362762]
Choice: 4
Trying update set global tmp_table_size=64
Trying update set global tmp_table_size=16777216
Trying assigning tmp_table_size to 64
Adding assignment ('tmp_table_size', '64') with weight 16
Assignment ('tmp_table_size', '64') extracted from "key_buffer_size = 1200
query_cache_size = 50
tmp_table_size = 128
innodb_buffer_pool_size = 4096
innodb_log_buffer_size = 32
sort_buffer_size = 2048
read_buffer_size = 256 key_buffer_size "
Hint counter: 37
Episode hint counter before: 16
Episode hint counter: 17
Hints per episode: 20
Done flag: False
No warmup - hint counter: 37
{'sequence': '32', 'labels': ['Use recommendation', 'Decrease recommendation strongly', 'Decrease recommendation', 'Increase recommendation strongly', 'Increase recommendation'], 'scores': [0.26641327142715454, 0.19402799010276794, 0.19214743375778198, 0.1895178258419037, 0.15789352357387543]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(244, 258), match='tmp_table_size'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19402799010276794, 0.19214743375778198, 0.26641327142715454, 0.15789352357387543, 0.1895178258419037]
Choice: 4
Done flag: False
No warmup - hint counter: 37
{'sequence': '32', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.46463149785995483, 0.20161142945289612, 0.1676764339208603, 0.13865259289741516, 0.027428098022937775]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(244, 258), match='tmp_table_size'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.027428098022937775, 0.46463149785995483, 0.20161142945289612, 0.1676764339208603, 0.13865259289741516]
Choice: 1
Trying update set global tmp_table_size=128
Trying update set global tmp_table_size=16777216
Trying assigning tmp_table_size to 128
Adding assignment ('tmp_table_size', '128') with weight 2
Assignment ('tmp_table_size', '128') extracted from "The whole problem is the number of cores. I advise you to install at least 2 CPU cores.
Given the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.
MySQL:
key_buffer_size = 16
query_cache_size = 0
tmp_table_size = 32 thread_cache_size "
Hint counter: 38
Episode hint counter before: 17
Episode hint counter: 18
Hints per episode: 20
Done flag: False
No warmup - hint counter: 38
{'sequence': '0', 'labels': ['Use recommendation', 'Decrease recommendation strongly', 'Decrease recommendation', 'Increase recommendation', 'Increase recommendation strongly'], 'scores': [0.27009207010269165, 0.20856523513793945, 0.2019384503364563, 0.17301714420318604, 0.14638707041740417]}
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(57, 87), match='innodb_flush_log_at_trx_commit'>, value=<re.Match object; span=(0, 1), match='0'>, recommendation='0', passage="Following the GitHub suggestion linked above, I also set innodb_flush_log_at_trx_commit to 0 - this means the database will no longer flush the to disk every time a transaction is performed, meaning it no longer conforms with ACID Principles, but however giving you a noticeable performance boost. This does mean if you lose power, you will lose the last second of transactions, but I'd prefer to have a UPS installed with Auto-Shutdown configured instead, or if in a datacenter some sort of failover and redundancy there. If you are turning this off though, make sure you have some sort of alternative to have those transactions written to disk in place - the last thing you want is to corrupt your Moodle Installation! (Hence why you have a Site backup of course).\nI also changed the log_slow_query_time to 1, meaning that anything taking longer than 1 second to process is considered a slow query. Seems quick to the naked eye, but bear in mind usually MariaDB/MySQL connections last milliseconds. innodb_flush_log_at_timeout ", float_val=0.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20856523513793945, 0.2019384503364563, 0.27009207010269165, 0.17301714420318604, 0.14638707041740417]
Choice: 0
Done flag: False
No warmup - hint counter: 38
{'sequence': '0', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.44440340995788574, 0.20087464153766632, 0.16065354645252228, 0.14993849396705627, 0.04412984102964401]}
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(57, 87), match='innodb_flush_log_at_trx_commit'>, value=<re.Match object; span=(0, 1), match='0'>, recommendation='0', passage="Following the GitHub suggestion linked above, I also set innodb_flush_log_at_trx_commit to 0 - this means the database will no longer flush the to disk every time a transaction is performed, meaning it no longer conforms with ACID Principles, but however giving you a noticeable performance boost. This does mean if you lose power, you will lose the last second of transactions, but I'd prefer to have a UPS installed with Auto-Shutdown configured instead, or if in a datacenter some sort of failover and redundancy there. If you are turning this off though, make sure you have some sort of alternative to have those transactions written to disk in place - the last thing you want is to corrupt your Moodle Installation! (Hence why you have a Site backup of course).\nI also changed the log_slow_query_time to 1, meaning that anything taking longer than 1 second to process is considered a slow query. Seems quick to the naked eye, but bear in mind usually MariaDB/MySQL connections last milliseconds. innodb_flush_log_at_timeout ", float_val=0.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.04412984102964401, 0.44440340995788574, 0.20087464153766632, 0.16065354645252228, 0.14993849396705627]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(57, 87), match='innodb_flush_log_at_trx_commit'>, value=<re.Match object; span=(0, 1), match='0'>, recommendation='0', passage="Following the GitHub suggestion linked above, I also set innodb_flush_log_at_trx_commit to 0 - this means the database will no longer flush the to disk every time a transaction is performed, meaning it no longer conforms with ACID Principles, but however giving you a noticeable performance boost. This does mean if you lose power, you will lose the last second of transactions, but I'd prefer to have a UPS installed with Auto-Shutdown configured instead, or if in a datacenter some sort of failover and redundancy there. If you are turning this off though, make sure you have some sort of alternative to have those transactions written to disk in place - the last thing you want is to corrupt your Moodle Installation! (Hence why you have a Site backup of course).\nI also changed the log_slow_query_time to 1, meaning that anything taking longer than 1 second to process is considered a slow query. Seems quick to the naked eye, but bear in mind usually MariaDB/MySQL connections last milliseconds. innodb_flush_log_at_timeout ", float_val=0.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20856523513793945, 0.2019384503364563, 0.27009207010269165, 0.17301714420318604, 0.14638707041740417]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(57, 87), match='innodb_flush_log_at_trx_commit'>, value=<re.Match object; span=(0, 1), match='0'>, recommendation='0', passage="Following the GitHub suggestion linked above, I also set innodb_flush_log_at_trx_commit to 0 - this means the database will no longer flush the to disk every time a transaction is performed, meaning it no longer conforms with ACID Principles, but however giving you a noticeable performance boost. This does mean if you lose power, you will lose the last second of transactions, but I'd prefer to have a UPS installed with Auto-Shutdown configured instead, or if in a datacenter some sort of failover and redundancy there. If you are turning this off though, make sure you have some sort of alternative to have those transactions written to disk in place - the last thing you want is to corrupt your Moodle Installation! (Hence why you have a Site backup of course).\nI also changed the log_slow_query_time to 1, meaning that anything taking longer than 1 second to process is considered a slow query. Seems quick to the naked eye, but bear in mind usually MariaDB/MySQL connections last milliseconds. innodb_flush_log_at_timeout ", float_val=0.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.04412984102964401, 0.44440340995788574, 0.20087464153766632, 0.16065354645252228, 0.14993849396705627]
Choice: 0
Trying update set global innodb_flush_log_at_trx_commit=0
Trying update set global innodb_flush_log_at_trx_commit=1
Trying assigning innodb_flush_log_at_trx_commit to 0
Adding assignment ('innodb_flush_log_at_trx_commit', '0') with weight 1
Assignment ('innodb_flush_log_at_trx_commit', '0') extracted from "Following the GitHub suggestion linked above, I also set innodb_flush_log_at_trx_commit to 0 - this means the database will no longer flush the to disk every time a transaction is performed, meaning it no longer conforms with ACID Principles, but however giving you a noticeable performance boost. This does mean if you lose power, you will lose the last second of transactions, but I'd prefer to have a UPS installed with Auto-Shutdown configured instead, or if in a datacenter some sort of failover and redundancy there. If you are turning this off though, make sure you have some sort of alternative to have those transactions written to disk in place - the last thing you want is to corrupt your Moodle Installation! (Hence why you have a Site backup of course).
I also changed the log_slow_query_time to 1, meaning that anything taking longer than 1 second to process is considered a slow query. Seems quick to the naked eye, but bear in mind usually MariaDB/MySQL connections last milliseconds. innodb_flush_log_at_timeout "
Hint counter: 39
Episode hint counter before: 18
Episode hint counter: 19
Hints per episode: 20
Done flag: False
No warmup - hint counter: 39
{'sequence': '2', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Increase recommendation', 'Decrease recommendation strongly', 'Decrease recommendation'], 'scores': [0.24640542268753052, 0.22665782272815704, 0.18963998556137085, 0.1801619678735733, 0.15713483095169067]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(155, 185), match='innodb_flush_log_at_trx_commit'>, value=<re.Match object; span=(0, 1), match='2'>, recommendation='2', passage='innodb_stats_on_metadata = off\ninnodb-flush-method = O_DIRECT\ninnodb-flush-log-at-trx-commit = 2\ninnodb_buffer_pool_size = 23G\ninnodb_read_io_threads = 32 innodb_flush_log_at_trx_commit ', float_val=2.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1801619678735733, 0.15713483095169067, 0.24640542268753052, 0.18963998556137085, 0.22665782272815704]
Choice: 0
Done flag: False
No warmup - hint counter: 39
{'sequence': '2', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4811877906322479, 0.19468748569488525, 0.15864630043506622, 0.13557271659374237, 0.02990572713315487]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(155, 185), match='innodb_flush_log_at_trx_commit'>, value=<re.Match object; span=(0, 1), match='2'>, recommendation='2', passage='innodb_stats_on_metadata = off\ninnodb-flush-method = O_DIRECT\ninnodb-flush-log-at-trx-commit = 2\ninnodb_buffer_pool_size = 23G\ninnodb_read_io_threads = 32 innodb_flush_log_at_trx_commit ', float_val=2.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02990572713315487, 0.4811877906322479, 0.19468748569488525, 0.15864630043506622, 0.13557271659374237]
Choice: 2
Trying update set global innodb_flush_log_at_trx_commit=0
Trying update set global innodb_flush_log_at_trx_commit=1
Trying assigning innodb_flush_log_at_trx_commit to 0
Adding assignment ('innodb_flush_log_at_trx_commit', '0') with weight 4
Assignment ('innodb_flush_log_at_trx_commit', '0') extracted from "innodb_stats_on_metadata = off
innodb-flush-method = O_DIRECT
innodb-flush-log-at-trx-commit = 2
innodb_buffer_pool_size = 23G
innodb_read_io_threads = 32 innodb_flush_log_at_trx_commit "
Hint counter: 40
Episode hint counter before: 19
Episode hint counter: 20
Hints per episode: 20
Episode finished!
Done flag: True
Finalizing episode!
Weighted hints: defaultdict(<function NlpTuningEnv._finalize_episode.<locals>.<lambda> at 0x7f8767de00d0>, {('table_open_cache', '512'): 4, ('table_open_cache', '8'): 2, ('table_open_cache', '0'): 4, ('table_open_cache', '2'): 2, ('table_open_cache', '256'): 8, ('table_open_cache', '1024'): 8, ('table_open_cache', '128'): 8, ('query_cache_size', '4'): 16, ('query_cache_size', '100'): 16, ('query_cache_size', '0'): 1, ('query_cache_size', '600M'): 16, ('query_cache_min_res_unit', '1K'): 2, ('query_cache_min_res_unit', '1024'): 4, ('query_cache_min_res_unit', '2KB'): 4, ('tmp_table_size', '2'): 16, ('tmp_table_size', '64'): 16, ('tmp_table_size', '128'): 2, ('innodb_flush_log_at_trx_commit', '0'): 5})\n[Restart] MariaDB server shut down!
[Restart] MariaDB server restarted!
\n[Restart] MariaDB server shut down!
[Restart] MariaDB server restarted!

Selected configurations: [{'table_open_cache': '512', 'query_cache_size': '100', 'query_cache_min_res_unit': '1024', 'tmp_table_size': '2', 'innodb_flush_log_at_trx_commit': '0'}, {'table_open_cache': '1024', 'query_cache_size': '600M', 'query_cache_min_res_unit': '2KB', 'tmp_table_size': '64', 'innodb_flush_log_at_trx_commit': '0'}]
Disconnecting ...
Trying to connect to tpch with user kaltenec
Trying update set session max_execution_time = 1500000
Exception during update: Unknown system variable 'max_execution_time'
Trying update update mariadb.server_cost set cost_value = NULL
Exception during update: Table 'mariadb.server_cost' doesn't exist
Trying update update mariadb.engine_cost set cost_value = NULL
Exception during update: Table 'mariadb.engine_cost' doesn't exist
Trying configuration: {'table_open_cache': '512', 'query_cache_size': '100', 'query_cache_min_res_unit': '1024', 'tmp_table_size': '2', 'innodb_flush_log_at_trx_commit': '0'}
Trying update set global table_open_cache=512
Trying update set global query_cache_size=100
Trying update set global query_cache_min_res_unit=1024
Trying update set global tmp_table_size=2
Trying update set global innodb_flush_log_at_trx_commit=0
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Reward 3766.91552734375 with {'table_open_cache': '512', 'query_cache_size': '100', 'query_cache_min_res_unit': '1024', 'tmp_table_size': '2', 'innodb_flush_log_at_trx_commit': '0'}
Disconnecting ...
Trying to connect to tpch with user kaltenec
Trying update set session max_execution_time = 1500000
Exception during update: Unknown system variable 'max_execution_time'
Trying update update mariadb.server_cost set cost_value = NULL
Exception during update: Table 'mariadb.server_cost' doesn't exist
Trying update update mariadb.engine_cost set cost_value = NULL
Exception during update: Table 'mariadb.engine_cost' doesn't exist
Trying configuration: {'table_open_cache': '1024', 'query_cache_size': '600M', 'query_cache_min_res_unit': '2KB', 'tmp_table_size': '64', 'innodb_flush_log_at_trx_commit': '0'}
Trying update set global table_open_cache=1024
Trying update set global query_cache_size=629145600
Trying update set global query_cache_min_res_unit=2048
Trying update set global tmp_table_size=64
Trying update set global innodb_flush_log_at_trx_commit=0
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Reward 1818.949462890625 with {'table_open_cache': '1024', 'query_cache_size': '600M', 'query_cache_min_res_unit': '2KB', 'tmp_table_size': '64', 'innodb_flush_log_at_trx_commit': '0'}
Obtained 3766.91552734375 by configuration {'table_open_cache': '512', 'query_cache_size': '100', 'query_cache_min_res_unit': '1024', 'tmp_table_size': '2', 'innodb_flush_log_at_trx_commit': '0'}
Achieved unscaled reward of 3766.91552734375 using {'table_open_cache': '512', 'query_cache_size': '100', 'query_cache_min_res_unit': '1024', 'tmp_table_size': '2', 'innodb_flush_log_at_trx_commit': '0'}.
No warmup - hint counter: 40
{'sequence': '65535', 'labels': ['Use recommendation', 'Decrease recommendation', 'Decrease recommendation strongly', 'Increase recommendation strongly', 'Increase recommendation'], 'scores': [0.24921073019504547, 0.2215997278690338, 0.1854260116815567, 0.18248112499713898, 0.16128242015838623]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(57, 73), match='open_files_limit'>, value=<re.Match object; span=(0, 5), match='65535'>, recommendation='65535', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=65535.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1854260116815567, 0.2215997278690338, 0.24921073019504547, 0.16128242015838623, 0.18248112499713898]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(57, 73), match='open_files_limit'>, value=<re.Match object; span=(0, 5), match='65535'>, recommendation='65535', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=65535.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1854260116815567, 0.2215997278690338, 0.24921073019504547, 0.16128242015838623, 0.18248112499713898]
Choice: 2
Done flag: False
No warmup - hint counter: 40
{'sequence': '65535', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4570375382900238, 0.19957877695560455, 0.1675446480512619, 0.13887451589107513, 0.03696446865797043]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(57, 73), match='open_files_limit'>, value=<re.Match object; span=(0, 5), match='65535'>, recommendation='65535', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=65535.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.03696446865797043, 0.4570375382900238, 0.19957877695560455, 0.1675446480512619, 0.13887451589107513]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(57, 73), match='open_files_limit'>, value=<re.Match object; span=(0, 5), match='65535'>, recommendation='65535', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=65535.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1854260116815567, 0.2215997278690338, 0.24921073019504547, 0.16128242015838623, 0.18248112499713898]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(57, 73), match='open_files_limit'>, value=<re.Match object; span=(0, 5), match='65535'>, recommendation='65535', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=65535.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.03696446865797043, 0.4570375382900238, 0.19957877695560455, 0.1675446480512619, 0.13887451589107513]
Choice: 2
Trying update set global open_files_limit=32767
Exception during update: Variable 'open_files_limit' is a read only variable
Trying update set global open_files_limit=32135
Exception during update: Variable 'open_files_limit' is a read only variable
Trying assigning open_files_limit to 32767
Assignment ('open_files_limit', '32767') was rejected
Hint counter: 41
Episode hint counter before: 0
Episode hint counter: 1
Hints per episode: 20
Done flag: False
No warmup - hint counter: 41
{'sequence': '1/4000/524288', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Increase recommendation', 'Decrease recommendation strongly', 'Decrease recommendation'], 'scores': [0.2936961352825165, 0.21271634101867676, 0.19875210523605347, 0.15048553049564362, 0.14434988796710968]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(5291, 5307), match='open_files_limit'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1/4000/524288', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.15048553049564362, 0.14434988796710968, 0.2936961352825165, 0.19875210523605347, 0.21271634101867676]
Choice: 4
Done flag: False
No warmup - hint counter: 41
{'sequence': '1/4000/524288', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4854452610015869, 0.20025865733623505, 0.16094550490379333, 0.13196787238121033, 0.02138276770710945]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(5291, 5307), match='open_files_limit'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1/4000/524288', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02138276770710945, 0.4854452610015869, 0.20025865733623505, 0.16094550490379333, 0.13196787238121033]
Choice: 3
Trying update set global open_files_limit=4
Exception during update: Variable 'open_files_limit' is a read only variable
Trying update set global open_files_limit=32135
Exception during update: Variable 'open_files_limit' is a read only variable
Trying assigning open_files_limit to 4
Assignment ('open_files_limit', '4') was rejected
Hint counter: 42
Episode hint counter before: 1
Episode hint counter: 2
Hints per episode: 20
Done flag: False
No warmup - hint counter: 42
{'sequence': '1/4000/524288', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Increase recommendation', 'Decrease recommendation strongly', 'Decrease recommendation'], 'scores': [0.2936961352825165, 0.21271634101867676, 0.19875210523605347, 0.15048553049564362, 0.14434988796710968]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(5291, 5307), match='open_files_limit'>, value=<re.Match object; span=(2, 6), match='4000'>, recommendation='1/4000/524288', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=4000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.15048553049564362, 0.14434988796710968, 0.2936961352825165, 0.19875210523605347, 0.21271634101867676]
Choice: 2
Done flag: False
No warmup - hint counter: 42
{'sequence': '1/4000/524288', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4854452610015869, 0.20025865733623505, 0.16094550490379333, 0.13196787238121033, 0.02138276770710945]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(5291, 5307), match='open_files_limit'>, value=<re.Match object; span=(2, 6), match='4000'>, recommendation='1/4000/524288', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=4000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02138276770710945, 0.4854452610015869, 0.20025865733623505, 0.16094550490379333, 0.13196787238121033]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(5291, 5307), match='open_files_limit'>, value=<re.Match object; span=(2, 6), match='4000'>, recommendation='1/4000/524288', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=4000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.15048553049564362, 0.14434988796710968, 0.2936961352825165, 0.19875210523605347, 0.21271634101867676]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(5291, 5307), match='open_files_limit'>, value=<re.Match object; span=(2, 6), match='4000'>, recommendation='1/4000/524288', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=4000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02138276770710945, 0.4854452610015869, 0.20025865733623505, 0.16094550490379333, 0.13196787238121033]
Choice: 2
Trying update set global open_files_limit=8000
Exception during update: Variable 'open_files_limit' is a read only variable
Trying update set global open_files_limit=32135
Exception during update: Variable 'open_files_limit' is a read only variable
Trying assigning open_files_limit to 8000
Assignment ('open_files_limit', '8000') was rejected
Hint counter: 43
Episode hint counter before: 2
Episode hint counter: 3
Hints per episode: 20
Done flag: False
No warmup - hint counter: 43
{'sequence': '1/4000/524288', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Increase recommendation', 'Decrease recommendation strongly', 'Decrease recommendation'], 'scores': [0.2936961352825165, 0.21271634101867676, 0.19875210523605347, 0.15048553049564362, 0.14434988796710968]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(5291, 5307), match='open_files_limit'>, value=<re.Match object; span=(7, 13), match='524288'>, recommendation='1/4000/524288', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=524288.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.15048553049564362, 0.14434988796710968, 0.2936961352825165, 0.19875210523605347, 0.21271634101867676]
Choice: 0
Done flag: False
No warmup - hint counter: 43
{'sequence': '1/4000/524288', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4854452610015869, 0.20025865733623505, 0.16094550490379333, 0.13196787238121033, 0.02138276770710945]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(5291, 5307), match='open_files_limit'>, value=<re.Match object; span=(7, 13), match='524288'>, recommendation='1/4000/524288', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=524288.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02138276770710945, 0.4854452610015869, 0.20025865733623505, 0.16094550490379333, 0.13196787238121033]
Choice: 3
Trying update set global open_files_limit=131072
Exception during update: Variable 'open_files_limit' is a read only variable
Trying update set global open_files_limit=32135
Exception during update: Variable 'open_files_limit' is a read only variable
Trying assigning open_files_limit to 131072
Assignment ('open_files_limit', '131072') was rejected
Hint counter: 44
Episode hint counter before: 3
Episode hint counter: 4
Hints per episode: 20
Done flag: False
No warmup - hint counter: 44
{'sequence': '65000', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Decrease recommendation', 'Increase recommendation'], 'scores': [0.27188217639923096, 0.204360231757164, 0.19281907379627228, 0.1722368597984314, 0.15870161354541779]}
Decision: Deciding adaption of TuningHint(doc_id=63, param=<re.Match object; span=(112, 128), match='open_files_limit'>, value=<re.Match object; span=(0, 5), match='65000'>, recommendation='65000', passage='max_connections\n= 500\nmax_user_connections\n= 500\n#table_cache\n= 64\nthread_concurrency\n= 300\ntable_cache\n= 30000\nopen_files_limit\n= 65000\n#innodb_force_recovery =6 max_binlog_stmt_cache_size ', float_val=65000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19281907379627228, 0.1722368597984314, 0.27188217639923096, 0.15870161354541779, 0.204360231757164]
Choice: 1
Done flag: False
No warmup - hint counter: 44
{'sequence': '65000', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4433954358100891, 0.20522458851337433, 0.17373628914356232, 0.14922446012496948, 0.028419196605682373]}
Decision: Deciding weight of TuningHint(doc_id=63, param=<re.Match object; span=(112, 128), match='open_files_limit'>, value=<re.Match object; span=(0, 5), match='65000'>, recommendation='65000', passage='max_connections\n= 500\nmax_user_connections\n= 500\n#table_cache\n= 64\nthread_concurrency\n= 300\ntable_cache\n= 30000\nopen_files_limit\n= 65000\n#innodb_force_recovery =6 max_binlog_stmt_cache_size ', float_val=65000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.028419196605682373, 0.4433954358100891, 0.20522458851337433, 0.17373628914356232, 0.14922446012496948]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=63, param=<re.Match object; span=(112, 128), match='open_files_limit'>, value=<re.Match object; span=(0, 5), match='65000'>, recommendation='65000', passage='max_connections\n= 500\nmax_user_connections\n= 500\n#table_cache\n= 64\nthread_concurrency\n= 300\ntable_cache\n= 30000\nopen_files_limit\n= 65000\n#innodb_force_recovery =6 max_binlog_stmt_cache_size ', float_val=65000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19281907379627228, 0.1722368597984314, 0.27188217639923096, 0.15870161354541779, 0.204360231757164]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=63, param=<re.Match object; span=(112, 128), match='open_files_limit'>, value=<re.Match object; span=(0, 5), match='65000'>, recommendation='65000', passage='max_connections\n= 500\nmax_user_connections\n= 500\n#table_cache\n= 64\nthread_concurrency\n= 300\ntable_cache\n= 30000\nopen_files_limit\n= 65000\n#innodb_force_recovery =6 max_binlog_stmt_cache_size ', float_val=65000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.028419196605682373, 0.4433954358100891, 0.20522458851337433, 0.17373628914356232, 0.14922446012496948]
Choice: 4
Trying update set global open_files_limit=32500
Exception during update: Variable 'open_files_limit' is a read only variable
Trying update set global open_files_limit=32135
Exception during update: Variable 'open_files_limit' is a read only variable
Trying assigning open_files_limit to 32500
Assignment ('open_files_limit', '32500') was rejected
Hint counter: 45
Episode hint counter before: 4
Episode hint counter: 5
Hints per episode: 20
Done flag: False
No warmup - hint counter: 45
{'sequence': '64M thread_pool_max_threads', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Increase recommendation', 'Decrease recommendation', 'Decrease recommendation strongly'], 'scores': [0.39629071950912476, 0.21179628372192383, 0.16224564611911774, 0.11911507695913315, 0.11055229604244232]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(140, 158), match='max_allowed_packet'>, value=<re.Match object; span=(0, 3), match='64M'>, recommendation='64M thread_pool_max_threads', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=64.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.11055229604244232, 0.11911507695913315, 0.39629071950912476, 0.16224564611911774, 0.21179628372192383]
Choice: 4
Done flag: False
No warmup - hint counter: 45
{'sequence': '64M thread_pool_max_threads', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.5346100926399231, 0.19197659194469452, 0.15021955966949463, 0.10270220786333084, 0.02049153484404087]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(140, 158), match='max_allowed_packet'>, value=<re.Match object; span=(0, 3), match='64M'>, recommendation='64M thread_pool_max_threads', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=64.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02049153484404087, 0.5346100926399231, 0.19197659194469452, 0.15021955966949463, 0.10270220786333084]
Choice: 0
Trying update set global max_allowed_packet=268435456
Trying update set global max_allowed_packet=16777216
Trying assigning max_allowed_packet to 256M
Adding assignment ('max_allowed_packet', '256M') with weight 1
Assignment ('max_allowed_packet', '256M') extracted from "tmp-table-size = 96M
max-heap-table-size = 96M
key_buffer_size = 64M
# Connections and Threads
max_connections = 1250
thread_cache_size = 8
max_allowed_packet = 64M thread_pool_max_threads "
Hint counter: 46
Episode hint counter before: 5
Episode hint counter: 6
Hints per episode: 20
Done flag: False
No warmup - hint counter: 46
{'sequence': '0/9/100000', 'labels': ['Use recommendation', 'Decrease recommendation strongly', 'Decrease recommendation', 'Increase recommendation strongly', 'Increase recommendation'], 'scores': [0.25142577290534973, 0.21503010392189026, 0.20545345544815063, 0.1900947242975235, 0.13799600303173065]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(2259, 2277), match='max_allowed_packet'>, value=<re.Match object; span=(0, 1), match='0'>, recommendation='0/9/100000', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=0.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.21503010392189026, 0.20545345544815063, 0.25142577290534973, 0.13799600303173065, 0.1900947242975235]
Choice: 3
Done flag: False
No warmup - hint counter: 46
{'sequence': '0/9/100000', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4524601995944977, 0.20364059507846832, 0.16856379806995392, 0.15148194134235382, 0.023853391408920288]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(2259, 2277), match='max_allowed_packet'>, value=<re.Match object; span=(0, 1), match='0'>, recommendation='0/9/100000', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=0.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.023853391408920288, 0.4524601995944977, 0.20364059507846832, 0.16856379806995392, 0.15148194134235382]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(2259, 2277), match='max_allowed_packet'>, value=<re.Match object; span=(0, 1), match='0'>, recommendation='0/9/100000', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=0.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.21503010392189026, 0.20545345544815063, 0.25142577290534973, 0.13799600303173065, 0.1900947242975235]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(2259, 2277), match='max_allowed_packet'>, value=<re.Match object; span=(0, 1), match='0'>, recommendation='0/9/100000', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=0.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.023853391408920288, 0.4524601995944977, 0.20364059507846832, 0.16856379806995392, 0.15148194134235382]
Choice: 1
Trying update set global max_allowed_packet=0
Trying update set global max_allowed_packet=16777216
Trying assigning max_allowed_packet to 0
Adding assignment ('max_allowed_packet', '0') with weight 2
Assignment ('max_allowed_packet', '0') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 47
Episode hint counter before: 6
Episode hint counter: 7
Hints per episode: 20
Done flag: False
No warmup - hint counter: 47
{'sequence': '0/9/100000', 'labels': ['Use recommendation', 'Decrease recommendation strongly', 'Decrease recommendation', 'Increase recommendation strongly', 'Increase recommendation'], 'scores': [0.25142577290534973, 0.21503010392189026, 0.20545345544815063, 0.1900947242975235, 0.13799600303173065]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(2259, 2277), match='max_allowed_packet'>, value=<re.Match object; span=(2, 3), match='9'>, recommendation='0/9/100000', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=9.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.21503010392189026, 0.20545345544815063, 0.25142577290534973, 0.13799600303173065, 0.1900947242975235]
Choice: 3
Done flag: False
No warmup - hint counter: 47
{'sequence': '0/9/100000', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4524601995944977, 0.20364059507846832, 0.16856379806995392, 0.15148194134235382, 0.023853391408920288]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(2259, 2277), match='max_allowed_packet'>, value=<re.Match object; span=(2, 3), match='9'>, recommendation='0/9/100000', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=9.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.023853391408920288, 0.4524601995944977, 0.20364059507846832, 0.16856379806995392, 0.15148194134235382]
Choice: 2
Trying update set global max_allowed_packet=18
Trying update set global max_allowed_packet=16777216
Trying assigning max_allowed_packet to 18
Adding assignment ('max_allowed_packet', '18') with weight 4
Assignment ('max_allowed_packet', '18') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 48
Episode hint counter before: 7
Episode hint counter: 8
Hints per episode: 20
Done flag: False
No warmup - hint counter: 48
{'sequence': '0/9/100000', 'labels': ['Use recommendation', 'Decrease recommendation strongly', 'Decrease recommendation', 'Increase recommendation strongly', 'Increase recommendation'], 'scores': [0.25142577290534973, 0.21503010392189026, 0.20545345544815063, 0.1900947242975235, 0.13799600303173065]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(2259, 2277), match='max_allowed_packet'>, value=<re.Match object; span=(4, 10), match='100000'>, recommendation='0/9/100000', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=100000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.21503010392189026, 0.20545345544815063, 0.25142577290534973, 0.13799600303173065, 0.1900947242975235]
Choice: 3
Done flag: False
No warmup - hint counter: 48
{'sequence': '0/9/100000', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4524601995944977, 0.20364059507846832, 0.16856379806995392, 0.15148194134235382, 0.023853391408920288]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(2259, 2277), match='max_allowed_packet'>, value=<re.Match object; span=(4, 10), match='100000'>, recommendation='0/9/100000', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=100000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.023853391408920288, 0.4524601995944977, 0.20364059507846832, 0.16856379806995392, 0.15148194134235382]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(2259, 2277), match='max_allowed_packet'>, value=<re.Match object; span=(4, 10), match='100000'>, recommendation='0/9/100000', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=100000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.21503010392189026, 0.20545345544815063, 0.25142577290534973, 0.13799600303173065, 0.1900947242975235]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(2259, 2277), match='max_allowed_packet'>, value=<re.Match object; span=(4, 10), match='100000'>, recommendation='0/9/100000', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=100000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.023853391408920288, 0.4524601995944977, 0.20364059507846832, 0.16856379806995392, 0.15148194134235382]
Choice: 3
Trying update set global max_allowed_packet=400000
Trying update set global max_allowed_packet=16777216
Trying assigning max_allowed_packet to 400000
Adding assignment ('max_allowed_packet', '400000') with weight 8
Assignment ('max_allowed_packet', '400000') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 49
Episode hint counter before: 8
Episode hint counter: 9
Hints per episode: 20
Done flag: False
No warmup - hint counter: 49
{'sequence': '16M', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Decrease recommendation', 'Increase recommendation'], 'scores': [0.2692857086658478, 0.20589323341846466, 0.1848161667585373, 0.17571277916431427, 0.1642920821905136]}
Decision: Deciding adaption of TuningHint(doc_id=63, param=<re.Match object; span=(20, 38), match='max_allowed_packet'>, value=<re.Match object; span=(0, 3), match='16M'>, recommendation='16M', passage='key_buffer\t\t= 2000M\nmax_allowed_packet\t= 16M\nthread_stack\t\t= 128K\nthread_cache_size\t= 8\n# This replaces the startup script and checks MyISAM tables if needed\n# the first time they are touched\nmyisam-recover\t\t= BACKUP table_open_cache_instances ', float_val=16.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1848161667585373, 0.17571277916431427, 0.2692857086658478, 0.1642920821905136, 0.20589323341846466]
Choice: 0
Done flag: False
No warmup - hint counter: 49
{'sequence': '16M', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4479617476463318, 0.20477642118930817, 0.16790476441383362, 0.15918168425559998, 0.020175406709313393]}
Decision: Deciding weight of TuningHint(doc_id=63, param=<re.Match object; span=(20, 38), match='max_allowed_packet'>, value=<re.Match object; span=(0, 3), match='16M'>, recommendation='16M', passage='key_buffer\t\t= 2000M\nmax_allowed_packet\t= 16M\nthread_stack\t\t= 128K\nthread_cache_size\t= 8\n# This replaces the startup script and checks MyISAM tables if needed\n# the first time they are touched\nmyisam-recover\t\t= BACKUP table_open_cache_instances ', float_val=16.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.020175406709313393, 0.4479617476463318, 0.20477642118930817, 0.16790476441383362, 0.15918168425559998]
Choice: 0
Trying update set global max_allowed_packet=4194304
Trying update set global max_allowed_packet=16777216
Trying assigning max_allowed_packet to 4M
Adding assignment ('max_allowed_packet', '4M') with weight 1
Assignment ('max_allowed_packet', '4M') extracted from "key_buffer		= 2000M
max_allowed_packet	= 16M
thread_stack		= 128K
thread_cache_size	= 8
# This replaces the startup script and checks MyISAM tables if needed
# the first time they are touched
myisam-recover		= BACKUP table_open_cache_instances "
Hint counter: 50
Episode hint counter before: 9
Episode hint counter: 10
Hints per episode: 20
Done flag: False
No warmup - hint counter: 50
{'sequence': '512', 'labels': ['Use recommendation', 'Increase recommendation', 'Decrease recommendation strongly', 'Increase recommendation strongly', 'Decrease recommendation'], 'scores': [0.2637619078159332, 0.19082817435264587, 0.18853892385959625, 0.18315310776233673, 0.17371782660484314]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(51, 63), match='thread_stack'>, value=<re.Match object; span=(0, 3), match='512'>, recommendation='512', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=512.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18853892385959625, 0.17371782660484314, 0.2637619078159332, 0.19082817435264587, 0.18315310776233673]
Choice: 1
Done flag: False
No warmup - hint counter: 50
{'sequence': '512', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.45673248171806335, 0.20234665274620056, 0.1712857037782669, 0.14736124873161316, 0.022273913025856018]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(51, 63), match='thread_stack'>, value=<re.Match object; span=(0, 3), match='512'>, recommendation='512', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=512.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.022273913025856018, 0.45673248171806335, 0.20234665274620056, 0.1712857037782669, 0.14736124873161316]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(51, 63), match='thread_stack'>, value=<re.Match object; span=(0, 3), match='512'>, recommendation='512', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=512.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18853892385959625, 0.17371782660484314, 0.2637619078159332, 0.19082817435264587, 0.18315310776233673]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(51, 63), match='thread_stack'>, value=<re.Match object; span=(0, 3), match='512'>, recommendation='512', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=512.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.022273913025856018, 0.45673248171806335, 0.20234665274620056, 0.1712857037782669, 0.14736124873161316]
Choice: 1
Trying update set global thread_stack=128
Exception during update: Variable 'thread_stack' is a read only variable
Trying update set global thread_stack=299008
Exception during update: Variable 'thread_stack' is a read only variable
Trying assigning thread_stack to 128
Assignment ('thread_stack', '128') was rejected
Hint counter: 51
Episode hint counter before: 10
Episode hint counter: 11
Hints per episode: 20
Done flag: False
No warmup - hint counter: 51
{'sequence': '192', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Increase recommendation', 'Decrease recommendation'], 'scores': [0.25859376788139343, 0.21243582665920258, 0.18821486830711365, 0.17812727391719818, 0.16262833774089813]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(157, 169), match='thread_stack'>, value=<re.Match object; span=(0, 3), match='192'>, recommendation='192', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=192.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18821486830711365, 0.16262833774089813, 0.25859376788139343, 0.17812727391719818, 0.21243582665920258]
Choice: 2
Done flag: False
No warmup - hint counter: 51
{'sequence': '192', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4440685212612152, 0.20842856168746948, 0.17406624555587769, 0.1505981981754303, 0.022838477045297623]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(157, 169), match='thread_stack'>, value=<re.Match object; span=(0, 3), match='192'>, recommendation='192', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=192.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.022838477045297623, 0.4440685212612152, 0.20842856168746948, 0.17406624555587769, 0.1505981981754303]
Choice: 0
Trying update set global thread_stack=192
Exception during update: Variable 'thread_stack' is a read only variable
Trying update set global thread_stack=299008
Exception during update: Variable 'thread_stack' is a read only variable
Trying assigning thread_stack to 192
Assignment ('thread_stack', '192') was rejected
Hint counter: 52
Episode hint counter before: 11
Episode hint counter: 12
Hints per episode: 20
Done flag: False
No warmup - hint counter: 52
{'sequence': '128K', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Increase recommendation', 'Decrease recommendation'], 'scores': [0.2818615138530731, 0.2129811942577362, 0.18397192656993866, 0.16471435129642487, 0.15647098422050476]}
Decision: Deciding adaption of TuningHint(doc_id=63, param=<re.Match object; span=(45, 57), match='thread_stack'>, value=<re.Match object; span=(0, 4), match='128K'>, recommendation='128K', passage='key_buffer\t\t= 2000M\nmax_allowed_packet\t= 16M\nthread_stack\t\t= 128K\nthread_cache_size\t= 8\n# This replaces the startup script and checks MyISAM tables if needed\n# the first time they are touched\nmyisam-recover\t\t= BACKUP table_open_cache_instances ', float_val=128.0, val_unit='K', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18397192656993866, 0.15647098422050476, 0.2818615138530731, 0.16471435129642487, 0.2129811942577362]
Choice: 1
Done flag: False
No warmup - hint counter: 52
{'sequence': '128K', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4361570477485657, 0.21562883257865906, 0.17626062035560608, 0.1473391205072403, 0.02461441420018673]}
Decision: Deciding weight of TuningHint(doc_id=63, param=<re.Match object; span=(45, 57), match='thread_stack'>, value=<re.Match object; span=(0, 4), match='128K'>, recommendation='128K', passage='key_buffer\t\t= 2000M\nmax_allowed_packet\t= 16M\nthread_stack\t\t= 128K\nthread_cache_size\t= 8\n# This replaces the startup script and checks MyISAM tables if needed\n# the first time they are touched\nmyisam-recover\t\t= BACKUP table_open_cache_instances ', float_val=128.0, val_unit='K', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02461441420018673, 0.4361570477485657, 0.21562883257865906, 0.17626062035560608, 0.1473391205072403]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=63, param=<re.Match object; span=(45, 57), match='thread_stack'>, value=<re.Match object; span=(0, 4), match='128K'>, recommendation='128K', passage='key_buffer\t\t= 2000M\nmax_allowed_packet\t= 16M\nthread_stack\t\t= 128K\nthread_cache_size\t= 8\n# This replaces the startup script and checks MyISAM tables if needed\n# the first time they are touched\nmyisam-recover\t\t= BACKUP table_open_cache_instances ', float_val=128.0, val_unit='K', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18397192656993866, 0.15647098422050476, 0.2818615138530731, 0.16471435129642487, 0.2129811942577362]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=63, param=<re.Match object; span=(45, 57), match='thread_stack'>, value=<re.Match object; span=(0, 4), match='128K'>, recommendation='128K', passage='key_buffer\t\t= 2000M\nmax_allowed_packet\t= 16M\nthread_stack\t\t= 128K\nthread_cache_size\t= 8\n# This replaces the startup script and checks MyISAM tables if needed\n# the first time they are touched\nmyisam-recover\t\t= BACKUP table_open_cache_instances ', float_val=128.0, val_unit='K', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02461441420018673, 0.4361570477485657, 0.21562883257865906, 0.17626062035560608, 0.1473391205072403]
Choice: 3
Trying update set global thread_stack=65536
Exception during update: Variable 'thread_stack' is a read only variable
Trying update set global thread_stack=299008
Exception during update: Variable 'thread_stack' is a read only variable
Trying assigning thread_stack to 64K
Assignment ('thread_stack', '64K') was rejected
Hint counter: 53
Episode hint counter before: 12
Episode hint counter: 13
Hints per episode: 20
Done flag: False
No warmup - hint counter: 53
{'sequence': '3 or a bigger', 'labels': ['Increase recommendation', 'Increase recommendation strongly', 'Use recommendation', 'Decrease recommendation strongly', 'Decrease recommendation'], 'scores': [0.46727150678634644, 0.273189902305603, 0.17399927973747253, 0.04928116500377655, 0.036258190870285034]}
Decision: Deciding adaption of TuningHint(doc_id=7, param=<re.Match object; span=(94, 110), match='join_cache_level'>, value=<re.Match object; span=(0, 1), match='3'>, recommendation='3 or a bigger', passage='Hash Join\nMariaDB supports Block Hash Join. It is not enabled by default, one needs to set it join_cache_level to 3 or a bigger value to enable it.\nBefore MDEV-30812, Query optimization for Block Hash Join would work as described in the above example: It would assume that the join operation is a cross join. query_alloc_block_size ', float_val=3.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.04928116500377655, 0.036258190870285034, 0.17399927973747253, 0.46727150678634644, 0.273189902305603]
Choice: 1
Done flag: False
No warmup - hint counter: 53
{'sequence': '3 or a bigger', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.47814804315567017, 0.2144041806459427, 0.16039974987506866, 0.12909729778766632, 0.017950722947716713]}
Decision: Deciding weight of TuningHint(doc_id=7, param=<re.Match object; span=(94, 110), match='join_cache_level'>, value=<re.Match object; span=(0, 1), match='3'>, recommendation='3 or a bigger', passage='Hash Join\nMariaDB supports Block Hash Join. It is not enabled by default, one needs to set it join_cache_level to 3 or a bigger value to enable it.\nBefore MDEV-30812, Query optimization for Block Hash Join would work as described in the above example: It would assume that the join operation is a cross join. query_alloc_block_size ', float_val=3.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.017950722947716713, 0.47814804315567017, 0.2144041806459427, 0.16039974987506866, 0.12909729778766632]
Choice: 4
Trying update set global join_cache_level=1
Trying update set global join_cache_level=2
Trying assigning join_cache_level to 1
Adding assignment ('join_cache_level', '1') with weight 16
Assignment ('join_cache_level', '1') extracted from "Hash Join
MariaDB supports Block Hash Join. It is not enabled by default, one needs to set it join_cache_level to 3 or a bigger value to enable it.
Before MDEV-30812, Query optimization for Block Hash Join would work as described in the above example: It would assume that the join operation is a cross join. query_alloc_block_size "
Hint counter: 54
Episode hint counter before: 13
Episode hint counter: 14
Hints per episode: 20
Done flag: False
No warmup - hint counter: 54
{'sequence': '64MB', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Increase recommendation', 'Decrease recommendation'], 'scores': [0.30582311749458313, 0.22592315077781677, 0.18528391420841217, 0.15321524441242218, 0.12975457310676575]}
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(16, 35), match='max_heap_table_size'>, value=<re.Match object; span=(0, 4), match='64MB'>, recommendation='64MB', passage="I also adjusted max_heap_table_size to 64MB again, on the recommendation of the internet. Looking at the information as to what it does, I figured it couldn't hurt - default is again 16MB. max_heap_table_size ", float_val=64.0, val_unit='MB', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18528391420841217, 0.12975457310676575, 0.30582311749458313, 0.15321524441242218, 0.22592315077781677]
Choice: 2
Done flag: False
No warmup - hint counter: 54
{'sequence': '64MB', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4747910797595978, 0.20364288985729218, 0.15496112406253815, 0.13760244846343994, 0.0290024746209383]}
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(16, 35), match='max_heap_table_size'>, value=<re.Match object; span=(0, 4), match='64MB'>, recommendation='64MB', passage="I also adjusted max_heap_table_size to 64MB again, on the recommendation of the internet. Looking at the information as to what it does, I figured it couldn't hurt - default is again 16MB. max_heap_table_size ", float_val=64.0, val_unit='MB', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.0290024746209383, 0.4747910797595978, 0.20364288985729218, 0.15496112406253815, 0.13760244846343994]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(16, 35), match='max_heap_table_size'>, value=<re.Match object; span=(0, 4), match='64MB'>, recommendation='64MB', passage="I also adjusted max_heap_table_size to 64MB again, on the recommendation of the internet. Looking at the information as to what it does, I figured it couldn't hurt - default is again 16MB. max_heap_table_size ", float_val=64.0, val_unit='MB', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18528391420841217, 0.12975457310676575, 0.30582311749458313, 0.15321524441242218, 0.22592315077781677]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(16, 35), match='max_heap_table_size'>, value=<re.Match object; span=(0, 4), match='64MB'>, recommendation='64MB', passage="I also adjusted max_heap_table_size to 64MB again, on the recommendation of the internet. Looking at the information as to what it does, I figured it couldn't hurt - default is again 16MB. max_heap_table_size ", float_val=64.0, val_unit='MB', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.0290024746209383, 0.4747910797595978, 0.20364288985729218, 0.15496112406253815, 0.13760244846343994]
Choice: 1
Trying update set global max_heap_table_size=16777216
Trying update set global max_heap_table_size=16777216
Trying assigning max_heap_table_size to 16MB
Adding assignment ('max_heap_table_size', '16MB') with weight 2
Assignment ('max_heap_table_size', '16MB') extracted from "I also adjusted max_heap_table_size to 64MB again, on the recommendation of the internet. Looking at the information as to what it does, I figured it couldn't hurt - default is again 16MB. max_heap_table_size "
Hint counter: 55
Episode hint counter before: 14
Episode hint counter: 15
Hints per episode: 20
Done flag: False
No warmup - hint counter: 55
{'sequence': '1', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Increase recommendation', 'Decrease recommendation strongly', 'Decrease recommendation'], 'scores': [0.26459458470344543, 0.25241753458976746, 0.18136560916900635, 0.16976413130760193, 0.1318582147359848]}
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(786, 805), match='log_slow_query_time'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1', passage="Following the GitHub suggestion linked above, I also set innodb_flush_log_at_trx_commit to 0 - this means the database will no longer flush the to disk every time a transaction is performed, meaning it no longer conforms with ACID Principles, but however giving you a noticeable performance boost. This does mean if you lose power, you will lose the last second of transactions, but I'd prefer to have a UPS installed with Auto-Shutdown configured instead, or if in a datacenter some sort of failover and redundancy there. If you are turning this off though, make sure you have some sort of alternative to have those transactions written to disk in place - the last thing you want is to corrupt your Moodle Installation! (Hence why you have a Site backup of course).\nI also changed the log_slow_query_time to 1, meaning that anything taking longer than 1 second to process is considered a slow query. Seems quick to the naked eye, but bear in mind usually MariaDB/MySQL connections last milliseconds. innodb_flush_log_at_timeout ", float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.16976413130760193, 0.1318582147359848, 0.26459458470344543, 0.18136560916900635, 0.25241753458976746]
Choice: 0
Done flag: False
No warmup - hint counter: 55
{'sequence': '1', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4530342221260071, 0.20463363826274872, 0.16576839983463287, 0.14695607125759125, 0.029607674106955528]}
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(786, 805), match='log_slow_query_time'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1', passage="Following the GitHub suggestion linked above, I also set innodb_flush_log_at_trx_commit to 0 - this means the database will no longer flush the to disk every time a transaction is performed, meaning it no longer conforms with ACID Principles, but however giving you a noticeable performance boost. This does mean if you lose power, you will lose the last second of transactions, but I'd prefer to have a UPS installed with Auto-Shutdown configured instead, or if in a datacenter some sort of failover and redundancy there. If you are turning this off though, make sure you have some sort of alternative to have those transactions written to disk in place - the last thing you want is to corrupt your Moodle Installation! (Hence why you have a Site backup of course).\nI also changed the log_slow_query_time to 1, meaning that anything taking longer than 1 second to process is considered a slow query. Seems quick to the naked eye, but bear in mind usually MariaDB/MySQL connections last milliseconds. innodb_flush_log_at_timeout ", float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.029607674106955528, 0.4530342221260071, 0.20463363826274872, 0.16576839983463287, 0.14695607125759125]
Choice: 4
Trying update set global log_slow_query_time=0
Trying update set global log_slow_query_time=10.0
Trying assigning log_slow_query_time to 0
Adding assignment ('log_slow_query_time', '0') with weight 16
Assignment ('log_slow_query_time', '0') extracted from "Following the GitHub suggestion linked above, I also set innodb_flush_log_at_trx_commit to 0 - this means the database will no longer flush the to disk every time a transaction is performed, meaning it no longer conforms with ACID Principles, but however giving you a noticeable performance boost. This does mean if you lose power, you will lose the last second of transactions, but I'd prefer to have a UPS installed with Auto-Shutdown configured instead, or if in a datacenter some sort of failover and redundancy there. If you are turning this off though, make sure you have some sort of alternative to have those transactions written to disk in place - the last thing you want is to corrupt your Moodle Installation! (Hence why you have a Site backup of course).
I also changed the log_slow_query_time to 1, meaning that anything taking longer than 1 second to process is considered a slow query. Seems quick to the naked eye, but bear in mind usually MariaDB/MySQL connections last milliseconds. innodb_flush_log_at_timeout "
Hint counter: 56
Episode hint counter before: 15
Episode hint counter: 16
Hints per episode: 20
Done flag: False
No warmup - hint counter: 56
{'sequence': 'expire_logs_days = 10', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Decrease recommendation', 'Increase recommendation'], 'scores': [0.3761512041091919, 0.18228799104690552, 0.1682940125465393, 0.15017206966876984, 0.12309473752975464]}
Decision: Deciding adaption of TuningHint(doc_id=31, param=<re.Match object; span=(205, 223), match='max_relay_log_size'>, value=<re.Match object; span=(19, 21), match='10'>, recommendation='expire_logs_days = 10', passage='#log-bin=mysql-bin\n#binlog_format=mixed\nOr, if you want to keep these logs but keep their size in check and old logs deleted, you can set these limits then restart:\nlog-bin=mysql-bin\nexpire_logs_days = 10 max_relay_log_size ', float_val=10.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1682940125465393, 0.15017206966876984, 0.3761512041091919, 0.12309473752975464, 0.18228799104690552]
Choice: 3
Done flag: False
No warmup - hint counter: 56
{'sequence': 'expire_logs_days = 10', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.5248767733573914, 0.2039925754070282, 0.1442306935787201, 0.10950566083192825, 0.017394283786416054]}
Decision: Deciding weight of TuningHint(doc_id=31, param=<re.Match object; span=(205, 223), match='max_relay_log_size'>, value=<re.Match object; span=(19, 21), match='10'>, recommendation='expire_logs_days = 10', passage='#log-bin=mysql-bin\n#binlog_format=mixed\nOr, if you want to keep these logs but keep their size in check and old logs deleted, you can set these limits then restart:\nlog-bin=mysql-bin\nexpire_logs_days = 10 max_relay_log_size ', float_val=10.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.017394283786416054, 0.5248767733573914, 0.2039925754070282, 0.1442306935787201, 0.10950566083192825]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=31, param=<re.Match object; span=(205, 223), match='max_relay_log_size'>, value=<re.Match object; span=(19, 21), match='10'>, recommendation='expire_logs_days = 10', passage='#log-bin=mysql-bin\n#binlog_format=mixed\nOr, if you want to keep these logs but keep their size in check and old logs deleted, you can set these limits then restart:\nlog-bin=mysql-bin\nexpire_logs_days = 10 max_relay_log_size ', float_val=10.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1682940125465393, 0.15017206966876984, 0.3761512041091919, 0.12309473752975464, 0.18228799104690552]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=31, param=<re.Match object; span=(205, 223), match='max_relay_log_size'>, value=<re.Match object; span=(19, 21), match='10'>, recommendation='expire_logs_days = 10', passage='#log-bin=mysql-bin\n#binlog_format=mixed\nOr, if you want to keep these logs but keep their size in check and old logs deleted, you can set these limits then restart:\nlog-bin=mysql-bin\nexpire_logs_days = 10 max_relay_log_size ', float_val=10.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.017394283786416054, 0.5248767733573914, 0.2039925754070282, 0.1442306935787201, 0.10950566083192825]
Choice: 0
Trying update set global max_relay_log_size=20
Trying update set global max_relay_log_size=1073741824
Trying assigning max_relay_log_size to 20
Adding assignment ('max_relay_log_size', '20') with weight 1
Assignment ('max_relay_log_size', '20') extracted from "#log-bin=mysql-bin
#binlog_format=mixed
Or, if you want to keep these logs but keep their size in check and old logs deleted, you can set these limits then restart:
log-bin=mysql-bin
expire_logs_days = 10 max_relay_log_size "
Hint counter: 57
Episode hint counter before: 16
Episode hint counter: 17
Hints per episode: 20
Done flag: False
No warmup - hint counter: 57
{'sequence': '10 max_relay_log_size', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Increase recommendation', 'Decrease recommendation strongly', 'Decrease recommendation'], 'scores': [0.3711424171924591, 0.21247731149196625, 0.15724073350429535, 0.13781723380088806, 0.12132231146097183]}
Decision: Deciding adaption of TuningHint(doc_id=31, param=<re.Match object; span=(183, 199), match='expire_logs_days'>, value=<re.Match object; span=(0, 2), match='10'>, recommendation='10 max_relay_log_size', passage='#log-bin=mysql-bin\n#binlog_format=mixed\nOr, if you want to keep these logs but keep their size in check and old logs deleted, you can set these limits then restart:\nlog-bin=mysql-bin\nexpire_logs_days = 10 max_relay_log_size ', float_val=10.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.13781723380088806, 0.12132231146097183, 0.3711424171924591, 0.15724073350429535, 0.21247731149196625]
Choice: 2
Done flag: False
No warmup - hint counter: 57
{'sequence': '10 max_relay_log_size', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.5150887370109558, 0.20148275792598724, 0.15038979053497314, 0.11753898859024048, 0.015499701723456383]}
Decision: Deciding weight of TuningHint(doc_id=31, param=<re.Match object; span=(183, 199), match='expire_logs_days'>, value=<re.Match object; span=(0, 2), match='10'>, recommendation='10 max_relay_log_size', passage='#log-bin=mysql-bin\n#binlog_format=mixed\nOr, if you want to keep these logs but keep their size in check and old logs deleted, you can set these limits then restart:\nlog-bin=mysql-bin\nexpire_logs_days = 10 max_relay_log_size ', float_val=10.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.015499701723456383, 0.5150887370109558, 0.20148275792598724, 0.15038979053497314, 0.11753898859024048]
Choice: 4
Trying update set global expire_logs_days=10
Trying update set global expire_logs_days=0.0
Trying assigning expire_logs_days to 10
Adding assignment ('expire_logs_days', '10') with weight 16
Assignment ('expire_logs_days', '10') extracted from "#log-bin=mysql-bin
#binlog_format=mixed
Or, if you want to keep these logs but keep their size in check and old logs deleted, you can set these limits then restart:
log-bin=mysql-bin
expire_logs_days = 10 max_relay_log_size "
Hint counter: 58
Episode hint counter before: 17
Episode hint counter: 18
Hints per episode: 20
Done flag: False
No warmup - hint counter: 58
{'sequence': '100M', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation', 'Decrease recommendation strongly', 'Increase recommendation'], 'scores': [0.2783204913139343, 0.2013481855392456, 0.1745326966047287, 0.17402055859565735, 0.17177808284759521]}
Decision: Deciding adaption of TuningHint(doc_id=31, param=<re.Match object; span=(0, 15), match='max_binlog_size'>, value=<re.Match object; span=(0, 4), match='100M'>, recommendation='100M', passage='max_binlog_size\n= 100M\nAlternatively, there exists a MariaDB command to manually purge logs older than a specific one. For example, you may see a file named mysql-bin.000023 and want to delete every log older than it. As long as the log-bin=mysql-bin setting is in effect, you would run: log_bin_compress_min_len ', float_val=100.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.17402055859565735, 0.1745326966047287, 0.2783204913139343, 0.17177808284759521, 0.2013481855392456]
Choice: 1
Done flag: False
No warmup - hint counter: 58
{'sequence': '100M', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4141623079776764, 0.20936425030231476, 0.18773645162582397, 0.17061880230903625, 0.01811819151043892]}
Decision: Deciding weight of TuningHint(doc_id=31, param=<re.Match object; span=(0, 15), match='max_binlog_size'>, value=<re.Match object; span=(0, 4), match='100M'>, recommendation='100M', passage='max_binlog_size\n= 100M\nAlternatively, there exists a MariaDB command to manually purge logs older than a specific one. For example, you may see a file named mysql-bin.000023 and want to delete every log older than it. As long as the log-bin=mysql-bin setting is in effect, you would run: log_bin_compress_min_len ', float_val=100.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.01811819151043892, 0.4141623079776764, 0.20936425030231476, 0.18773645162582397, 0.17061880230903625]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=31, param=<re.Match object; span=(0, 15), match='max_binlog_size'>, value=<re.Match object; span=(0, 4), match='100M'>, recommendation='100M', passage='max_binlog_size\n= 100M\nAlternatively, there exists a MariaDB command to manually purge logs older than a specific one. For example, you may see a file named mysql-bin.000023 and want to delete every log older than it. As long as the log-bin=mysql-bin setting is in effect, you would run: log_bin_compress_min_len ', float_val=100.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.17402055859565735, 0.1745326966047287, 0.2783204913139343, 0.17177808284759521, 0.2013481855392456]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=31, param=<re.Match object; span=(0, 15), match='max_binlog_size'>, value=<re.Match object; span=(0, 4), match='100M'>, recommendation='100M', passage='max_binlog_size\n= 100M\nAlternatively, there exists a MariaDB command to manually purge logs older than a specific one. For example, you may see a file named mysql-bin.000023 and want to delete every log older than it. As long as the log-bin=mysql-bin setting is in effect, you would run: log_bin_compress_min_len ', float_val=100.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.01811819151043892, 0.4141623079776764, 0.20936425030231476, 0.18773645162582397, 0.17061880230903625]
Choice: 3
Trying update set global max_binlog_size=52428800
Trying update set global max_binlog_size=1073741824
Trying assigning max_binlog_size to 50M
Adding assignment ('max_binlog_size', '50M') with weight 8
Assignment ('max_binlog_size', '50M') extracted from "max_binlog_size
= 100M
Alternatively, there exists a MariaDB command to manually purge logs older than a specific one. For example, you may see a file named mysql-bin.000023 and want to delete every log older than it. As long as the log-bin=mysql-bin setting is in effect, you would run: log_bin_compress_min_len "
Hint counter: 59
Episode hint counter before: 18
Episode hint counter: 19
Hints per episode: 20
Done flag: False
No warmup - hint counter: 59
{'sequence': '128M', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Decrease recommendation', 'Increase recommendation'], 'scores': [0.2693910002708435, 0.20637144148349762, 0.20040468871593475, 0.17397674918174744, 0.1498560756444931]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(170, 190), match='innodb_log_file_size'>, value=<re.Match object; span=(0, 4), match='128M'>, recommendation='128M', passage='# InnoDB Configuration\ninnodb-log-file-size = 128M\ninnodb-log-buffer-size = 128M\ninnodb-file-per-table = 1\ninnodb_buffer_pool_instances = 8\ninnodb_old_blocks_time = 1000 innodb_log_file_size ', float_val=128.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20040468871593475, 0.17397674918174744, 0.2693910002708435, 0.1498560756444931, 0.20637144148349762]
Choice: 3
Done flag: False
No warmup - hint counter: 59
{'sequence': '128M', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.434274286031723, 0.21036945283412933, 0.1776532381772995, 0.15528060495853424, 0.022422391921281815]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(170, 190), match='innodb_log_file_size'>, value=<re.Match object; span=(0, 4), match='128M'>, recommendation='128M', passage='# InnoDB Configuration\ninnodb-log-file-size = 128M\ninnodb-log-buffer-size = 128M\ninnodb-file-per-table = 1\ninnodb_buffer_pool_instances = 8\ninnodb_old_blocks_time = 1000 innodb_log_file_size ', float_val=128.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.022422391921281815, 0.434274286031723, 0.21036945283412933, 0.1776532381772995, 0.15528060495853424]\n[Restart] MariaDB server shut down!
[Restart] MariaDB server restarted!
\n[Restart] MariaDB server shut down!
[Restart] MariaDB server restarted!

Choice: 1
Trying update set global innodb_log_file_size=268435456
Trying update set global innodb_log_file_size=100663296
Trying assigning innodb_log_file_size to 256M
Adding assignment ('innodb_log_file_size', '256M') with weight 2
Assignment ('innodb_log_file_size', '256M') extracted from "# InnoDB Configuration
innodb-log-file-size = 128M
innodb-log-buffer-size = 128M
innodb-file-per-table = 1
innodb_buffer_pool_instances = 8
innodb_old_blocks_time = 1000 innodb_log_file_size "
Hint counter: 60
Episode hint counter before: 19
Episode hint counter: 20
Hints per episode: 20
Episode finished!
Done flag: True
Finalizing episode!
Weighted hints: defaultdict(<function NlpTuningEnv._finalize_episode.<locals>.<lambda> at 0x7f8767de01f0>, {('max_allowed_packet', '256M'): 1, ('max_allowed_packet', '0'): 2, ('max_allowed_packet', '18'): 4, ('max_allowed_packet', '400000'): 8, ('max_allowed_packet', '4M'): 1, ('join_cache_level', '1'): 16, ('max_heap_table_size', '16MB'): 2, ('log_slow_query_time', '0'): 16, ('max_relay_log_size', '20'): 1, ('expire_logs_days', '10'): 16, ('max_binlog_size', '50M'): 8, ('innodb_log_file_size', '256M'): 2})
Selected configurations: [{'max_allowed_packet': '4M', 'join_cache_level': '1', 'max_heap_table_size': '16MB', 'log_slow_query_time': '0', 'max_relay_log_size': '20', 'expire_logs_days': '10', 'max_binlog_size': '50M', 'innodb_log_file_size': '256M'}, {'max_allowed_packet': '256M', 'join_cache_level': '1', 'max_heap_table_size': '16MB', 'log_slow_query_time': '0', 'max_relay_log_size': '20', 'expire_logs_days': '10', 'max_binlog_size': '50M', 'innodb_log_file_size': '256M'}]
Disconnecting ...
Trying to connect to tpch with user kaltenec
Trying update set session max_execution_time = 1500000
Exception during update: Unknown system variable 'max_execution_time'
Trying update update mariadb.server_cost set cost_value = NULL
Exception during update: Table 'mariadb.server_cost' doesn't exist
Trying update update mariadb.engine_cost set cost_value = NULL
Exception during update: Table 'mariadb.engine_cost' doesn't exist
Trying configuration: {'max_allowed_packet': '4M', 'join_cache_level': '1', 'max_heap_table_size': '16MB', 'log_slow_query_time': '0', 'max_relay_log_size': '20', 'expire_logs_days': '10', 'max_binlog_size': '50M', 'innodb_log_file_size': '256M'}
Trying update set global max_allowed_packet=4194304
Trying update set global join_cache_level=1
Trying update set global max_heap_table_size=16777216
Trying update set global log_slow_query_time=0
Trying update set global max_relay_log_size=20
Trying update set global expire_logs_days=10
Trying update set global max_binlog_size=52428800
Trying update set global innodb_log_file_size=268435456
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Reward 2037.048095703125 with {'max_allowed_packet': '4M', 'join_cache_level': '1', 'max_heap_table_size': '16MB', 'log_slow_query_time': '0', 'max_relay_log_size': '20', 'expire_logs_days': '10', 'max_binlog_size': '50M', 'innodb_log_file_size': '256M'}
Disconnecting ...
Trying to connect to tpch with user kaltenec
Trying update set session max_execution_time = 1500000
Exception during update: Unknown system variable 'max_execution_time'
Trying update update mariadb.server_cost set cost_value = NULL
Exception during update: Table 'mariadb.server_cost' doesn't exist
Trying update update mariadb.engine_cost set cost_value = NULL
Exception during update: Table 'mariadb.engine_cost' doesn't exist
Trying configuration: {'max_allowed_packet': '256M', 'join_cache_level': '1', 'max_heap_table_size': '16MB', 'log_slow_query_time': '0', 'max_relay_log_size': '20', 'expire_logs_days': '10', 'max_binlog_size': '50M', 'innodb_log_file_size': '256M'}
Trying update set global max_allowed_packet=268435456
Trying update set global join_cache_level=1
Trying update set global max_heap_table_size=16777216
Trying update set global log_slow_query_time=0
Trying update set global max_relay_log_size=20
Trying update set global expire_logs_days=10
Trying update set global max_binlog_size=52428800
Trying update set global innodb_log_file_size=268435456
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Reward 2054.095947265625 with {'max_allowed_packet': '256M', 'join_cache_level': '1', 'max_heap_table_size': '16MB', 'log_slow_query_time': '0', 'max_relay_log_size': '20', 'expire_logs_days': '10', 'max_binlog_size': '50M', 'innodb_log_file_size': '256M'}
Obtained 2054.095947265625 by configuration {'max_allowed_packet': '256M', 'join_cache_level': '1', 'max_heap_table_size': '16MB', 'log_slow_query_time': '0', 'max_relay_log_size': '20', 'expire_logs_days': '10', 'max_binlog_size': '50M', 'innodb_log_file_size': '256M'}
Achieved unscaled reward of 2054.095947265625 using {'max_allowed_packet': '256M', 'join_cache_level': '1', 'max_heap_table_size': '16MB', 'log_slow_query_time': '0', 'max_relay_log_size': '20', 'expire_logs_days': '10', 'max_binlog_size': '50M', 'innodb_log_file_size': '256M'}.
No warmup - hint counter: 60
{'sequence': '16', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Increase recommendation', 'Decrease recommendation'], 'scores': [0.2578245997428894, 0.21941344439983368, 0.18871235847473145, 0.17040672898292542, 0.16364289820194244]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(0, 26), match='table_open_cache_instances'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18871235847473145, 0.16364289820194244, 0.2578245997428894, 0.17040672898292542, 0.21941344439983368]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(0, 26), match='table_open_cache_instances'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18871235847473145, 0.16364289820194244, 0.2578245997428894, 0.17040672898292542, 0.21941344439983368]
Choice: 4
Done flag: False
No warmup - hint counter: 60
{'sequence': '16', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4661506414413452, 0.19984710216522217, 0.16229088604450226, 0.1465105265378952, 0.025200868025422096]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(0, 26), match='table_open_cache_instances'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.025200868025422096, 0.4661506414413452, 0.19984710216522217, 0.16229088604450226, 0.1465105265378952]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(0, 26), match='table_open_cache_instances'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18871235847473145, 0.16364289820194244, 0.2578245997428894, 0.17040672898292542, 0.21941344439983368]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(0, 26), match='table_open_cache_instances'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.025200868025422096, 0.4661506414413452, 0.19984710216522217, 0.16229088604450226, 0.1465105265378952]
Choice: 0
Trying update set global table_open_cache_instances=8
Exception during update: Variable 'table_open_cache_instances' is a read only variable
Trying update set global table_open_cache_instances=8
Exception during update: Variable 'table_open_cache_instances' is a read only variable
Trying assigning table_open_cache_instances to 8
Assignment ('table_open_cache_instances', '8') was rejected
Hint counter: 61
Episode hint counter before: 0
Episode hint counter: 1
Hints per episode: 20
Done flag: False
No warmup - hint counter: 61
{'sequence': '300', 'labels': ['Use recommendation', 'Decrease recommendation strongly', 'Increase recommendation', 'Decrease recommendation', 'Increase recommendation strongly'], 'scores': [0.24746622145175934, 0.2047126293182373, 0.19365791976451874, 0.18261092901229858, 0.17155222594738007]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(96, 111), match='connect_timeout'>, value=<re.Match object; span=(0, 3), match='300'>, recommendation='300', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=300.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.2047126293182373, 0.18261092901229858, 0.24746622145175934, 0.19365791976451874, 0.17155222594738007]
Choice: 1
Done flag: False
No warmup - hint counter: 61
{'sequence': '300', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.45760852098464966, 0.20202812552452087, 0.16958750784397125, 0.14617766439914703, 0.024598082527518272]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(96, 111), match='connect_timeout'>, value=<re.Match object; span=(0, 3), match='300'>, recommendation='300', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=300.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.024598082527518272, 0.45760852098464966, 0.20202812552452087, 0.16958750784397125, 0.14617766439914703]
Choice: 2
Trying update set global connect_timeout=150
Trying update set global connect_timeout=10
Trying assigning connect_timeout to 150
Adding assignment ('connect_timeout', '150') with weight 4
Assignment ('connect_timeout', '150') extracted from "innodb_write_io_threads = 32
innodb_io_capacity = 4000
innodb_io_capacity_max = 6000
# Timeouts
connect_timeout = 300
wait_timeout = 30000
# Caches and Limits innodb_flush_log_at_timeout "
Hint counter: 62
Episode hint counter before: 1
Episode hint counter: 2
Hints per episode: 20
Done flag: False
No warmup - hint counter: 62
{'sequence': '4000', 'labels': ['Use recommendation', 'Increase recommendation', 'Decrease recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly'], 'scores': [0.2586197257041931, 0.1903301477432251, 0.1893036663532257, 0.18380886316299438, 0.1779375821352005]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(29, 47), match='innodb_io_capacity'>, value=<re.Match object; span=(0, 4), match='4000'>, recommendation='4000', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=4000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1779375821352005, 0.1893036663532257, 0.2586197257041931, 0.1903301477432251, 0.18380886316299438]
Choice: 1
Done flag: False
No warmup - hint counter: 62
{'sequence': '4000', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4483853578567505, 0.2076708972454071, 0.17431151866912842, 0.14844806492328644, 0.021184172481298447]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(29, 47), match='innodb_io_capacity'>, value=<re.Match object; span=(0, 4), match='4000'>, recommendation='4000', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=4000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.021184172481298447, 0.4483853578567505, 0.2076708972454071, 0.17431151866912842, 0.14844806492328644]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(29, 47), match='innodb_io_capacity'>, value=<re.Match object; span=(0, 4), match='4000'>, recommendation='4000', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=4000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1779375821352005, 0.1893036663532257, 0.2586197257041931, 0.1903301477432251, 0.18380886316299438]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(29, 47), match='innodb_io_capacity'>, value=<re.Match object; span=(0, 4), match='4000'>, recommendation='4000', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=4000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.021184172481298447, 0.4483853578567505, 0.2076708972454071, 0.17431151866912842, 0.14844806492328644]
Choice: 4
Trying update set global innodb_io_capacity=4000
Trying update set global innodb_io_capacity=200
Trying assigning innodb_io_capacity to 4000
Adding assignment ('innodb_io_capacity', '4000') with weight 16
Assignment ('innodb_io_capacity', '4000') extracted from "innodb_write_io_threads = 32
innodb_io_capacity = 4000
innodb_io_capacity_max = 6000
# Timeouts
connect_timeout = 300
wait_timeout = 30000
# Caches and Limits innodb_flush_log_at_timeout "
Hint counter: 63
Episode hint counter before: 2
Episode hint counter: 3
Hints per episode: 20
Done flag: False
No warmup - hint counter: 63
{'sequence': '30000', 'labels': ['Use recommendation', 'Decrease recommendation', 'Decrease recommendation strongly', 'Increase recommendation strongly', 'Increase recommendation'], 'scores': [0.27192777395248413, 0.19408154487609863, 0.18324296176433563, 0.18074218928813934, 0.17000548541545868]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(118, 130), match='wait_timeout'>, value=<re.Match object; span=(0, 5), match='30000'>, recommendation='30000', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=30000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18324296176433563, 0.19408154487609863, 0.27192777395248413, 0.17000548541545868, 0.18074218928813934]
Choice: 0
Done flag: False
No warmup - hint counter: 63
{'sequence': '30000', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.444963276386261, 0.2073020190000534, 0.1703442484140396, 0.15172511339187622, 0.02566535398364067]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(118, 130), match='wait_timeout'>, value=<re.Match object; span=(0, 5), match='30000'>, recommendation='30000', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=30000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02566535398364067, 0.444963276386261, 0.2073020190000534, 0.1703442484140396, 0.15172511339187622]
Choice: 0
Trying update set global wait_timeout=7500
Trying update set global wait_timeout=60
Trying assigning wait_timeout to 7500
Adding assignment ('wait_timeout', '7500') with weight 1
Assignment ('wait_timeout', '7500') extracted from "innodb_write_io_threads = 32
innodb_io_capacity = 4000
innodb_io_capacity_max = 6000
# Timeouts
connect_timeout = 300
wait_timeout = 30000
# Caches and Limits innodb_flush_log_at_timeout "
Hint counter: 64
Episode hint counter before: 3
Episode hint counter: 4
Hints per episode: 20
Done flag: False
No warmup - hint counter: 64
{'sequence': '6000', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Decrease recommendation', 'Increase recommendation'], 'scores': [0.26613572239875793, 0.20174598693847656, 0.198944091796875, 0.167149156332016, 0.1660250425338745]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(55, 77), match='innodb_io_capacity_max'>, value=<re.Match object; span=(0, 4), match='6000'>, recommendation='6000', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=6000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.198944091796875, 0.167149156332016, 0.26613572239875793, 0.1660250425338745, 0.20174598693847656]
Choice: 4
Done flag: False
No warmup - hint counter: 64
{'sequence': '6000', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.44496822357177734, 0.202551931142807, 0.17452304065227509, 0.15683667361736298, 0.021120181307196617]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(55, 77), match='innodb_io_capacity_max'>, value=<re.Match object; span=(0, 4), match='6000'>, recommendation='6000', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=6000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.021120181307196617, 0.44496822357177734, 0.202551931142807, 0.17452304065227509, 0.15683667361736298]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(55, 77), match='innodb_io_capacity_max'>, value=<re.Match object; span=(0, 4), match='6000'>, recommendation='6000', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=6000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.198944091796875, 0.167149156332016, 0.26613572239875793, 0.1660250425338745, 0.20174598693847656]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(55, 77), match='innodb_io_capacity_max'>, value=<re.Match object; span=(0, 4), match='6000'>, recommendation='6000', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=6000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.021120181307196617, 0.44496822357177734, 0.202551931142807, 0.17452304065227509, 0.15683667361736298]
Choice: 1
Trying update set global innodb_io_capacity_max=12000
Trying update set global innodb_io_capacity_max=8000
Trying assigning innodb_io_capacity_max to 12000
Adding assignment ('innodb_io_capacity_max', '12000') with weight 2
Assignment ('innodb_io_capacity_max', '12000') extracted from "innodb_write_io_threads = 32
innodb_io_capacity = 4000
innodb_io_capacity_max = 6000
# Timeouts
connect_timeout = 300
wait_timeout = 30000
# Caches and Limits innodb_flush_log_at_timeout "
Hint counter: 65
Episode hint counter before: 4
Episode hint counter: 5
Hints per episode: 20
Done flag: False
No warmup - hint counter: 65
{'sequence': '100/200/2**64-1', 'labels': ['Increase recommendation', 'Increase recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Decrease recommendation strongly'], 'scores': [0.2461479753255844, 0.209076926112175, 0.2044525444507599, 0.19387376308441162, 0.1464487612247467]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(0, 3), match='100'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=100.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1464487612247467, 0.2044525444507599, 0.19387376308441162, 0.2461479753255844, 0.209076926112175]
Choice: 3
Done flag: False
No warmup - hint counter: 65
{'sequence': '100/200/2**64-1', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.541114330291748, 0.18097959458827972, 0.14087186753749847, 0.10998997092247009, 0.02704428881406784]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(0, 3), match='100'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=100.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02704428881406784, 0.541114330291748, 0.18097959458827972, 0.14087186753749847, 0.10998997092247009]
Choice: 3
Trying update set global innodb_io_capacity_max=200
Trying update set global innodb_io_capacity_max=8000
Trying assigning innodb_io_capacity_max to 200
Adding assignment ('innodb_io_capacity_max', '200') with weight 8
Assignment ('innodb_io_capacity_max', '200') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 66
Episode hint counter before: 5
Episode hint counter: 6
Hints per episode: 20
Done flag: False
No warmup - hint counter: 66
{'sequence': '100/200/2**64-1', 'labels': ['Increase recommendation', 'Increase recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Decrease recommendation strongly'], 'scores': [0.2461479753255844, 0.209076926112175, 0.2044525444507599, 0.19387376308441162, 0.1464487612247467]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(4, 7), match='200'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1464487612247467, 0.2044525444507599, 0.19387376308441162, 0.2461479753255844, 0.209076926112175]
Choice: 0
Done flag: False
No warmup - hint counter: 66
{'sequence': '100/200/2**64-1', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.541114330291748, 0.18097959458827972, 0.14087186753749847, 0.10998997092247009, 0.02704428881406784]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(4, 7), match='200'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02704428881406784, 0.541114330291748, 0.18097959458827972, 0.14087186753749847, 0.10998997092247009]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(4, 7), match='200'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1464487612247467, 0.2044525444507599, 0.19387376308441162, 0.2461479753255844, 0.209076926112175]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(4, 7), match='200'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02704428881406784, 0.541114330291748, 0.18097959458827972, 0.14087186753749847, 0.10998997092247009]
Choice: 4
Trying update set global innodb_io_capacity_max=50
Trying update set global innodb_io_capacity_max=8000
Trying assigning innodb_io_capacity_max to 50
Adding assignment ('innodb_io_capacity_max', '50') with weight 16
Assignment ('innodb_io_capacity_max', '50') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 67
Episode hint counter before: 6
Episode hint counter: 7
Hints per episode: 20
Done flag: False
No warmup - hint counter: 67
{'sequence': '100/200/2**64-1', 'labels': ['Increase recommendation', 'Increase recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Decrease recommendation strongly'], 'scores': [0.2461479753255844, 0.209076926112175, 0.2044525444507599, 0.19387376308441162, 0.1464487612247467]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(8, 9), match='2'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=2.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1464487612247467, 0.2044525444507599, 0.19387376308441162, 0.2461479753255844, 0.209076926112175]
Choice: 4
Done flag: False
No warmup - hint counter: 67
{'sequence': '100/200/2**64-1', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.541114330291748, 0.18097959458827972, 0.14087186753749847, 0.10998997092247009, 0.02704428881406784]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(8, 9), match='2'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=2.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02704428881406784, 0.541114330291748, 0.18097959458827972, 0.14087186753749847, 0.10998997092247009]
Choice: 3
Trying update set global innodb_io_capacity_max=8
Trying update set global innodb_io_capacity_max=8000
Trying assigning innodb_io_capacity_max to 8
Adding assignment ('innodb_io_capacity_max', '8') with weight 8
Assignment ('innodb_io_capacity_max', '8') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 68
Episode hint counter before: 7
Episode hint counter: 8
Hints per episode: 20
Done flag: False
No warmup - hint counter: 68
{'sequence': '100/200/2**64-1', 'labels': ['Increase recommendation', 'Increase recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Decrease recommendation strongly'], 'scores': [0.2461479753255844, 0.209076926112175, 0.2044525444507599, 0.19387376308441162, 0.1464487612247467]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(11, 13), match='64'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1464487612247467, 0.2044525444507599, 0.19387376308441162, 0.2461479753255844, 0.209076926112175]
Choice: 1
Done flag: False
No warmup - hint counter: 68
{'sequence': '100/200/2**64-1', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.541114330291748, 0.18097959458827972, 0.14087186753749847, 0.10998997092247009, 0.02704428881406784]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(11, 13), match='64'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02704428881406784, 0.541114330291748, 0.18097959458827972, 0.14087186753749847, 0.10998997092247009]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(11, 13), match='64'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1464487612247467, 0.2044525444507599, 0.19387376308441162, 0.2461479753255844, 0.209076926112175]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(11, 13), match='64'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02704428881406784, 0.541114330291748, 0.18097959458827972, 0.14087186753749847, 0.10998997092247009]
Choice: 2
Trying update set global innodb_io_capacity_max=32
Trying update set global innodb_io_capacity_max=8000
Trying assigning innodb_io_capacity_max to 32
Adding assignment ('innodb_io_capacity_max', '32') with weight 4
Assignment ('innodb_io_capacity_max', '32') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 69
Episode hint counter before: 8
Episode hint counter: 9
Hints per episode: 20
Done flag: False
No warmup - hint counter: 69
{'sequence': '100/200/2**64-1', 'labels': ['Increase recommendation', 'Increase recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Decrease recommendation strongly'], 'scores': [0.2461479753255844, 0.209076926112175, 0.2044525444507599, 0.19387376308441162, 0.1464487612247467]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(14, 15), match='1'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1464487612247467, 0.2044525444507599, 0.19387376308441162, 0.2461479753255844, 0.209076926112175]
Choice: 1
Done flag: False
No warmup - hint counter: 69
{'sequence': '100/200/2**64-1', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.541114330291748, 0.18097959458827972, 0.14087186753749847, 0.10998997092247009, 0.02704428881406784]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(14, 15), match='1'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02704428881406784, 0.541114330291748, 0.18097959458827972, 0.14087186753749847, 0.10998997092247009]
Choice: 3
Trying update set global innodb_io_capacity_max=0
Trying update set global innodb_io_capacity_max=8000
Trying assigning innodb_io_capacity_max to 0
Adding assignment ('innodb_io_capacity_max', '0') with weight 8
Assignment ('innodb_io_capacity_max', '0') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 70
Episode hint counter before: 9
Episode hint counter: 10
Hints per episode: 20
Done flag: False
No warmup - hint counter: 70
{'sequence': '1000000', 'labels': ['Use recommendation', 'Increase recommendation', 'Increase recommendation strongly', 'Decrease recommendation', 'Decrease recommendation strongly'], 'scores': [0.2528064250946045, 0.19543568789958954, 0.19329147040843964, 0.18156594038009644, 0.17690053582191467]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(82, 100), match='max_connect_errors'>, value=<re.Match object; span=(0, 7), match='1000000'>, recommendation='1000000', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=1000000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.17690053582191467, 0.18156594038009644, 0.2528064250946045, 0.19543568789958954, 0.19329147040843964]
Choice: 3
Done flag: False
No warmup - hint counter: 70
{'sequence': '1000000', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.43378427624702454, 0.20846743881702423, 0.16758155822753906, 0.1633659303188324, 0.02680082619190216]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(82, 100), match='max_connect_errors'>, value=<re.Match object; span=(0, 7), match='1000000'>, recommendation='1000000', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=1000000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02680082619190216, 0.43378427624702454, 0.20846743881702423, 0.16758155822753906, 0.1633659303188324]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(82, 100), match='max_connect_errors'>, value=<re.Match object; span=(0, 7), match='1000000'>, recommendation='1000000', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=1000000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.17690053582191467, 0.18156594038009644, 0.2528064250946045, 0.19543568789958954, 0.19329147040843964]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(82, 100), match='max_connect_errors'>, value=<re.Match object; span=(0, 7), match='1000000'>, recommendation='1000000', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=1000000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02680082619190216, 0.43378427624702454, 0.20846743881702423, 0.16758155822753906, 0.1633659303188324]
Choice: 4
Trying update set global max_connect_errors=500000
Trying update set global max_connect_errors=100
Trying assigning max_connect_errors to 500000
Adding assignment ('max_connect_errors', '500000') with weight 16
Assignment ('max_connect_errors', '500000') extracted from "table_open_cache_instances = 16
table_open_cache
= 32012
open_files_limit = 65535
max_connect_errors = 1000000
[client]
# MySQL Client Configuration
# Client Socket table_open_cache_instances "
Hint counter: 71
Episode hint counter before: 10
Episode hint counter: 11
Hints per episode: 20
Done flag: False
No warmup - hint counter: 71
{'sequence': '32', 'labels': ['Use recommendation', 'Decrease recommendation strongly', 'Decrease recommendation', 'Increase recommendation strongly', 'Increase recommendation'], 'scores': [0.26641327142715454, 0.19402799010276794, 0.19214743375778198, 0.1895178258419037, 0.15789352357387543]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(127, 149), match='innodb_read_io_threads'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='innodb_stats_on_metadata = off\ninnodb-flush-method = O_DIRECT\ninnodb-flush-log-at-trx-commit = 2\ninnodb_buffer_pool_size = 23G\ninnodb_read_io_threads = 32 innodb_flush_log_at_trx_commit ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19402799010276794, 0.19214743375778198, 0.26641327142715454, 0.15789352357387543, 0.1895178258419037]
Choice: 1
Done flag: False
No warmup - hint counter: 71
{'sequence': '32', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.46463149785995483, 0.20161142945289612, 0.1676764339208603, 0.13865259289741516, 0.027428098022937775]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(127, 149), match='innodb_read_io_threads'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='innodb_stats_on_metadata = off\ninnodb-flush-method = O_DIRECT\ninnodb-flush-log-at-trx-commit = 2\ninnodb_buffer_pool_size = 23G\ninnodb_read_io_threads = 32 innodb_flush_log_at_trx_commit ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.027428098022937775, 0.46463149785995483, 0.20161142945289612, 0.1676764339208603, 0.13865259289741516]
Choice: 0
Trying update set global innodb_read_io_threads=16
Trying update set global innodb_read_io_threads=4
Trying assigning innodb_read_io_threads to 16
Adding assignment ('innodb_read_io_threads', '16') with weight 1
Assignment ('innodb_read_io_threads', '16') extracted from "innodb_stats_on_metadata = off
innodb-flush-method = O_DIRECT
innodb-flush-log-at-trx-commit = 2
innodb_buffer_pool_size = 23G
innodb_read_io_threads = 32 innodb_flush_log_at_trx_commit "
Hint counter: 72
Episode hint counter before: 11
Episode hint counter: 12
Hints per episode: 20
Done flag: False
No warmup - hint counter: 72
{'sequence': '32', 'labels': ['Use recommendation', 'Decrease recommendation strongly', 'Decrease recommendation', 'Increase recommendation strongly', 'Increase recommendation'], 'scores': [0.26641327142715454, 0.19402799010276794, 0.19214743375778198, 0.1895178258419037, 0.15789352357387543]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(0, 23), match='innodb_write_io_threads'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19402799010276794, 0.19214743375778198, 0.26641327142715454, 0.15789352357387543, 0.1895178258419037]
Choice: 0
Done flag: False
No warmup - hint counter: 72
{'sequence': '32', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.46463149785995483, 0.20161142945289612, 0.1676764339208603, 0.13865259289741516, 0.027428098022937775]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(0, 23), match='innodb_write_io_threads'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.027428098022937775, 0.46463149785995483, 0.20161142945289612, 0.1676764339208603, 0.13865259289741516]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(0, 23), match='innodb_write_io_threads'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19402799010276794, 0.19214743375778198, 0.26641327142715454, 0.15789352357387543, 0.1895178258419037]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(0, 23), match='innodb_write_io_threads'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.027428098022937775, 0.46463149785995483, 0.20161142945289612, 0.1676764339208603, 0.13865259289741516]
Choice: 0
Trying update set global innodb_write_io_threads=64
Trying update set global innodb_write_io_threads=4
Trying assigning innodb_write_io_threads to 64
Adding assignment ('innodb_write_io_threads', '64') with weight 1
Assignment ('innodb_write_io_threads', '64') extracted from "innodb_write_io_threads = 32
innodb_io_capacity = 4000
innodb_io_capacity_max = 6000
# Timeouts
connect_timeout = 300
wait_timeout = 30000
# Caches and Limits innodb_flush_log_at_timeout "
Hint counter: 73
Episode hint counter before: 12
Episode hint counter: 13
Hints per episode: 20
Done flag: False
No warmup - hint counter: 73
{'sequence': '1000', 'labels': ['Use recommendation', 'Increase recommendation', 'Decrease recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly'], 'scores': [0.28242507576942444, 0.19090786576271057, 0.18482346832752228, 0.17559082806110382, 0.1662527620792389]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(140, 162), match='innodb_old_blocks_time'>, value=<re.Match object; span=(0, 4), match='1000'>, recommendation='1000', passage='# InnoDB Configuration\ninnodb-log-file-size = 128M\ninnodb-log-buffer-size = 128M\ninnodb-file-per-table = 1\ninnodb_buffer_pool_instances = 8\ninnodb_old_blocks_time = 1000 innodb_log_file_size ', float_val=1000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1662527620792389, 0.18482346832752228, 0.28242507576942444, 0.19090786576271057, 0.17559082806110382]
Choice: 1
Done flag: False
No warmup - hint counter: 73
{'sequence': '1000', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.43016543984413147, 0.20931342244148254, 0.1748356819152832, 0.16804377734661102, 0.017641622573137283]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(140, 162), match='innodb_old_blocks_time'>, value=<re.Match object; span=(0, 4), match='1000'>, recommendation='1000', passage='# InnoDB Configuration\ninnodb-log-file-size = 128M\ninnodb-log-buffer-size = 128M\ninnodb-file-per-table = 1\ninnodb_buffer_pool_instances = 8\ninnodb_old_blocks_time = 1000 innodb_log_file_size ', float_val=1000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.017641622573137283, 0.43016543984413147, 0.20931342244148254, 0.1748356819152832, 0.16804377734661102]
Choice: 4
Trying update set global innodb_old_blocks_time=500
Trying update set global innodb_old_blocks_time=1000
Trying assigning innodb_old_blocks_time to 500
Adding assignment ('innodb_old_blocks_time', '500') with weight 16
Assignment ('innodb_old_blocks_time', '500') extracted from "# InnoDB Configuration
innodb-log-file-size = 128M
innodb-log-buffer-size = 128M
innodb-file-per-table = 1
innodb_buffer_pool_instances = 8
innodb_old_blocks_time = 1000 innodb_log_file_size "
Hint counter: 74
Episode hint counter before: 13
Episode hint counter: 14
Hints per episode: 20
Done flag: False
No warmup - hint counter: 74
{'sequence': '1/8/64', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Increase recommendation', 'Decrease recommendation'], 'scores': [0.31530001759529114, 0.21982860565185547, 0.17826427519321442, 0.15975500643253326, 0.1268521249294281]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(3130, 3152), match='innodb_old_blocks_time'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1/8/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.17826427519321442, 0.1268521249294281, 0.31530001759529114, 0.15975500643253326, 0.21982860565185547]
Choice: 2
Done flag: False
No warmup - hint counter: 74
{'sequence': '1/8/64', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4616946578025818, 0.20274142920970917, 0.1691240817308426, 0.13472667336463928, 0.031713131815195084]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(3130, 3152), match='innodb_old_blocks_time'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1/8/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.031713131815195084, 0.4616946578025818, 0.20274142920970917, 0.1691240817308426, 0.13472667336463928]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(3130, 3152), match='innodb_old_blocks_time'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1/8/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.17826427519321442, 0.1268521249294281, 0.31530001759529114, 0.15975500643253326, 0.21982860565185547]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(3130, 3152), match='innodb_old_blocks_time'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1/8/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.031713131815195084, 0.4616946578025818, 0.20274142920970917, 0.1691240817308426, 0.13472667336463928]
Choice: 1
Trying update set global innodb_old_blocks_time=4
Trying update set global innodb_old_blocks_time=1000
Trying assigning innodb_old_blocks_time to 4
Adding assignment ('innodb_old_blocks_time', '4') with weight 2
Assignment ('innodb_old_blocks_time', '4') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 75
Episode hint counter before: 14
Episode hint counter: 15
Hints per episode: 20
Done flag: False
No warmup - hint counter: 75
{'sequence': '1/8/64', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Increase recommendation', 'Decrease recommendation'], 'scores': [0.31530001759529114, 0.21982860565185547, 0.17826427519321442, 0.15975500643253326, 0.1268521249294281]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(3130, 3152), match='innodb_old_blocks_time'>, value=<re.Match object; span=(2, 3), match='8'>, recommendation='1/8/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.17826427519321442, 0.1268521249294281, 0.31530001759529114, 0.15975500643253326, 0.21982860565185547]
Choice: 4
Done flag: False
No warmup - hint counter: 75
{'sequence': '1/8/64', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4616946578025818, 0.20274142920970917, 0.1691240817308426, 0.13472667336463928, 0.031713131815195084]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(3130, 3152), match='innodb_old_blocks_time'>, value=<re.Match object; span=(2, 3), match='8'>, recommendation='1/8/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.031713131815195084, 0.4616946578025818, 0.20274142920970917, 0.1691240817308426, 0.13472667336463928]
Choice: 1
Trying update set global innodb_old_blocks_time=32
Trying update set global innodb_old_blocks_time=1000
Trying assigning innodb_old_blocks_time to 32
Adding assignment ('innodb_old_blocks_time', '32') with weight 2
Assignment ('innodb_old_blocks_time', '32') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 76
Episode hint counter before: 15
Episode hint counter: 16
Hints per episode: 20
Done flag: False
No warmup - hint counter: 76
{'sequence': '1/8/64', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Increase recommendation', 'Decrease recommendation'], 'scores': [0.31530001759529114, 0.21982860565185547, 0.17826427519321442, 0.15975500643253326, 0.1268521249294281]}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(3130, 3152), match='innodb_old_blocks_time'>, value=<re.Match object; span=(4, 6), match='64'>, recommendation='1/8/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.17826427519321442, 0.1268521249294281, 0.31530001759529114, 0.15975500643253326, 0.21982860565185547]
Choice: 3
Done flag: False
No warmup - hint counter: 76
{'sequence': '1/8/64', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4616946578025818, 0.20274142920970917, 0.1691240817308426, 0.13472667336463928, 0.031713131815195084]}
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(3130, 3152), match='innodb_old_blocks_time'>, value=<re.Match object; span=(4, 6), match='64'>, recommendation='1/8/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.031713131815195084, 0.4616946578025818, 0.20274142920970917, 0.1691240817308426, 0.13472667336463928]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(3130, 3152), match='innodb_old_blocks_time'>, value=<re.Match object; span=(4, 6), match='64'>, recommendation='1/8/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.17826427519321442, 0.1268521249294281, 0.31530001759529114, 0.15975500643253326, 0.21982860565185547]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(3130, 3152), match='innodb_old_blocks_time'>, value=<re.Match object; span=(4, 6), match='64'>, recommendation='1/8/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.031713131815195084, 0.4616946578025818, 0.20274142920970917, 0.1691240817308426, 0.13472667336463928]
Choice: 1
Trying update set global innodb_old_blocks_time=256
Trying update set global innodb_old_blocks_time=1000
Trying assigning innodb_old_blocks_time to 256
Adding assignment ('innodb_old_blocks_time', '256') with weight 2
Assignment ('innodb_old_blocks_time', '256') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 77
Episode hint counter before: 16
Episode hint counter: 17
Hints per episode: 20
Done flag: False
No warmup - hint counter: 77
{'sequence': '2048', 'labels': ['Use recommendation', 'Decrease recommendation', 'Decrease recommendation strongly', 'Increase recommendation', 'Increase recommendation strongly'], 'scores': [0.2764931619167328, 0.20450188219547272, 0.17999409139156342, 0.1695912778377533, 0.1694195717573166]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(125, 141), match='sort_buffer_size'>, value=<re.Match object; span=(0, 4), match='2048'>, recommendation='2048', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=2048.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.17999409139156342, 0.20450188219547272, 0.2764931619167328, 0.1695912778377533, 0.1694195717573166]
Choice: 1
Done flag: False
No warmup - hint counter: 77
{'sequence': '2048', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.44854864478111267, 0.20763951539993286, 0.17194095253944397, 0.14623866975307465, 0.025632193312048912]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(125, 141), match='sort_buffer_size'>, value=<re.Match object; span=(0, 4), match='2048'>, recommendation='2048', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=2048.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.025632193312048912, 0.44854864478111267, 0.20763951539993286, 0.17194095253944397, 0.14623866975307465]
Choice: 4
Trying update set global sort_buffer_size=1024
Trying update set global sort_buffer_size=2097152
Trying assigning sort_buffer_size to 1024
Adding assignment ('sort_buffer_size', '1024') with weight 16
Assignment ('sort_buffer_size', '1024') extracted from "key_buffer_size = 1200
query_cache_size = 50
tmp_table_size = 128
innodb_buffer_pool_size = 4096
innodb_log_buffer_size = 32
sort_buffer_size = 2048
read_buffer_size = 256 key_buffer_size "
Hint counter: 78
Episode hint counter before: 17
Episode hint counter: 18
Hints per episode: 20
Done flag: False
No warmup - hint counter: 78
{'sequence': '1024', 'labels': ['Use recommendation', 'Increase recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Decrease recommendation'], 'scores': [0.28181496262550354, 0.2019103467464447, 0.19123758375644684, 0.16487236320972443, 0.1601647138595581]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(57, 73), match='sort_buffer_size'>, value=<re.Match object; span=(0, 4), match='1024'>, recommendation='1024', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=1024.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.16487236320972443, 0.1601647138595581, 0.28181496262550354, 0.2019103467464447, 0.19123758375644684]
Choice: 4
Done flag: False
No warmup - hint counter: 78
{'sequence': '1024', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.41018953919410706, 0.21158428490161896, 0.18349096179008484, 0.17497636377811432, 0.019758854061365128]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(57, 73), match='sort_buffer_size'>, value=<re.Match object; span=(0, 4), match='1024'>, recommendation='1024', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=1024.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.019758854061365128, 0.41018953919410706, 0.21158428490161896, 0.18349096179008484, 0.17497636377811432]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(57, 73), match='sort_buffer_size'>, value=<re.Match object; span=(0, 4), match='1024'>, recommendation='1024', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=1024.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.16487236320972443, 0.1601647138595581, 0.28181496262550354, 0.2019103467464447, 0.19123758375644684]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(57, 73), match='sort_buffer_size'>, value=<re.Match object; span=(0, 4), match='1024'>, recommendation='1024', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=1024.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.019758854061365128, 0.41018953919410706, 0.21158428490161896, 0.18349096179008484, 0.17497636377811432]
Choice: 4
Trying update set global sort_buffer_size=4096
Trying update set global sort_buffer_size=2097152
Trying assigning sort_buffer_size to 4096
Adding assignment ('sort_buffer_size', '4096') with weight 16
Assignment ('sort_buffer_size', '4096') extracted from "innodb_buffer_pool_size = 512
innodb_log_buffer_size = 8
sort_buffer_size = 1024
read_buffer_size = 1024
read_rnd_buffer_size = 4096
join_buffer_size = 1024
thread_stack = 192 innodb_log_buffer_size "
Hint counter: 79
Episode hint counter before: 18
Episode hint counter: 19
Hints per episode: 20
Done flag: False
No warmup - hint counter: 79
{'sequence': '10M', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Increase recommendation', 'Decrease recommendation'], 'scores': [0.2938447892665863, 0.20927472412586212, 0.174553781747818, 0.16246436536312103, 0.15986230969429016]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(0, 16), match='sort_buffer_size'>, value=<re.Match object; span=(0, 3), match='10M'>, recommendation='10M', passage="sort_buffer_size = 10M\nread_buffer_size = 10M ( always on mysql configuration use M (MB) because if you use 1024 is translated to bytes and the sort_buffer_size have a minimum value of 32768 bytes so that's being said, 1024 is a useless number used two times in the above configuration, read_buffer_size have a 8192 minimum value) read_buffer_size ", float_val=10.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.174553781747818, 0.15986230969429016, 0.2938447892665863, 0.16246436536312103, 0.20927472412586212]
Choice: 0
Done flag: False
No warmup - hint counter: 79
{'sequence': '10M', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4279082417488098, 0.2015354484319687, 0.1824634075164795, 0.1726716011762619, 0.015421286225318909]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(0, 16), match='sort_buffer_size'>, value=<re.Match object; span=(0, 3), match='10M'>, recommendation='10M', passage="sort_buffer_size = 10M\nread_buffer_size = 10M ( always on mysql configuration use M (MB) because if you use 1024 is translated to bytes and the sort_buffer_size have a minimum value of 32768 bytes so that's being said, 1024 is a useless number used two times in the above configuration, read_buffer_size have a 8192 minimum value) read_buffer_size ", float_val=10.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)\n[Restart] MariaDB server shut down!
[Restart] MariaDB server restarted!
\n[Restart] MariaDB server shut down!
[Restart] MariaDB server restarted!

Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.015421286225318909, 0.4279082417488098, 0.2015354484319687, 0.1824634075164795, 0.1726716011762619]
Choice: 3
Trying update set global sort_buffer_size=2097152
Trying update set global sort_buffer_size=2097152
Trying assigning sort_buffer_size to 2M
Adding assignment ('sort_buffer_size', '2M') with weight 8
Assignment ('sort_buffer_size', '2M') extracted from "sort_buffer_size = 10M
read_buffer_size = 10M ( always on mysql configuration use M (MB) because if you use 1024 is translated to bytes and the sort_buffer_size have a minimum value of 32768 bytes so that's being said, 1024 is a useless number used two times in the above configuration, read_buffer_size have a 8192 minimum value) read_buffer_size "
Hint counter: 80
Episode hint counter before: 19
Episode hint counter: 20
Hints per episode: 20
Episode finished!
Done flag: True
Finalizing episode!
Weighted hints: defaultdict(<function NlpTuningEnv._finalize_episode.<locals>.<lambda> at 0x7f8767de03a0>, {('connect_timeout', '150'): 4, ('innodb_io_capacity', '4000'): 16, ('wait_timeout', '7500'): 1, ('innodb_io_capacity_max', '12000'): 2, ('innodb_io_capacity_max', '200'): 8, ('innodb_io_capacity_max', '50'): 16, ('innodb_io_capacity_max', '8'): 8, ('innodb_io_capacity_max', '32'): 4, ('innodb_io_capacity_max', '0'): 8, ('max_connect_errors', '500000'): 16, ('innodb_read_io_threads', '16'): 1, ('innodb_write_io_threads', '64'): 1, ('innodb_old_blocks_time', '500'): 16, ('innodb_old_blocks_time', '4'): 2, ('innodb_old_blocks_time', '32'): 2, ('innodb_old_blocks_time', '256'): 2, ('sort_buffer_size', '1024'): 16, ('sort_buffer_size', '4096'): 16, ('sort_buffer_size', '2M'): 8})
Selected configurations: [{'connect_timeout': '150', 'innodb_io_capacity': '4000', 'wait_timeout': '7500', 'innodb_io_capacity_max': '200', 'max_connect_errors': '500000', 'innodb_read_io_threads': '16', 'innodb_write_io_threads': '64', 'innodb_old_blocks_time': '500', 'sort_buffer_size': '4096'}, {'connect_timeout': '150', 'innodb_io_capacity': '4000', 'wait_timeout': '7500', 'innodb_io_capacity_max': '12000', 'max_connect_errors': '500000', 'innodb_read_io_threads': '16', 'innodb_write_io_threads': '64', 'innodb_old_blocks_time': '32', 'sort_buffer_size': '2M'}]
Disconnecting ...
Trying to connect to tpch with user kaltenec
Trying update set session max_execution_time = 1500000
Exception during update: Unknown system variable 'max_execution_time'
Trying update update mariadb.server_cost set cost_value = NULL
Exception during update: Table 'mariadb.server_cost' doesn't exist
Trying update update mariadb.engine_cost set cost_value = NULL
Exception during update: Table 'mariadb.engine_cost' doesn't exist
Trying configuration: {'connect_timeout': '150', 'innodb_io_capacity': '4000', 'wait_timeout': '7500', 'innodb_io_capacity_max': '200', 'max_connect_errors': '500000', 'innodb_read_io_threads': '16', 'innodb_write_io_threads': '64', 'innodb_old_blocks_time': '500', 'sort_buffer_size': '4096'}
Trying update set global connect_timeout=150
Trying update set global innodb_io_capacity=4000
Trying update set global wait_timeout=7500
Trying update set global innodb_io_capacity_max=200
Trying update set global max_connect_errors=500000
Trying update set global innodb_read_io_threads=16
Trying update set global innodb_write_io_threads=64
Trying update set global innodb_old_blocks_time=500
Trying update set global sort_buffer_size=4096
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Reward 1744.5146484375 with {'connect_timeout': '150', 'innodb_io_capacity': '4000', 'wait_timeout': '7500', 'innodb_io_capacity_max': '200', 'max_connect_errors': '500000', 'innodb_read_io_threads': '16', 'innodb_write_io_threads': '64', 'innodb_old_blocks_time': '500', 'sort_buffer_size': '4096'}
Disconnecting ...
Trying to connect to tpch with user kaltenec
Trying update set session max_execution_time = 1500000
Exception during update: Unknown system variable 'max_execution_time'
Trying update update mariadb.server_cost set cost_value = NULL
Exception during update: Table 'mariadb.server_cost' doesn't exist
Trying update update mariadb.engine_cost set cost_value = NULL
Exception during update: Table 'mariadb.engine_cost' doesn't exist
Trying configuration: {'connect_timeout': '150', 'innodb_io_capacity': '4000', 'wait_timeout': '7500', 'innodb_io_capacity_max': '12000', 'max_connect_errors': '500000', 'innodb_read_io_threads': '16', 'innodb_write_io_threads': '64', 'innodb_old_blocks_time': '32', 'sort_buffer_size': '2M'}
Trying update set global connect_timeout=150
Trying update set global innodb_io_capacity=4000
Trying update set global wait_timeout=7500
Trying update set global innodb_io_capacity_max=12000
Trying update set global max_connect_errors=500000
Trying update set global innodb_read_io_threads=16
Trying update set global innodb_write_io_threads=64
Trying update set global innodb_old_blocks_time=32
Trying update set global sort_buffer_size=2097152
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Reward 1397.6826171875 with {'connect_timeout': '150', 'innodb_io_capacity': '4000', 'wait_timeout': '7500', 'innodb_io_capacity_max': '12000', 'max_connect_errors': '500000', 'innodb_read_io_threads': '16', 'innodb_write_io_threads': '64', 'innodb_old_blocks_time': '32', 'sort_buffer_size': '2M'}
Obtained 1744.5146484375 by configuration {'connect_timeout': '150', 'innodb_io_capacity': '4000', 'wait_timeout': '7500', 'innodb_io_capacity_max': '200', 'max_connect_errors': '500000', 'innodb_read_io_threads': '16', 'innodb_write_io_threads': '64', 'innodb_old_blocks_time': '500', 'sort_buffer_size': '4096'}
Achieved unscaled reward of 1744.5146484375 using {'connect_timeout': '150', 'innodb_io_capacity': '4000', 'wait_timeout': '7500', 'innodb_io_capacity_max': '200', 'max_connect_errors': '500000', 'innodb_read_io_threads': '16', 'innodb_write_io_threads': '64', 'innodb_old_blocks_time': '500', 'sort_buffer_size': '4096'}.
No warmup - hint counter: 80
{'sequence': '32', 'labels': ['Use recommendation', 'Decrease recommendation strongly', 'Decrease recommendation', 'Increase recommendation strongly', 'Increase recommendation'], 'scores': [0.26641327142715454, 0.19402799010276794, 0.19214743375778198, 0.1895178258419037, 0.15789352357387543]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(97, 119), match='innodb_log_buffer_size'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19402799010276794, 0.19214743375778198, 0.26641327142715454, 0.15789352357387543, 0.1895178258419037]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(97, 119), match='innodb_log_buffer_size'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19402799010276794, 0.19214743375778198, 0.26641327142715454, 0.15789352357387543, 0.1895178258419037]
Choice: 4
Done flag: False
No warmup - hint counter: 80
{'sequence': '32', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.46463149785995483, 0.20161142945289612, 0.1676764339208603, 0.13865259289741516, 0.027428098022937775]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(97, 119), match='innodb_log_buffer_size'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.027428098022937775, 0.46463149785995483, 0.20161142945289612, 0.1676764339208603, 0.13865259289741516]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(97, 119), match='innodb_log_buffer_size'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19402799010276794, 0.19214743375778198, 0.26641327142715454, 0.15789352357387543, 0.1895178258419037]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(97, 119), match='innodb_log_buffer_size'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.027428098022937775, 0.46463149785995483, 0.20161142945289612, 0.1676764339208603, 0.13865259289741516]
Choice: 2
Trying update set global innodb_log_buffer_size=8
Exception during update: Variable 'innodb_log_buffer_size' is a read only variable
Trying update set global innodb_log_buffer_size=16777216
Exception during update: Variable 'innodb_log_buffer_size' is a read only variable
Trying assigning innodb_log_buffer_size to 8
Assignment ('innodb_log_buffer_size', '8') was rejected
Hint counter: 81
Episode hint counter before: 0
Episode hint counter: 1
Hints per episode: 20
Done flag: False
No warmup - hint counter: 81
{'sequence': '8', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Increase recommendation', 'Decrease recommendation'], 'scores': [0.266186386346817, 0.2173980474472046, 0.1844906359910965, 0.17978301644325256, 0.15214183926582336]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(30, 52), match='innodb_log_buffer_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1844906359910965, 0.15214183926582336, 0.266186386346817, 0.17978301644325256, 0.2173980474472046]
Choice: 0
Done flag: False
No warmup - hint counter: 81
{'sequence': '8', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.46210938692092896, 0.20298469066619873, 0.1625889241695404, 0.145525261759758, 0.026791756972670555]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(30, 52), match='innodb_log_buffer_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.026791756972670555, 0.46210938692092896, 0.20298469066619873, 0.1625889241695404, 0.145525261759758]
Choice: 2
Trying update set global innodb_log_buffer_size=2
Exception during update: Variable 'innodb_log_buffer_size' is a read only variable
Trying update set global innodb_log_buffer_size=16777216
Exception during update: Variable 'innodb_log_buffer_size' is a read only variable
Trying assigning innodb_log_buffer_size to 2
Assignment ('innodb_log_buffer_size', '2') was rejected
Hint counter: 82
Episode hint counter before: 1
Episode hint counter: 2
Hints per episode: 20
Done flag: False
No warmup - hint counter: 82
{'sequence': '2048', 'labels': ['Use recommendation', 'Decrease recommendation', 'Decrease recommendation strongly', 'Increase recommendation', 'Increase recommendation strongly'], 'scores': [0.2764931619167328, 0.20450188219547272, 0.17999409139156342, 0.1695912778377533, 0.1694195717573166]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(27, 43), match='join_buffer_size'>, value=<re.Match object; span=(0, 4), match='2048'>, recommendation='2048', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=2048.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.17999409139156342, 0.20450188219547272, 0.2764931619167328, 0.1695912778377533, 0.1694195717573166]
Choice: 2
Done flag: False
No warmup - hint counter: 82
{'sequence': '2048', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.44854864478111267, 0.20763951539993286, 0.17194095253944397, 0.14623866975307465, 0.025632193312048912]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(27, 43), match='join_buffer_size'>, value=<re.Match object; span=(0, 4), match='2048'>, recommendation='2048', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=2048.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.025632193312048912, 0.44854864478111267, 0.20763951539993286, 0.17194095253944397, 0.14623866975307465]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(27, 43), match='join_buffer_size'>, value=<re.Match object; span=(0, 4), match='2048'>, recommendation='2048', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=2048.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.17999409139156342, 0.20450188219547272, 0.2764931619167328, 0.1695912778377533, 0.1694195717573166]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(27, 43), match='join_buffer_size'>, value=<re.Match object; span=(0, 4), match='2048'>, recommendation='2048', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=2048.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.025632193312048912, 0.44854864478111267, 0.20763951539993286, 0.17194095253944397, 0.14623866975307465]
Choice: 1
Trying update set global join_buffer_size=512
Trying update set global join_buffer_size=262144
Trying assigning join_buffer_size to 512
Adding assignment ('join_buffer_size', '512') with weight 2
Assignment ('join_buffer_size', '512') extracted from "read_rnd_buffer_size = 512
join_buffer_size = 2048
thread_stack = 512
binlog_cache_size = 64
thread_cache_size = 16
table_open_cache = 2048
max_connections = 200
PHP:
max_children = 4 thread_cache_size "
Hint counter: 83
Episode hint counter before: 2
Episode hint counter: 3
Hints per episode: 20
Done flag: False
No warmup - hint counter: 83
{'sequence': '1024', 'labels': ['Use recommendation', 'Increase recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Decrease recommendation'], 'scores': [0.28181496262550354, 0.2019103467464447, 0.19123758375644684, 0.16487236320972443, 0.1601647138595581]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(133, 149), match='join_buffer_size'>, value=<re.Match object; span=(0, 4), match='1024'>, recommendation='1024', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=1024.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.16487236320972443, 0.1601647138595581, 0.28181496262550354, 0.2019103467464447, 0.19123758375644684]
Choice: 1
Done flag: False
No warmup - hint counter: 83
{'sequence': '1024', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.41018953919410706, 0.21158428490161896, 0.18349096179008484, 0.17497636377811432, 0.019758854061365128]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(133, 149), match='join_buffer_size'>, value=<re.Match object; span=(0, 4), match='1024'>, recommendation='1024', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=1024.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.019758854061365128, 0.41018953919410706, 0.21158428490161896, 0.18349096179008484, 0.17497636377811432]
Choice: 0
Trying update set global join_buffer_size=512
Trying update set global join_buffer_size=262144
Trying assigning join_buffer_size to 512
Adding assignment ('join_buffer_size', '512') with weight 1
Assignment ('join_buffer_size', '512') extracted from "innodb_buffer_pool_size = 512
innodb_log_buffer_size = 8
sort_buffer_size = 1024
read_buffer_size = 1024
read_rnd_buffer_size = 4096
join_buffer_size = 1024
thread_stack = 192 innodb_log_buffer_size "
Hint counter: 84
Episode hint counter before: 3
Episode hint counter: 4
Hints per episode: 20
Done flag: False
No warmup - hint counter: 84
{'sequence': '512', 'labels': ['Use recommendation', 'Increase recommendation', 'Decrease recommendation strongly', 'Increase recommendation strongly', 'Decrease recommendation'], 'scores': [0.2637619078159332, 0.19082817435264587, 0.18853892385959625, 0.18315310776233673, 0.17371782660484314]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(0, 20), match='read_rnd_buffer_size'>, value=<re.Match object; span=(0, 3), match='512'>, recommendation='512', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=512.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18853892385959625, 0.17371782660484314, 0.2637619078159332, 0.19082817435264587, 0.18315310776233673]
Choice: 1
Done flag: False
No warmup - hint counter: 84
{'sequence': '512', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.45673248171806335, 0.20234665274620056, 0.1712857037782669, 0.14736124873161316, 0.022273913025856018]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(0, 20), match='read_rnd_buffer_size'>, value=<re.Match object; span=(0, 3), match='512'>, recommendation='512', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=512.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.022273913025856018, 0.45673248171806335, 0.20234665274620056, 0.1712857037782669, 0.14736124873161316]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(0, 20), match='read_rnd_buffer_size'>, value=<re.Match object; span=(0, 3), match='512'>, recommendation='512', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=512.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18853892385959625, 0.17371782660484314, 0.2637619078159332, 0.19082817435264587, 0.18315310776233673]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(0, 20), match='read_rnd_buffer_size'>, value=<re.Match object; span=(0, 3), match='512'>, recommendation='512', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=512.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.022273913025856018, 0.45673248171806335, 0.20234665274620056, 0.1712857037782669, 0.14736124873161316]
Choice: 0
Trying update set global read_rnd_buffer_size=512
Trying update set global read_rnd_buffer_size=262144
Trying assigning read_rnd_buffer_size to 512
Adding assignment ('read_rnd_buffer_size', '512') with weight 1
Assignment ('read_rnd_buffer_size', '512') extracted from "read_rnd_buffer_size = 512
join_buffer_size = 2048
thread_stack = 512
binlog_cache_size = 64
thread_cache_size = 16
table_open_cache = 2048
max_connections = 200
PHP:
max_children = 4 thread_cache_size "
Hint counter: 85
Episode hint counter before: 4
Episode hint counter: 5
Hints per episode: 20
Done flag: False
No warmup - hint counter: 85
{'sequence': '4096', 'labels': ['Use recommendation', 'Decrease recommendation', 'Decrease recommendation strongly', 'Increase recommendation strongly', 'Increase recommendation'], 'scores': [0.27467942237854004, 0.20756587386131287, 0.1929043084383011, 0.16955099999904633, 0.1552993506193161]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(105, 125), match='read_rnd_buffer_size'>, value=<re.Match object; span=(0, 4), match='4096'>, recommendation='4096', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=4096.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1929043084383011, 0.20756587386131287, 0.27467942237854004, 0.1552993506193161, 0.16955099999904633]
Choice: 4
Done flag: False
No warmup - hint counter: 85
{'sequence': '4096', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4537006616592407, 0.2012118697166443, 0.17119792103767395, 0.14479291439056396, 0.029096694663167]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(105, 125), match='read_rnd_buffer_size'>, value=<re.Match object; span=(0, 4), match='4096'>, recommendation='4096', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=4096.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.029096694663167, 0.4537006616592407, 0.2012118697166443, 0.17119792103767395, 0.14479291439056396]
Choice: 2
Trying update set global read_rnd_buffer_size=16384
Trying update set global read_rnd_buffer_size=262144
Trying assigning read_rnd_buffer_size to 16384
Adding assignment ('read_rnd_buffer_size', '16384') with weight 4
Assignment ('read_rnd_buffer_size', '16384') extracted from "innodb_buffer_pool_size = 512
innodb_log_buffer_size = 8
sort_buffer_size = 1024
read_buffer_size = 1024
read_rnd_buffer_size = 4096
join_buffer_size = 1024
thread_stack = 192 innodb_log_buffer_size "
Hint counter: 86
Episode hint counter before: 5
Episode hint counter: 6
Hints per episode: 20
Done flag: False
No warmup - hint counter: 86
{'sequence': '256', 'labels': ['Use recommendation', 'Decrease recommendation strongly', 'Decrease recommendation', 'Increase recommendation strongly', 'Increase recommendation'], 'scores': [0.26477310061454773, 0.21567395329475403, 0.18666331470012665, 0.18013955652713776, 0.15275011956691742]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(149, 165), match='read_buffer_size'>, value=<re.Match object; span=(0, 3), match='256'>, recommendation='256', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=256.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.21567395329475403, 0.18666331470012665, 0.26477310061454773, 0.15275011956691742, 0.18013955652713776]
Choice: 2
Done flag: False
No warmup - hint counter: 86
{'sequence': '256', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4565011262893677, 0.20721030235290527, 0.16764211654663086, 0.1437726467847824, 0.024873826652765274]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(149, 165), match='read_buffer_size'>, value=<re.Match object; span=(0, 3), match='256'>, recommendation='256', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=256.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.024873826652765274, 0.4565011262893677, 0.20721030235290527, 0.16764211654663086, 0.1437726467847824]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(149, 165), match='read_buffer_size'>, value=<re.Match object; span=(0, 3), match='256'>, recommendation='256', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=256.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.21567395329475403, 0.18666331470012665, 0.26477310061454773, 0.15275011956691742, 0.18013955652713776]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(149, 165), match='read_buffer_size'>, value=<re.Match object; span=(0, 3), match='256'>, recommendation='256', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=256.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.024873826652765274, 0.4565011262893677, 0.20721030235290527, 0.16764211654663086, 0.1437726467847824]
Choice: 0
Trying update set global read_buffer_size=256
Trying update set global read_buffer_size=131072
Trying assigning read_buffer_size to 256
Adding assignment ('read_buffer_size', '256') with weight 1
Assignment ('read_buffer_size', '256') extracted from "key_buffer_size = 1200
query_cache_size = 50
tmp_table_size = 128
innodb_buffer_pool_size = 4096
innodb_log_buffer_size = 32
sort_buffer_size = 2048
read_buffer_size = 256 key_buffer_size "
Hint counter: 87
Episode hint counter before: 6
Episode hint counter: 7
Hints per episode: 20
Done flag: False
No warmup - hint counter: 87
{'sequence': '1024', 'labels': ['Use recommendation', 'Increase recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Decrease recommendation'], 'scores': [0.28181496262550354, 0.2019103467464447, 0.19123758375644684, 0.16487236320972443, 0.1601647138595581]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(81, 97), match='read_buffer_size'>, value=<re.Match object; span=(0, 4), match='1024'>, recommendation='1024', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=1024.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.16487236320972443, 0.1601647138595581, 0.28181496262550354, 0.2019103467464447, 0.19123758375644684]
Choice: 2
Done flag: False
No warmup - hint counter: 87
{'sequence': '1024', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.41018953919410706, 0.21158428490161896, 0.18349096179008484, 0.17497636377811432, 0.019758854061365128]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(81, 97), match='read_buffer_size'>, value=<re.Match object; span=(0, 4), match='1024'>, recommendation='1024', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=1024.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.019758854061365128, 0.41018953919410706, 0.21158428490161896, 0.18349096179008484, 0.17497636377811432]
Choice: 0
Trying update set global read_buffer_size=1024
Trying update set global read_buffer_size=131072
Trying assigning read_buffer_size to 1024
Adding assignment ('read_buffer_size', '1024') with weight 1
Assignment ('read_buffer_size', '1024') extracted from "innodb_buffer_pool_size = 512
innodb_log_buffer_size = 8
sort_buffer_size = 1024
read_buffer_size = 1024
read_rnd_buffer_size = 4096
join_buffer_size = 1024
thread_stack = 192 innodb_log_buffer_size "
Hint counter: 88
Episode hint counter before: 7
Episode hint counter: 8
Hints per episode: 20
Done flag: False
No warmup - hint counter: 88
{'sequence': '8192 minimum value', 'labels': ['Use recommendation', 'Decrease recommendation strongly', 'Decrease recommendation', 'Increase recommendation strongly', 'Increase recommendation'], 'scores': [0.3612131178379059, 0.22560782730579376, 0.20574815571308136, 0.12235478311777115, 0.08507612347602844]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(23, 39), match='read_buffer_size'>, value=<re.Match object; span=(0, 4), match='8192'>, recommendation='8192 minimum value', passage="sort_buffer_size = 10M\nread_buffer_size = 10M ( always on mysql configuration use M (MB) because if you use 1024 is translated to bytes and the sort_buffer_size have a minimum value of 32768 bytes so that's being said, 1024 is a useless number used two times in the above configuration, read_buffer_size have a 8192 minimum value) read_buffer_size ", float_val=8192.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.22560782730579376, 0.20574815571308136, 0.3612131178379059, 0.08507612347602844, 0.12235478311777115]
Choice: 1
Done flag: False
No warmup - hint counter: 88
{'sequence': '8192 minimum value', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4772242307662964, 0.21026545763015747, 0.1587396264076233, 0.12528249621391296, 0.028488151729106903]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(23, 39), match='read_buffer_size'>, value=<re.Match object; span=(0, 4), match='8192'>, recommendation='8192 minimum value', passage="sort_buffer_size = 10M\nread_buffer_size = 10M ( always on mysql configuration use M (MB) because if you use 1024 is translated to bytes and the sort_buffer_size have a minimum value of 32768 bytes so that's being said, 1024 is a useless number used two times in the above configuration, read_buffer_size have a 8192 minimum value) read_buffer_size ", float_val=8192.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.028488151729106903, 0.4772242307662964, 0.21026545763015747, 0.1587396264076233, 0.12528249621391296]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(23, 39), match='read_buffer_size'>, value=<re.Match object; span=(0, 4), match='8192'>, recommendation='8192 minimum value', passage="sort_buffer_size = 10M\nread_buffer_size = 10M ( always on mysql configuration use M (MB) because if you use 1024 is translated to bytes and the sort_buffer_size have a minimum value of 32768 bytes so that's being said, 1024 is a useless number used two times in the above configuration, read_buffer_size have a 8192 minimum value) read_buffer_size ", float_val=8192.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.22560782730579376, 0.20574815571308136, 0.3612131178379059, 0.08507612347602844, 0.12235478311777115]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(23, 39), match='read_buffer_size'>, value=<re.Match object; span=(0, 4), match='8192'>, recommendation='8192 minimum value', passage="sort_buffer_size = 10M\nread_buffer_size = 10M ( always on mysql configuration use M (MB) because if you use 1024 is translated to bytes and the sort_buffer_size have a minimum value of 32768 bytes so that's being said, 1024 is a useless number used two times in the above configuration, read_buffer_size have a 8192 minimum value) read_buffer_size ", float_val=8192.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.028488151729106903, 0.4772242307662964, 0.21026545763015747, 0.1587396264076233, 0.12528249621391296]
Choice: 4
Trying update set global read_buffer_size=16384
Trying update set global read_buffer_size=131072
Trying assigning read_buffer_size to 16384
Adding assignment ('read_buffer_size', '16384') with weight 16
Assignment ('read_buffer_size', '16384') extracted from "sort_buffer_size = 10M
read_buffer_size = 10M ( always on mysql configuration use M (MB) because if you use 1024 is translated to bytes and the sort_buffer_size have a minimum value of 32768 bytes so that's being said, 1024 is a useless number used two times in the above configuration, read_buffer_size have a 8192 minimum value) read_buffer_size "
Hint counter: 89
Episode hint counter before: 8
Episode hint counter: 9
Hints per episode: 20
Done flag: False
No warmup - hint counter: 89
{'sequence': '64', 'labels': ['Use recommendation', 'Increase recommendation strongly', 'Decrease recommendation strongly', 'Decrease recommendation', 'Increase recommendation'], 'scores': [0.2561816871166229, 0.20899151265621185, 0.20224447548389435, 0.18172581493854523, 0.15085653960704803]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(70, 87), match='binlog_cache_size'>, value=<re.Match object; span=(0, 2), match='64'>, recommendation='64', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20224447548389435, 0.18172581493854523, 0.2561816871166229, 0.15085653960704803, 0.20899151265621185]
Choice: 1
Done flag: False
No warmup - hint counter: 89
{'sequence': '64', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.460867315530777, 0.20801353454589844, 0.16750642657279968, 0.13584065437316895, 0.027772024273872375]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(70, 87), match='binlog_cache_size'>, value=<re.Match object; span=(0, 2), match='64'>, recommendation='64', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.027772024273872375, 0.460867315530777, 0.20801353454589844, 0.16750642657279968, 0.13584065437316895]
Choice: 0
Trying update set global binlog_cache_size=32
Trying update set global binlog_cache_size=32768
Trying assigning binlog_cache_size to 32
Adding assignment ('binlog_cache_size', '32') with weight 1
Assignment ('binlog_cache_size', '32') extracted from "read_rnd_buffer_size = 512
join_buffer_size = 2048
thread_stack = 512
binlog_cache_size = 64
thread_cache_size = 16
table_open_cache = 2048
max_connections = 200
PHP:
max_children = 4 thread_cache_size "
Hint counter: 90
Episode hint counter before: 9
Episode hint counter: 10
Hints per episode: 20
Done flag: False
No warmup - hint counter: 90
{'sequence': '32', 'labels': ['Use recommendation', 'Decrease recommendation strongly', 'Decrease recommendation', 'Increase recommendation strongly', 'Increase recommendation'], 'scores': [0.26641327142715454, 0.19402799010276794, 0.19214743375778198, 0.1895178258419037, 0.15789352357387543]}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(0, 17), match='binlog_cache_size'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19402799010276794, 0.19214743375778198, 0.26641327142715454, 0.15789352357387543, 0.1895178258419037]
Choice: 1
Done flag: False
No warmup - hint counter: 90
{'sequence': '32', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.46463149785995483, 0.20161142945289612, 0.1676764339208603, 0.13865259289741516, 0.027428098022937775]}
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(0, 17), match='binlog_cache_size'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.027428098022937775, 0.46463149785995483, 0.20161142945289612, 0.1676764339208603, 0.13865259289741516]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(0, 17), match='binlog_cache_size'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19402799010276794, 0.19214743375778198, 0.26641327142715454, 0.15789352357387543, 0.1895178258419037]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(0, 17), match='binlog_cache_size'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.027428098022937775, 0.46463149785995483, 0.20161142945289612, 0.1676764339208603, 0.13865259289741516]
Choice: 0
Trying update set global binlog_cache_size=64
Trying update set global binlog_cache_size=32768
Trying assigning binlog_cache_size to 64
Adding assignment ('binlog_cache_size', '64') with weight 1
Assignment ('binlog_cache_size', '64') extracted from "binlog_cache_size = 32
thread_cache_size = 8
table_open_cache = 64
max_connections = 20
PHP:
max_children = 10
start_servers = 2
min_spare_servers = 1
max_spare_servers = 3 binlog_stmt_cache_size "
Hint counter: 91
Episode hint counter before: 10
Episode hint counter: 11
Hints per episode: 20
Done flag: False
No warmup - hint counter: 91
{'sequence': '50M', 'labels': ['Use recommendation', 'Decrease recommendation', 'Decrease recommendation strongly', 'Increase recommendation strongly', 'Increase recommendation'], 'scores': [0.2992051839828491, 0.18822643160820007, 0.18395723402500153, 0.1785123348236084, 0.15009883046150208]}
Decision: Deciding adaption of TuningHint(doc_id=63, param=<re.Match object; span=(30, 47), match='query_cache_limit'>, value=<re.Match object; span=(0, 3), match='50M'>, recommendation='50M', passage='# * Query Cache Configuration\nquery_cache_limit\n= 50M\nquery_cache_size\n= 300M\n# * Logging and Replication\n# * InnoDB\n# InnoDB is enabled by default with a 10MB datafile in /var/lib/mysql/. query_cache_limit ', float_val=50.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18395723402500153, 0.18822643160820007, 0.2992051839828491, 0.15009883046150208, 0.1785123348236084]
Choice: 1
Done flag: False
No warmup - hint counter: 91
{'sequence': '50M', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.4569627642631531, 0.20047272741794586, 0.17280185222625732, 0.14727100729942322, 0.022491659969091415]}
Decision: Deciding weight of TuningHint(doc_id=63, param=<re.Match object; span=(30, 47), match='query_cache_limit'>, value=<re.Match object; span=(0, 3), match='50M'>, recommendation='50M', passage='# * Query Cache Configuration\nquery_cache_limit\n= 50M\nquery_cache_size\n= 300M\n# * Logging and Replication\n# * InnoDB\n# InnoDB is enabled by default with a 10MB datafile in /var/lib/mysql/. query_cache_limit ', float_val=50.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.022491659969091415, 0.4569627642631531, 0.20047272741794586, 0.17280185222625732, 0.14727100729942322]
Choice: 2
Trying update set global query_cache_limit=26214400
Trying update set global query_cache_limit=1048576
Trying assigning query_cache_limit to 25M
Adding assignment ('query_cache_limit', '25M') with weight 4
Assignment ('query_cache_limit', '25M') extracted from "# * Query Cache Configuration
query_cache_limit
= 50M
query_cache_size
= 300M
# * Logging and Replication
# * InnoDB
# InnoDB is enabled by default with a 10MB datafile in /var/lib/mysql/. query_cache_limit "
Hint counter: 92
Episode hint counter before: 11
Episode hint counter: 12
Hints per episode: 20
Done flag: False
No warmup - hint counter: 92
{'sequence': '6', 'labels': ['Increase recommendation strongly', 'Use recommendation', 'Decrease recommendation strongly', 'Increase recommendation', 'Decrease recommendation'], 'scores': [0.23660901188850403, 0.23435266315937042, 0.19875401258468628, 0.1751263439655304, 0.15515796840190887]}
Decision: Deciding adaption of TuningHint(doc_id=63, param=<re.Match object; span=(138, 159), match='innodb_force_recovery'>, value=<re.Match object; span=(0, 1), match='6'>, recommendation='6', passage='max_connections\n= 500\nmax_user_connections\n= 500\n#table_cache\n= 64\nthread_concurrency\n= 300\ntable_cache\n= 30000\nopen_files_limit\n= 65000\n#innodb_force_recovery =6 max_binlog_stmt_cache_size ', float_val=6.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19875401258468628, 0.15515796840190887, 0.23435266315937042, 0.1751263439655304, 0.23660901188850403]
Choice: 3
Done flag: False
No warmup - hint counter: 92
{'sequence': '6', 'labels': ['This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.', 'This hint is not important.'], 'scores': [0.48199930787086487, 0.197042778134346, 0.15717408061027527, 0.13847839832305908, 0.025305401533842087]}
Decision: Deciding weight of TuningHint(doc_id=63, param=<re.Match object; span=(138, 159), match='innodb_force_recovery'>, value=<re.Match object; span=(0, 1), match='6'>, recommendation='6', passage='max_connections\n= 500\nmax_user_connections\n= 500\n#table_cache\n= 64\nthread_concurrency\n= 300\ntable_cache\n= 30000\nopen_files_limit\n= 65000\n#innodb_force_recovery =6 max_binlog_stmt_cache_size ', float_val=6.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.025305401533842087, 0.48199930787086487, 0.197042778134346, 0.15717408061027527, 0.13847839832305908]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=63, param=<re.Match object; span=(138, 159), match='innodb_force_recovery'>, value=<re.Match object; span=(0, 1), match='6'>, recommendation='6', passage='max_connections\n= 500\nmax_user_connections\n= 500\n#table_cache\n= 64\nthread_concurrency\n= 300\ntable_cache\n= 30000\nopen_files_limit\n= 65000\n#innodb_force_recovery =6 max_binlog_stmt_cache_size ', float_val=6.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19875401258468628, 0.15515796840190887, 0.23435266315937042, 0.1751263439655304, 0.23660901188850403]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=63, param=<re.Match object; span=(138, 159), match='innodb_force_recovery'>, value=<re.Match object; span=(0, 1), match='6'>, recommendation='6', passage='max_connections\n= 500\nmax_user_connections\n= 500\n#table_cache\n= 64\nthread_concurrency\n= 300\ntable_cache\n= 30000\nopen_files_limit\n= 65000\n#innodb_force_recovery =6 max_binlog_stmt_cache_size ', float_val=6.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.025305401533842087, 0.48199930787086487, 0.197042778134346, 0.15717408061027527, 0.13847839832305908]
Choice: 0
Trying update set global innodb_force_recovery=6
Exception during update: Variable 'innodb_force_recovery' is a read only variable
Trying update set global innodb_force_recovery=0
Exception during update: Variable 'innodb_force_recovery' is a read only variable
Trying assigning innodb_force_recovery to 6
Assignment ('innodb_force_recovery', '6') was rejected
Hint counter: 93
Episode hint counter before: 12
Episode hint counter: 13
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(568, 585), match='thread_cache_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16 or so', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18521332740783691, 0.1852453649044037, 0.28911828994750977, 0.15424436330795288, 0.18617865443229675]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(568, 585), match='thread_cache_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16 or so', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.028563059866428375, 0.50733482837677, 0.1963784247636795, 0.14746752381324768, 0.12025613337755203]
Choice: 1
Trying update set global thread_cache_size=16
Trying update set global thread_cache_size=100
Trying assigning thread_cache_size to 16
Adding assignment ('thread_cache_size', '16') with weight 2
Assignment ('thread_cache_size', '16') extracted from "Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).
Adjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size "
Hint counter: 1
Episode hint counter before: 13
Episode hint counter: 14
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(118, 135), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1844906359910965, 0.15214183926582336, 0.266186386346817, 0.17978301644325256, 0.2173980474472046]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(118, 135), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.026791756972670555, 0.46210938692092896, 0.20298469066619873, 0.1625889241695404, 0.145525261759758]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(118, 135), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1844906359910965, 0.15214183926582336, 0.266186386346817, 0.17978301644325256, 0.2173980474472046]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(118, 135), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.026791756972670555, 0.46210938692092896, 0.20298469066619873, 0.1625889241695404, 0.145525261759758]
Choice: 1
Trying update set global thread_cache_size=2
Trying update set global thread_cache_size=100
Trying assigning thread_cache_size to 2
Adding assignment ('thread_cache_size', '2') with weight 2
Assignment ('thread_cache_size', '2') extracted from "tmp-table-size = 96M
max-heap-table-size = 96M
key_buffer_size = 64M
# Connections and Threads
max_connections = 1250
thread_cache_size = 8
max_allowed_packet = 64M thread_pool_max_threads "
Hint counter: 2
Episode hint counter before: 14
Episode hint counter: 15
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(23, 40), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1844906359910965, 0.15214183926582336, 0.266186386346817, 0.17978301644325256, 0.2173980474472046]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(23, 40), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.026791756972670555, 0.46210938692092896, 0.20298469066619873, 0.1625889241695404, 0.145525261759758]
Choice: 1
Trying update set global thread_cache_size=8
Trying update set global thread_cache_size=100
Trying assigning thread_cache_size to 8
Adding assignment ('thread_cache_size', '8') with weight 2
Assignment ('thread_cache_size', '8') extracted from "binlog_cache_size = 32
thread_cache_size = 8
table_open_cache = 64
max_connections = 20
PHP:
max_children = 10
start_servers = 2
min_spare_servers = 1
max_spare_servers = 3 binlog_stmt_cache_size "
Hint counter: 3
Episode hint counter before: 15
Episode hint counter: 16
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=63, param=<re.Match object; span=(66, 83), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8\n', passage='key_buffer\t\t= 2000M\nmax_allowed_packet\t= 16M\nthread_stack\t\t= 128K\nthread_cache_size\t= 8\n# This replaces the startup script and checks MyISAM tables if needed\n# the first time they are touched\nmyisam-recover\t\t= BACKUP table_open_cache_instances ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18013985455036163, 0.22041219472885132, 0.28335413336753845, 0.17767491936683655, 0.13841883838176727]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=63, param=<re.Match object; span=(66, 83), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8\n', passage='key_buffer\t\t= 2000M\nmax_allowed_packet\t= 16M\nthread_stack\t\t= 128K\nthread_cache_size\t= 8\n# This replaces the startup script and checks MyISAM tables if needed\n# the first time they are touched\nmyisam-recover\t\t= BACKUP table_open_cache_instances ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02484126389026642, 0.46155181527137756, 0.19460640847682953, 0.1654755026102066, 0.15352493524551392]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=63, param=<re.Match object; span=(66, 83), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8\n', passage='key_buffer\t\t= 2000M\nmax_allowed_packet\t= 16M\nthread_stack\t\t= 128K\nthread_cache_size\t= 8\n# This replaces the startup script and checks MyISAM tables if needed\n# the first time they are touched\nmyisam-recover\t\t= BACKUP table_open_cache_instances ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18013985455036163, 0.22041219472885132, 0.28335413336753845, 0.17767491936683655, 0.13841883838176727]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=63, param=<re.Match object; span=(66, 83), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8\n', passage='key_buffer\t\t= 2000M\nmax_allowed_packet\t= 16M\nthread_stack\t\t= 128K\nthread_cache_size\t= 8\n# This replaces the startup script and checks MyISAM tables if needed\n# the first time they are touched\nmyisam-recover\t\t= BACKUP table_open_cache_instances ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02484126389026642, 0.46155181527137756, 0.19460640847682953, 0.1654755026102066, 0.15352493524551392]
Choice: 4
Trying update set global thread_cache_size=16
Trying update set global thread_cache_size=100
Trying assigning thread_cache_size to 16
Adding assignment ('thread_cache_size', '16') with weight 16
Assignment ('thread_cache_size', '16') extracted from "key_buffer		= 2000M
max_allowed_packet	= 16M
thread_stack		= 128K
thread_cache_size	= 8
# This replaces the startup script and checks MyISAM tables if needed
# the first time they are touched
myisam-recover		= BACKUP table_open_cache_instances "
Hint counter: 4
Episode hint counter before: 16
Episode hint counter: 17
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=38, param=<re.Match object; span=(1999, 2014), match='max_connections'>, value=<re.Match object; span=(0, 3), match='200'>, recommendation='200', passage='hayden_james@linux\xa0aboutarticlesservicesfeedbacksponsorscontactforumsMySQL Database Performance: Avoid this common mistake March 21, 2023 by Hayden James, in Blog LinuxOne frequent topic of support request emails I receive is MySQL database performance. Clients complain about MySQL using too much server memory, too many MySQL slow queries, the famous Mysql server has gone away errors, and many other MySQL performance-related issues. As such, I wanted to share solutions to some common MySQL configuration mistakes.If you are a DBA, feel free to share your experiences or suggestions in the comments section. I’m referring to four MySQL config variables. These four my.cnf config lines are often responsible for poor MySQL database performance and scaling due to insufficient server memory for incoming connections. This article also applies to MariaDB and Percona drop-in replacements for MySQL.Note: This is an update and follow-up to this article. I’ve added some relevant and more up-to-date information and links, as well as a new section that covers some additional my.cnf performance config tips.\xa0Avoid arbitrarily increasing MySQL per-connection buffers Excerpt of my.cnf edits for a client. (some lines were removed and some blurred to avoid misuse)Who knows where or when this bad practice started. I frequently encounter instances where I log into production servers for the first time and find that the values of virtually every my.cnf variable have been arbitrarily increased without sound reasoning behind the changes.This is never a good practice, especially for four my.cnf variables discussed below. Although increasing the value of some variables can improve performance, these four will almost always degrade MySQL server performance and capacity when increased.The four buffers in question are the\xa0join_buffer_size,\xa0sort_buffer_size,\xa0read_buffer_size and read_rnd_buffer_size.These four buffers are\xa0allocated per connection. For example, a setting of join_buffer_size=1M\xa0with\xa0max_connections=200 will configure MySQL to allocate an additional 1M per connection (1M x 200). The same goes for the other three buffers. Again, all are per connection.A good rule of thumb is that if you can’t provide a valid reason to increase any of these buffers, keep them set to the default values.In nearly all cases, it’s best to keep the defaults by removing or commenting out these four config lines. As connections increase with traffic, queries that need more space than what’s available due to larger buffer settings may trigger paging those buffers to disk. This dramatically slows down your DB server and creates a bottleneck.I’ve often seen significantly improved MySQL performance by simply reverting these buffers to their defaults. Also, read Analyzing Linux server performance with atop.The above screenshot shows MySQL status output two weeks after I made the first my.cnf optimization pass. Now, let’s take a closer look at each of these buffers.\xa0MySQL join_buffer_sizeThe join_buffer_size is allocated for each full join between two tables. From MySQL’s documentation the join_buffer_size is described as: “The minimum size of the buffer that is used for plain index scans, range index scans, and joins that do not use indexes and thus perform full table scans.”MySQL’s documentation goes on to say: “Memory allocation time can cause substantial performance drops if the global size is larger than needed by most queries that use it.” The join buffer is allocated to cache table rows when the join can’t use an index.If your database suffers from many joins performed without indexes, it cannot be solved by increasing join_buffer_size. The problem is “joins performed without indexes.” Thus, the solution for faster joins is to add indexes.\xa0MySQL sort_buffer_sizeUnless you have data indicating otherwise, you should avoid arbitrarily increasing the\xa0sort_buffer_size. Memory here is also assigned per connection!MySQL’s documentation warns: “On Linux, there are thresholds of 256KB and 2MB where larger values may significantly slow down memory allocation, so you should consider staying below one of those values.”Avoid increasing sort_buffer_size above 2M since there is a performance penalty that will eliminate benefits.\xa0MySQL read_buffer_size & read_rnd_buffer_sizeUpdate: Some of you still use MyISAM over InnoDB. MyISAM is based on the old ISAM storage engine. It has many useful extensions, as discussed here. You should consider converting your MySQL tables to the InnoDB storage engine.InnoDB is the default storage engine of MySQL 5.7 and MySQL 8.0. InnoDB features improved performance, rollback and crash-recovery capabilities to protect data. read_buffer_size\xa0Applies generally to MyISAM.Each request that performs a sequential table scan allocates a read buffer. The read_buffer_size\xa0system variable determines the buffer size.Starting from MySQL 8.0.22, the value of select_into_buffer_size overrides the value of read_buffer_size when performing SELECT INTO DUMPFILE and SELECT INTO OUTFILE statements. read_buffer_size\xa0is used for the I/O cache buffer size in all other cases.The read_rnd_buffer_size variable is also used mainly for\xa0MyISAM reads from tables. Again, consider InnoDB or MariaDB’s Aria storage engines. For the past decade, the default values of these buffers have remained the same.\xa0Additional my.cnf Performance config tipsMonitor the appropriate MySQL status variable_name(s) to assist you in tuning the below config lines. An example of viewing the status of MySQL runtime variables. (So I increased max_connections)max_connectionsA MySQL configuration parameter that sets the maximum number of concurrent connections the server can handle. A value that is too large can allocate too much server memory and lead to performance issues, while a low value can result in connection rejections.To tune this parameter, monitor the max_used_connections status variable; try to set this to ~ 2x to 3x your max used connections after a few days of uptime. However, if your MySQL max connections are more than 200 then make sure to have at least 100 extra connections available. So if max_used_connections is 300 then set max_connections to at least 400. Watch memory usage!!thread_cache_sizeDetermines the number of threads that can be cached and reused by the server. Properly tuning this parameter can help improve the performance of your MySQL server by reducing the overhead of creating new threads and freeing up system resources.To tune this parameter, you can monitor the threads_created and threads_cached status variables and set the value to a reasonable number based on the number of expected concurrent connections. As a general rule, a value of 16 is a good starting point. Then increase gradually until it’s at least 50% of max_connections. For example, if the threads_cached value is 16 and the max_used_connections value is 40 then increase this from 16 to 32. At the same time, as per above advice, if max_used_connections is 40 then your max_connections should be at least 80.table_definition_cacheA MySQL configuration parameter that sets the number of table definitions (metadata) that can be stored in the cache. A high value of table_definition_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of reading the table definition from disk.To tune this parameter, monitor the opened_table_definitions and open_table_definitionsstatus variables, set table_definition_cache to ~ 2x the number of open table definitions and adjust as needed. Consider other factors, such as system memory and query complexity when tuning. .table_open_cacheA MySQL configuration parameter that sets the number of open table objects that can be stored in the cache. A high value of table_open_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of opening tables from disk.To tune this parameter, monitor the opened_tables and open_tables status variables, set table_open_cache to ~ 2x the number of open tables, and adjust as needed. Consider other factors such as memory and query complexity when tuning. Generally table_open_cache and table_definition_cache are set to the same value. The number of open table objects and table definitions are directly related, so setting these two parameters to the same value can ensure that the metadata and open table objects are stored in the cache in a consistent and efficient manner.wait_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on a non-interactive connection before closing it. A high value of wait_timeout can result in increased memory usage and increased # of connections, while a low value can result in frequent disconnections for long-running queries.To tune this parameter, set wait_timeout to the lowest resonable expected duration of non-interactive connections, and adjust as needed. The default value is 28800 seconds. This is way to high in most cases and will consume a lot of system memory by keeping many connections open. I set most of my configs to 30 seconds or less.connect_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for a successful connection to be established before timing out. A high value of connect_timeout can result in increased wait time for clients and increase in max_connections. A low value can result in connection failures for slow or heavily loaded servers.To tune this parameter, set connect_timeout to a reasonable value based on the expected response time of the server. Consider other factors such as network latency, mobile users, and server load when tuning. I set most of my configs to 15 seconds or less. For example, this blog’s mysql connection timeout is set to 5 seconds.interactive_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on an interactive connection before closing it. A high value of interactive_timeout can result in increased memory usage and increased concurrent connetions. A low value can result in frequent disconnections for long-running queries.To tune this parameter, set interactive_timeout to a reasonable value based on the expected duration of your longest-running requests.tmp_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables used by the server. When a query creates a temporary table that exceeds the value of tmp_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set tmp_table_size to a reasonable value based on the available memory and the value of the created_tmp_disk_table variable.max_heap_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables created with the MEMORY storage engine. When a query creates a temporary table that exceeds the value of max_heap_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set max_heap_table_size to the same value as tmp_table_size.Want more tips?For example, Innodb tuning tips, setting open_files_limit, etc. Let me know your interests in the comments section below, or hire me for MySQL optimization.\xa0Additional MySQL performance related articlesMySQL Performance Tuning: Tips, Scripts and Tools.MySQL Performance: Stop hoarding. Drop unused MySQL databases.“MySQL server has gone away” error – Solution(s).Could not increase number of max_open_files to more than… (Solution).Linux server performance: Is disk I/O slowing your application?Tuning MySQL my.cnf? Avoid this common pitfall!\xa0ConclusionIn conclusion, we discussed some common issues with MySQL performance often raised in support requests. The focus was on four specific my.cnf variables frequently responsible for poor database performance and scaling due to a shortage of server memory.It was emphasized that arbitrarily increasing these variables can lead to a decline in MySQL server performance and capacity and that it is important to keep these buffers set to their default values unless there is a specific reason to increase them. Then we covered tuning some additional MySQL performance config lines.A good rule of thumb: if you can’t provide a valid reason for increasing these buffers, keep them set to the default values. This also applies less strictly to all of MySQL’s variables. Be careful when making changes, don’t overwrite your entire my.cnf all at once. Back up everything first, make one or two changes per restart and test for 24 to 48 hours before making another pass. wsrep_mysql_replication_bundle ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20448258519172668, 0.20679712295532227, 0.24968837201595306, 0.1696714460849762, 0.16936053335666656]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=38, param=<re.Match object; span=(1999, 2014), match='max_connections'>, value=<re.Match object; span=(0, 3), match='200'>, recommendation='200', passage='hayden_james@linux\xa0aboutarticlesservicesfeedbacksponsorscontactforumsMySQL Database Performance: Avoid this common mistake March 21, 2023 by Hayden James, in Blog LinuxOne frequent topic of support request emails I receive is MySQL database performance. Clients complain about MySQL using too much server memory, too many MySQL slow queries, the famous Mysql server has gone away errors, and many other MySQL performance-related issues. As such, I wanted to share solutions to some common MySQL configuration mistakes.If you are a DBA, feel free to share your experiences or suggestions in the comments section. I’m referring to four MySQL config variables. These four my.cnf config lines are often responsible for poor MySQL database performance and scaling due to insufficient server memory for incoming connections. This article also applies to MariaDB and Percona drop-in replacements for MySQL.Note: This is an update and follow-up to this article. I’ve added some relevant and more up-to-date information and links, as well as a new section that covers some additional my.cnf performance config tips.\xa0Avoid arbitrarily increasing MySQL per-connection buffers Excerpt of my.cnf edits for a client. (some lines were removed and some blurred to avoid misuse)Who knows where or when this bad practice started. I frequently encounter instances where I log into production servers for the first time and find that the values of virtually every my.cnf variable have been arbitrarily increased without sound reasoning behind the changes.This is never a good practice, especially for four my.cnf variables discussed below. Although increasing the value of some variables can improve performance, these four will almost always degrade MySQL server performance and capacity when increased.The four buffers in question are the\xa0join_buffer_size,\xa0sort_buffer_size,\xa0read_buffer_size and read_rnd_buffer_size.These four buffers are\xa0allocated per connection. For example, a setting of join_buffer_size=1M\xa0with\xa0max_connections=200 will configure MySQL to allocate an additional 1M per connection (1M x 200). The same goes for the other three buffers. Again, all are per connection.A good rule of thumb is that if you can’t provide a valid reason to increase any of these buffers, keep them set to the default values.In nearly all cases, it’s best to keep the defaults by removing or commenting out these four config lines. As connections increase with traffic, queries that need more space than what’s available due to larger buffer settings may trigger paging those buffers to disk. This dramatically slows down your DB server and creates a bottleneck.I’ve often seen significantly improved MySQL performance by simply reverting these buffers to their defaults. Also, read Analyzing Linux server performance with atop.The above screenshot shows MySQL status output two weeks after I made the first my.cnf optimization pass. Now, let’s take a closer look at each of these buffers.\xa0MySQL join_buffer_sizeThe join_buffer_size is allocated for each full join between two tables. From MySQL’s documentation the join_buffer_size is described as: “The minimum size of the buffer that is used for plain index scans, range index scans, and joins that do not use indexes and thus perform full table scans.”MySQL’s documentation goes on to say: “Memory allocation time can cause substantial performance drops if the global size is larger than needed by most queries that use it.” The join buffer is allocated to cache table rows when the join can’t use an index.If your database suffers from many joins performed without indexes, it cannot be solved by increasing join_buffer_size. The problem is “joins performed without indexes.” Thus, the solution for faster joins is to add indexes.\xa0MySQL sort_buffer_sizeUnless you have data indicating otherwise, you should avoid arbitrarily increasing the\xa0sort_buffer_size. Memory here is also assigned per connection!MySQL’s documentation warns: “On Linux, there are thresholds of 256KB and 2MB where larger values may significantly slow down memory allocation, so you should consider staying below one of those values.”Avoid increasing sort_buffer_size above 2M since there is a performance penalty that will eliminate benefits.\xa0MySQL read_buffer_size & read_rnd_buffer_sizeUpdate: Some of you still use MyISAM over InnoDB. MyISAM is based on the old ISAM storage engine. It has many useful extensions, as discussed here. You should consider converting your MySQL tables to the InnoDB storage engine.InnoDB is the default storage engine of MySQL 5.7 and MySQL 8.0. InnoDB features improved performance, rollback and crash-recovery capabilities to protect data. read_buffer_size\xa0Applies generally to MyISAM.Each request that performs a sequential table scan allocates a read buffer. The read_buffer_size\xa0system variable determines the buffer size.Starting from MySQL 8.0.22, the value of select_into_buffer_size overrides the value of read_buffer_size when performing SELECT INTO DUMPFILE and SELECT INTO OUTFILE statements. read_buffer_size\xa0is used for the I/O cache buffer size in all other cases.The read_rnd_buffer_size variable is also used mainly for\xa0MyISAM reads from tables. Again, consider InnoDB or MariaDB’s Aria storage engines. For the past decade, the default values of these buffers have remained the same.\xa0Additional my.cnf Performance config tipsMonitor the appropriate MySQL status variable_name(s) to assist you in tuning the below config lines. An example of viewing the status of MySQL runtime variables. (So I increased max_connections)max_connectionsA MySQL configuration parameter that sets the maximum number of concurrent connections the server can handle. A value that is too large can allocate too much server memory and lead to performance issues, while a low value can result in connection rejections.To tune this parameter, monitor the max_used_connections status variable; try to set this to ~ 2x to 3x your max used connections after a few days of uptime. However, if your MySQL max connections are more than 200 then make sure to have at least 100 extra connections available. So if max_used_connections is 300 then set max_connections to at least 400. Watch memory usage!!thread_cache_sizeDetermines the number of threads that can be cached and reused by the server. Properly tuning this parameter can help improve the performance of your MySQL server by reducing the overhead of creating new threads and freeing up system resources.To tune this parameter, you can monitor the threads_created and threads_cached status variables and set the value to a reasonable number based on the number of expected concurrent connections. As a general rule, a value of 16 is a good starting point. Then increase gradually until it’s at least 50% of max_connections. For example, if the threads_cached value is 16 and the max_used_connections value is 40 then increase this from 16 to 32. At the same time, as per above advice, if max_used_connections is 40 then your max_connections should be at least 80.table_definition_cacheA MySQL configuration parameter that sets the number of table definitions (metadata) that can be stored in the cache. A high value of table_definition_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of reading the table definition from disk.To tune this parameter, monitor the opened_table_definitions and open_table_definitionsstatus variables, set table_definition_cache to ~ 2x the number of open table definitions and adjust as needed. Consider other factors, such as system memory and query complexity when tuning. .table_open_cacheA MySQL configuration parameter that sets the number of open table objects that can be stored in the cache. A high value of table_open_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of opening tables from disk.To tune this parameter, monitor the opened_tables and open_tables status variables, set table_open_cache to ~ 2x the number of open tables, and adjust as needed. Consider other factors such as memory and query complexity when tuning. Generally table_open_cache and table_definition_cache are set to the same value. The number of open table objects and table definitions are directly related, so setting these two parameters to the same value can ensure that the metadata and open table objects are stored in the cache in a consistent and efficient manner.wait_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on a non-interactive connection before closing it. A high value of wait_timeout can result in increased memory usage and increased # of connections, while a low value can result in frequent disconnections for long-running queries.To tune this parameter, set wait_timeout to the lowest resonable expected duration of non-interactive connections, and adjust as needed. The default value is 28800 seconds. This is way to high in most cases and will consume a lot of system memory by keeping many connections open. I set most of my configs to 30 seconds or less.connect_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for a successful connection to be established before timing out. A high value of connect_timeout can result in increased wait time for clients and increase in max_connections. A low value can result in connection failures for slow or heavily loaded servers.To tune this parameter, set connect_timeout to a reasonable value based on the expected response time of the server. Consider other factors such as network latency, mobile users, and server load when tuning. I set most of my configs to 15 seconds or less. For example, this blog’s mysql connection timeout is set to 5 seconds.interactive_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on an interactive connection before closing it. A high value of interactive_timeout can result in increased memory usage and increased concurrent connetions. A low value can result in frequent disconnections for long-running queries.To tune this parameter, set interactive_timeout to a reasonable value based on the expected duration of your longest-running requests.tmp_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables used by the server. When a query creates a temporary table that exceeds the value of tmp_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set tmp_table_size to a reasonable value based on the available memory and the value of the created_tmp_disk_table variable.max_heap_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables created with the MEMORY storage engine. When a query creates a temporary table that exceeds the value of max_heap_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set max_heap_table_size to the same value as tmp_table_size.Want more tips?For example, Innodb tuning tips, setting open_files_limit, etc. Let me know your interests in the comments section below, or hire me for MySQL optimization.\xa0Additional MySQL performance related articlesMySQL Performance Tuning: Tips, Scripts and Tools.MySQL Performance: Stop hoarding. Drop unused MySQL databases.“MySQL server has gone away” error – Solution(s).Could not increase number of max_open_files to more than… (Solution).Linux server performance: Is disk I/O slowing your application?Tuning MySQL my.cnf? Avoid this common pitfall!\xa0ConclusionIn conclusion, we discussed some common issues with MySQL performance often raised in support requests. The focus was on four specific my.cnf variables frequently responsible for poor database performance and scaling due to a shortage of server memory.It was emphasized that arbitrarily increasing these variables can lead to a decline in MySQL server performance and capacity and that it is important to keep these buffers set to their default values unless there is a specific reason to increase them. Then we covered tuning some additional MySQL performance config lines.A good rule of thumb: if you can’t provide a valid reason for increasing these buffers, keep them set to the default values. This also applies less strictly to all of MySQL’s variables. Be careful when making changes, don’t overwrite your entire my.cnf all at once. Back up everything first, make one or two changes per restart and test for 24 to 48 hours before making another pass. wsrep_mysql_replication_bundle ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.023928122594952583, 0.4574962556362152, 0.20133262872695923, 0.16734036803245544, 0.14990268647670746]
Choice: 1
Trying update set global max_connections=50
Trying update set global max_connections=100
Trying assigning max_connections to 50
Adding assignment ('max_connections', '50') with weight 2
Assignment ('max_connections', '50') extracted from "hayden_james@linux aboutarticlesservicesfeedbacksponsorscontactforumsMySQL Database Performance: Avoid this common mistake March 21, 2023 by Hayden James, in Blog LinuxOne frequent topic of support request emails I receive is MySQL database performance. Clients complain about MySQL using too much server memory, too many MySQL slow queries, the famous Mysql server has gone away errors, and many other MySQL performance-related issues. As such, I wanted to share solutions to some common MySQL configuration mistakes.If you are a DBA, feel free to share your experiences or suggestions in the comments section. I’m referring to four MySQL config variables. These four my.cnf config lines are often responsible for poor MySQL database performance and scaling due to insufficient server memory for incoming connections. This article also applies to MariaDB and Percona drop-in replacements for MySQL.Note: This is an update and follow-up to this article. I’ve added some relevant and more up-to-date information and links, as well as a new section that covers some additional my.cnf performance config tips. Avoid arbitrarily increasing MySQL per-connection buffers Excerpt of my.cnf edits for a client. (some lines were removed and some blurred to avoid misuse)Who knows where or when this bad practice started. I frequently encounter instances where I log into production servers for the first time and find that the values of virtually every my.cnf variable have been arbitrarily increased without sound reasoning behind the changes.This is never a good practice, especially for four my.cnf variables discussed below. Although increasing the value of some variables can improve performance, these four will almost always degrade MySQL server performance and capacity when increased.The four buffers in question are the join_buffer_size, sort_buffer_size, read_buffer_size and read_rnd_buffer_size.These four buffers are allocated per connection. For example, a setting of join_buffer_size=1M with max_connections=200 will configure MySQL to allocate an additional 1M per connection (1M x 200). The same goes for the other three buffers. Again, all are per connection.A good rule of thumb is that if you can’t provide a valid reason to increase any of these buffers, keep them set to the default values.In nearly all cases, it’s best to keep the defaults by removing or commenting out these four config lines. As connections increase with traffic, queries that need more space than what’s available due to larger buffer settings may trigger paging those buffers to disk. This dramatically slows down your DB server and creates a bottleneck.I’ve often seen significantly improved MySQL performance by simply reverting these buffers to their defaults. Also, read Analyzing Linux server performance with atop.The above screenshot shows MySQL status output two weeks after I made the first my.cnf optimization pass. Now, let’s take a closer look at each of these buffers. MySQL join_buffer_sizeThe join_buffer_size is allocated for each full join between two tables. From MySQL’s documentation the join_buffer_size is described as: “The minimum size of the buffer that is used for plain index scans, range index scans, and joins that do not use indexes and thus perform full table scans.”MySQL’s documentation goes on to say: “Memory allocation time can cause substantial performance drops if the global size is larger than needed by most queries that use it.” The join buffer is allocated to cache table rows when the join can’t use an index.If your database suffers from many joins performed without indexes, it cannot be solved by increasing join_buffer_size. The problem is “joins performed without indexes.” Thus, the solution for faster joins is to add indexes. MySQL sort_buffer_sizeUnless you have data indicating otherwise, you should avoid arbitrarily increasing the sort_buffer_size. Memory here is also assigned per connection!MySQL’s documentation warns: “On Linux, there are thresholds of 256KB and 2MB where larger values may significantly slow down memory allocation, so you should consider staying below one of those values.”Avoid increasing sort_buffer_size above 2M since there is a performance penalty that will eliminate benefits. MySQL read_buffer_size & read_rnd_buffer_sizeUpdate: Some of you still use MyISAM over InnoDB. MyISAM is based on the old ISAM storage engine. It has many useful extensions, as discussed here. You should consider converting your MySQL tables to the InnoDB storage engine.InnoDB is the default storage engine of MySQL 5.7 and MySQL 8.0. InnoDB features improved performance, rollback and crash-recovery capabilities to protect data. read_buffer_size Applies generally to MyISAM.Each request that performs a sequential table scan allocates a read buffer. The read_buffer_size system variable determines the buffer size.Starting from MySQL 8.0.22, the value of select_into_buffer_size overrides the value of read_buffer_size when performing SELECT INTO DUMPFILE and SELECT INTO OUTFILE statements. read_buffer_size is used for the I/O cache buffer size in all other cases.The read_rnd_buffer_size variable is also used mainly for MyISAM reads from tables. Again, consider InnoDB or MariaDB’s Aria storage engines. For the past decade, the default values of these buffers have remained the same. Additional my.cnf Performance config tipsMonitor the appropriate MySQL status variable_name(s) to assist you in tuning the below config lines. An example of viewing the status of MySQL runtime variables. (So I increased max_connections)max_connectionsA MySQL configuration parameter that sets the maximum number of concurrent connections the server can handle. A value that is too large can allocate too much server memory and lead to performance issues, while a low value can result in connection rejections.To tune this parameter, monitor the max_used_connections status variable; try to set this to ~ 2x to 3x your max used connections after a few days of uptime. However, if your MySQL max connections are more than 200 then make sure to have at least 100 extra connections available. So if max_used_connections is 300 then set max_connections to at least 400. Watch memory usage!!thread_cache_sizeDetermines the number of threads that can be cached and reused by the server. Properly tuning this parameter can help improve the performance of your MySQL server by reducing the overhead of creating new threads and freeing up system resources.To tune this parameter, you can monitor the threads_created and threads_cached status variables and set the value to a reasonable number based on the number of expected concurrent connections. As a general rule, a value of 16 is a good starting point. Then increase gradually until it’s at least 50% of max_connections. For example, if the threads_cached value is 16 and the max_used_connections value is 40 then increase this from 16 to 32. At the same time, as per above advice, if max_used_connections is 40 then your max_connections should be at least 80.table_definition_cacheA MySQL configuration parameter that sets the number of table definitions (metadata) that can be stored in the cache. A high value of table_definition_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of reading the table definition from disk.To tune this parameter, monitor the opened_table_definitions and open_table_definitionsstatus variables, set table_definition_cache to ~ 2x the number of open table definitions and adjust as needed. Consider other factors, such as system memory and query complexity when tuning. .table_open_cacheA MySQL configuration parameter that sets the number of open table objects that can be stored in the cache. A high value of table_open_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of opening tables from disk.To tune this parameter, monitor the opened_tables and open_tables status variables, set table_open_cache to ~ 2x the number of open tables, and adjust as needed. Consider other factors such as memory and query complexity when tuning. Generally table_open_cache and table_definition_cache are set to the same value. The number of open table objects and table definitions are directly related, so setting these two parameters to the same value can ensure that the metadata and open table objects are stored in the cache in a consistent and efficient manner.wait_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on a non-interactive connection before closing it. A high value of wait_timeout can result in increased memory usage and increased # of connections, while a low value can result in frequent disconnections for long-running queries.To tune this parameter, set wait_timeout to the lowest resonable expected duration of non-interactive connections, and adjust as needed. The default value is 28800 seconds. This is way to high in most cases and will consume a lot of system memory by keeping many connections open. I set most of my configs to 30 seconds or less.connect_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for a successful connection to be established before timing out. A high value of connect_timeout can result in increased wait time for clients and increase in max_connections. A low value can result in connection failures for slow or heavily loaded servers.To tune this parameter, set connect_timeout to a reasonable value based on the expected response time of the server. Consider other factors such as network latency, mobile users, and server load when tuning. I set most of my configs to 15 seconds or less. For example, this blog’s mysql connection timeout is set to 5 seconds.interactive_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on an interactive connection before closing it. A high value of interactive_timeout can result in increased memory usage and increased concurrent connetions. A low value can result in frequent disconnections for long-running queries.To tune this parameter, set interactive_timeout to a reasonable value based on the expected duration of your longest-running requests.tmp_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables used by the server. When a query creates a temporary table that exceeds the value of tmp_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set tmp_table_size to a reasonable value based on the available memory and the value of the created_tmp_disk_table variable.max_heap_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables created with the MEMORY storage engine. When a query creates a temporary table that exceeds the value of max_heap_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set max_heap_table_size to the same value as tmp_table_size.Want more tips?For example, Innodb tuning tips, setting open_files_limit, etc. Let me know your interests in the comments section below, or hire me for MySQL optimization. Additional MySQL performance related articlesMySQL Performance Tuning: Tips, Scripts and Tools.MySQL Performance: Stop hoarding. Drop unused MySQL databases.“MySQL server has gone away” error – Solution(s).Could not increase number of max_open_files to more than… (Solution).Linux server performance: Is disk I/O slowing your application?Tuning MySQL my.cnf? Avoid this common pitfall! ConclusionIn conclusion, we discussed some common issues with MySQL performance often raised in support requests. The focus was on four specific my.cnf variables frequently responsible for poor database performance and scaling due to a shortage of server memory.It was emphasized that arbitrarily increasing these variables can lead to a decline in MySQL server performance and capacity and that it is important to keep these buffers set to their default values unless there is a specific reason to increase them. Then we covered tuning some additional MySQL performance config lines.A good rule of thumb: if you can’t provide a valid reason for increasing these buffers, keep them set to the default values. This also applies less strictly to all of MySQL’s variables. Be careful when making changes, don’t overwrite your entire my.cnf all at once. Back up everything first, make one or two changes per restart and test for 24 to 48 hours before making another pass. wsrep_mysql_replication_bundle "\n[Restart] MariaDB server shut down!
[Restart] MariaDB server restarted!

Hint counter: 5
Episode hint counter before: 17
Episode hint counter: 18
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(95, 110), match='max_connections'>, value=<re.Match object; span=(0, 4), match='1250'>, recommendation='1250', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=1250.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20277561247348785, 0.23470382392406464, 0.2442580908536911, 0.15910832583904266, 0.15915419161319733]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(95, 110), match='max_connections'>, value=<re.Match object; span=(0, 4), match='1250'>, recommendation='1250', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=1250.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.022127989679574966, 0.4868924915790558, 0.19467118382453918, 0.1581139713525772, 0.13819433748722076]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(95, 110), match='max_connections'>, value=<re.Match object; span=(0, 4), match='1250'>, recommendation='1250', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=1250.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20277561247348785, 0.23470382392406464, 0.2442580908536911, 0.15910832583904266, 0.15915419161319733]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(95, 110), match='max_connections'>, value=<re.Match object; span=(0, 4), match='1250'>, recommendation='1250', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=1250.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.022127989679574966, 0.4868924915790558, 0.19467118382453918, 0.1581139713525772, 0.13819433748722076]
Choice: 3
Trying update set global max_connections=5000
Trying update set global max_connections=100
Trying assigning max_connections to 5000
Adding assignment ('max_connections', '5000') with weight 8
Assignment ('max_connections', '5000') extracted from "tmp-table-size = 96M
max-heap-table-size = 96M
key_buffer_size = 64M
# Connections and Threads
max_connections = 1250
thread_cache_size = 8
max_allowed_packet = 64M thread_pool_max_threads "
Hint counter: 6
Episode hint counter before: 18
Episode hint counter: 19
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(149, 164), match='max_connections'>, value=<re.Match object; span=(65, 68), match='150'>, recommendation='larger than the total number of all Zabbix server processes plus 150', passage='Later, we will go through every configuration parameter with our ChatGPT friend, but first, there are two things to remember!Configuration parameter\xa0max_connections\xa0must be larger than the total number of all Zabbix server processes plus 150. You can use the command below to automatically check the number of Zabbix processes and add 150 to that number:egrep "^Start.+=[0-9]" /etc/zabbix/zabbix_server.conf | awk -F "=" \'{s+=$2} END {print s+150}\' max_password_errors ', float_val=150.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1274421215057373, 0.07760956138372421, 0.3626527190208435, 0.16154444217681885, 0.27075114846229553]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(149, 164), match='max_connections'>, value=<re.Match object; span=(65, 68), match='150'>, recommendation='larger than the total number of all Zabbix server processes plus 150', passage='Later, we will go through every configuration parameter with our ChatGPT friend, but first, there are two things to remember!Configuration parameter\xa0max_connections\xa0must be larger than the total number of all Zabbix server processes plus 150. You can use the command below to automatically check the number of Zabbix processes and add 150 to that number:egrep "^Start.+=[0-9]" /etc/zabbix/zabbix_server.conf | awk -F "=" \'{s+=$2} END {print s+150}\' max_password_errors ', float_val=150.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.012601979076862335, 0.5690935850143433, 0.1851271241903305, 0.12315736711025238, 0.11001989245414734]
Choice: 3
Trying update set global max_connections=75
Trying update set global max_connections=100
Trying assigning max_connections to 75
Adding assignment ('max_connections', '75') with weight 8
Assignment ('max_connections', '75') extracted from "Later, we will go through every configuration parameter with our ChatGPT friend, but first, there are two things to remember!Configuration parameter max_connections must be larger than the total number of all Zabbix server processes plus 150. You can use the command below to automatically check the number of Zabbix processes and add 150 to that number:egrep "^Start.+=[0-9]" /etc/zabbix/zabbix_server.conf | awk -F "=" '{s+=$2} END {print s+150}' max_password_errors "
Hint counter: 7
Episode hint counter before: 19
Episode hint counter: 20
Hints per episode: 20
Episode finished!
Done flag: True
Finalizing episode!
Weighted hints: defaultdict(<function NlpTuningEnv._finalize_episode.<locals>.<lambda> at 0x7f8767de04c0>, {('join_buffer_size', '512'): 3, ('read_rnd_buffer_size', '512'): 1, ('read_rnd_buffer_size', '16384'): 4, ('read_buffer_size', '256'): 1, ('read_buffer_size', '1024'): 1, ('read_buffer_size', '16384'): 16, ('binlog_cache_size', '32'): 1, ('binlog_cache_size', '64'): 1, ('query_cache_limit', '25M'): 4, ('thread_cache_size', '16'): 18, ('thread_cache_size', '2'): 2, ('thread_cache_size', '8'): 2, ('max_connections', '50'): 2, ('max_connections', '5000'): 8, ('max_connections', '75'): 8})
Selected configurations: [{'join_buffer_size': '512', 'read_rnd_buffer_size': '16384', 'read_buffer_size': '16384', 'binlog_cache_size': '32', 'query_cache_limit': '25M', 'thread_cache_size': '16', 'max_connections': '5000'}, {'join_buffer_size': '512', 'read_rnd_buffer_size': '512', 'read_buffer_size': '256', 'binlog_cache_size': '64', 'query_cache_limit': '25M', 'thread_cache_size': '2', 'max_connections': '75'}]
Disconnecting ...
Trying to connect to tpch with user kaltenec
Trying update set session max_execution_time = 1500000
Exception during update: Unknown system variable 'max_execution_time'\n[Restart] MariaDB server shut down!
[Restart] MariaDB server restarted!

Trying update update mariadb.server_cost set cost_value = NULL
Exception during update: Table 'mariadb.server_cost' doesn't exist
Trying update update mariadb.engine_cost set cost_value = NULL
Exception during update: Table 'mariadb.engine_cost' doesn't exist
Trying configuration: {'join_buffer_size': '512', 'read_rnd_buffer_size': '16384', 'read_buffer_size': '16384', 'binlog_cache_size': '32', 'query_cache_limit': '25M', 'thread_cache_size': '16', 'max_connections': '5000'}
Trying update set global join_buffer_size=512
Trying update set global read_rnd_buffer_size=16384
Trying update set global read_buffer_size=16384
Trying update set global binlog_cache_size=32
Trying update set global query_cache_limit=26214400
Trying update set global thread_cache_size=16
Trying update set global max_connections=5000
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Reward 2019.471923828125 with {'join_buffer_size': '512', 'read_rnd_buffer_size': '16384', 'read_buffer_size': '16384', 'binlog_cache_size': '32', 'query_cache_limit': '25M', 'thread_cache_size': '16', 'max_connections': '5000'}
Disconnecting ...
Trying to connect to tpch with user kaltenec
Trying update set session max_execution_time = 1500000
Exception during update: Unknown system variable 'max_execution_time'
Trying update update mariadb.server_cost set cost_value = NULL
Exception during update: Table 'mariadb.server_cost' doesn't exist
Trying update update mariadb.engine_cost set cost_value = NULL
Exception during update: Table 'mariadb.engine_cost' doesn't exist
Trying configuration: {'join_buffer_size': '512', 'read_rnd_buffer_size': '512', 'read_buffer_size': '256', 'binlog_cache_size': '64', 'query_cache_limit': '25M', 'thread_cache_size': '2', 'max_connections': '75'}
Trying update set global join_buffer_size=512
Trying update set global read_rnd_buffer_size=512
Trying update set global read_buffer_size=256
Trying update set global binlog_cache_size=64
Trying update set global query_cache_limit=26214400
Trying update set global thread_cache_size=2
Trying update set global max_connections=75
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Reward 1965.504150390625 with {'join_buffer_size': '512', 'read_rnd_buffer_size': '512', 'read_buffer_size': '256', 'binlog_cache_size': '64', 'query_cache_limit': '25M', 'thread_cache_size': '2', 'max_connections': '75'}
Obtained 2019.471923828125 by configuration {'join_buffer_size': '512', 'read_rnd_buffer_size': '16384', 'read_buffer_size': '16384', 'binlog_cache_size': '32', 'query_cache_limit': '25M', 'thread_cache_size': '16', 'max_connections': '5000'}
Achieved unscaled reward of 2019.471923828125 using {'join_buffer_size': '512', 'read_rnd_buffer_size': '16384', 'read_buffer_size': '16384', 'binlog_cache_size': '32', 'query_cache_limit': '25M', 'thread_cache_size': '16', 'max_connections': '5000'}.
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(140, 155), match='max_connections'>, value=<re.Match object; span=(0, 3), match='200'>, recommendation='200', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20448258519172668, 0.20679712295532227, 0.24968837201595306, 0.1696714460849762, 0.16936053335666656]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(140, 155), match='max_connections'>, value=<re.Match object; span=(0, 3), match='200'>, recommendation='200', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20448258519172668, 0.20679712295532227, 0.24968837201595306, 0.1696714460849762, 0.16936053335666656]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(140, 155), match='max_connections'>, value=<re.Match object; span=(0, 3), match='200'>, recommendation='200', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.023928122594952583, 0.4574962556362152, 0.20133262872695923, 0.16734036803245544, 0.14990268647670746]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(140, 155), match='max_connections'>, value=<re.Match object; span=(0, 3), match='200'>, recommendation='200', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20448258519172668, 0.20679712295532227, 0.24968837201595306, 0.1696714460849762, 0.16936053335666656]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(140, 155), match='max_connections'>, value=<re.Match object; span=(0, 3), match='200'>, recommendation='200', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.023928122594952583, 0.4574962556362152, 0.20133262872695923, 0.16734036803245544, 0.14990268647670746]
Choice: 4
Trying update set global max_connections=50
Trying update set global max_connections=75
Trying assigning max_connections to 50
Adding assignment ('max_connections', '50') with weight 16
Assignment ('max_connections', '50') extracted from "read_rnd_buffer_size = 512
join_buffer_size = 2048
thread_stack = 512
binlog_cache_size = 64
thread_cache_size = 16
table_open_cache = 2048
max_connections = 200
PHP:
max_children = 4 thread_cache_size "
Hint counter: 8
Episode hint counter before: 0
Episode hint counter: 1
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(67, 82), match='max_connections'>, value=<re.Match object; span=(0, 2), match='20'>, recommendation='20', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=20.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18651802837848663, 0.19193889200687408, 0.25157612562179565, 0.1705176830291748, 0.19944924116134644]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(67, 82), match='max_connections'>, value=<re.Match object; span=(0, 2), match='20'>, recommendation='20', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=20.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.024509061127901077, 0.4811500310897827, 0.19708628952503204, 0.1599201112985611, 0.1373344212770462]
Choice: 4
Trying update set global max_connections=20
Trying update set global max_connections=75
Trying assigning max_connections to 20
Adding assignment ('max_connections', '20') with weight 16
Assignment ('max_connections', '20') extracted from "binlog_cache_size = 32
thread_cache_size = 8
table_open_cache = 64
max_connections = 20
PHP:
max_children = 10
start_servers = 2
min_spare_servers = 1
max_spare_servers = 3 binlog_stmt_cache_size "
Hint counter: 9
Episode hint counter before: 1
Episode hint counter: 2
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=63, param=<re.Match object; span=(0, 15), match='max_connections'>, value=<re.Match object; span=(0, 3), match='500'>, recommendation='500', passage='max_connections\n= 500\nmax_user_connections\n= 500\n#table_cache\n= 64\nthread_concurrency\n= 300\ntable_cache\n= 30000\nopen_files_limit\n= 65000\n#innodb_force_recovery =6 max_binlog_stmt_cache_size ', float_val=500.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.2242766171693802, 0.18561743199825287, 0.25007033348083496, 0.17030423879623413, 0.16973133385181427]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=63, param=<re.Match object; span=(0, 15), match='max_connections'>, value=<re.Match object; span=(0, 3), match='500'>, recommendation='500', passage='max_connections\n= 500\nmax_user_connections\n= 500\n#table_cache\n= 64\nthread_concurrency\n= 300\ntable_cache\n= 30000\nopen_files_limit\n= 65000\n#innodb_force_recovery =6 max_binlog_stmt_cache_size ', float_val=500.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.022781977429986, 0.46374940872192383, 0.2040889710187912, 0.16545264422893524, 0.1439269781112671]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=63, param=<re.Match object; span=(0, 15), match='max_connections'>, value=<re.Match object; span=(0, 3), match='500'>, recommendation='500', passage='max_connections\n= 500\nmax_user_connections\n= 500\n#table_cache\n= 64\nthread_concurrency\n= 300\ntable_cache\n= 30000\nopen_files_limit\n= 65000\n#innodb_force_recovery =6 max_binlog_stmt_cache_size ', float_val=500.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.2242766171693802, 0.18561743199825287, 0.25007033348083496, 0.17030423879623413, 0.16973133385181427]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=63, param=<re.Match object; span=(0, 15), match='max_connections'>, value=<re.Match object; span=(0, 3), match='500'>, recommendation='500', passage='max_connections\n= 500\nmax_user_connections\n= 500\n#table_cache\n= 64\nthread_concurrency\n= 300\ntable_cache\n= 30000\nopen_files_limit\n= 65000\n#innodb_force_recovery =6 max_binlog_stmt_cache_size ', float_val=500.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.022781977429986, 0.46374940872192383, 0.2040889710187912, 0.16545264422893524, 0.1439269781112671]
Choice: 1
Trying update set global max_connections=2000
Trying update set global max_connections=75
Trying assigning max_connections to 2000
Adding assignment ('max_connections', '2000') with weight 2
Assignment ('max_connections', '2000') extracted from "max_connections
= 500
max_user_connections
= 500
#table_cache
= 64
thread_concurrency
= 300
table_cache
= 30000
open_files_limit
= 65000
#innodb_force_recovery =6 max_binlog_stmt_cache_size "
Hint counter: 10
Episode hint counter before: 2
Episode hint counter: 3
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=1, param=<re.Match object; span=(0, 23), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 2), match='70'>, recommendation='70-80% of the available memory', passage='innodb_buffer_pool_size: Allocate more memory to the InnoDB buffer pool to reduce disk I/O. Typically, this value should be set to at least 70-80% of the available memory.\ninnodb_log_file_size: A larger log file size reduces the need for frequent log rotations, thus improving write performance. However, a log size that is too large might slow down the recovery process after a crash.\nTweak Query Cache Variables innodb_log_buffer_size ', float_val=70.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.12051532417535782, 0.1557127982378006, 0.3688836991786957, 0.1453220099210739, 0.20956619083881378]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=1, param=<re.Match object; span=(0, 23), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 2), match='70'>, recommendation='70-80% of the available memory', passage='innodb_buffer_pool_size: Allocate more memory to the InnoDB buffer pool to reduce disk I/O. Typically, this value should be set to at least 70-80% of the available memory.\ninnodb_log_file_size: A larger log file size reduces the need for frequent log rotations, thus improving write performance. However, a log size that is too large might slow down the recovery process after a crash.\nTweak Query Cache Variables innodb_log_buffer_size ', float_val=70.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.021443508565425873, 0.5487614274024963, 0.17386455833911896, 0.14200177788734436, 0.11392877995967865]
Choice: 0
Trying update set global innodb_buffer_pool_size=17
Exception during update: Variable 'innodb_buffer_pool_size' can't be set to the value of '17'
Trying update set global innodb_buffer_pool_size=134217728
Trying assigning innodb_buffer_pool_size to 17
Assignment ('innodb_buffer_pool_size', '17') was rejected
Hint counter: 11
Episode hint counter before: 3
Episode hint counter: 4
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=1, param=<re.Match object; span=(0, 23), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(3, 6), match='80%'>, recommendation='70-80% of the available memory', passage='innodb_buffer_pool_size: Allocate more memory to the InnoDB buffer pool to reduce disk I/O. Typically, this value should be set to at least 70-80% of the available memory.\ninnodb_log_file_size: A larger log file size reduces the need for frequent log rotations, thus improving write performance. However, a log size that is too large might slow down the recovery process after a crash.\nTweak Query Cache Variables innodb_log_buffer_size ', float_val=0.8, val_unit='', hint_type=<HintType.RAM_RATIO: 1>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.12051532417535782, 0.1557127982378006, 0.3688836991786957, 0.1453220099210739, 0.20956619083881378]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=1, param=<re.Match object; span=(0, 23), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(3, 6), match='80%'>, recommendation='70-80% of the available memory', passage='innodb_buffer_pool_size: Allocate more memory to the InnoDB buffer pool to reduce disk I/O. Typically, this value should be set to at least 70-80% of the available memory.\ninnodb_log_file_size: A larger log file size reduces the need for frequent log rotations, thus improving write performance. However, a log size that is too large might slow down the recovery process after a crash.\nTweak Query Cache Variables innodb_log_buffer_size ', float_val=0.8, val_unit='', hint_type=<HintType.RAM_RATIO: 1>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.021443508565425873, 0.5487614274024963, 0.17386455833911896, 0.14200177788734436, 0.11392877995967865]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=1, param=<re.Match object; span=(0, 23), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(3, 6), match='80%'>, recommendation='70-80% of the available memory', passage='innodb_buffer_pool_size: Allocate more memory to the InnoDB buffer pool to reduce disk I/O. Typically, this value should be set to at least 70-80% of the available memory.\ninnodb_log_file_size: A larger log file size reduces the need for frequent log rotations, thus improving write performance. However, a log size that is too large might slow down the recovery process after a crash.\nTweak Query Cache Variables innodb_log_buffer_size ', float_val=0.8, val_unit='', hint_type=<HintType.RAM_RATIO: 1>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.12051532417535782, 0.1557127982378006, 0.3688836991786957, 0.1453220099210739, 0.20956619083881378]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=1, param=<re.Match object; span=(0, 23), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(3, 6), match='80%'>, recommendation='70-80% of the available memory', passage='innodb_buffer_pool_size: Allocate more memory to the InnoDB buffer pool to reduce disk I/O. Typically, this value should be set to at least 70-80% of the available memory.\ninnodb_log_file_size: A larger log file size reduces the need for frequent log rotations, thus improving write performance. However, a log size that is too large might slow down the recovery process after a crash.\nTweak Query Cache Variables innodb_log_buffer_size ', float_val=0.8, val_unit='', hint_type=<HintType.RAM_RATIO: 1>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.021443508565425873, 0.5487614274024963, 0.17386455833911896, 0.14200177788734436, 0.11392877995967865]
Choice: 1
Trying update set global innodb_buffer_pool_size=2147483648
Trying update set global innodb_buffer_pool_size=134217728
Exception during update: Another buffer pool resize is already in progress.
Trying assigning innodb_buffer_pool_size to 2147483648
Adding assignment ('innodb_buffer_pool_size', '2147483648') with weight 2
Assignment ('innodb_buffer_pool_size', '2147483648') extracted from "innodb_buffer_pool_size: Allocate more memory to the InnoDB buffer pool to reduce disk I/O. Typically, this value should be set to at least 70-80% of the available memory.
innodb_log_file_size: A larger log file size reduces the need for frequent log rotations, thus improving write performance. However, a log size that is too large might slow down the recovery process after a crash.
Tweak Query Cache Variables innodb_log_buffer_size "
Hint counter: 12
Episode hint counter before: 4
Episode hint counter: 5
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(97, 120), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 3), match='23G'>, recommendation='23G', passage='innodb_stats_on_metadata = off\ninnodb-flush-method = O_DIRECT\ninnodb-flush-log-at-trx-commit = 2\ninnodb_buffer_pool_size = 23G\ninnodb_read_io_threads = 32 innodb_flush_log_at_trx_commit ', float_val=23.0, val_unit='G', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18098114430904388, 0.19943229854106903, 0.23072713613510132, 0.20386049151420593, 0.18499886989593506]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(97, 120), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 3), match='23G'>, recommendation='23G', passage='innodb_stats_on_metadata = off\ninnodb-flush-method = O_DIRECT\ninnodb-flush-log-at-trx-commit = 2\ninnodb_buffer_pool_size = 23G\ninnodb_read_io_threads = 32 innodb_flush_log_at_trx_commit ', float_val=23.0, val_unit='G', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.01924968883395195, 0.4707958996295929, 0.1976868361234665, 0.166013702750206, 0.1462538093328476]
Choice: 2
Trying update set global innodb_buffer_pool_size=11811160064
Exception during update: Another buffer pool resize is already in progress.
Trying update set global innodb_buffer_pool_size=2147483648
Exception during update: Another buffer pool resize is already in progress.
Trying assigning innodb_buffer_pool_size to 11G
Assignment ('innodb_buffer_pool_size', '11G') was rejected
Hint counter: 13
Episode hint counter before: 5
Episode hint counter: 6
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(66, 89), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 4), match='4096'>, recommendation='4096', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=4096.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1929043084383011, 0.20756587386131287, 0.27467942237854004, 0.1552993506193161, 0.16955099999904633]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(66, 89), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 4), match='4096'>, recommendation='4096', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=4096.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.029096694663167, 0.4537006616592407, 0.2012118697166443, 0.17119792103767395, 0.14479291439056396]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(66, 89), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 4), match='4096'>, recommendation='4096', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=4096.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1929043084383011, 0.20756587386131287, 0.27467942237854004, 0.1552993506193161, 0.16955099999904633]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(66, 89), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 4), match='4096'>, recommendation='4096', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=4096.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.029096694663167, 0.4537006616592407, 0.2012118697166443, 0.17119792103767395, 0.14479291439056396]
Choice: 3
Trying update set global innodb_buffer_pool_size=1024
Exception during update: Variable 'innodb_buffer_pool_size' can't be set to the value of '1024'
Trying update set global innodb_buffer_pool_size=2147483648
Trying assigning innodb_buffer_pool_size to 1024
Assignment ('innodb_buffer_pool_size', '1024') was rejected
Hint counter: 14
Episode hint counter before: 6
Episode hint counter: 7
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(38, 61), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 4), match='180M'>, recommendation='180M', passage="Mysql need's by default 512MB of RAM.\ninnodb_buffer_pool_size = 180M with this settings you can limit the RAM ussage, a high value is pointless\nMysql is runing on a local server so if you have a ssd on it the access is pretty fast there is no point to use your ram for nothing. sql_slave_skip_counter ", float_val=180.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20210203528404236, 0.19127501547336578, 0.2364121675491333, 0.1605609506368637, 0.20964983105659485]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(38, 61), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 4), match='180M'>, recommendation='180M', passage="Mysql need's by default 512MB of RAM.\ninnodb_buffer_pool_size = 180M with this settings you can limit the RAM ussage, a high value is pointless\nMysql is runing on a local server so if you have a ssd on it the access is pretty fast there is no point to use your ram for nothing. sql_slave_skip_counter ", float_val=180.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.020154068246483803, 0.43662428855895996, 0.20483645796775818, 0.17478047311306, 0.1636047512292862]
Choice: 0
Trying update set global innodb_buffer_pool_size=47185920
Trying update set global innodb_buffer_pool_size=2147483648
Exception during update: Another buffer pool resize is already in progress.
Trying assigning innodb_buffer_pool_size to 45M
Adding assignment ('innodb_buffer_pool_size', '45M') with weight 1
Assignment ('innodb_buffer_pool_size', '45M') extracted from "Mysql need's by default 512MB of RAM.
innodb_buffer_pool_size = 180M with this settings you can limit the RAM ussage, a high value is pointless
Mysql is runing on a local server so if you have a ssd on it the access is pretty fast there is no point to use your ram for nothing. sql_slave_skip_counter "
Hint counter: 15
Episode hint counter before: 7
Episode hint counter: 8
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=11, param=<re.Match object; span=(245, 260), match='key_buffer_size'>, value=<re.Match object; span=(0, 3), match='32M'>, recommendation='32M', passage="The key buffer can improve the access speed to Moodle's SELECT queries. The correct size depends on the size of the index files (.myi) and in Moodle 1.6 or later (without any additional modules and plugins), the recommendation for this value is key_buffer_size = 32M. Ideally you want the database to be reading once from the disk for every 100 requests so monitor that the value is suitable for your install by adjusting the value of key_buffer_size so that the following formulas are true:\nkey_read / key_read_requests < 0.01\nkey_write / key_write_requests <= 1.0 key_buffer_size ", float_val=32.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18291717767715454, 0.17137980461120605, 0.30023810267448425, 0.15002238750457764, 0.19544251263141632]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=11, param=<re.Match object; span=(245, 260), match='key_buffer_size'>, value=<re.Match object; span=(0, 3), match='32M'>, recommendation='32M', passage="The key buffer can improve the access speed to Moodle's SELECT queries. The correct size depends on the size of the index files (.myi) and in Moodle 1.6 or later (without any additional modules and plugins), the recommendation for this value is key_buffer_size = 32M. Ideally you want the database to be reading once from the disk for every 100 requests so monitor that the value is suitable for your install by adjusting the value of key_buffer_size so that the following formulas are true:\nkey_read / key_read_requests < 0.01\nkey_write / key_write_requests <= 1.0 key_buffer_size ", float_val=32.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02246321365237236, 0.4591565728187561, 0.2058204859495163, 0.16968268156051636, 0.14287708699703217]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=11, param=<re.Match object; span=(245, 260), match='key_buffer_size'>, value=<re.Match object; span=(0, 3), match='32M'>, recommendation='32M', passage="The key buffer can improve the access speed to Moodle's SELECT queries. The correct size depends on the size of the index files (.myi) and in Moodle 1.6 or later (without any additional modules and plugins), the recommendation for this value is key_buffer_size = 32M. Ideally you want the database to be reading once from the disk for every 100 requests so monitor that the value is suitable for your install by adjusting the value of key_buffer_size so that the following formulas are true:\nkey_read / key_read_requests < 0.01\nkey_write / key_write_requests <= 1.0 key_buffer_size ", float_val=32.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18291717767715454, 0.17137980461120605, 0.30023810267448425, 0.15002238750457764, 0.19544251263141632]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=11, param=<re.Match object; span=(245, 260), match='key_buffer_size'>, value=<re.Match object; span=(0, 3), match='32M'>, recommendation='32M', passage="The key buffer can improve the access speed to Moodle's SELECT queries. The correct size depends on the size of the index files (.myi) and in Moodle 1.6 or later (without any additional modules and plugins), the recommendation for this value is key_buffer_size = 32M. Ideally you want the database to be reading once from the disk for every 100 requests so monitor that the value is suitable for your install by adjusting the value of key_buffer_size so that the following formulas are true:\nkey_read / key_read_requests < 0.01\nkey_write / key_write_requests <= 1.0 key_buffer_size ", float_val=32.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02246321365237236, 0.4591565728187561, 0.2058204859495163, 0.16968268156051636, 0.14287708699703217]
Choice: 3
Trying update set global key_buffer_size=8388608
Trying update set global key_buffer_size=134217728
Trying assigning key_buffer_size to 8M
Adding assignment ('key_buffer_size', '8M') with weight 8
Assignment ('key_buffer_size', '8M') extracted from "The key buffer can improve the access speed to Moodle's SELECT queries. The correct size depends on the size of the index files (.myi) and in Moodle 1.6 or later (without any additional modules and plugins), the recommendation for this value is key_buffer_size = 32M. Ideally you want the database to be reading once from the disk for every 100 requests so monitor that the value is suitable for your install by adjusting the value of key_buffer_size so that the following formulas are true:
key_read / key_read_requests < 0.01
key_write / key_write_requests <= 1.0 key_buffer_size "
Hint counter: 16
Episode hint counter before: 8
Episode hint counter: 9
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(47, 62), match='key_buffer_size'>, value=<re.Match object; span=(0, 3), match='64M'>, recommendation='64M', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=64.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19450999796390533, 0.15914979577064514, 0.2871057093143463, 0.14859525859355927, 0.21063925325870514]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(47, 62), match='key_buffer_size'>, value=<re.Match object; span=(0, 3), match='64M'>, recommendation='64M', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=64.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.023741085082292557, 0.44100087881088257, 0.21198078989982605, 0.1755017787218094, 0.14777542650699615]
Choice: 4
Trying update set global key_buffer_size=134217728
Trying update set global key_buffer_size=134217728
Trying assigning key_buffer_size to 128M
Adding assignment ('key_buffer_size', '128M') with weight 16
Assignment ('key_buffer_size', '128M') extracted from "tmp-table-size = 96M
max-heap-table-size = 96M
key_buffer_size = 64M
# Connections and Threads
max_connections = 1250
thread_cache_size = 8
max_allowed_packet = 64M thread_pool_max_threads "
Hint counter: 17
Episode hint counter before: 9
Episode hint counter: 10
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(1789, 1804), match='key_buffer_size'>, value=<re.Match object; span=(0, 2), match='8M'>, recommendation='8M/128M/No limit', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=8.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.13929742574691772, 0.2145470678806305, 0.28674599528312683, 0.18182188272476196, 0.17758767306804657]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(1789, 1804), match='key_buffer_size'>, value=<re.Match object; span=(0, 2), match='8M'>, recommendation='8M/128M/No limit', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=8.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.10024014115333557, 0.4005581736564636, 0.20327132940292358, 0.16120778024196625, 0.13472256064414978]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(1789, 1804), match='key_buffer_size'>, value=<re.Match object; span=(0, 2), match='8M'>, recommendation='8M/128M/No limit', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=8.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.13929742574691772, 0.2145470678806305, 0.28674599528312683, 0.18182188272476196, 0.17758767306804657]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(1789, 1804), match='key_buffer_size'>, value=<re.Match object; span=(0, 2), match='8M'>, recommendation='8M/128M/No limit', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=8.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.10024014115333557, 0.4005581736564636, 0.20327132940292358, 0.16120778024196625, 0.13472256064414978]
Choice: 2
Trying update set global key_buffer_size=16777216
Trying update set global key_buffer_size=134217728
Trying assigning key_buffer_size to 16M
Adding assignment ('key_buffer_size', '16M') with weight 4
Assignment ('key_buffer_size', '16M') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 18
Episode hint counter before: 10
Episode hint counter: 11
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(1789, 1804), match='key_buffer_size'>, value=<re.Match object; span=(3, 7), match='128M'>, recommendation='8M/128M/No limit', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=128.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.13929742574691772, 0.2145470678806305, 0.28674599528312683, 0.18182188272476196, 0.17758767306804657]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(1789, 1804), match='key_buffer_size'>, value=<re.Match object; span=(3, 7), match='128M'>, recommendation='8M/128M/No limit', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=128.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.10024014115333557, 0.4005581736564636, 0.20327132940292358, 0.16120778024196625, 0.13472256064414978]
Choice: 3
Trying update set global key_buffer_size=33554432
Trying update set global key_buffer_size=134217728
Trying assigning key_buffer_size to 32M
Adding assignment ('key_buffer_size', '32M') with weight 8
Assignment ('key_buffer_size', '32M') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 19
Episode hint counter before: 11
Episode hint counter: 12
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(0, 15), match='key_buffer_size'>, value=<re.Match object; span=(0, 4), match='1200'>, recommendation='1200', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=1200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18510159850120544, 0.19854989647865295, 0.25001347064971924, 0.1852368712425232, 0.18109816312789917]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(0, 15), match='key_buffer_size'>, value=<re.Match object; span=(0, 4), match='1200'>, recommendation='1200', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=1200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.01587599329650402, 0.4516242742538452, 0.19539159536361694, 0.16862988471984863, 0.168478325009346]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(0, 15), match='key_buffer_size'>, value=<re.Match object; span=(0, 4), match='1200'>, recommendation='1200', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=1200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18510159850120544, 0.19854989647865295, 0.25001347064971924, 0.1852368712425232, 0.18109816312789917]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(0, 15), match='key_buffer_size'>, value=<re.Match object; span=(0, 4), match='1200'>, recommendation='1200', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=1200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.01587599329650402, 0.4516242742538452, 0.19539159536361694, 0.16862988471984863, 0.168478325009346]
Choice: 2
Trying update set global key_buffer_size=600
Exception during update: Cannot drop default keycache
Trying update set global key_buffer_size=134217728
Trying assigning key_buffer_size to 600
Assignment ('key_buffer_size', '600') was rejected
Hint counter: 20
Episode hint counter before: 12
Episode hint counter: 13
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(202, 217), match='key_buffer_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18871235847473145, 0.16364289820194244, 0.2578245997428894, 0.17040672898292542, 0.21941344439983368]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(202, 217), match='key_buffer_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.025200868025422096, 0.4661506414413452, 0.19984710216522217, 0.16229088604450226, 0.1465105265378952]
Choice: 2
Trying update set global key_buffer_size=8
Exception during update: Cannot drop default keycache
Trying update set global key_buffer_size=134217728
Trying assigning key_buffer_size to 8
Assignment ('key_buffer_size', '8') was rejected
Hint counter: 21
Episode hint counter before: 13
Episode hint counter: 14
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(326, 342), match='table_open_cache'>, value=<re.Match object; span=(0, 3), match='512'>, recommendation='512', passage="Adjusting key_buffer_size, and reducing this if you're not using MyISAM Tables, (It's only relevant to have a large key_buffer_size if you're using MyISAM Tables, which by default MariaDB uses InnoDB. General consensus is InnoDB offers better performance as well, so really only use MyISAM if you have a reason to).\nAdjusting table_open_cache (previously called table_cache) - in Performance recommendations under MySQL, it recommends having this as 512 for most Moodle Installations, but I left it at the default MariaDB setting of 2000. lower_case_table_names ", float_val=512.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18853892385959625, 0.17371782660484314, 0.2637619078159332, 0.19082817435264587, 0.18315310776233673]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(326, 342), match='table_open_cache'>, value=<re.Match object; span=(0, 3), match='512'>, recommendation='512', passage="Adjusting key_buffer_size, and reducing this if you're not using MyISAM Tables, (It's only relevant to have a large key_buffer_size if you're using MyISAM Tables, which by default MariaDB uses InnoDB. General consensus is InnoDB offers better performance as well, so really only use MyISAM if you have a reason to).\nAdjusting table_open_cache (previously called table_cache) - in Performance recommendations under MySQL, it recommends having this as 512 for most Moodle Installations, but I left it at the default MariaDB setting of 2000. lower_case_table_names ", float_val=512.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.022273913025856018, 0.45673248171806335, 0.20234665274620056, 0.1712857037782669, 0.14736124873161316]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(326, 342), match='table_open_cache'>, value=<re.Match object; span=(0, 3), match='512'>, recommendation='512', passage="Adjusting key_buffer_size, and reducing this if you're not using MyISAM Tables, (It's only relevant to have a large key_buffer_size if you're using MyISAM Tables, which by default MariaDB uses InnoDB. General consensus is InnoDB offers better performance as well, so really only use MyISAM if you have a reason to).\nAdjusting table_open_cache (previously called table_cache) - in Performance recommendations under MySQL, it recommends having this as 512 for most Moodle Installations, but I left it at the default MariaDB setting of 2000. lower_case_table_names ", float_val=512.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18853892385959625, 0.17371782660484314, 0.2637619078159332, 0.19082817435264587, 0.18315310776233673]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(326, 342), match='table_open_cache'>, value=<re.Match object; span=(0, 3), match='512'>, recommendation='512', passage="Adjusting key_buffer_size, and reducing this if you're not using MyISAM Tables, (It's only relevant to have a large key_buffer_size if you're using MyISAM Tables, which by default MariaDB uses InnoDB. General consensus is InnoDB offers better performance as well, so really only use MyISAM if you have a reason to).\nAdjusting table_open_cache (previously called table_cache) - in Performance recommendations under MySQL, it recommends having this as 512 for most Moodle Installations, but I left it at the default MariaDB setting of 2000. lower_case_table_names ", float_val=512.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.022273913025856018, 0.45673248171806335, 0.20234665274620056, 0.1712857037782669, 0.14736124873161316]
Choice: 3
Trying update set global table_open_cache=1024
Trying update set global table_open_cache=2000
Trying assigning table_open_cache to 1024
Adding assignment ('table_open_cache', '1024') with weight 8
Assignment ('table_open_cache', '1024') extracted from "Adjusting key_buffer_size, and reducing this if you're not using MyISAM Tables, (It's only relevant to have a large key_buffer_size if you're using MyISAM Tables, which by default MariaDB uses InnoDB. General consensus is InnoDB offers better performance as well, so really only use MyISAM if you have a reason to).
Adjusting table_open_cache (previously called table_cache) - in Performance recommendations under MySQL, it recommends having this as 512 for most Moodle Installations, but I left it at the default MariaDB setting of 2000. lower_case_table_names "
Hint counter: 22
Episode hint counter before: 14
Episode hint counter: 15
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(0, 16), match='table_open_cache'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18871235847473145, 0.16364289820194244, 0.2578245997428894, 0.17040672898292542, 0.21941344439983368]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(0, 16), match='table_open_cache'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.025200868025422096, 0.4661506414413452, 0.19984710216522217, 0.16229088604450226, 0.1465105265378952]
Choice: 2
Trying update set global table_open_cache=4
Trying update set global table_open_cache=2000
Trying assigning table_open_cache to 4
Adding assignment ('table_open_cache', '4') with weight 4
Assignment ('table_open_cache', '4') extracted from "table_open_cache_instances = 16
table_open_cache
= 32012
open_files_limit = 65535
max_connect_errors = 1000000
[client]
# MySQL Client Configuration
# Client Socket table_open_cache_instances "
Hint counter: 23
Episode hint counter before: 15
Episode hint counter: 16
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18495632708072662, 0.14171242713928223, 0.2996373772621155, 0.15297187864780426, 0.22072190046310425]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02901652827858925, 0.4701266586780548, 0.20297597348690033, 0.16598810255527496, 0.13189274072647095]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18495632708072662, 0.14171242713928223, 0.2996373772621155, 0.15297187864780426, 0.22072190046310425]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02901652827858925, 0.4701266586780548, 0.20297597348690033, 0.16598810255527496, 0.13189274072647095]
Choice: 0
Trying update set global table_open_cache=1
Trying update set global table_open_cache=2000
Trying assigning table_open_cache to 1
Adding assignment ('table_open_cache', '1') with weight 1
Assignment ('table_open_cache', '1') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 24
Episode hint counter before: 16
Episode hint counter: 17
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(2, 3), match='1'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18495632708072662, 0.14171242713928223, 0.2996373772621155, 0.15297187864780426, 0.22072190046310425]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(2, 3), match='1'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02901652827858925, 0.4701266586780548, 0.20297597348690033, 0.16598810255527496, 0.13189274072647095]
Choice: 0
Trying update set global table_open_cache=0
Trying update set global table_open_cache=2000
Trying assigning table_open_cache to 0
Adding assignment ('table_open_cache', '0') with weight 1
Assignment ('table_open_cache', '0') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 25
Episode hint counter before: 17
Episode hint counter: 18
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(4, 6), match='64'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18495632708072662, 0.14171242713928223, 0.2996373772621155, 0.15297187864780426, 0.22072190046310425]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(4, 6), match='64'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02901652827858925, 0.4701266586780548, 0.20297597348690033, 0.16598810255527496, 0.13189274072647095]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(4, 6), match='64'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18495632708072662, 0.14171242713928223, 0.2996373772621155, 0.15297187864780426, 0.22072190046310425]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(4, 6), match='64'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02901652827858925, 0.4701266586780548, 0.20297597348690033, 0.16598810255527496, 0.13189274072647095]
Choice: 0
Trying update set global table_open_cache=256
Trying update set global table_open_cache=2000
Trying assigning table_open_cache to 256
Adding assignment ('table_open_cache', '256') with weight 1
Assignment ('table_open_cache', '256') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "\n[Restart] MariaDB server shut down!
[Restart] MariaDB server restarted!
\n[Restart] MariaDB server shut down!
[Restart] MariaDB server restarted!

Hint counter: 26
Episode hint counter before: 18
Episode hint counter: 19
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(116, 132), match='table_open_cache'>, value=<re.Match object; span=(0, 4), match='2048'>, recommendation='2048', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=2048.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.17999409139156342, 0.20450188219547272, 0.2764931619167328, 0.1695912778377533, 0.1694195717573166]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(116, 132), match='table_open_cache'>, value=<re.Match object; span=(0, 4), match='2048'>, recommendation='2048', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=2048.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.025632193312048912, 0.44854864478111267, 0.20763951539993286, 0.17194095253944397, 0.14623866975307465]
Choice: 3
Trying update set global table_open_cache=1024
Trying update set global table_open_cache=2000
Trying assigning table_open_cache to 1024
Adding assignment ('table_open_cache', '1024') with weight 8
Assignment ('table_open_cache', '1024') extracted from "read_rnd_buffer_size = 512
join_buffer_size = 2048
thread_stack = 512
binlog_cache_size = 64
thread_cache_size = 16
table_open_cache = 2048
max_connections = 200
PHP:
max_children = 4 thread_cache_size "
Hint counter: 27
Episode hint counter before: 19
Episode hint counter: 20
Hints per episode: 20
Episode finished!
Done flag: True
Finalizing episode!
Weighted hints: defaultdict(<function NlpTuningEnv._finalize_episode.<locals>.<lambda> at 0x7f8767de0160>, {('max_connections', '50'): 16, ('max_connections', '20'): 16, ('max_connections', '2000'): 2, ('innodb_buffer_pool_size', '2147483648'): 2, ('innodb_buffer_pool_size', '45M'): 1, ('key_buffer_size', '8M'): 8, ('key_buffer_size', '128M'): 16, ('key_buffer_size', '16M'): 4, ('key_buffer_size', '32M'): 8, ('table_open_cache', '1024'): 16, ('table_open_cache', '4'): 4, ('table_open_cache', '1'): 1, ('table_open_cache', '0'): 1, ('table_open_cache', '256'): 1})
Selected configurations: [{'max_connections': '50', 'innodb_buffer_pool_size': '2147483648', 'key_buffer_size': '128M', 'table_open_cache': '1024'}, {'max_connections': '2000', 'innodb_buffer_pool_size': '45M', 'key_buffer_size': '16M', 'table_open_cache': '4'}]
Disconnecting ...
Trying to connect to tpch with user kaltenec
Trying update set session max_execution_time = 1500000
Exception during update: Unknown system variable 'max_execution_time'
Trying update update mariadb.server_cost set cost_value = NULL
Exception during update: Table 'mariadb.server_cost' doesn't exist
Trying update update mariadb.engine_cost set cost_value = NULL
Exception during update: Table 'mariadb.engine_cost' doesn't exist
Trying configuration: {'max_connections': '50', 'innodb_buffer_pool_size': '2147483648', 'key_buffer_size': '128M', 'table_open_cache': '1024'}
Trying update set global max_connections=50
Trying update set global innodb_buffer_pool_size=2147483648
Trying update set global key_buffer_size=134217728
Trying update set global table_open_cache=1024
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Reward 43872.937744140625 with {'max_connections': '50', 'innodb_buffer_pool_size': '2147483648', 'key_buffer_size': '128M', 'table_open_cache': '1024'}
Disconnecting ...
Trying to connect to tpch with user kaltenec
Trying update set session max_execution_time = 1500000
Exception during update: Unknown system variable 'max_execution_time'
Trying update update mariadb.server_cost set cost_value = NULL
Exception during update: Table 'mariadb.server_cost' doesn't exist
Trying update update mariadb.engine_cost set cost_value = NULL
Exception during update: Table 'mariadb.engine_cost' doesn't exist
Trying configuration: {'max_connections': '2000', 'innodb_buffer_pool_size': '45M', 'key_buffer_size': '16M', 'table_open_cache': '4'}
Trying update set global max_connections=2000
Trying update set global innodb_buffer_pool_size=47185920
Trying update set global key_buffer_size=16777216
Trying update set global table_open_cache=4
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 59182.109375
Achieved with configuration: {}
Reward -126782.42333984375 with {'max_connections': '2000', 'innodb_buffer_pool_size': '45M', 'key_buffer_size': '16M', 'table_open_cache': '4'}
Obtained 43872.937744140625 by configuration {'max_connections': '50', 'innodb_buffer_pool_size': '2147483648', 'key_buffer_size': '128M', 'table_open_cache': '1024'}
Achieved unscaled reward of 43872.937744140625 using {'max_connections': '50', 'innodb_buffer_pool_size': '2147483648', 'key_buffer_size': '128M', 'table_open_cache': '1024'}.
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(45, 61), match='table_open_cache'>, value=<re.Match object; span=(0, 2), match='64'>, recommendation='64', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20224447548389435, 0.18172581493854523, 0.2561816871166229, 0.15085653960704803, 0.20899151265621185]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(45, 61), match='table_open_cache'>, value=<re.Match object; span=(0, 2), match='64'>, recommendation='64', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20224447548389435, 0.18172581493854523, 0.2561816871166229, 0.15085653960704803, 0.20899151265621185]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(45, 61), match='table_open_cache'>, value=<re.Match object; span=(0, 2), match='64'>, recommendation='64', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.027772024273872375, 0.460867315530777, 0.20801353454589844, 0.16750642657279968, 0.13584065437316895]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(45, 61), match='table_open_cache'>, value=<re.Match object; span=(0, 2), match='64'>, recommendation='64', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20224447548389435, 0.18172581493854523, 0.2561816871166229, 0.15085653960704803, 0.20899151265621185]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(45, 61), match='table_open_cache'>, value=<re.Match object; span=(0, 2), match='64'>, recommendation='64', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.027772024273872375, 0.460867315530777, 0.20801353454589844, 0.16750642657279968, 0.13584065437316895]
Choice: 1
Trying update set global table_open_cache=128
Trying update set global table_open_cache=10
Trying assigning table_open_cache to 128
Adding assignment ('table_open_cache', '128') with weight 2
Assignment ('table_open_cache', '128') extracted from "binlog_cache_size = 32
thread_cache_size = 8
table_open_cache = 64
max_connections = 20
PHP:
max_children = 10
start_servers = 2
min_spare_servers = 1
max_spare_servers = 3 binlog_stmt_cache_size "
Hint counter: 28
Episode hint counter before: 0
Episode hint counter: 1
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(360, 376), match='query_cache_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16 or so', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18521332740783691, 0.1852453649044037, 0.28911828994750977, 0.15424436330795288, 0.18617865443229675]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(360, 376), match='query_cache_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16 or so', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.028563059866428375, 0.50733482837677, 0.1963784247636795, 0.14746752381324768, 0.12025613337755203]
Choice: 1
Trying update set global query_cache_size=8
Trying update set global query_cache_size=1048576
Trying assigning query_cache_size to 8
Adding assignment ('query_cache_size', '8') with weight 2
Assignment ('query_cache_size', '8') extracted from "Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).
Adjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size "
Hint counter: 29
Episode hint counter before: 1
Episode hint counter: 2
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(23, 39), match='query_cache_size'>, value=<re.Match object; span=(0, 2), match='50'>, recommendation='50', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=50.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19981148838996887, 0.21986037492752075, 0.2630220055580139, 0.16092373430728912, 0.15638239681720734]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(23, 39), match='query_cache_size'>, value=<re.Match object; span=(0, 2), match='50'>, recommendation='50', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=50.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.03255493938922882, 0.4847303330898285, 0.1944613754749298, 0.1586245894432068, 0.1296287328004837]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(23, 39), match='query_cache_size'>, value=<re.Match object; span=(0, 2), match='50'>, recommendation='50', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=50.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19981148838996887, 0.21986037492752075, 0.2630220055580139, 0.16092373430728912, 0.15638239681720734]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(23, 39), match='query_cache_size'>, value=<re.Match object; span=(0, 2), match='50'>, recommendation='50', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=50.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.03255493938922882, 0.4847303330898285, 0.1944613754749298, 0.1586245894432068, 0.1296287328004837]
Choice: 3
Trying update set global query_cache_size=50
Trying update set global query_cache_size=1048576
Trying assigning query_cache_size to 50
Adding assignment ('query_cache_size', '50') with weight 8
Assignment ('query_cache_size', '50') extracted from "key_buffer_size = 1200
query_cache_size = 50
tmp_table_size = 128
innodb_buffer_pool_size = 4096
innodb_log_buffer_size = 32
sort_buffer_size = 2048
read_buffer_size = 256 key_buffer_size "
Hint counter: 30
Episode hint counter before: 2
Episode hint counter: 3
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(223, 239), match='query_cache_size'>, value=<re.Match object; span=(0, 1), match='0'>, recommendation='0', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=0.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20856523513793945, 0.2019384503364563, 0.27009207010269165, 0.17301714420318604, 0.14638707041740417]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(223, 239), match='query_cache_size'>, value=<re.Match object; span=(0, 1), match='0'>, recommendation='0', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=0.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.04412984102964401, 0.44440340995788574, 0.20087464153766632, 0.16065354645252228, 0.14993849396705627]
Choice: 4
Trying update set global query_cache_size=0
Trying update set global query_cache_size=1048576
Trying assigning query_cache_size to 0
Adding assignment ('query_cache_size', '0') with weight 16
Assignment ('query_cache_size', '0') extracted from "The whole problem is the number of cores. I advise you to install at least 2 CPU cores.
Given the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.
MySQL:
key_buffer_size = 16
query_cache_size = 0
tmp_table_size = 32 thread_cache_size "
Hint counter: 31
Episode hint counter before: 3
Episode hint counter: 4
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=63, param=<re.Match object; span=(54, 70), match='query_cache_size'>, value=<re.Match object; span=(0, 4), match='300M'>, recommendation='300M', passage='# * Query Cache Configuration\nquery_cache_limit\n= 50M\nquery_cache_size\n= 300M\n# * Logging and Replication\n# * InnoDB\n# InnoDB is enabled by default with a 10MB datafile in /var/lib/mysql/. query_cache_limit ', float_val=300.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.16972294449806213, 0.1636090725660324, 0.28496333956718445, 0.17855490744113922, 0.2031497359275818]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=63, param=<re.Match object; span=(54, 70), match='query_cache_size'>, value=<re.Match object; span=(0, 4), match='300M'>, recommendation='300M', passage='# * Query Cache Configuration\nquery_cache_limit\n= 50M\nquery_cache_size\n= 300M\n# * Logging and Replication\n# * InnoDB\n# InnoDB is enabled by default with a 10MB datafile in /var/lib/mysql/. query_cache_limit ', float_val=300.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.01771782524883747, 0.43009284138679504, 0.20850959420204163, 0.18484938144683838, 0.15883034467697144]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=63, param=<re.Match object; span=(54, 70), match='query_cache_size'>, value=<re.Match object; span=(0, 4), match='300M'>, recommendation='300M', passage='# * Query Cache Configuration\nquery_cache_limit\n= 50M\nquery_cache_size\n= 300M\n# * Logging and Replication\n# * InnoDB\n# InnoDB is enabled by default with a 10MB datafile in /var/lib/mysql/. query_cache_limit ', float_val=300.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.16972294449806213, 0.1636090725660324, 0.28496333956718445, 0.17855490744113922, 0.2031497359275818]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=63, param=<re.Match object; span=(54, 70), match='query_cache_size'>, value=<re.Match object; span=(0, 4), match='300M'>, recommendation='300M', passage='# * Query Cache Configuration\nquery_cache_limit\n= 50M\nquery_cache_size\n= 300M\n# * Logging and Replication\n# * InnoDB\n# InnoDB is enabled by default with a 10MB datafile in /var/lib/mysql/. query_cache_limit ', float_val=300.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.01771782524883747, 0.43009284138679504, 0.20850959420204163, 0.18484938144683838, 0.15883034467697144]
Choice: 2
Trying update set global query_cache_size=1258291200
Trying update set global query_cache_size=1048576
Trying assigning query_cache_size to 1200M
Adding assignment ('query_cache_size', '1200M') with weight 4
Assignment ('query_cache_size', '1200M') extracted from "# * Query Cache Configuration
query_cache_limit
= 50M
query_cache_size
= 300M
# * Logging and Replication
# * InnoDB
# InnoDB is enabled by default with a 10MB datafile in /var/lib/mysql/. query_cache_limit "
Hint counter: 32
Episode hint counter before: 4
Episode hint counter: 5
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=11, param=<re.Match object; span=(343, 367), match='query_cache_min_res_unit'>, value=<re.Match object; span=(0, 2), match='2K'>, recommendation='2K. max_binlog_stmt_cache_size', passage='If you are able, the MySQLTuner tool can be run against your MySQL server and will calculate appropriate configuration values for most of the following settings based on your current load, status and variables automatically.\nEnable the query cache with\nquery_cache_type = 1.\nFor most Moodle installs, set the following:\nquery_cache_size = 36M\nquery_cache_min_res_unit = 2K. max_binlog_stmt_cache_size ', float_val=2.0, val_unit='K', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1023973599076271, 0.10131178051233292, 0.37586623430252075, 0.2043144553899765, 0.21611016988754272]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=11, param=<re.Match object; span=(343, 367), match='query_cache_min_res_unit'>, value=<re.Match object; span=(0, 2), match='2K'>, recommendation='2K. max_binlog_stmt_cache_size', passage='If you are able, the MySQLTuner tool can be run against your MySQL server and will calculate appropriate configuration values for most of the following settings based on your current load, status and variables automatically.\nEnable the query cache with\nquery_cache_type = 1.\nFor most Moodle installs, set the following:\nquery_cache_size = 36M\nquery_cache_min_res_unit = 2K. max_binlog_stmt_cache_size ', float_val=2.0, val_unit='K', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.01548533234745264, 0.5477354526519775, 0.17416539788246155, 0.14326906204223633, 0.11934469640254974]
Choice: 3
Trying update set global query_cache_min_res_unit=2048
Trying update set global query_cache_min_res_unit=4096
Trying assigning query_cache_min_res_unit to 2K
Adding assignment ('query_cache_min_res_unit', '2K') with weight 8
Assignment ('query_cache_min_res_unit', '2K') extracted from "If you are able, the MySQLTuner tool can be run against your MySQL server and will calculate appropriate configuration values for most of the following settings based on your current load, status and variables automatically.
Enable the query cache with
query_cache_type = 1.
For most Moodle installs, set the following:
query_cache_size = 36M
query_cache_min_res_unit = 2K. max_binlog_stmt_cache_size "
Hint counter: 33
Episode hint counter before: 5
Episode hint counter: 6
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(497, 521), match='query_cache_min_res_unit'>, value=<re.Match object; span=(0, 4), match='4096'>, recommendation='4096 (4KB).', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=4096.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1934792846441269, 0.12025752663612366, 0.3037382960319519, 0.15213847160339355, 0.23038634657859802]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(497, 521), match='query_cache_min_res_unit'>, value=<re.Match object; span=(0, 4), match='4096'>, recommendation='4096 (4KB).', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=4096.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.028957035392522812, 0.4735428988933563, 0.2037220150232315, 0.16191641986370087, 0.13186153769493103]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(497, 521), match='query_cache_min_res_unit'>, value=<re.Match object; span=(0, 4), match='4096'>, recommendation='4096 (4KB).', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=4096.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1934792846441269, 0.12025752663612366, 0.3037382960319519, 0.15213847160339355, 0.23038634657859802]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(497, 521), match='query_cache_min_res_unit'>, value=<re.Match object; span=(0, 4), match='4096'>, recommendation='4096 (4KB).', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=4096.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.028957035392522812, 0.4735428988933563, 0.2037220150232315, 0.16191641986370087, 0.13186153769493103]
Choice: 0
Trying update set global query_cache_min_res_unit=2048
Trying update set global query_cache_min_res_unit=4096
Trying assigning query_cache_min_res_unit to 2048
Adding assignment ('query_cache_min_res_unit', '2048') with weight 1
Assignment ('query_cache_min_res_unit', '2048') extracted from "Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).
Adjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size "
Hint counter: 34
Episode hint counter before: 6
Episode hint counter: 7
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(497, 521), match='query_cache_min_res_unit'>, value=<re.Match object; span=(6, 9), match='4KB'>, recommendation='4096 (4KB).', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=4.0, val_unit='KB', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1934792846441269, 0.12025752663612366, 0.3037382960319519, 0.15213847160339355, 0.23038634657859802]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(497, 521), match='query_cache_min_res_unit'>, value=<re.Match object; span=(6, 9), match='4KB'>, recommendation='4096 (4KB).', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=4.0, val_unit='KB', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.028957035392522812, 0.4735428988933563, 0.2037220150232315, 0.16191641986370087, 0.13186153769493103]
Choice: 2
Trying update set global query_cache_min_res_unit=1024
Trying update set global query_cache_min_res_unit=4096
Trying assigning query_cache_min_res_unit to 1KB
Adding assignment ('query_cache_min_res_unit', '1KB') with weight 4
Assignment ('query_cache_min_res_unit', '1KB') extracted from "Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).
Adjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size "
Hint counter: 35
Episode hint counter before: 7
Episode hint counter: 8
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(380, 394), match='tmp_table_size'>, value=<re.Match object; span=(0, 1), match='5'>, recommendation='5', passage="Adjusting Swappiness - Swappiness is how aggressively the OS will swap to and from RAM to disk - useful for applications you're using and then quickly switching, not so much for databasing where the buffer_pool could then be swapped out to disk, defeating the purpose of the buffer_pool. I set this to the recommended value of 5.\nOther Adjustments from the Inter-webs:\nI adjusted tmp_table_size to 64MB, seems to be recommended a lot over the internet, and I figured it couldn't hurt due to the amount of RAM we have available (default is 16MB for this). thread_cache_size ", float_val=5.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19026686251163483, 0.15310339629650116, 0.2528528869152069, 0.18311728537082672, 0.2206595540046692]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(380, 394), match='tmp_table_size'>, value=<re.Match object; span=(0, 1), match='5'>, recommendation='5', passage="Adjusting Swappiness - Swappiness is how aggressively the OS will swap to and from RAM to disk - useful for applications you're using and then quickly switching, not so much for databasing where the buffer_pool could then be swapped out to disk, defeating the purpose of the buffer_pool. I set this to the recommended value of 5.\nOther Adjustments from the Inter-webs:\nI adjusted tmp_table_size to 64MB, seems to be recommended a lot over the internet, and I figured it couldn't hurt due to the amount of RAM we have available (default is 16MB for this). thread_cache_size ", float_val=5.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.031143534928560257, 0.47899532318115234, 0.1991700381040573, 0.1566268354654312, 0.13406425714492798]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(380, 394), match='tmp_table_size'>, value=<re.Match object; span=(0, 1), match='5'>, recommendation='5', passage="Adjusting Swappiness - Swappiness is how aggressively the OS will swap to and from RAM to disk - useful for applications you're using and then quickly switching, not so much for databasing where the buffer_pool could then be swapped out to disk, defeating the purpose of the buffer_pool. I set this to the recommended value of 5.\nOther Adjustments from the Inter-webs:\nI adjusted tmp_table_size to 64MB, seems to be recommended a lot over the internet, and I figured it couldn't hurt due to the amount of RAM we have available (default is 16MB for this). thread_cache_size ", float_val=5.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19026686251163483, 0.15310339629650116, 0.2528528869152069, 0.18311728537082672, 0.2206595540046692]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(380, 394), match='tmp_table_size'>, value=<re.Match object; span=(0, 1), match='5'>, recommendation='5', passage="Adjusting Swappiness - Swappiness is how aggressively the OS will swap to and from RAM to disk - useful for applications you're using and then quickly switching, not so much for databasing where the buffer_pool could then be swapped out to disk, defeating the purpose of the buffer_pool. I set this to the recommended value of 5.\nOther Adjustments from the Inter-webs:\nI adjusted tmp_table_size to 64MB, seems to be recommended a lot over the internet, and I figured it couldn't hurt due to the amount of RAM we have available (default is 16MB for this). thread_cache_size ", float_val=5.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.031143534928560257, 0.47899532318115234, 0.1991700381040573, 0.1566268354654312, 0.13406425714492798]
Choice: 0
Trying update set global tmp_table_size=10
Trying update set global tmp_table_size=16777216
Trying assigning tmp_table_size to 10
Adding assignment ('tmp_table_size', '10') with weight 1
Assignment ('tmp_table_size', '10') extracted from "Adjusting Swappiness - Swappiness is how aggressively the OS will swap to and from RAM to disk - useful for applications you're using and then quickly switching, not so much for databasing where the buffer_pool could then be swapped out to disk, defeating the purpose of the buffer_pool. I set this to the recommended value of 5.
Other Adjustments from the Inter-webs:
I adjusted tmp_table_size to 64MB, seems to be recommended a lot over the internet, and I figured it couldn't hurt due to the amount of RAM we have available (default is 16MB for this). thread_cache_size "
Hint counter: 36
Episode hint counter before: 8
Episode hint counter: 9
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(45, 59), match='tmp_table_size'>, value=<re.Match object; span=(0, 3), match='128'>, recommendation='128', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=128.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19846782088279724, 0.18246710300445557, 0.2555597424507141, 0.16601499915122986, 0.19749031960964203]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(45, 59), match='tmp_table_size'>, value=<re.Match object; span=(0, 3), match='128'>, recommendation='128', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=128.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.023743821308016777, 0.4462120532989502, 0.20742511749267578, 0.17375534772872925, 0.14886371791362762]
Choice: 1
Trying update set global tmp_table_size=512
Trying update set global tmp_table_size=16777216
Trying assigning tmp_table_size to 512
Adding assignment ('tmp_table_size', '512') with weight 2
Assignment ('tmp_table_size', '512') extracted from "key_buffer_size = 1200
query_cache_size = 50
tmp_table_size = 128
innodb_buffer_pool_size = 4096
innodb_log_buffer_size = 32
sort_buffer_size = 2048
read_buffer_size = 256 key_buffer_size "
Hint counter: 37
Episode hint counter before: 9
Episode hint counter: 10
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(244, 258), match='tmp_table_size'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19402799010276794, 0.19214743375778198, 0.26641327142715454, 0.15789352357387543, 0.1895178258419037]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(244, 258), match='tmp_table_size'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.027428098022937775, 0.46463149785995483, 0.20161142945289612, 0.1676764339208603, 0.13865259289741516]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(244, 258), match='tmp_table_size'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19402799010276794, 0.19214743375778198, 0.26641327142715454, 0.15789352357387543, 0.1895178258419037]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(244, 258), match='tmp_table_size'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.027428098022937775, 0.46463149785995483, 0.20161142945289612, 0.1676764339208603, 0.13865259289741516]
Choice: 4
Trying update set global tmp_table_size=64
Trying update set global tmp_table_size=16777216
Trying assigning tmp_table_size to 64
Adding assignment ('tmp_table_size', '64') with weight 16
Assignment ('tmp_table_size', '64') extracted from "The whole problem is the number of cores. I advise you to install at least 2 CPU cores.
Given the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.
MySQL:
key_buffer_size = 16
query_cache_size = 0
tmp_table_size = 32 thread_cache_size "
Hint counter: 38
Episode hint counter before: 10
Episode hint counter: 11
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(57, 87), match='innodb_flush_log_at_trx_commit'>, value=<re.Match object; span=(0, 1), match='0'>, recommendation='0', passage="Following the GitHub suggestion linked above, I also set innodb_flush_log_at_trx_commit to 0 - this means the database will no longer flush the to disk every time a transaction is performed, meaning it no longer conforms with ACID Principles, but however giving you a noticeable performance boost. This does mean if you lose power, you will lose the last second of transactions, but I'd prefer to have a UPS installed with Auto-Shutdown configured instead, or if in a datacenter some sort of failover and redundancy there. If you are turning this off though, make sure you have some sort of alternative to have those transactions written to disk in place - the last thing you want is to corrupt your Moodle Installation! (Hence why you have a Site backup of course).\nI also changed the log_slow_query_time to 1, meaning that anything taking longer than 1 second to process is considered a slow query. Seems quick to the naked eye, but bear in mind usually MariaDB/MySQL connections last milliseconds. innodb_flush_log_at_timeout ", float_val=0.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20856523513793945, 0.2019384503364563, 0.27009207010269165, 0.17301714420318604, 0.14638707041740417]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(57, 87), match='innodb_flush_log_at_trx_commit'>, value=<re.Match object; span=(0, 1), match='0'>, recommendation='0', passage="Following the GitHub suggestion linked above, I also set innodb_flush_log_at_trx_commit to 0 - this means the database will no longer flush the to disk every time a transaction is performed, meaning it no longer conforms with ACID Principles, but however giving you a noticeable performance boost. This does mean if you lose power, you will lose the last second of transactions, but I'd prefer to have a UPS installed with Auto-Shutdown configured instead, or if in a datacenter some sort of failover and redundancy there. If you are turning this off though, make sure you have some sort of alternative to have those transactions written to disk in place - the last thing you want is to corrupt your Moodle Installation! (Hence why you have a Site backup of course).\nI also changed the log_slow_query_time to 1, meaning that anything taking longer than 1 second to process is considered a slow query. Seems quick to the naked eye, but bear in mind usually MariaDB/MySQL connections last milliseconds. innodb_flush_log_at_timeout ", float_val=0.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.04412984102964401, 0.44440340995788574, 0.20087464153766632, 0.16065354645252228, 0.14993849396705627]
Choice: 0
Trying update set global innodb_flush_log_at_trx_commit=0
Trying update set global innodb_flush_log_at_trx_commit=1
Trying assigning innodb_flush_log_at_trx_commit to 0
Adding assignment ('innodb_flush_log_at_trx_commit', '0') with weight 1
Assignment ('innodb_flush_log_at_trx_commit', '0') extracted from "Following the GitHub suggestion linked above, I also set innodb_flush_log_at_trx_commit to 0 - this means the database will no longer flush the to disk every time a transaction is performed, meaning it no longer conforms with ACID Principles, but however giving you a noticeable performance boost. This does mean if you lose power, you will lose the last second of transactions, but I'd prefer to have a UPS installed with Auto-Shutdown configured instead, or if in a datacenter some sort of failover and redundancy there. If you are turning this off though, make sure you have some sort of alternative to have those transactions written to disk in place - the last thing you want is to corrupt your Moodle Installation! (Hence why you have a Site backup of course).
I also changed the log_slow_query_time to 1, meaning that anything taking longer than 1 second to process is considered a slow query. Seems quick to the naked eye, but bear in mind usually MariaDB/MySQL connections last milliseconds. innodb_flush_log_at_timeout "
Hint counter: 39
Episode hint counter before: 11
Episode hint counter: 12
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(155, 185), match='innodb_flush_log_at_trx_commit'>, value=<re.Match object; span=(0, 1), match='2'>, recommendation='2', passage='innodb_stats_on_metadata = off\ninnodb-flush-method = O_DIRECT\ninnodb-flush-log-at-trx-commit = 2\ninnodb_buffer_pool_size = 23G\ninnodb_read_io_threads = 32 innodb_flush_log_at_trx_commit ', float_val=2.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1801619678735733, 0.15713483095169067, 0.24640542268753052, 0.18963998556137085, 0.22665782272815704]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(155, 185), match='innodb_flush_log_at_trx_commit'>, value=<re.Match object; span=(0, 1), match='2'>, recommendation='2', passage='innodb_stats_on_metadata = off\ninnodb-flush-method = O_DIRECT\ninnodb-flush-log-at-trx-commit = 2\ninnodb_buffer_pool_size = 23G\ninnodb_read_io_threads = 32 innodb_flush_log_at_trx_commit ', float_val=2.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02990572713315487, 0.4811877906322479, 0.19468748569488525, 0.15864630043506622, 0.13557271659374237]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(155, 185), match='innodb_flush_log_at_trx_commit'>, value=<re.Match object; span=(0, 1), match='2'>, recommendation='2', passage='innodb_stats_on_metadata = off\ninnodb-flush-method = O_DIRECT\ninnodb-flush-log-at-trx-commit = 2\ninnodb_buffer_pool_size = 23G\ninnodb_read_io_threads = 32 innodb_flush_log_at_trx_commit ', float_val=2.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1801619678735733, 0.15713483095169067, 0.24640542268753052, 0.18963998556137085, 0.22665782272815704]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(155, 185), match='innodb_flush_log_at_trx_commit'>, value=<re.Match object; span=(0, 1), match='2'>, recommendation='2', passage='innodb_stats_on_metadata = off\ninnodb-flush-method = O_DIRECT\ninnodb-flush-log-at-trx-commit = 2\ninnodb_buffer_pool_size = 23G\ninnodb_read_io_threads = 32 innodb_flush_log_at_trx_commit ', float_val=2.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02990572713315487, 0.4811877906322479, 0.19468748569488525, 0.15864630043506622, 0.13557271659374237]
Choice: 2
Trying update set global innodb_flush_log_at_trx_commit=2
Trying update set global innodb_flush_log_at_trx_commit=1
Trying assigning innodb_flush_log_at_trx_commit to 2
Adding assignment ('innodb_flush_log_at_trx_commit', '2') with weight 4
Assignment ('innodb_flush_log_at_trx_commit', '2') extracted from "innodb_stats_on_metadata = off
innodb-flush-method = O_DIRECT
innodb-flush-log-at-trx-commit = 2
innodb_buffer_pool_size = 23G
innodb_read_io_threads = 32 innodb_flush_log_at_trx_commit "
Hint counter: 40
Episode hint counter before: 12
Episode hint counter: 13
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(57, 73), match='open_files_limit'>, value=<re.Match object; span=(0, 5), match='65535'>, recommendation='65535', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=65535.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1854260116815567, 0.2215997278690338, 0.24921073019504547, 0.16128242015838623, 0.18248112499713898]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(57, 73), match='open_files_limit'>, value=<re.Match object; span=(0, 5), match='65535'>, recommendation='65535', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=65535.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.03696446865797043, 0.4570375382900238, 0.19957877695560455, 0.1675446480512619, 0.13887451589107513]
Choice: 0
Trying update set global open_files_limit=131070
Exception during update: Variable 'open_files_limit' is a read only variable
Trying update set global open_files_limit=32135
Exception during update: Variable 'open_files_limit' is a read only variable
Trying assigning open_files_limit to 131070
Assignment ('open_files_limit', '131070') was rejected
Hint counter: 41
Episode hint counter before: 13
Episode hint counter: 14
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(5291, 5307), match='open_files_limit'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1/4000/524288', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.15048553049564362, 0.14434988796710968, 0.2936961352825165, 0.19875210523605347, 0.21271634101867676]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(5291, 5307), match='open_files_limit'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1/4000/524288', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02138276770710945, 0.4854452610015869, 0.20025865733623505, 0.16094550490379333, 0.13196787238121033]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(5291, 5307), match='open_files_limit'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1/4000/524288', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.15048553049564362, 0.14434988796710968, 0.2936961352825165, 0.19875210523605347, 0.21271634101867676]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(5291, 5307), match='open_files_limit'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1/4000/524288', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02138276770710945, 0.4854452610015869, 0.20025865733623505, 0.16094550490379333, 0.13196787238121033]
Choice: 4
Trying update set global open_files_limit=1
Exception during update: Variable 'open_files_limit' is a read only variable
Trying update set global open_files_limit=32135
Exception during update: Variable 'open_files_limit' is a read only variable
Trying assigning open_files_limit to 1
Assignment ('open_files_limit', '1') was rejected
Hint counter: 42
Episode hint counter before: 14
Episode hint counter: 15
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(5291, 5307), match='open_files_limit'>, value=<re.Match object; span=(2, 6), match='4000'>, recommendation='1/4000/524288', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=4000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.15048553049564362, 0.14434988796710968, 0.2936961352825165, 0.19875210523605347, 0.21271634101867676]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(5291, 5307), match='open_files_limit'>, value=<re.Match object; span=(2, 6), match='4000'>, recommendation='1/4000/524288', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=4000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02138276770710945, 0.4854452610015869, 0.20025865733623505, 0.16094550490379333, 0.13196787238121033]
Choice: 1
Trying update set global open_files_limit=4000
Exception during update: Variable 'open_files_limit' is a read only variable
Trying update set global open_files_limit=32135
Exception during update: Variable 'open_files_limit' is a read only variable
Trying assigning open_files_limit to 4000
Assignment ('open_files_limit', '4000') was rejected
Hint counter: 43
Episode hint counter before: 15
Episode hint counter: 16
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(5291, 5307), match='open_files_limit'>, value=<re.Match object; span=(7, 13), match='524288'>, recommendation='1/4000/524288', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=524288.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.15048553049564362, 0.14434988796710968, 0.2936961352825165, 0.19875210523605347, 0.21271634101867676]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(5291, 5307), match='open_files_limit'>, value=<re.Match object; span=(7, 13), match='524288'>, recommendation='1/4000/524288', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=524288.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02138276770710945, 0.4854452610015869, 0.20025865733623505, 0.16094550490379333, 0.13196787238121033]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(5291, 5307), match='open_files_limit'>, value=<re.Match object; span=(7, 13), match='524288'>, recommendation='1/4000/524288', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=524288.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.15048553049564362, 0.14434988796710968, 0.2936961352825165, 0.19875210523605347, 0.21271634101867676]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(5291, 5307), match='open_files_limit'>, value=<re.Match object; span=(7, 13), match='524288'>, recommendation='1/4000/524288', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=524288.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02138276770710945, 0.4854452610015869, 0.20025865733623505, 0.16094550490379333, 0.13196787238121033]
Choice: 0
Trying update set global open_files_limit=524288
Exception during update: Variable 'open_files_limit' is a read only variable
Trying update set global open_files_limit=32135
Exception during update: Variable 'open_files_limit' is a read only variable
Trying assigning open_files_limit to 524288
Assignment ('open_files_limit', '524288') was rejected
Hint counter: 44
Episode hint counter before: 16
Episode hint counter: 17
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=63, param=<re.Match object; span=(112, 128), match='open_files_limit'>, value=<re.Match object; span=(0, 5), match='65000'>, recommendation='65000', passage='max_connections\n= 500\nmax_user_connections\n= 500\n#table_cache\n= 64\nthread_concurrency\n= 300\ntable_cache\n= 30000\nopen_files_limit\n= 65000\n#innodb_force_recovery =6 max_binlog_stmt_cache_size ', float_val=65000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19281907379627228, 0.1722368597984314, 0.27188217639923096, 0.15870161354541779, 0.204360231757164]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=63, param=<re.Match object; span=(112, 128), match='open_files_limit'>, value=<re.Match object; span=(0, 5), match='65000'>, recommendation='65000', passage='max_connections\n= 500\nmax_user_connections\n= 500\n#table_cache\n= 64\nthread_concurrency\n= 300\ntable_cache\n= 30000\nopen_files_limit\n= 65000\n#innodb_force_recovery =6 max_binlog_stmt_cache_size ', float_val=65000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.028419196605682373, 0.4433954358100891, 0.20522458851337433, 0.17373628914356232, 0.14922446012496948]
Choice: 0
Trying update set global open_files_limit=65000
Exception during update: Variable 'open_files_limit' is a read only variable
Trying update set global open_files_limit=32135
Exception during update: Variable 'open_files_limit' is a read only variable
Trying assigning open_files_limit to 65000
Assignment ('open_files_limit', '65000') was rejected
Hint counter: 45
Episode hint counter before: 17
Episode hint counter: 18
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(140, 158), match='max_allowed_packet'>, value=<re.Match object; span=(0, 3), match='64M'>, recommendation='64M thread_pool_max_threads', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=64.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.11055229604244232, 0.11911507695913315, 0.39629071950912476, 0.16224564611911774, 0.21179628372192383]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(140, 158), match='max_allowed_packet'>, value=<re.Match object; span=(0, 3), match='64M'>, recommendation='64M thread_pool_max_threads', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=64.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02049153484404087, 0.5346100926399231, 0.19197659194469452, 0.15021955966949463, 0.10270220786333084]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(140, 158), match='max_allowed_packet'>, value=<re.Match object; span=(0, 3), match='64M'>, recommendation='64M thread_pool_max_threads', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=64.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.11055229604244232, 0.11911507695913315, 0.39629071950912476, 0.16224564611911774, 0.21179628372192383]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(140, 158), match='max_allowed_packet'>, value=<re.Match object; span=(0, 3), match='64M'>, recommendation='64M thread_pool_max_threads', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=64.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02049153484404087, 0.5346100926399231, 0.19197659194469452, 0.15021955966949463, 0.10270220786333084]
Choice: 4
Trying update set global max_allowed_packet=134217728
Trying update set global max_allowed_packet=16777216
Trying assigning max_allowed_packet to 128M
Adding assignment ('max_allowed_packet', '128M') with weight 16
Assignment ('max_allowed_packet', '128M') extracted from "tmp-table-size = 96M
max-heap-table-size = 96M
key_buffer_size = 64M
# Connections and Threads
max_connections = 1250
thread_cache_size = 8
max_allowed_packet = 64M thread_pool_max_threads "
Hint counter: 46
Episode hint counter before: 18
Episode hint counter: 19
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(2259, 2277), match='max_allowed_packet'>, value=<re.Match object; span=(0, 1), match='0'>, recommendation='0/9/100000', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=0.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.21503010392189026, 0.20545345544815063, 0.25142577290534973, 0.13799600303173065, 0.1900947242975235]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(2259, 2277), match='max_allowed_packet'>, value=<re.Match object; span=(0, 1), match='0'>, recommendation='0/9/100000', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=0.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.023853391408920288, 0.4524601995944977, 0.20364059507846832, 0.16856379806995392, 0.15148194134235382]
Choice: 4
Trying update set global max_allowed_packet=0
Trying update set global max_allowed_packet=16777216
Trying assigning max_allowed_packet to 0
Adding assignment ('max_allowed_packet', '0') with weight 16
Assignment ('max_allowed_packet', '0') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "\n[Restart] MariaDB server shut down!
[Restart] MariaDB server restarted!
\n[Restart] MariaDB server shut down!
[Restart] MariaDB server restarted!

Hint counter: 47
Episode hint counter before: 19
Episode hint counter: 20
Hints per episode: 20
Episode finished!
Done flag: True
Finalizing episode!
Weighted hints: defaultdict(<function NlpTuningEnv._finalize_episode.<locals>.<lambda> at 0x7f8767de0670>, {('table_open_cache', '128'): 2, ('query_cache_size', '8'): 2, ('query_cache_size', '50'): 8, ('query_cache_size', '0'): 16, ('query_cache_size', '1200M'): 4, ('query_cache_min_res_unit', '2K'): 8, ('query_cache_min_res_unit', '2048'): 1, ('query_cache_min_res_unit', '1KB'): 4, ('tmp_table_size', '10'): 1, ('tmp_table_size', '512'): 2, ('tmp_table_size', '64'): 16, ('innodb_flush_log_at_trx_commit', '0'): 1, ('innodb_flush_log_at_trx_commit', '2'): 4, ('max_allowed_packet', '128M'): 16, ('max_allowed_packet', '0'): 16})
Selected configurations: [{'table_open_cache': '128', 'query_cache_size': '50', 'query_cache_min_res_unit': '2K', 'tmp_table_size': '64', 'innodb_flush_log_at_trx_commit': '2', 'max_allowed_packet': '128M'}, {'table_open_cache': '128', 'query_cache_size': '1200M', 'query_cache_min_res_unit': '1KB', 'tmp_table_size': '512', 'innodb_flush_log_at_trx_commit': '0', 'max_allowed_packet': '0'}]
Disconnecting ...
Trying to connect to tpch with user kaltenec
Trying update set session max_execution_time = 1500000
Exception during update: Unknown system variable 'max_execution_time'
Trying update update mariadb.server_cost set cost_value = NULL
Exception during update: Table 'mariadb.server_cost' doesn't exist
Trying update update mariadb.engine_cost set cost_value = NULL
Exception during update: Table 'mariadb.engine_cost' doesn't exist
Trying configuration: {'table_open_cache': '128', 'query_cache_size': '50', 'query_cache_min_res_unit': '2K', 'tmp_table_size': '64', 'innodb_flush_log_at_trx_commit': '2', 'max_allowed_packet': '128M'}
Trying update set global table_open_cache=128
Trying update set global query_cache_size=50
Trying update set global query_cache_min_res_unit=2048
Trying update set global tmp_table_size=64
Trying update set global innodb_flush_log_at_trx_commit=2
Trying update set global max_allowed_packet=134217728
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Reward 287.2470703125 with {'table_open_cache': '128', 'query_cache_size': '50', 'query_cache_min_res_unit': '2K', 'tmp_table_size': '64', 'innodb_flush_log_at_trx_commit': '2', 'max_allowed_packet': '128M'}
Disconnecting ...
Trying to connect to tpch with user kaltenec
Trying update set session max_execution_time = 1500000
Exception during update: Unknown system variable 'max_execution_time'
Trying update update mariadb.server_cost set cost_value = NULL
Exception during update: Table 'mariadb.server_cost' doesn't exist
Trying update update mariadb.engine_cost set cost_value = NULL
Exception during update: Table 'mariadb.engine_cost' doesn't exist
Trying configuration: {'table_open_cache': '128', 'query_cache_size': '1200M', 'query_cache_min_res_unit': '1KB', 'tmp_table_size': '512', 'innodb_flush_log_at_trx_commit': '0', 'max_allowed_packet': '0'}
Trying update set global table_open_cache=128
Trying update set global query_cache_size=1258291200
Trying update set global query_cache_min_res_unit=1024
Trying update set global tmp_table_size=512
Trying update set global innodb_flush_log_at_trx_commit=0
Trying update set global max_allowed_packet=0
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Reward 2103.548828125 with {'table_open_cache': '128', 'query_cache_size': '1200M', 'query_cache_min_res_unit': '1KB', 'tmp_table_size': '512', 'innodb_flush_log_at_trx_commit': '0', 'max_allowed_packet': '0'}
Obtained 2103.548828125 by configuration {'table_open_cache': '128', 'query_cache_size': '1200M', 'query_cache_min_res_unit': '1KB', 'tmp_table_size': '512', 'innodb_flush_log_at_trx_commit': '0', 'max_allowed_packet': '0'}
Achieved unscaled reward of 2103.548828125 using {'table_open_cache': '128', 'query_cache_size': '1200M', 'query_cache_min_res_unit': '1KB', 'tmp_table_size': '512', 'innodb_flush_log_at_trx_commit': '0', 'max_allowed_packet': '0'}.
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(2259, 2277), match='max_allowed_packet'>, value=<re.Match object; span=(2, 3), match='9'>, recommendation='0/9/100000', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=9.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.21503010392189026, 0.20545345544815063, 0.25142577290534973, 0.13799600303173065, 0.1900947242975235]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(2259, 2277), match='max_allowed_packet'>, value=<re.Match object; span=(2, 3), match='9'>, recommendation='0/9/100000', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=9.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.21503010392189026, 0.20545345544815063, 0.25142577290534973, 0.13799600303173065, 0.1900947242975235]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(2259, 2277), match='max_allowed_packet'>, value=<re.Match object; span=(2, 3), match='9'>, recommendation='0/9/100000', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=9.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.023853391408920288, 0.4524601995944977, 0.20364059507846832, 0.16856379806995392, 0.15148194134235382]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(2259, 2277), match='max_allowed_packet'>, value=<re.Match object; span=(2, 3), match='9'>, recommendation='0/9/100000', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=9.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.21503010392189026, 0.20545345544815063, 0.25142577290534973, 0.13799600303173065, 0.1900947242975235]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(2259, 2277), match='max_allowed_packet'>, value=<re.Match object; span=(2, 3), match='9'>, recommendation='0/9/100000', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=9.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.023853391408920288, 0.4524601995944977, 0.20364059507846832, 0.16856379806995392, 0.15148194134235382]
Choice: 1
Trying update set global max_allowed_packet=9
Trying update set global max_allowed_packet=16777216
Trying assigning max_allowed_packet to 9
Adding assignment ('max_allowed_packet', '9') with weight 2
Assignment ('max_allowed_packet', '9') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 48
Episode hint counter before: 0
Episode hint counter: 1
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(2259, 2277), match='max_allowed_packet'>, value=<re.Match object; span=(4, 10), match='100000'>, recommendation='0/9/100000', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=100000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.21503010392189026, 0.20545345544815063, 0.25142577290534973, 0.13799600303173065, 0.1900947242975235]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(2259, 2277), match='max_allowed_packet'>, value=<re.Match object; span=(4, 10), match='100000'>, recommendation='0/9/100000', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=100000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.023853391408920288, 0.4524601995944977, 0.20364059507846832, 0.16856379806995392, 0.15148194134235382]
Choice: 4
Trying update set global max_allowed_packet=25000
Trying update set global max_allowed_packet=16777216
Trying assigning max_allowed_packet to 25000
Adding assignment ('max_allowed_packet', '25000') with weight 16
Assignment ('max_allowed_packet', '25000') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 49
Episode hint counter before: 1
Episode hint counter: 2
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=63, param=<re.Match object; span=(20, 38), match='max_allowed_packet'>, value=<re.Match object; span=(0, 3), match='16M'>, recommendation='16M', passage='key_buffer\t\t= 2000M\nmax_allowed_packet\t= 16M\nthread_stack\t\t= 128K\nthread_cache_size\t= 8\n# This replaces the startup script and checks MyISAM tables if needed\n# the first time they are touched\nmyisam-recover\t\t= BACKUP table_open_cache_instances ', float_val=16.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1848161667585373, 0.17571277916431427, 0.2692857086658478, 0.1642920821905136, 0.20589323341846466]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=63, param=<re.Match object; span=(20, 38), match='max_allowed_packet'>, value=<re.Match object; span=(0, 3), match='16M'>, recommendation='16M', passage='key_buffer\t\t= 2000M\nmax_allowed_packet\t= 16M\nthread_stack\t\t= 128K\nthread_cache_size\t= 8\n# This replaces the startup script and checks MyISAM tables if needed\n# the first time they are touched\nmyisam-recover\t\t= BACKUP table_open_cache_instances ', float_val=16.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.020175406709313393, 0.4479617476463318, 0.20477642118930817, 0.16790476441383362, 0.15918168425559998]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=63, param=<re.Match object; span=(20, 38), match='max_allowed_packet'>, value=<re.Match object; span=(0, 3), match='16M'>, recommendation='16M', passage='key_buffer\t\t= 2000M\nmax_allowed_packet\t= 16M\nthread_stack\t\t= 128K\nthread_cache_size\t= 8\n# This replaces the startup script and checks MyISAM tables if needed\n# the first time they are touched\nmyisam-recover\t\t= BACKUP table_open_cache_instances ', float_val=16.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1848161667585373, 0.17571277916431427, 0.2692857086658478, 0.1642920821905136, 0.20589323341846466]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=63, param=<re.Match object; span=(20, 38), match='max_allowed_packet'>, value=<re.Match object; span=(0, 3), match='16M'>, recommendation='16M', passage='key_buffer\t\t= 2000M\nmax_allowed_packet\t= 16M\nthread_stack\t\t= 128K\nthread_cache_size\t= 8\n# This replaces the startup script and checks MyISAM tables if needed\n# the first time they are touched\nmyisam-recover\t\t= BACKUP table_open_cache_instances ', float_val=16.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.020175406709313393, 0.4479617476463318, 0.20477642118930817, 0.16790476441383362, 0.15918168425559998]
Choice: 4
Trying update set global max_allowed_packet=4194304
Trying update set global max_allowed_packet=16777216
Trying assigning max_allowed_packet to 4M
Adding assignment ('max_allowed_packet', '4M') with weight 16
Assignment ('max_allowed_packet', '4M') extracted from "key_buffer		= 2000M
max_allowed_packet	= 16M
thread_stack		= 128K
thread_cache_size	= 8
# This replaces the startup script and checks MyISAM tables if needed
# the first time they are touched
myisam-recover		= BACKUP table_open_cache_instances "
Hint counter: 50
Episode hint counter before: 2
Episode hint counter: 3
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(51, 63), match='thread_stack'>, value=<re.Match object; span=(0, 3), match='512'>, recommendation='512', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=512.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18853892385959625, 0.17371782660484314, 0.2637619078159332, 0.19082817435264587, 0.18315310776233673]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(51, 63), match='thread_stack'>, value=<re.Match object; span=(0, 3), match='512'>, recommendation='512', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=512.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.022273913025856018, 0.45673248171806335, 0.20234665274620056, 0.1712857037782669, 0.14736124873161316]
Choice: 0
Trying update set global thread_stack=512
Exception during update: Variable 'thread_stack' is a read only variable
Trying update set global thread_stack=299008
Exception during update: Variable 'thread_stack' is a read only variable
Trying assigning thread_stack to 512
Assignment ('thread_stack', '512') was rejected
Hint counter: 51
Episode hint counter before: 3
Episode hint counter: 4
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(157, 169), match='thread_stack'>, value=<re.Match object; span=(0, 3), match='192'>, recommendation='192', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=192.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18821486830711365, 0.16262833774089813, 0.25859376788139343, 0.17812727391719818, 0.21243582665920258]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(157, 169), match='thread_stack'>, value=<re.Match object; span=(0, 3), match='192'>, recommendation='192', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=192.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.022838477045297623, 0.4440685212612152, 0.20842856168746948, 0.17406624555587769, 0.1505981981754303]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(157, 169), match='thread_stack'>, value=<re.Match object; span=(0, 3), match='192'>, recommendation='192', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=192.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18821486830711365, 0.16262833774089813, 0.25859376788139343, 0.17812727391719818, 0.21243582665920258]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(157, 169), match='thread_stack'>, value=<re.Match object; span=(0, 3), match='192'>, recommendation='192', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=192.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.022838477045297623, 0.4440685212612152, 0.20842856168746948, 0.17406624555587769, 0.1505981981754303]
Choice: 4
Trying update set global thread_stack=384
Exception during update: Variable 'thread_stack' is a read only variable
Trying update set global thread_stack=299008
Exception during update: Variable 'thread_stack' is a read only variable
Trying assigning thread_stack to 384
Assignment ('thread_stack', '384') was rejected
Hint counter: 52
Episode hint counter before: 4
Episode hint counter: 5
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=63, param=<re.Match object; span=(45, 57), match='thread_stack'>, value=<re.Match object; span=(0, 4), match='128K'>, recommendation='128K', passage='key_buffer\t\t= 2000M\nmax_allowed_packet\t= 16M\nthread_stack\t\t= 128K\nthread_cache_size\t= 8\n# This replaces the startup script and checks MyISAM tables if needed\n# the first time they are touched\nmyisam-recover\t\t= BACKUP table_open_cache_instances ', float_val=128.0, val_unit='K', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18397192656993866, 0.15647098422050476, 0.2818615138530731, 0.16471435129642487, 0.2129811942577362]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=63, param=<re.Match object; span=(45, 57), match='thread_stack'>, value=<re.Match object; span=(0, 4), match='128K'>, recommendation='128K', passage='key_buffer\t\t= 2000M\nmax_allowed_packet\t= 16M\nthread_stack\t\t= 128K\nthread_cache_size\t= 8\n# This replaces the startup script and checks MyISAM tables if needed\n# the first time they are touched\nmyisam-recover\t\t= BACKUP table_open_cache_instances ', float_val=128.0, val_unit='K', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02461441420018673, 0.4361570477485657, 0.21562883257865906, 0.17626062035560608, 0.1473391205072403]
Choice: 2
Trying update set global thread_stack=262144
Exception during update: Variable 'thread_stack' is a read only variable
Trying update set global thread_stack=299008
Exception during update: Variable 'thread_stack' is a read only variable
Trying assigning thread_stack to 256K
Assignment ('thread_stack', '256K') was rejected
Hint counter: 53
Episode hint counter before: 5
Episode hint counter: 6
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=7, param=<re.Match object; span=(94, 110), match='join_cache_level'>, value=<re.Match object; span=(0, 1), match='3'>, recommendation='3 or a bigger', passage='Hash Join\nMariaDB supports Block Hash Join. It is not enabled by default, one needs to set it join_cache_level to 3 or a bigger value to enable it.\nBefore MDEV-30812, Query optimization for Block Hash Join would work as described in the above example: It would assume that the join operation is a cross join. query_alloc_block_size ', float_val=3.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.04928116500377655, 0.036258190870285034, 0.17399927973747253, 0.46727150678634644, 0.273189902305603]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=7, param=<re.Match object; span=(94, 110), match='join_cache_level'>, value=<re.Match object; span=(0, 1), match='3'>, recommendation='3 or a bigger', passage='Hash Join\nMariaDB supports Block Hash Join. It is not enabled by default, one needs to set it join_cache_level to 3 or a bigger value to enable it.\nBefore MDEV-30812, Query optimization for Block Hash Join would work as described in the above example: It would assume that the join operation is a cross join. query_alloc_block_size ', float_val=3.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.017950722947716713, 0.47814804315567017, 0.2144041806459427, 0.16039974987506866, 0.12909729778766632]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=7, param=<re.Match object; span=(94, 110), match='join_cache_level'>, value=<re.Match object; span=(0, 1), match='3'>, recommendation='3 or a bigger', passage='Hash Join\nMariaDB supports Block Hash Join. It is not enabled by default, one needs to set it join_cache_level to 3 or a bigger value to enable it.\nBefore MDEV-30812, Query optimization for Block Hash Join would work as described in the above example: It would assume that the join operation is a cross join. query_alloc_block_size ', float_val=3.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.04928116500377655, 0.036258190870285034, 0.17399927973747253, 0.46727150678634644, 0.273189902305603]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=7, param=<re.Match object; span=(94, 110), match='join_cache_level'>, value=<re.Match object; span=(0, 1), match='3'>, recommendation='3 or a bigger', passage='Hash Join\nMariaDB supports Block Hash Join. It is not enabled by default, one needs to set it join_cache_level to 3 or a bigger value to enable it.\nBefore MDEV-30812, Query optimization for Block Hash Join would work as described in the above example: It would assume that the join operation is a cross join. query_alloc_block_size ', float_val=3.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.017950722947716713, 0.47814804315567017, 0.2144041806459427, 0.16039974987506866, 0.12909729778766632]
Choice: 4
Trying update set global join_cache_level=1
Trying update set global join_cache_level=2
Trying assigning join_cache_level to 1
Adding assignment ('join_cache_level', '1') with weight 16
Assignment ('join_cache_level', '1') extracted from "Hash Join
MariaDB supports Block Hash Join. It is not enabled by default, one needs to set it join_cache_level to 3 or a bigger value to enable it.
Before MDEV-30812, Query optimization for Block Hash Join would work as described in the above example: It would assume that the join operation is a cross join. query_alloc_block_size "
Hint counter: 54
Episode hint counter before: 6
Episode hint counter: 7
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(16, 35), match='max_heap_table_size'>, value=<re.Match object; span=(0, 4), match='64MB'>, recommendation='64MB', passage="I also adjusted max_heap_table_size to 64MB again, on the recommendation of the internet. Looking at the information as to what it does, I figured it couldn't hurt - default is again 16MB. max_heap_table_size ", float_val=64.0, val_unit='MB', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18528391420841217, 0.12975457310676575, 0.30582311749458313, 0.15321524441242218, 0.22592315077781677]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(16, 35), match='max_heap_table_size'>, value=<re.Match object; span=(0, 4), match='64MB'>, recommendation='64MB', passage="I also adjusted max_heap_table_size to 64MB again, on the recommendation of the internet. Looking at the information as to what it does, I figured it couldn't hurt - default is again 16MB. max_heap_table_size ", float_val=64.0, val_unit='MB', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.0290024746209383, 0.4747910797595978, 0.20364288985729218, 0.15496112406253815, 0.13760244846343994]
Choice: 4
Trying update set global max_heap_table_size=67108864
Trying update set global max_heap_table_size=16777216
Trying assigning max_heap_table_size to 64MB
Adding assignment ('max_heap_table_size', '64MB') with weight 16
Assignment ('max_heap_table_size', '64MB') extracted from "I also adjusted max_heap_table_size to 64MB again, on the recommendation of the internet. Looking at the information as to what it does, I figured it couldn't hurt - default is again 16MB. max_heap_table_size "
Hint counter: 55
Episode hint counter before: 7
Episode hint counter: 8
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(786, 805), match='log_slow_query_time'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1', passage="Following the GitHub suggestion linked above, I also set innodb_flush_log_at_trx_commit to 0 - this means the database will no longer flush the to disk every time a transaction is performed, meaning it no longer conforms with ACID Principles, but however giving you a noticeable performance boost. This does mean if you lose power, you will lose the last second of transactions, but I'd prefer to have a UPS installed with Auto-Shutdown configured instead, or if in a datacenter some sort of failover and redundancy there. If you are turning this off though, make sure you have some sort of alternative to have those transactions written to disk in place - the last thing you want is to corrupt your Moodle Installation! (Hence why you have a Site backup of course).\nI also changed the log_slow_query_time to 1, meaning that anything taking longer than 1 second to process is considered a slow query. Seems quick to the naked eye, but bear in mind usually MariaDB/MySQL connections last milliseconds. innodb_flush_log_at_timeout ", float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.16976413130760193, 0.1318582147359848, 0.26459458470344543, 0.18136560916900635, 0.25241753458976746]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(786, 805), match='log_slow_query_time'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1', passage="Following the GitHub suggestion linked above, I also set innodb_flush_log_at_trx_commit to 0 - this means the database will no longer flush the to disk every time a transaction is performed, meaning it no longer conforms with ACID Principles, but however giving you a noticeable performance boost. This does mean if you lose power, you will lose the last second of transactions, but I'd prefer to have a UPS installed with Auto-Shutdown configured instead, or if in a datacenter some sort of failover and redundancy there. If you are turning this off though, make sure you have some sort of alternative to have those transactions written to disk in place - the last thing you want is to corrupt your Moodle Installation! (Hence why you have a Site backup of course).\nI also changed the log_slow_query_time to 1, meaning that anything taking longer than 1 second to process is considered a slow query. Seems quick to the naked eye, but bear in mind usually MariaDB/MySQL connections last milliseconds. innodb_flush_log_at_timeout ", float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.029607674106955528, 0.4530342221260071, 0.20463363826274872, 0.16576839983463287, 0.14695607125759125]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(786, 805), match='log_slow_query_time'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1', passage="Following the GitHub suggestion linked above, I also set innodb_flush_log_at_trx_commit to 0 - this means the database will no longer flush the to disk every time a transaction is performed, meaning it no longer conforms with ACID Principles, but however giving you a noticeable performance boost. This does mean if you lose power, you will lose the last second of transactions, but I'd prefer to have a UPS installed with Auto-Shutdown configured instead, or if in a datacenter some sort of failover and redundancy there. If you are turning this off though, make sure you have some sort of alternative to have those transactions written to disk in place - the last thing you want is to corrupt your Moodle Installation! (Hence why you have a Site backup of course).\nI also changed the log_slow_query_time to 1, meaning that anything taking longer than 1 second to process is considered a slow query. Seems quick to the naked eye, but bear in mind usually MariaDB/MySQL connections last milliseconds. innodb_flush_log_at_timeout ", float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.16976413130760193, 0.1318582147359848, 0.26459458470344543, 0.18136560916900635, 0.25241753458976746]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(786, 805), match='log_slow_query_time'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1', passage="Following the GitHub suggestion linked above, I also set innodb_flush_log_at_trx_commit to 0 - this means the database will no longer flush the to disk every time a transaction is performed, meaning it no longer conforms with ACID Principles, but however giving you a noticeable performance boost. This does mean if you lose power, you will lose the last second of transactions, but I'd prefer to have a UPS installed with Auto-Shutdown configured instead, or if in a datacenter some sort of failover and redundancy there. If you are turning this off though, make sure you have some sort of alternative to have those transactions written to disk in place - the last thing you want is to corrupt your Moodle Installation! (Hence why you have a Site backup of course).\nI also changed the log_slow_query_time to 1, meaning that anything taking longer than 1 second to process is considered a slow query. Seems quick to the naked eye, but bear in mind usually MariaDB/MySQL connections last milliseconds. innodb_flush_log_at_timeout ", float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.029607674106955528, 0.4530342221260071, 0.20463363826274872, 0.16576839983463287, 0.14695607125759125]
Choice: 1
Trying update set global log_slow_query_time=4
Trying update set global log_slow_query_time=10.0
Trying assigning log_slow_query_time to 4
Adding assignment ('log_slow_query_time', '4') with weight 2
Assignment ('log_slow_query_time', '4') extracted from "Following the GitHub suggestion linked above, I also set innodb_flush_log_at_trx_commit to 0 - this means the database will no longer flush the to disk every time a transaction is performed, meaning it no longer conforms with ACID Principles, but however giving you a noticeable performance boost. This does mean if you lose power, you will lose the last second of transactions, but I'd prefer to have a UPS installed with Auto-Shutdown configured instead, or if in a datacenter some sort of failover and redundancy there. If you are turning this off though, make sure you have some sort of alternative to have those transactions written to disk in place - the last thing you want is to corrupt your Moodle Installation! (Hence why you have a Site backup of course).
I also changed the log_slow_query_time to 1, meaning that anything taking longer than 1 second to process is considered a slow query. Seems quick to the naked eye, but bear in mind usually MariaDB/MySQL connections last milliseconds. innodb_flush_log_at_timeout "
Hint counter: 56
Episode hint counter before: 8
Episode hint counter: 9
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=31, param=<re.Match object; span=(205, 223), match='max_relay_log_size'>, value=<re.Match object; span=(19, 21), match='10'>, recommendation='expire_logs_days = 10', passage='#log-bin=mysql-bin\n#binlog_format=mixed\nOr, if you want to keep these logs but keep their size in check and old logs deleted, you can set these limits then restart:\nlog-bin=mysql-bin\nexpire_logs_days = 10 max_relay_log_size ', float_val=10.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1682940125465393, 0.15017206966876984, 0.3761512041091919, 0.12309473752975464, 0.18228799104690552]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=31, param=<re.Match object; span=(205, 223), match='max_relay_log_size'>, value=<re.Match object; span=(19, 21), match='10'>, recommendation='expire_logs_days = 10', passage='#log-bin=mysql-bin\n#binlog_format=mixed\nOr, if you want to keep these logs but keep their size in check and old logs deleted, you can set these limits then restart:\nlog-bin=mysql-bin\nexpire_logs_days = 10 max_relay_log_size ', float_val=10.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.017394283786416054, 0.5248767733573914, 0.2039925754070282, 0.1442306935787201, 0.10950566083192825]
Choice: 4
Trying update set global max_relay_log_size=5
Trying update set global max_relay_log_size=1073741824
Trying assigning max_relay_log_size to 5
Adding assignment ('max_relay_log_size', '5') with weight 16
Assignment ('max_relay_log_size', '5') extracted from "#log-bin=mysql-bin
#binlog_format=mixed
Or, if you want to keep these logs but keep their size in check and old logs deleted, you can set these limits then restart:
log-bin=mysql-bin
expire_logs_days = 10 max_relay_log_size "
Hint counter: 57
Episode hint counter before: 9
Episode hint counter: 10
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=31, param=<re.Match object; span=(183, 199), match='expire_logs_days'>, value=<re.Match object; span=(0, 2), match='10'>, recommendation='10 max_relay_log_size', passage='#log-bin=mysql-bin\n#binlog_format=mixed\nOr, if you want to keep these logs but keep their size in check and old logs deleted, you can set these limits then restart:\nlog-bin=mysql-bin\nexpire_logs_days = 10 max_relay_log_size ', float_val=10.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.13781723380088806, 0.12132231146097183, 0.3711424171924591, 0.15724073350429535, 0.21247731149196625]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=31, param=<re.Match object; span=(183, 199), match='expire_logs_days'>, value=<re.Match object; span=(0, 2), match='10'>, recommendation='10 max_relay_log_size', passage='#log-bin=mysql-bin\n#binlog_format=mixed\nOr, if you want to keep these logs but keep their size in check and old logs deleted, you can set these limits then restart:\nlog-bin=mysql-bin\nexpire_logs_days = 10 max_relay_log_size ', float_val=10.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.015499701723456383, 0.5150887370109558, 0.20148275792598724, 0.15038979053497314, 0.11753898859024048]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=31, param=<re.Match object; span=(183, 199), match='expire_logs_days'>, value=<re.Match object; span=(0, 2), match='10'>, recommendation='10 max_relay_log_size', passage='#log-bin=mysql-bin\n#binlog_format=mixed\nOr, if you want to keep these logs but keep their size in check and old logs deleted, you can set these limits then restart:\nlog-bin=mysql-bin\nexpire_logs_days = 10 max_relay_log_size ', float_val=10.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.13781723380088806, 0.12132231146097183, 0.3711424171924591, 0.15724073350429535, 0.21247731149196625]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=31, param=<re.Match object; span=(183, 199), match='expire_logs_days'>, value=<re.Match object; span=(0, 2), match='10'>, recommendation='10 max_relay_log_size', passage='#log-bin=mysql-bin\n#binlog_format=mixed\nOr, if you want to keep these logs but keep their size in check and old logs deleted, you can set these limits then restart:\nlog-bin=mysql-bin\nexpire_logs_days = 10 max_relay_log_size ', float_val=10.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.015499701723456383, 0.5150887370109558, 0.20148275792598724, 0.15038979053497314, 0.11753898859024048]
Choice: 2
Trying update set global expire_logs_days=20
Trying update set global expire_logs_days=0.0
Trying assigning expire_logs_days to 20
Adding assignment ('expire_logs_days', '20') with weight 4
Assignment ('expire_logs_days', '20') extracted from "#log-bin=mysql-bin
#binlog_format=mixed
Or, if you want to keep these logs but keep their size in check and old logs deleted, you can set these limits then restart:
log-bin=mysql-bin
expire_logs_days = 10 max_relay_log_size "
Hint counter: 58
Episode hint counter before: 10
Episode hint counter: 11
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=31, param=<re.Match object; span=(0, 15), match='max_binlog_size'>, value=<re.Match object; span=(0, 4), match='100M'>, recommendation='100M', passage='max_binlog_size\n= 100M\nAlternatively, there exists a MariaDB command to manually purge logs older than a specific one. For example, you may see a file named mysql-bin.000023 and want to delete every log older than it. As long as the log-bin=mysql-bin setting is in effect, you would run: log_bin_compress_min_len ', float_val=100.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.17402055859565735, 0.1745326966047287, 0.2783204913139343, 0.17177808284759521, 0.2013481855392456]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=31, param=<re.Match object; span=(0, 15), match='max_binlog_size'>, value=<re.Match object; span=(0, 4), match='100M'>, recommendation='100M', passage='max_binlog_size\n= 100M\nAlternatively, there exists a MariaDB command to manually purge logs older than a specific one. For example, you may see a file named mysql-bin.000023 and want to delete every log older than it. As long as the log-bin=mysql-bin setting is in effect, you would run: log_bin_compress_min_len ', float_val=100.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.01811819151043892, 0.4141623079776764, 0.20936425030231476, 0.18773645162582397, 0.17061880230903625]
Choice: 3
Trying update set global max_binlog_size=419430400
Trying update set global max_binlog_size=1073741824
Trying assigning max_binlog_size to 400M
Adding assignment ('max_binlog_size', '400M') with weight 8
Assignment ('max_binlog_size', '400M') extracted from "max_binlog_size
= 100M
Alternatively, there exists a MariaDB command to manually purge logs older than a specific one. For example, you may see a file named mysql-bin.000023 and want to delete every log older than it. As long as the log-bin=mysql-bin setting is in effect, you would run: log_bin_compress_min_len "
Hint counter: 59
Episode hint counter before: 11
Episode hint counter: 12
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(170, 190), match='innodb_log_file_size'>, value=<re.Match object; span=(0, 4), match='128M'>, recommendation='128M', passage='# InnoDB Configuration\ninnodb-log-file-size = 128M\ninnodb-log-buffer-size = 128M\ninnodb-file-per-table = 1\ninnodb_buffer_pool_instances = 8\ninnodb_old_blocks_time = 1000 innodb_log_file_size ', float_val=128.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20040468871593475, 0.17397674918174744, 0.2693910002708435, 0.1498560756444931, 0.20637144148349762]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(170, 190), match='innodb_log_file_size'>, value=<re.Match object; span=(0, 4), match='128M'>, recommendation='128M', passage='# InnoDB Configuration\ninnodb-log-file-size = 128M\ninnodb-log-buffer-size = 128M\ninnodb-file-per-table = 1\ninnodb_buffer_pool_instances = 8\ninnodb_old_blocks_time = 1000 innodb_log_file_size ', float_val=128.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.022422391921281815, 0.434274286031723, 0.21036945283412933, 0.1776532381772995, 0.15528060495853424]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(170, 190), match='innodb_log_file_size'>, value=<re.Match object; span=(0, 4), match='128M'>, recommendation='128M', passage='# InnoDB Configuration\ninnodb-log-file-size = 128M\ninnodb-log-buffer-size = 128M\ninnodb-file-per-table = 1\ninnodb_buffer_pool_instances = 8\ninnodb_old_blocks_time = 1000 innodb_log_file_size ', float_val=128.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20040468871593475, 0.17397674918174744, 0.2693910002708435, 0.1498560756444931, 0.20637144148349762]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(170, 190), match='innodb_log_file_size'>, value=<re.Match object; span=(0, 4), match='128M'>, recommendation='128M', passage='# InnoDB Configuration\ninnodb-log-file-size = 128M\ninnodb-log-buffer-size = 128M\ninnodb-file-per-table = 1\ninnodb_buffer_pool_instances = 8\ninnodb_old_blocks_time = 1000 innodb_log_file_size ', float_val=128.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.022422391921281815, 0.434274286031723, 0.21036945283412933, 0.1776532381772995, 0.15528060495853424]
Choice: 1
Trying update set global innodb_log_file_size=67108864
Trying update set global innodb_log_file_size=100663296
Trying assigning innodb_log_file_size to 64M
Adding assignment ('innodb_log_file_size', '64M') with weight 2
Assignment ('innodb_log_file_size', '64M') extracted from "# InnoDB Configuration
innodb-log-file-size = 128M
innodb-log-buffer-size = 128M
innodb-file-per-table = 1
innodb_buffer_pool_instances = 8
innodb_old_blocks_time = 1000 innodb_log_file_size "
Hint counter: 60
Episode hint counter before: 12
Episode hint counter: 13
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(0, 26), match='table_open_cache_instances'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18871235847473145, 0.16364289820194244, 0.2578245997428894, 0.17040672898292542, 0.21941344439983368]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(0, 26), match='table_open_cache_instances'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.025200868025422096, 0.4661506414413452, 0.19984710216522217, 0.16229088604450226, 0.1465105265378952]
Choice: 1
Trying update set global table_open_cache_instances=8
Exception during update: Variable 'table_open_cache_instances' is a read only variable
Trying update set global table_open_cache_instances=8
Exception during update: Variable 'table_open_cache_instances' is a read only variable
Trying assigning table_open_cache_instances to 8
Assignment ('table_open_cache_instances', '8') was rejected
Hint counter: 61
Episode hint counter before: 13
Episode hint counter: 14
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(96, 111), match='connect_timeout'>, value=<re.Match object; span=(0, 3), match='300'>, recommendation='300', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=300.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.2047126293182373, 0.18261092901229858, 0.24746622145175934, 0.19365791976451874, 0.17155222594738007]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(96, 111), match='connect_timeout'>, value=<re.Match object; span=(0, 3), match='300'>, recommendation='300', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=300.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.024598082527518272, 0.45760852098464966, 0.20202812552452087, 0.16958750784397125, 0.14617766439914703]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(96, 111), match='connect_timeout'>, value=<re.Match object; span=(0, 3), match='300'>, recommendation='300', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=300.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.2047126293182373, 0.18261092901229858, 0.24746622145175934, 0.19365791976451874, 0.17155222594738007]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(96, 111), match='connect_timeout'>, value=<re.Match object; span=(0, 3), match='300'>, recommendation='300', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=300.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.024598082527518272, 0.45760852098464966, 0.20202812552452087, 0.16958750784397125, 0.14617766439914703]
Choice: 1
Trying update set global connect_timeout=1200
Trying update set global connect_timeout=10
Trying assigning connect_timeout to 1200
Adding assignment ('connect_timeout', '1200') with weight 2
Assignment ('connect_timeout', '1200') extracted from "innodb_write_io_threads = 32
innodb_io_capacity = 4000
innodb_io_capacity_max = 6000
# Timeouts
connect_timeout = 300
wait_timeout = 30000
# Caches and Limits innodb_flush_log_at_timeout "
Hint counter: 62
Episode hint counter before: 14
Episode hint counter: 15
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(29, 47), match='innodb_io_capacity'>, value=<re.Match object; span=(0, 4), match='4000'>, recommendation='4000', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=4000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1779375821352005, 0.1893036663532257, 0.2586197257041931, 0.1903301477432251, 0.18380886316299438]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(29, 47), match='innodb_io_capacity'>, value=<re.Match object; span=(0, 4), match='4000'>, recommendation='4000', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=4000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.021184172481298447, 0.4483853578567505, 0.2076708972454071, 0.17431151866912842, 0.14844806492328644]
Choice: 0
Trying update set global innodb_io_capacity=8000
Trying update set global innodb_io_capacity=200
Trying assigning innodb_io_capacity to 8000
Adding assignment ('innodb_io_capacity', '8000') with weight 1
Assignment ('innodb_io_capacity', '8000') extracted from "innodb_write_io_threads = 32
innodb_io_capacity = 4000
innodb_io_capacity_max = 6000
# Timeouts
connect_timeout = 300
wait_timeout = 30000
# Caches and Limits innodb_flush_log_at_timeout "
Hint counter: 63
Episode hint counter before: 15
Episode hint counter: 16
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(118, 130), match='wait_timeout'>, value=<re.Match object; span=(0, 5), match='30000'>, recommendation='30000', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=30000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18324296176433563, 0.19408154487609863, 0.27192777395248413, 0.17000548541545868, 0.18074218928813934]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(118, 130), match='wait_timeout'>, value=<re.Match object; span=(0, 5), match='30000'>, recommendation='30000', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=30000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02566535398364067, 0.444963276386261, 0.2073020190000534, 0.1703442484140396, 0.15172511339187622]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(118, 130), match='wait_timeout'>, value=<re.Match object; span=(0, 5), match='30000'>, recommendation='30000', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=30000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18324296176433563, 0.19408154487609863, 0.27192777395248413, 0.17000548541545868, 0.18074218928813934]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(118, 130), match='wait_timeout'>, value=<re.Match object; span=(0, 5), match='30000'>, recommendation='30000', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=30000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02566535398364067, 0.444963276386261, 0.2073020190000534, 0.1703442484140396, 0.15172511339187622]
Choice: 3
Trying update set global wait_timeout=60000
Trying update set global wait_timeout=60
Trying assigning wait_timeout to 60000
Adding assignment ('wait_timeout', '60000') with weight 8
Assignment ('wait_timeout', '60000') extracted from "innodb_write_io_threads = 32
innodb_io_capacity = 4000
innodb_io_capacity_max = 6000
# Timeouts
connect_timeout = 300
wait_timeout = 30000
# Caches and Limits innodb_flush_log_at_timeout "
Hint counter: 64
Episode hint counter before: 16
Episode hint counter: 17
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(55, 77), match='innodb_io_capacity_max'>, value=<re.Match object; span=(0, 4), match='6000'>, recommendation='6000', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=6000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.198944091796875, 0.167149156332016, 0.26613572239875793, 0.1660250425338745, 0.20174598693847656]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(55, 77), match='innodb_io_capacity_max'>, value=<re.Match object; span=(0, 4), match='6000'>, recommendation='6000', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=6000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.021120181307196617, 0.44496822357177734, 0.202551931142807, 0.17452304065227509, 0.15683667361736298]
Choice: 4
Trying update set global innodb_io_capacity_max=24000
Trying update set global innodb_io_capacity_max=16000
Trying assigning innodb_io_capacity_max to 24000
Adding assignment ('innodb_io_capacity_max', '24000') with weight 16
Assignment ('innodb_io_capacity_max', '24000') extracted from "innodb_write_io_threads = 32
innodb_io_capacity = 4000
innodb_io_capacity_max = 6000
# Timeouts
connect_timeout = 300
wait_timeout = 30000
# Caches and Limits innodb_flush_log_at_timeout "
Hint counter: 65
Episode hint counter before: 17
Episode hint counter: 18
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(0, 3), match='100'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=100.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1464487612247467, 0.2044525444507599, 0.19387376308441162, 0.2461479753255844, 0.209076926112175]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(0, 3), match='100'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=100.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02704428881406784, 0.541114330291748, 0.18097959458827972, 0.14087186753749847, 0.10998997092247009]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(0, 3), match='100'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=100.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1464487612247467, 0.2044525444507599, 0.19387376308441162, 0.2461479753255844, 0.209076926112175]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(0, 3), match='100'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=100.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02704428881406784, 0.541114330291748, 0.18097959458827972, 0.14087186753749847, 0.10998997092247009]
Choice: 4
Trying update set global innodb_io_capacity_max=400
Trying update set global innodb_io_capacity_max=16000
Trying assigning innodb_io_capacity_max to 400
Adding assignment ('innodb_io_capacity_max', '400') with weight 16
Assignment ('innodb_io_capacity_max', '400') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 66
Episode hint counter before: 18
Episode hint counter: 19
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(4, 7), match='200'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1464487612247467, 0.2044525444507599, 0.19387376308441162, 0.2461479753255844, 0.209076926112175]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(4, 7), match='200'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02704428881406784, 0.541114330291748, 0.18097959458827972, 0.14087186753749847, 0.10998997092247009]
Choice: 0
Trying update set global innodb_io_capacity_max=50
Trying update set global innodb_io_capacity_max=16000
Trying assigning innodb_io_capacity_max to 50
Adding assignment ('innodb_io_capacity_max', '50') with weight 1
Assignment ('innodb_io_capacity_max', '50') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 67
Episode hint counter before: 19
Episode hint counter: 20
Hints per episode: 20
Episode finished!
Done flag: True
Finalizing episode!
Weighted hints: defaultdict(<function NlpTuningEnv._finalize_episode.<locals>.<lambda> at 0x7f8767de0a60>, {('max_allowed_packet', '9'): 2, ('max_allowed_packet', '25000'): 16, ('max_allowed_packet', '4M'): 16, ('join_cache_level', '1'): 16, ('max_heap_table_size', '64MB'): 16, ('log_slow_query_time', '4'): 2, ('max_relay_log_size', '5'): 16, ('expire_logs_days', '20'): 4, ('max_binlog_size', '400M'): 8, ('innodb_log_file_size', '64M'): 2, ('connect_timeout', '1200'): 2, ('innodb_io_capacity', '8000'): 1, ('wait_timeout', '60000'): 8, ('innodb_io_capacity_max', '24000'): 16, ('innodb_io_capacity_max', '400'): 16, ('innodb_io_capacity_max', '50'): 1})
Selected configurations: [{'max_allowed_packet': '25000', 'join_cache_level': '1', 'max_heap_table_size': '64MB', 'log_slow_query_time': '4', 'max_relay_log_size': '5', 'expire_logs_days': '20', 'max_binlog_size': '400M', 'innodb_log_file_size': '64M', 'connect_timeout': '1200', 'innodb_io_capacity': '8000', 'wait_timeout': '60000', 'innodb_io_capacity_max': '24000'}, {'max_allowed_packet': '4M', 'join_cache_level': '1', 'max_heap_table_size': '64MB', 'log_slow_query_time': '4', 'max_relay_log_size': '5', 'expire_logs_days': '20', 'max_binlog_size': '400M', 'innodb_log_file_size': '64M', 'connect_timeout': '1200', 'innodb_io_capacity': '8000', 'wait_timeout': '60000', 'innodb_io_capacity_max': '400'}]\n[Restart] MariaDB server shut down!
[Restart] MariaDB server restarted!
\n[Restart] MariaDB server shut down!
[Restart] MariaDB server restarted!

Disconnecting ...
Trying to connect to tpch with user kaltenec
Trying update set session max_execution_time = 1500000
Exception during update: Unknown system variable 'max_execution_time'
Trying update update mariadb.server_cost set cost_value = NULL
Exception during update: Table 'mariadb.server_cost' doesn't exist
Trying update update mariadb.engine_cost set cost_value = NULL
Exception during update: Table 'mariadb.engine_cost' doesn't exist
Trying configuration: {'max_allowed_packet': '25000', 'join_cache_level': '1', 'max_heap_table_size': '64MB', 'log_slow_query_time': '4', 'max_relay_log_size': '5', 'expire_logs_days': '20', 'max_binlog_size': '400M', 'innodb_log_file_size': '64M', 'connect_timeout': '1200', 'innodb_io_capacity': '8000', 'wait_timeout': '60000', 'innodb_io_capacity_max': '24000'}
Trying update set global max_allowed_packet=25000
Trying update set global join_cache_level=1
Trying update set global max_heap_table_size=67108864
Trying update set global log_slow_query_time=4
Trying update set global max_relay_log_size=5
Trying update set global expire_logs_days=20
Trying update set global max_binlog_size=419430400
Trying update set global innodb_log_file_size=67108864
Trying update set global connect_timeout=1200
Trying update set global innodb_io_capacity=8000
Trying update set global wait_timeout=60000
Trying update set global innodb_io_capacity_max=24000
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Reward 1865.7255859375 with {'max_allowed_packet': '25000', 'join_cache_level': '1', 'max_heap_table_size': '64MB', 'log_slow_query_time': '4', 'max_relay_log_size': '5', 'expire_logs_days': '20', 'max_binlog_size': '400M', 'innodb_log_file_size': '64M', 'connect_timeout': '1200', 'innodb_io_capacity': '8000', 'wait_timeout': '60000', 'innodb_io_capacity_max': '24000'}
Disconnecting ...
Trying to connect to tpch with user kaltenec
Trying update set session max_execution_time = 1500000
Exception during update: Unknown system variable 'max_execution_time'
Trying update update mariadb.server_cost set cost_value = NULL
Exception during update: Table 'mariadb.server_cost' doesn't exist
Trying update update mariadb.engine_cost set cost_value = NULL
Exception during update: Table 'mariadb.engine_cost' doesn't exist
Trying configuration: {'max_allowed_packet': '4M', 'join_cache_level': '1', 'max_heap_table_size': '64MB', 'log_slow_query_time': '4', 'max_relay_log_size': '5', 'expire_logs_days': '20', 'max_binlog_size': '400M', 'innodb_log_file_size': '64M', 'connect_timeout': '1200', 'innodb_io_capacity': '8000', 'wait_timeout': '60000', 'innodb_io_capacity_max': '400'}
Trying update set global max_allowed_packet=4194304
Trying update set global join_cache_level=1
Trying update set global max_heap_table_size=67108864
Trying update set global log_slow_query_time=4
Trying update set global max_relay_log_size=5
Trying update set global expire_logs_days=20
Trying update set global max_binlog_size=419430400
Trying update set global innodb_log_file_size=67108864
Trying update set global connect_timeout=1200
Trying update set global innodb_io_capacity=8000
Trying update set global wait_timeout=60000
Trying update set global innodb_io_capacity_max=400
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Reward 1768.87939453125 with {'max_allowed_packet': '4M', 'join_cache_level': '1', 'max_heap_table_size': '64MB', 'log_slow_query_time': '4', 'max_relay_log_size': '5', 'expire_logs_days': '20', 'max_binlog_size': '400M', 'innodb_log_file_size': '64M', 'connect_timeout': '1200', 'innodb_io_capacity': '8000', 'wait_timeout': '60000', 'innodb_io_capacity_max': '400'}
Obtained 1865.7255859375 by configuration {'max_allowed_packet': '25000', 'join_cache_level': '1', 'max_heap_table_size': '64MB', 'log_slow_query_time': '4', 'max_relay_log_size': '5', 'expire_logs_days': '20', 'max_binlog_size': '400M', 'innodb_log_file_size': '64M', 'connect_timeout': '1200', 'innodb_io_capacity': '8000', 'wait_timeout': '60000', 'innodb_io_capacity_max': '24000'}
Achieved unscaled reward of 1865.7255859375 using {'max_allowed_packet': '25000', 'join_cache_level': '1', 'max_heap_table_size': '64MB', 'log_slow_query_time': '4', 'max_relay_log_size': '5', 'expire_logs_days': '20', 'max_binlog_size': '400M', 'innodb_log_file_size': '64M', 'connect_timeout': '1200', 'innodb_io_capacity': '8000', 'wait_timeout': '60000', 'innodb_io_capacity_max': '24000'}.
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(8, 9), match='2'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=2.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1464487612247467, 0.2044525444507599, 0.19387376308441162, 0.2461479753255844, 0.209076926112175]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(8, 9), match='2'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=2.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1464487612247467, 0.2044525444507599, 0.19387376308441162, 0.2461479753255844, 0.209076926112175]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(8, 9), match='2'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=2.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02704428881406784, 0.541114330291748, 0.18097959458827972, 0.14087186753749847, 0.10998997092247009]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(8, 9), match='2'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=2.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1464487612247467, 0.2044525444507599, 0.19387376308441162, 0.2461479753255844, 0.209076926112175]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(8, 9), match='2'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=2.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02704428881406784, 0.541114330291748, 0.18097959458827972, 0.14087186753749847, 0.10998997092247009]
Choice: 0
Trying update set global innodb_io_capacity_max=2
Trying update set global innodb_io_capacity_max=400
Trying assigning innodb_io_capacity_max to 2
Adding assignment ('innodb_io_capacity_max', '2') with weight 1
Assignment ('innodb_io_capacity_max', '2') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 68
Episode hint counter before: 0
Episode hint counter: 1
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(11, 13), match='64'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1464487612247467, 0.2044525444507599, 0.19387376308441162, 0.2461479753255844, 0.209076926112175]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(11, 13), match='64'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02704428881406784, 0.541114330291748, 0.18097959458827972, 0.14087186753749847, 0.10998997092247009]
Choice: 1
Trying update set global innodb_io_capacity_max=32
Trying update set global innodb_io_capacity_max=400
Trying assigning innodb_io_capacity_max to 32
Adding assignment ('innodb_io_capacity_max', '32') with weight 2
Assignment ('innodb_io_capacity_max', '32') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 69
Episode hint counter before: 1
Episode hint counter: 2
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(14, 15), match='1'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1464487612247467, 0.2044525444507599, 0.19387376308441162, 0.2461479753255844, 0.209076926112175]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(14, 15), match='1'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02704428881406784, 0.541114330291748, 0.18097959458827972, 0.14087186753749847, 0.10998997092247009]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(14, 15), match='1'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1464487612247467, 0.2044525444507599, 0.19387376308441162, 0.2461479753255844, 0.209076926112175]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(4470, 4492), match='innodb_io_capacity_max'>, value=<re.Match object; span=(14, 15), match='1'>, recommendation='100/200/2**64-1', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02704428881406784, 0.541114330291748, 0.18097959458827972, 0.14087186753749847, 0.10998997092247009]
Choice: 1
Trying update set global innodb_io_capacity_max=0
Trying update set global innodb_io_capacity_max=400
Trying assigning innodb_io_capacity_max to 0
Adding assignment ('innodb_io_capacity_max', '0') with weight 2
Assignment ('innodb_io_capacity_max', '0') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 70
Episode hint counter before: 2
Episode hint counter: 3
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(82, 100), match='max_connect_errors'>, value=<re.Match object; span=(0, 7), match='1000000'>, recommendation='1000000', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=1000000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.17690053582191467, 0.18156594038009644, 0.2528064250946045, 0.19543568789958954, 0.19329147040843964]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(82, 100), match='max_connect_errors'>, value=<re.Match object; span=(0, 7), match='1000000'>, recommendation='1000000', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=1000000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02680082619190216, 0.43378427624702454, 0.20846743881702423, 0.16758155822753906, 0.1633659303188324]
Choice: 1
Trying update set global max_connect_errors=1000000
Trying update set global max_connect_errors=100
Trying assigning max_connect_errors to 1000000
Adding assignment ('max_connect_errors', '1000000') with weight 2
Assignment ('max_connect_errors', '1000000') extracted from "table_open_cache_instances = 16
table_open_cache
= 32012
open_files_limit = 65535
max_connect_errors = 1000000
[client]
# MySQL Client Configuration
# Client Socket table_open_cache_instances "
Hint counter: 71
Episode hint counter before: 3
Episode hint counter: 4
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(127, 149), match='innodb_read_io_threads'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='innodb_stats_on_metadata = off\ninnodb-flush-method = O_DIRECT\ninnodb-flush-log-at-trx-commit = 2\ninnodb_buffer_pool_size = 23G\ninnodb_read_io_threads = 32 innodb_flush_log_at_trx_commit ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19402799010276794, 0.19214743375778198, 0.26641327142715454, 0.15789352357387543, 0.1895178258419037]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(127, 149), match='innodb_read_io_threads'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='innodb_stats_on_metadata = off\ninnodb-flush-method = O_DIRECT\ninnodb-flush-log-at-trx-commit = 2\ninnodb_buffer_pool_size = 23G\ninnodb_read_io_threads = 32 innodb_flush_log_at_trx_commit ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.027428098022937775, 0.46463149785995483, 0.20161142945289612, 0.1676764339208603, 0.13865259289741516]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(127, 149), match='innodb_read_io_threads'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='innodb_stats_on_metadata = off\ninnodb-flush-method = O_DIRECT\ninnodb-flush-log-at-trx-commit = 2\ninnodb_buffer_pool_size = 23G\ninnodb_read_io_threads = 32 innodb_flush_log_at_trx_commit ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19402799010276794, 0.19214743375778198, 0.26641327142715454, 0.15789352357387543, 0.1895178258419037]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(127, 149), match='innodb_read_io_threads'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='innodb_stats_on_metadata = off\ninnodb-flush-method = O_DIRECT\ninnodb-flush-log-at-trx-commit = 2\ninnodb_buffer_pool_size = 23G\ninnodb_read_io_threads = 32 innodb_flush_log_at_trx_commit ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.027428098022937775, 0.46463149785995483, 0.20161142945289612, 0.1676764339208603, 0.13865259289741516]
Choice: 3
Trying update set global innodb_read_io_threads=16
Trying update set global innodb_read_io_threads=4
Trying assigning innodb_read_io_threads to 16
Adding assignment ('innodb_read_io_threads', '16') with weight 8
Assignment ('innodb_read_io_threads', '16') extracted from "innodb_stats_on_metadata = off
innodb-flush-method = O_DIRECT
innodb-flush-log-at-trx-commit = 2
innodb_buffer_pool_size = 23G
innodb_read_io_threads = 32 innodb_flush_log_at_trx_commit "
Hint counter: 72
Episode hint counter before: 4
Episode hint counter: 5
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(0, 23), match='innodb_write_io_threads'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19402799010276794, 0.19214743375778198, 0.26641327142715454, 0.15789352357387543, 0.1895178258419037]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(0, 23), match='innodb_write_io_threads'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='innodb_write_io_threads = 32\ninnodb_io_capacity = 4000\ninnodb_io_capacity_max = 6000\n# Timeouts\nconnect_timeout = 300\nwait_timeout = 30000\n# Caches and Limits innodb_flush_log_at_timeout ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.027428098022937775, 0.46463149785995483, 0.20161142945289612, 0.1676764339208603, 0.13865259289741516]
Choice: 0
Trying update set global innodb_write_io_threads=16
Trying update set global innodb_write_io_threads=4
Trying assigning innodb_write_io_threads to 16
Adding assignment ('innodb_write_io_threads', '16') with weight 1
Assignment ('innodb_write_io_threads', '16') extracted from "innodb_write_io_threads = 32
innodb_io_capacity = 4000
innodb_io_capacity_max = 6000
# Timeouts
connect_timeout = 300
wait_timeout = 30000
# Caches and Limits innodb_flush_log_at_timeout "
Hint counter: 73
Episode hint counter before: 5
Episode hint counter: 6
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(140, 162), match='innodb_old_blocks_time'>, value=<re.Match object; span=(0, 4), match='1000'>, recommendation='1000', passage='# InnoDB Configuration\ninnodb-log-file-size = 128M\ninnodb-log-buffer-size = 128M\ninnodb-file-per-table = 1\ninnodb_buffer_pool_instances = 8\ninnodb_old_blocks_time = 1000 innodb_log_file_size ', float_val=1000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1662527620792389, 0.18482346832752228, 0.28242507576942444, 0.19090786576271057, 0.17559082806110382]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(140, 162), match='innodb_old_blocks_time'>, value=<re.Match object; span=(0, 4), match='1000'>, recommendation='1000', passage='# InnoDB Configuration\ninnodb-log-file-size = 128M\ninnodb-log-buffer-size = 128M\ninnodb-file-per-table = 1\ninnodb_buffer_pool_instances = 8\ninnodb_old_blocks_time = 1000 innodb_log_file_size ', float_val=1000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.017641622573137283, 0.43016543984413147, 0.20931342244148254, 0.1748356819152832, 0.16804377734661102]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(140, 162), match='innodb_old_blocks_time'>, value=<re.Match object; span=(0, 4), match='1000'>, recommendation='1000', passage='# InnoDB Configuration\ninnodb-log-file-size = 128M\ninnodb-log-buffer-size = 128M\ninnodb-file-per-table = 1\ninnodb_buffer_pool_instances = 8\ninnodb_old_blocks_time = 1000 innodb_log_file_size ', float_val=1000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1662527620792389, 0.18482346832752228, 0.28242507576942444, 0.19090786576271057, 0.17559082806110382]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(140, 162), match='innodb_old_blocks_time'>, value=<re.Match object; span=(0, 4), match='1000'>, recommendation='1000', passage='# InnoDB Configuration\ninnodb-log-file-size = 128M\ninnodb-log-buffer-size = 128M\ninnodb-file-per-table = 1\ninnodb_buffer_pool_instances = 8\ninnodb_old_blocks_time = 1000 innodb_log_file_size ', float_val=1000.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.017641622573137283, 0.43016543984413147, 0.20931342244148254, 0.1748356819152832, 0.16804377734661102]
Choice: 1
Trying update set global innodb_old_blocks_time=250
Trying update set global innodb_old_blocks_time=1000
Trying assigning innodb_old_blocks_time to 250
Adding assignment ('innodb_old_blocks_time', '250') with weight 2
Assignment ('innodb_old_blocks_time', '250') extracted from "# InnoDB Configuration
innodb-log-file-size = 128M
innodb-log-buffer-size = 128M
innodb-file-per-table = 1
innodb_buffer_pool_instances = 8
innodb_old_blocks_time = 1000 innodb_log_file_size "
Hint counter: 74
Episode hint counter before: 6
Episode hint counter: 7
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(3130, 3152), match='innodb_old_blocks_time'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1/8/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.17826427519321442, 0.1268521249294281, 0.31530001759529114, 0.15975500643253326, 0.21982860565185547]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(3130, 3152), match='innodb_old_blocks_time'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1/8/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.031713131815195084, 0.4616946578025818, 0.20274142920970917, 0.1691240817308426, 0.13472667336463928]
Choice: 0
Trying update set global innodb_old_blocks_time=0
Trying update set global innodb_old_blocks_time=1000
Trying assigning innodb_old_blocks_time to 0
Adding assignment ('innodb_old_blocks_time', '0') with weight 1
Assignment ('innodb_old_blocks_time', '0') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 75
Episode hint counter before: 7
Episode hint counter: 8
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(3130, 3152), match='innodb_old_blocks_time'>, value=<re.Match object; span=(2, 3), match='8'>, recommendation='1/8/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.17826427519321442, 0.1268521249294281, 0.31530001759529114, 0.15975500643253326, 0.21982860565185547]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(3130, 3152), match='innodb_old_blocks_time'>, value=<re.Match object; span=(2, 3), match='8'>, recommendation='1/8/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.031713131815195084, 0.4616946578025818, 0.20274142920970917, 0.1691240817308426, 0.13472667336463928]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(3130, 3152), match='innodb_old_blocks_time'>, value=<re.Match object; span=(2, 3), match='8'>, recommendation='1/8/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.17826427519321442, 0.1268521249294281, 0.31530001759529114, 0.15975500643253326, 0.21982860565185547]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(3130, 3152), match='innodb_old_blocks_time'>, value=<re.Match object; span=(2, 3), match='8'>, recommendation='1/8/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.031713131815195084, 0.4616946578025818, 0.20274142920970917, 0.1691240817308426, 0.13472667336463928]
Choice: 1
Trying update set global innodb_old_blocks_time=4
Trying update set global innodb_old_blocks_time=1000
Trying assigning innodb_old_blocks_time to 4
Adding assignment ('innodb_old_blocks_time', '4') with weight 2
Assignment ('innodb_old_blocks_time', '4') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 76
Episode hint counter before: 8
Episode hint counter: 9
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(3130, 3152), match='innodb_old_blocks_time'>, value=<re.Match object; span=(4, 6), match='64'>, recommendation='1/8/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.17826427519321442, 0.1268521249294281, 0.31530001759529114, 0.15975500643253326, 0.21982860565185547]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(3130, 3152), match='innodb_old_blocks_time'>, value=<re.Match object; span=(4, 6), match='64'>, recommendation='1/8/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.031713131815195084, 0.4616946578025818, 0.20274142920970917, 0.1691240817308426, 0.13472667336463928]
Choice: 3
Trying update set global innodb_old_blocks_time=64
Trying update set global innodb_old_blocks_time=1000
Trying assigning innodb_old_blocks_time to 64
Adding assignment ('innodb_old_blocks_time', '64') with weight 8
Assignment ('innodb_old_blocks_time', '64') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 77
Episode hint counter before: 9
Episode hint counter: 10
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(125, 141), match='sort_buffer_size'>, value=<re.Match object; span=(0, 4), match='2048'>, recommendation='2048', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=2048.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.17999409139156342, 0.20450188219547272, 0.2764931619167328, 0.1695912778377533, 0.1694195717573166]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(125, 141), match='sort_buffer_size'>, value=<re.Match object; span=(0, 4), match='2048'>, recommendation='2048', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=2048.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.025632193312048912, 0.44854864478111267, 0.20763951539993286, 0.17194095253944397, 0.14623866975307465]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(125, 141), match='sort_buffer_size'>, value=<re.Match object; span=(0, 4), match='2048'>, recommendation='2048', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=2048.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.17999409139156342, 0.20450188219547272, 0.2764931619167328, 0.1695912778377533, 0.1694195717573166]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(125, 141), match='sort_buffer_size'>, value=<re.Match object; span=(0, 4), match='2048'>, recommendation='2048', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=2048.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.025632193312048912, 0.44854864478111267, 0.20763951539993286, 0.17194095253944397, 0.14623866975307465]
Choice: 3
Trying update set global sort_buffer_size=512
Trying update set global sort_buffer_size=2097152
Trying assigning sort_buffer_size to 512
Adding assignment ('sort_buffer_size', '512') with weight 8
Assignment ('sort_buffer_size', '512') extracted from "key_buffer_size = 1200
query_cache_size = 50
tmp_table_size = 128
innodb_buffer_pool_size = 4096
innodb_log_buffer_size = 32
sort_buffer_size = 2048
read_buffer_size = 256 key_buffer_size "
Hint counter: 78
Episode hint counter before: 10
Episode hint counter: 11
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(57, 73), match='sort_buffer_size'>, value=<re.Match object; span=(0, 4), match='1024'>, recommendation='1024', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=1024.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.16487236320972443, 0.1601647138595581, 0.28181496262550354, 0.2019103467464447, 0.19123758375644684]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(57, 73), match='sort_buffer_size'>, value=<re.Match object; span=(0, 4), match='1024'>, recommendation='1024', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=1024.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.019758854061365128, 0.41018953919410706, 0.21158428490161896, 0.18349096179008484, 0.17497636377811432]
Choice: 0
Trying update set global sort_buffer_size=1024
Trying update set global sort_buffer_size=2097152
Trying assigning sort_buffer_size to 1024
Adding assignment ('sort_buffer_size', '1024') with weight 1
Assignment ('sort_buffer_size', '1024') extracted from "innodb_buffer_pool_size = 512
innodb_log_buffer_size = 8
sort_buffer_size = 1024
read_buffer_size = 1024
read_rnd_buffer_size = 4096
join_buffer_size = 1024
thread_stack = 192 innodb_log_buffer_size "
Hint counter: 79
Episode hint counter before: 11
Episode hint counter: 12
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(0, 16), match='sort_buffer_size'>, value=<re.Match object; span=(0, 3), match='10M'>, recommendation='10M', passage="sort_buffer_size = 10M\nread_buffer_size = 10M ( always on mysql configuration use M (MB) because if you use 1024 is translated to bytes and the sort_buffer_size have a minimum value of 32768 bytes so that's being said, 1024 is a useless number used two times in the above configuration, read_buffer_size have a 8192 minimum value) read_buffer_size ", float_val=10.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.174553781747818, 0.15986230969429016, 0.2938447892665863, 0.16246436536312103, 0.20927472412586212]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(0, 16), match='sort_buffer_size'>, value=<re.Match object; span=(0, 3), match='10M'>, recommendation='10M', passage="sort_buffer_size = 10M\nread_buffer_size = 10M ( always on mysql configuration use M (MB) because if you use 1024 is translated to bytes and the sort_buffer_size have a minimum value of 32768 bytes so that's being said, 1024 is a useless number used two times in the above configuration, read_buffer_size have a 8192 minimum value) read_buffer_size ", float_val=10.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.015421286225318909, 0.4279082417488098, 0.2015354484319687, 0.1824634075164795, 0.1726716011762619]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(0, 16), match='sort_buffer_size'>, value=<re.Match object; span=(0, 3), match='10M'>, recommendation='10M', passage="sort_buffer_size = 10M\nread_buffer_size = 10M ( always on mysql configuration use M (MB) because if you use 1024 is translated to bytes and the sort_buffer_size have a minimum value of 32768 bytes so that's being said, 1024 is a useless number used two times in the above configuration, read_buffer_size have a 8192 minimum value) read_buffer_size ", float_val=10.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.174553781747818, 0.15986230969429016, 0.2938447892665863, 0.16246436536312103, 0.20927472412586212]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(0, 16), match='sort_buffer_size'>, value=<re.Match object; span=(0, 3), match='10M'>, recommendation='10M', passage="sort_buffer_size = 10M\nread_buffer_size = 10M ( always on mysql configuration use M (MB) because if you use 1024 is translated to bytes and the sort_buffer_size have a minimum value of 32768 bytes so that's being said, 1024 is a useless number used two times in the above configuration, read_buffer_size have a 8192 minimum value) read_buffer_size ", float_val=10.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.015421286225318909, 0.4279082417488098, 0.2015354484319687, 0.1824634075164795, 0.1726716011762619]
Choice: 4
Trying update set global sort_buffer_size=2097152
Trying update set global sort_buffer_size=2097152
Trying assigning sort_buffer_size to 2M
Adding assignment ('sort_buffer_size', '2M') with weight 16
Assignment ('sort_buffer_size', '2M') extracted from "sort_buffer_size = 10M
read_buffer_size = 10M ( always on mysql configuration use M (MB) because if you use 1024 is translated to bytes and the sort_buffer_size have a minimum value of 32768 bytes so that's being said, 1024 is a useless number used two times in the above configuration, read_buffer_size have a 8192 minimum value) read_buffer_size "
Hint counter: 80
Episode hint counter before: 12
Episode hint counter: 13
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(97, 119), match='innodb_log_buffer_size'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19402799010276794, 0.19214743375778198, 0.26641327142715454, 0.15789352357387543, 0.1895178258419037]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(97, 119), match='innodb_log_buffer_size'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.027428098022937775, 0.46463149785995483, 0.20161142945289612, 0.1676764339208603, 0.13865259289741516]
Choice: 0
Trying update set global innodb_log_buffer_size=16
Exception during update: Variable 'innodb_log_buffer_size' is a read only variable
Trying update set global innodb_log_buffer_size=16777216
Exception during update: Variable 'innodb_log_buffer_size' is a read only variable
Trying assigning innodb_log_buffer_size to 16
Assignment ('innodb_log_buffer_size', '16') was rejected
Hint counter: 81
Episode hint counter before: 13
Episode hint counter: 14
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(30, 52), match='innodb_log_buffer_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1844906359910965, 0.15214183926582336, 0.266186386346817, 0.17978301644325256, 0.2173980474472046]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(30, 52), match='innodb_log_buffer_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.026791756972670555, 0.46210938692092896, 0.20298469066619873, 0.1625889241695404, 0.145525261759758]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(30, 52), match='innodb_log_buffer_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1844906359910965, 0.15214183926582336, 0.266186386346817, 0.17978301644325256, 0.2173980474472046]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(30, 52), match='innodb_log_buffer_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.026791756972670555, 0.46210938692092896, 0.20298469066619873, 0.1625889241695404, 0.145525261759758]
Choice: 2
Trying update set global innodb_log_buffer_size=4
Exception during update: Variable 'innodb_log_buffer_size' is a read only variable
Trying update set global innodb_log_buffer_size=16777216
Exception during update: Variable 'innodb_log_buffer_size' is a read only variable
Trying assigning innodb_log_buffer_size to 4
Assignment ('innodb_log_buffer_size', '4') was rejected
Hint counter: 82
Episode hint counter before: 14
Episode hint counter: 15
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(27, 43), match='join_buffer_size'>, value=<re.Match object; span=(0, 4), match='2048'>, recommendation='2048', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=2048.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.17999409139156342, 0.20450188219547272, 0.2764931619167328, 0.1695912778377533, 0.1694195717573166]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(27, 43), match='join_buffer_size'>, value=<re.Match object; span=(0, 4), match='2048'>, recommendation='2048', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=2048.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.025632193312048912, 0.44854864478111267, 0.20763951539993286, 0.17194095253944397, 0.14623866975307465]
Choice: 4
Trying update set global join_buffer_size=8192
Trying update set global join_buffer_size=262144
Trying assigning join_buffer_size to 8192
Adding assignment ('join_buffer_size', '8192') with weight 16
Assignment ('join_buffer_size', '8192') extracted from "read_rnd_buffer_size = 512
join_buffer_size = 2048
thread_stack = 512
binlog_cache_size = 64
thread_cache_size = 16
table_open_cache = 2048
max_connections = 200
PHP:
max_children = 4 thread_cache_size "
Hint counter: 83
Episode hint counter before: 15
Episode hint counter: 16
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(133, 149), match='join_buffer_size'>, value=<re.Match object; span=(0, 4), match='1024'>, recommendation='1024', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=1024.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.16487236320972443, 0.1601647138595581, 0.28181496262550354, 0.2019103467464447, 0.19123758375644684]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(133, 149), match='join_buffer_size'>, value=<re.Match object; span=(0, 4), match='1024'>, recommendation='1024', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=1024.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.019758854061365128, 0.41018953919410706, 0.21158428490161896, 0.18349096179008484, 0.17497636377811432]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(133, 149), match='join_buffer_size'>, value=<re.Match object; span=(0, 4), match='1024'>, recommendation='1024', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=1024.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.16487236320972443, 0.1601647138595581, 0.28181496262550354, 0.2019103467464447, 0.19123758375644684]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(133, 149), match='join_buffer_size'>, value=<re.Match object; span=(0, 4), match='1024'>, recommendation='1024', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=1024.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.019758854061365128, 0.41018953919410706, 0.21158428490161896, 0.18349096179008484, 0.17497636377811432]
Choice: 2
Trying update set global join_buffer_size=512
Trying update set global join_buffer_size=262144
Trying assigning join_buffer_size to 512
Adding assignment ('join_buffer_size', '512') with weight 4
Assignment ('join_buffer_size', '512') extracted from "innodb_buffer_pool_size = 512
innodb_log_buffer_size = 8
sort_buffer_size = 1024
read_buffer_size = 1024
read_rnd_buffer_size = 4096
join_buffer_size = 1024
thread_stack = 192 innodb_log_buffer_size "
Hint counter: 84
Episode hint counter before: 16
Episode hint counter: 17
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(0, 20), match='read_rnd_buffer_size'>, value=<re.Match object; span=(0, 3), match='512'>, recommendation='512', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=512.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18853892385959625, 0.17371782660484314, 0.2637619078159332, 0.19082817435264587, 0.18315310776233673]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(0, 20), match='read_rnd_buffer_size'>, value=<re.Match object; span=(0, 3), match='512'>, recommendation='512', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=512.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.022273913025856018, 0.45673248171806335, 0.20234665274620056, 0.1712857037782669, 0.14736124873161316]
Choice: 2
Trying update set global read_rnd_buffer_size=128\n[Restart] MariaDB server shut down!
[Restart] MariaDB server restarted!

Trying update set global read_rnd_buffer_size=262144
Trying assigning read_rnd_buffer_size to 128
Adding assignment ('read_rnd_buffer_size', '128') with weight 4
Assignment ('read_rnd_buffer_size', '128') extracted from "read_rnd_buffer_size = 512
join_buffer_size = 2048
thread_stack = 512
binlog_cache_size = 64
thread_cache_size = 16
table_open_cache = 2048
max_connections = 200
PHP:
max_children = 4 thread_cache_size "
Hint counter: 85
Episode hint counter before: 17
Episode hint counter: 18
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(105, 125), match='read_rnd_buffer_size'>, value=<re.Match object; span=(0, 4), match='4096'>, recommendation='4096', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=4096.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1929043084383011, 0.20756587386131287, 0.27467942237854004, 0.1552993506193161, 0.16955099999904633]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(105, 125), match='read_rnd_buffer_size'>, value=<re.Match object; span=(0, 4), match='4096'>, recommendation='4096', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=4096.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.029096694663167, 0.4537006616592407, 0.2012118697166443, 0.17119792103767395, 0.14479291439056396]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(105, 125), match='read_rnd_buffer_size'>, value=<re.Match object; span=(0, 4), match='4096'>, recommendation='4096', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=4096.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1929043084383011, 0.20756587386131287, 0.27467942237854004, 0.1552993506193161, 0.16955099999904633]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(105, 125), match='read_rnd_buffer_size'>, value=<re.Match object; span=(0, 4), match='4096'>, recommendation='4096', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=4096.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.029096694663167, 0.4537006616592407, 0.2012118697166443, 0.17119792103767395, 0.14479291439056396]
Choice: 3
Trying update set global read_rnd_buffer_size=4096
Trying update set global read_rnd_buffer_size=262144
Trying assigning read_rnd_buffer_size to 4096
Adding assignment ('read_rnd_buffer_size', '4096') with weight 8
Assignment ('read_rnd_buffer_size', '4096') extracted from "innodb_buffer_pool_size = 512
innodb_log_buffer_size = 8
sort_buffer_size = 1024
read_buffer_size = 1024
read_rnd_buffer_size = 4096
join_buffer_size = 1024
thread_stack = 192 innodb_log_buffer_size "
Hint counter: 86
Episode hint counter before: 18
Episode hint counter: 19
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(149, 165), match='read_buffer_size'>, value=<re.Match object; span=(0, 3), match='256'>, recommendation='256', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=256.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.21567395329475403, 0.18666331470012665, 0.26477310061454773, 0.15275011956691742, 0.18013955652713776]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(149, 165), match='read_buffer_size'>, value=<re.Match object; span=(0, 3), match='256'>, recommendation='256', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=256.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.024873826652765274, 0.4565011262893677, 0.20721030235290527, 0.16764211654663086, 0.1437726467847824]
Choice: 2
Trying update set global read_buffer_size=128
Trying update set global read_buffer_size=131072
Trying assigning read_buffer_size to 128
Adding assignment ('read_buffer_size', '128') with weight 4
Assignment ('read_buffer_size', '128') extracted from "key_buffer_size = 1200
query_cache_size = 50
tmp_table_size = 128
innodb_buffer_pool_size = 4096
innodb_log_buffer_size = 32
sort_buffer_size = 2048
read_buffer_size = 256 key_buffer_size "
Hint counter: 87
Episode hint counter before: 19
Episode hint counter: 20
Hints per episode: 20
Episode finished!
Done flag: True
Finalizing episode!
Weighted hints: defaultdict(<function NlpTuningEnv._finalize_episode.<locals>.<lambda> at 0x7f8767de0430>, {('innodb_io_capacity_max', '2'): 1, ('innodb_io_capacity_max', '32'): 2, ('innodb_io_capacity_max', '0'): 2, ('max_connect_errors', '1000000'): 2, ('innodb_read_io_threads', '16'): 8, ('innodb_write_io_threads', '16'): 1, ('innodb_old_blocks_time', '250'): 2, ('innodb_old_blocks_time', '0'): 1, ('innodb_old_blocks_time', '4'): 2, ('innodb_old_blocks_time', '64'): 8, ('sort_buffer_size', '512'): 8, ('sort_buffer_size', '1024'): 1, ('sort_buffer_size', '2M'): 16, ('join_buffer_size', '8192'): 16, ('join_buffer_size', '512'): 4, ('read_rnd_buffer_size', '128'): 4, ('read_rnd_buffer_size', '4096'): 8, ('read_buffer_size', '128'): 4})
Selected configurations: [{'innodb_io_capacity_max': '2', 'max_connect_errors': '1000000', 'innodb_read_io_threads': '16', 'innodb_write_io_threads': '16', 'innodb_old_blocks_time': '64', 'sort_buffer_size': '2M', 'join_buffer_size': '8192', 'read_rnd_buffer_size': '4096', 'read_buffer_size': '128'}, {'innodb_io_capacity_max': '32', 'max_connect_errors': '1000000', 'innodb_read_io_threads': '16', 'innodb_write_io_threads': '16', 'innodb_old_blocks_time': '250', 'sort_buffer_size': '512', 'join_buffer_size': '512', 'read_rnd_buffer_size': '128', 'read_buffer_size': '128'}]
Disconnecting ...
Trying to connect to tpch with user kaltenec
Trying update set session max_execution_time = 1500000
Exception during update: Unknown system variable 'max_execution_time'\n[Restart] MariaDB server shut down!
[Restart] MariaDB server restarted!

Trying update update mariadb.server_cost set cost_value = NULL
Exception during update: Table 'mariadb.server_cost' doesn't exist
Trying update update mariadb.engine_cost set cost_value = NULL
Exception during update: Table 'mariadb.engine_cost' doesn't exist
Trying configuration: {'innodb_io_capacity_max': '2', 'max_connect_errors': '1000000', 'innodb_read_io_threads': '16', 'innodb_write_io_threads': '16', 'innodb_old_blocks_time': '64', 'sort_buffer_size': '2M', 'join_buffer_size': '8192', 'read_rnd_buffer_size': '4096', 'read_buffer_size': '128'}
Trying update set global innodb_io_capacity_max=2
Trying update set global max_connect_errors=1000000
Trying update set global innodb_read_io_threads=16
Trying update set global innodb_write_io_threads=16
Trying update set global innodb_old_blocks_time=64
Trying update set global sort_buffer_size=2097152
Trying update set global join_buffer_size=8192
Trying update set global read_rnd_buffer_size=4096
Trying update set global read_buffer_size=128
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Reward 1381.326171875 with {'innodb_io_capacity_max': '2', 'max_connect_errors': '1000000', 'innodb_read_io_threads': '16', 'innodb_write_io_threads': '16', 'innodb_old_blocks_time': '64', 'sort_buffer_size': '2M', 'join_buffer_size': '8192', 'read_rnd_buffer_size': '4096', 'read_buffer_size': '128'}
Disconnecting ...
Trying to connect to tpch with user kaltenec
Trying update set session max_execution_time = 1500000
Exception during update: Unknown system variable 'max_execution_time'
Trying update update mariadb.server_cost set cost_value = NULL
Exception during update: Table 'mariadb.server_cost' doesn't exist
Trying update update mariadb.engine_cost set cost_value = NULL
Exception during update: Table 'mariadb.engine_cost' doesn't exist
Trying configuration: {'innodb_io_capacity_max': '32', 'max_connect_errors': '1000000', 'innodb_read_io_threads': '16', 'innodb_write_io_threads': '16', 'innodb_old_blocks_time': '250', 'sort_buffer_size': '512', 'join_buffer_size': '512', 'read_rnd_buffer_size': '128', 'read_buffer_size': '128'}
Trying update set global innodb_io_capacity_max=32
Trying update set global max_connect_errors=1000000
Trying update set global innodb_read_io_threads=16
Trying update set global innodb_write_io_threads=16
Trying update set global innodb_old_blocks_time=250
Trying update set global sort_buffer_size=512
Trying update set global join_buffer_size=512
Trying update set global read_rnd_buffer_size=128
Trying update set global read_buffer_size=128
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Reward 1230.610107421875 with {'innodb_io_capacity_max': '32', 'max_connect_errors': '1000000', 'innodb_read_io_threads': '16', 'innodb_write_io_threads': '16', 'innodb_old_blocks_time': '250', 'sort_buffer_size': '512', 'join_buffer_size': '512', 'read_rnd_buffer_size': '128', 'read_buffer_size': '128'}
Obtained 1381.326171875 by configuration {'innodb_io_capacity_max': '2', 'max_connect_errors': '1000000', 'innodb_read_io_threads': '16', 'innodb_write_io_threads': '16', 'innodb_old_blocks_time': '64', 'sort_buffer_size': '2M', 'join_buffer_size': '8192', 'read_rnd_buffer_size': '4096', 'read_buffer_size': '128'}
Achieved unscaled reward of 1381.326171875 using {'innodb_io_capacity_max': '2', 'max_connect_errors': '1000000', 'innodb_read_io_threads': '16', 'innodb_write_io_threads': '16', 'innodb_old_blocks_time': '64', 'sort_buffer_size': '2M', 'join_buffer_size': '8192', 'read_rnd_buffer_size': '4096', 'read_buffer_size': '128'}.
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(81, 97), match='read_buffer_size'>, value=<re.Match object; span=(0, 4), match='1024'>, recommendation='1024', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=1024.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.16487236320972443, 0.1601647138595581, 0.28181496262550354, 0.2019103467464447, 0.19123758375644684]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(81, 97), match='read_buffer_size'>, value=<re.Match object; span=(0, 4), match='1024'>, recommendation='1024', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=1024.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.16487236320972443, 0.1601647138595581, 0.28181496262550354, 0.2019103467464447, 0.19123758375644684]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(81, 97), match='read_buffer_size'>, value=<re.Match object; span=(0, 4), match='1024'>, recommendation='1024', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=1024.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.019758854061365128, 0.41018953919410706, 0.21158428490161896, 0.18349096179008484, 0.17497636377811432]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(81, 97), match='read_buffer_size'>, value=<re.Match object; span=(0, 4), match='1024'>, recommendation='1024', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=1024.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.16487236320972443, 0.1601647138595581, 0.28181496262550354, 0.2019103467464447, 0.19123758375644684]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(81, 97), match='read_buffer_size'>, value=<re.Match object; span=(0, 4), match='1024'>, recommendation='1024', passage='innodb_buffer_pool_size = 512\ninnodb_log_buffer_size = 8\nsort_buffer_size = 1024\nread_buffer_size = 1024\nread_rnd_buffer_size = 4096\njoin_buffer_size = 1024\nthread_stack = 192 innodb_log_buffer_size ', float_val=1024.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.019758854061365128, 0.41018953919410706, 0.21158428490161896, 0.18349096179008484, 0.17497636377811432]
Choice: 0
Trying update set global read_buffer_size=4096
Trying update set global read_buffer_size=131072
Trying assigning read_buffer_size to 4096
Adding assignment ('read_buffer_size', '4096') with weight 1
Assignment ('read_buffer_size', '4096') extracted from "innodb_buffer_pool_size = 512
innodb_log_buffer_size = 8
sort_buffer_size = 1024
read_buffer_size = 1024
read_rnd_buffer_size = 4096
join_buffer_size = 1024
thread_stack = 192 innodb_log_buffer_size "
Hint counter: 88
Episode hint counter before: 0
Episode hint counter: 1
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(23, 39), match='read_buffer_size'>, value=<re.Match object; span=(0, 4), match='8192'>, recommendation='8192 minimum value', passage="sort_buffer_size = 10M\nread_buffer_size = 10M ( always on mysql configuration use M (MB) because if you use 1024 is translated to bytes and the sort_buffer_size have a minimum value of 32768 bytes so that's being said, 1024 is a useless number used two times in the above configuration, read_buffer_size have a 8192 minimum value) read_buffer_size ", float_val=8192.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.22560782730579376, 0.20574815571308136, 0.3612131178379059, 0.08507612347602844, 0.12235478311777115]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(23, 39), match='read_buffer_size'>, value=<re.Match object; span=(0, 4), match='8192'>, recommendation='8192 minimum value', passage="sort_buffer_size = 10M\nread_buffer_size = 10M ( always on mysql configuration use M (MB) because if you use 1024 is translated to bytes and the sort_buffer_size have a minimum value of 32768 bytes so that's being said, 1024 is a useless number used two times in the above configuration, read_buffer_size have a 8192 minimum value) read_buffer_size ", float_val=8192.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.028488151729106903, 0.4772242307662964, 0.21026545763015747, 0.1587396264076233, 0.12528249621391296]
Choice: 1
Trying update set global read_buffer_size=8192
Trying update set global read_buffer_size=131072
Trying assigning read_buffer_size to 8192
Adding assignment ('read_buffer_size', '8192') with weight 2
Assignment ('read_buffer_size', '8192') extracted from "sort_buffer_size = 10M
read_buffer_size = 10M ( always on mysql configuration use M (MB) because if you use 1024 is translated to bytes and the sort_buffer_size have a minimum value of 32768 bytes so that's being said, 1024 is a useless number used two times in the above configuration, read_buffer_size have a 8192 minimum value) read_buffer_size "
Hint counter: 89
Episode hint counter before: 1
Episode hint counter: 2
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(70, 87), match='binlog_cache_size'>, value=<re.Match object; span=(0, 2), match='64'>, recommendation='64', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20224447548389435, 0.18172581493854523, 0.2561816871166229, 0.15085653960704803, 0.20899151265621185]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(70, 87), match='binlog_cache_size'>, value=<re.Match object; span=(0, 2), match='64'>, recommendation='64', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.027772024273872375, 0.460867315530777, 0.20801353454589844, 0.16750642657279968, 0.13584065437316895]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(70, 87), match='binlog_cache_size'>, value=<re.Match object; span=(0, 2), match='64'>, recommendation='64', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20224447548389435, 0.18172581493854523, 0.2561816871166229, 0.15085653960704803, 0.20899151265621185]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(70, 87), match='binlog_cache_size'>, value=<re.Match object; span=(0, 2), match='64'>, recommendation='64', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.027772024273872375, 0.460867315530777, 0.20801353454589844, 0.16750642657279968, 0.13584065437316895]
Choice: 3
Trying update set global binlog_cache_size=256
Trying update set global binlog_cache_size=32768
Trying assigning binlog_cache_size to 256
Adding assignment ('binlog_cache_size', '256') with weight 8
Assignment ('binlog_cache_size', '256') extracted from "read_rnd_buffer_size = 512
join_buffer_size = 2048
thread_stack = 512
binlog_cache_size = 64
thread_cache_size = 16
table_open_cache = 2048
max_connections = 200
PHP:
max_children = 4 thread_cache_size "
Hint counter: 90
Episode hint counter before: 2
Episode hint counter: 3
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(0, 17), match='binlog_cache_size'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19402799010276794, 0.19214743375778198, 0.26641327142715454, 0.15789352357387543, 0.1895178258419037]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(0, 17), match='binlog_cache_size'>, value=<re.Match object; span=(0, 2), match='32'>, recommendation='32', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=32.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.027428098022937775, 0.46463149785995483, 0.20161142945289612, 0.1676764339208603, 0.13865259289741516]
Choice: 1
Trying update set global binlog_cache_size=8
Trying update set global binlog_cache_size=32768
Trying assigning binlog_cache_size to 8
Adding assignment ('binlog_cache_size', '8') with weight 2
Assignment ('binlog_cache_size', '8') extracted from "binlog_cache_size = 32
thread_cache_size = 8
table_open_cache = 64
max_connections = 20
PHP:
max_children = 10
start_servers = 2
min_spare_servers = 1
max_spare_servers = 3 binlog_stmt_cache_size "
Hint counter: 91
Episode hint counter before: 3
Episode hint counter: 4
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=63, param=<re.Match object; span=(30, 47), match='query_cache_limit'>, value=<re.Match object; span=(0, 3), match='50M'>, recommendation='50M', passage='# * Query Cache Configuration\nquery_cache_limit\n= 50M\nquery_cache_size\n= 300M\n# * Logging and Replication\n# * InnoDB\n# InnoDB is enabled by default with a 10MB datafile in /var/lib/mysql/. query_cache_limit ', float_val=50.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18395723402500153, 0.18822643160820007, 0.2992051839828491, 0.15009883046150208, 0.1785123348236084]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=63, param=<re.Match object; span=(30, 47), match='query_cache_limit'>, value=<re.Match object; span=(0, 3), match='50M'>, recommendation='50M', passage='# * Query Cache Configuration\nquery_cache_limit\n= 50M\nquery_cache_size\n= 300M\n# * Logging and Replication\n# * InnoDB\n# InnoDB is enabled by default with a 10MB datafile in /var/lib/mysql/. query_cache_limit ', float_val=50.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.022491659969091415, 0.4569627642631531, 0.20047272741794586, 0.17280185222625732, 0.14727100729942322]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=63, param=<re.Match object; span=(30, 47), match='query_cache_limit'>, value=<re.Match object; span=(0, 3), match='50M'>, recommendation='50M', passage='# * Query Cache Configuration\nquery_cache_limit\n= 50M\nquery_cache_size\n= 300M\n# * Logging and Replication\n# * InnoDB\n# InnoDB is enabled by default with a 10MB datafile in /var/lib/mysql/. query_cache_limit ', float_val=50.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18395723402500153, 0.18822643160820007, 0.2992051839828491, 0.15009883046150208, 0.1785123348236084]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=63, param=<re.Match object; span=(30, 47), match='query_cache_limit'>, value=<re.Match object; span=(0, 3), match='50M'>, recommendation='50M', passage='# * Query Cache Configuration\nquery_cache_limit\n= 50M\nquery_cache_size\n= 300M\n# * Logging and Replication\n# * InnoDB\n# InnoDB is enabled by default with a 10MB datafile in /var/lib/mysql/. query_cache_limit ', float_val=50.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.022491659969091415, 0.4569627642631531, 0.20047272741794586, 0.17280185222625732, 0.14727100729942322]
Choice: 4
Trying update set global query_cache_limit=26214400
Trying update set global query_cache_limit=1048576
Trying assigning query_cache_limit to 25M
Adding assignment ('query_cache_limit', '25M') with weight 16
Assignment ('query_cache_limit', '25M') extracted from "# * Query Cache Configuration
query_cache_limit
= 50M
query_cache_size
= 300M
# * Logging and Replication
# * InnoDB
# InnoDB is enabled by default with a 10MB datafile in /var/lib/mysql/. query_cache_limit "
Hint counter: 92
Episode hint counter before: 4
Episode hint counter: 5
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=63, param=<re.Match object; span=(138, 159), match='innodb_force_recovery'>, value=<re.Match object; span=(0, 1), match='6'>, recommendation='6', passage='max_connections\n= 500\nmax_user_connections\n= 500\n#table_cache\n= 64\nthread_concurrency\n= 300\ntable_cache\n= 30000\nopen_files_limit\n= 65000\n#innodb_force_recovery =6 max_binlog_stmt_cache_size ', float_val=6.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19875401258468628, 0.15515796840190887, 0.23435266315937042, 0.1751263439655304, 0.23660901188850403]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=63, param=<re.Match object; span=(138, 159), match='innodb_force_recovery'>, value=<re.Match object; span=(0, 1), match='6'>, recommendation='6', passage='max_connections\n= 500\nmax_user_connections\n= 500\n#table_cache\n= 64\nthread_concurrency\n= 300\ntable_cache\n= 30000\nopen_files_limit\n= 65000\n#innodb_force_recovery =6 max_binlog_stmt_cache_size ', float_val=6.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.025305401533842087, 0.48199930787086487, 0.197042778134346, 0.15717408061027527, 0.13847839832305908]
Choice: 1
Trying update set global innodb_force_recovery=3
Exception during update: Variable 'innodb_force_recovery' is a read only variable
Trying update set global innodb_force_recovery=0
Exception during update: Variable 'innodb_force_recovery' is a read only variable
Trying assigning innodb_force_recovery to 3
Assignment ('innodb_force_recovery', '3') was rejected
Hint counter: 93
Episode hint counter before: 5
Episode hint counter: 6
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(568, 585), match='thread_cache_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16 or so', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18521332740783691, 0.1852453649044037, 0.28911828994750977, 0.15424436330795288, 0.18617865443229675]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(568, 585), match='thread_cache_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16 or so', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.028563059866428375, 0.50733482837677, 0.1963784247636795, 0.14746752381324768, 0.12025613337755203]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(568, 585), match='thread_cache_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16 or so', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18521332740783691, 0.1852453649044037, 0.28911828994750977, 0.15424436330795288, 0.18617865443229675]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(568, 585), match='thread_cache_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16 or so', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.028563059866428375, 0.50733482837677, 0.1963784247636795, 0.14746752381324768, 0.12025613337755203]
Choice: 4
Trying update set global thread_cache_size=4
Trying update set global thread_cache_size=100
Trying assigning thread_cache_size to 4
Adding assignment ('thread_cache_size', '4') with weight 16
Assignment ('thread_cache_size', '4') extracted from "Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).
Adjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size "
Hint counter: 1
Episode hint counter before: 6
Episode hint counter: 7
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(118, 135), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1844906359910965, 0.15214183926582336, 0.266186386346817, 0.17978301644325256, 0.2173980474472046]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(118, 135), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.026791756972670555, 0.46210938692092896, 0.20298469066619873, 0.1625889241695404, 0.145525261759758]
Choice: 0
Trying update set global thread_cache_size=4
Trying update set global thread_cache_size=100
Trying assigning thread_cache_size to 4
Adding assignment ('thread_cache_size', '4') with weight 1
Assignment ('thread_cache_size', '4') extracted from "tmp-table-size = 96M
max-heap-table-size = 96M
key_buffer_size = 64M
# Connections and Threads
max_connections = 1250
thread_cache_size = 8
max_allowed_packet = 64M thread_pool_max_threads "
Hint counter: 2
Episode hint counter before: 7
Episode hint counter: 8
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(23, 40), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1844906359910965, 0.15214183926582336, 0.266186386346817, 0.17978301644325256, 0.2173980474472046]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(23, 40), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.026791756972670555, 0.46210938692092896, 0.20298469066619873, 0.1625889241695404, 0.145525261759758]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(23, 40), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1844906359910965, 0.15214183926582336, 0.266186386346817, 0.17978301644325256, 0.2173980474472046]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(23, 40), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.026791756972670555, 0.46210938692092896, 0.20298469066619873, 0.1625889241695404, 0.145525261759758]
Choice: 2
Trying update set global thread_cache_size=4
Trying update set global thread_cache_size=100
Trying assigning thread_cache_size to 4
Adding assignment ('thread_cache_size', '4') with weight 4
Assignment ('thread_cache_size', '4') extracted from "binlog_cache_size = 32
thread_cache_size = 8
table_open_cache = 64
max_connections = 20
PHP:
max_children = 10
start_servers = 2
min_spare_servers = 1
max_spare_servers = 3 binlog_stmt_cache_size "
Hint counter: 3
Episode hint counter before: 8
Episode hint counter: 9
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=63, param=<re.Match object; span=(66, 83), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8\n', passage='key_buffer\t\t= 2000M\nmax_allowed_packet\t= 16M\nthread_stack\t\t= 128K\nthread_cache_size\t= 8\n# This replaces the startup script and checks MyISAM tables if needed\n# the first time they are touched\nmyisam-recover\t\t= BACKUP table_open_cache_instances ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18013985455036163, 0.22041219472885132, 0.28335413336753845, 0.17767491936683655, 0.13841883838176727]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=63, param=<re.Match object; span=(66, 83), match='thread_cache_size'>, value=<re.Match object; span=(0, 1), match='8'>, recommendation='8\n', passage='key_buffer\t\t= 2000M\nmax_allowed_packet\t= 16M\nthread_stack\t\t= 128K\nthread_cache_size\t= 8\n# This replaces the startup script and checks MyISAM tables if needed\n# the first time they are touched\nmyisam-recover\t\t= BACKUP table_open_cache_instances ', float_val=8.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02484126389026642, 0.46155181527137756, 0.19460640847682953, 0.1654755026102066, 0.15352493524551392]
Choice: 2
Trying update set global thread_cache_size=2
Trying update set global thread_cache_size=100
Trying assigning thread_cache_size to 2
Adding assignment ('thread_cache_size', '2') with weight 4
Assignment ('thread_cache_size', '2') extracted from "key_buffer		= 2000M
max_allowed_packet	= 16M
thread_stack		= 128K
thread_cache_size	= 8
# This replaces the startup script and checks MyISAM tables if needed
# the first time they are touched
myisam-recover		= BACKUP table_open_cache_instances "
Hint counter: 4
Episode hint counter before: 9
Episode hint counter: 10
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=38, param=<re.Match object; span=(1999, 2014), match='max_connections'>, value=<re.Match object; span=(0, 3), match='200'>, recommendation='200', passage='hayden_james@linux\xa0aboutarticlesservicesfeedbacksponsorscontactforumsMySQL Database Performance: Avoid this common mistake March 21, 2023 by Hayden James, in Blog LinuxOne frequent topic of support request emails I receive is MySQL database performance. Clients complain about MySQL using too much server memory, too many MySQL slow queries, the famous Mysql server has gone away errors, and many other MySQL performance-related issues. As such, I wanted to share solutions to some common MySQL configuration mistakes.If you are a DBA, feel free to share your experiences or suggestions in the comments section. I’m referring to four MySQL config variables. These four my.cnf config lines are often responsible for poor MySQL database performance and scaling due to insufficient server memory for incoming connections. This article also applies to MariaDB and Percona drop-in replacements for MySQL.Note: This is an update and follow-up to this article. I’ve added some relevant and more up-to-date information and links, as well as a new section that covers some additional my.cnf performance config tips.\xa0Avoid arbitrarily increasing MySQL per-connection buffers Excerpt of my.cnf edits for a client. (some lines were removed and some blurred to avoid misuse)Who knows where or when this bad practice started. I frequently encounter instances where I log into production servers for the first time and find that the values of virtually every my.cnf variable have been arbitrarily increased without sound reasoning behind the changes.This is never a good practice, especially for four my.cnf variables discussed below. Although increasing the value of some variables can improve performance, these four will almost always degrade MySQL server performance and capacity when increased.The four buffers in question are the\xa0join_buffer_size,\xa0sort_buffer_size,\xa0read_buffer_size and read_rnd_buffer_size.These four buffers are\xa0allocated per connection. For example, a setting of join_buffer_size=1M\xa0with\xa0max_connections=200 will configure MySQL to allocate an additional 1M per connection (1M x 200). The same goes for the other three buffers. Again, all are per connection.A good rule of thumb is that if you can’t provide a valid reason to increase any of these buffers, keep them set to the default values.In nearly all cases, it’s best to keep the defaults by removing or commenting out these four config lines. As connections increase with traffic, queries that need more space than what’s available due to larger buffer settings may trigger paging those buffers to disk. This dramatically slows down your DB server and creates a bottleneck.I’ve often seen significantly improved MySQL performance by simply reverting these buffers to their defaults. Also, read Analyzing Linux server performance with atop.The above screenshot shows MySQL status output two weeks after I made the first my.cnf optimization pass. Now, let’s take a closer look at each of these buffers.\xa0MySQL join_buffer_sizeThe join_buffer_size is allocated for each full join between two tables. From MySQL’s documentation the join_buffer_size is described as: “The minimum size of the buffer that is used for plain index scans, range index scans, and joins that do not use indexes and thus perform full table scans.”MySQL’s documentation goes on to say: “Memory allocation time can cause substantial performance drops if the global size is larger than needed by most queries that use it.” The join buffer is allocated to cache table rows when the join can’t use an index.If your database suffers from many joins performed without indexes, it cannot be solved by increasing join_buffer_size. The problem is “joins performed without indexes.” Thus, the solution for faster joins is to add indexes.\xa0MySQL sort_buffer_sizeUnless you have data indicating otherwise, you should avoid arbitrarily increasing the\xa0sort_buffer_size. Memory here is also assigned per connection!MySQL’s documentation warns: “On Linux, there are thresholds of 256KB and 2MB where larger values may significantly slow down memory allocation, so you should consider staying below one of those values.”Avoid increasing sort_buffer_size above 2M since there is a performance penalty that will eliminate benefits.\xa0MySQL read_buffer_size & read_rnd_buffer_sizeUpdate: Some of you still use MyISAM over InnoDB. MyISAM is based on the old ISAM storage engine. It has many useful extensions, as discussed here. You should consider converting your MySQL tables to the InnoDB storage engine.InnoDB is the default storage engine of MySQL 5.7 and MySQL 8.0. InnoDB features improved performance, rollback and crash-recovery capabilities to protect data. read_buffer_size\xa0Applies generally to MyISAM.Each request that performs a sequential table scan allocates a read buffer. The read_buffer_size\xa0system variable determines the buffer size.Starting from MySQL 8.0.22, the value of select_into_buffer_size overrides the value of read_buffer_size when performing SELECT INTO DUMPFILE and SELECT INTO OUTFILE statements. read_buffer_size\xa0is used for the I/O cache buffer size in all other cases.The read_rnd_buffer_size variable is also used mainly for\xa0MyISAM reads from tables. Again, consider InnoDB or MariaDB’s Aria storage engines. For the past decade, the default values of these buffers have remained the same.\xa0Additional my.cnf Performance config tipsMonitor the appropriate MySQL status variable_name(s) to assist you in tuning the below config lines. An example of viewing the status of MySQL runtime variables. (So I increased max_connections)max_connectionsA MySQL configuration parameter that sets the maximum number of concurrent connections the server can handle. A value that is too large can allocate too much server memory and lead to performance issues, while a low value can result in connection rejections.To tune this parameter, monitor the max_used_connections status variable; try to set this to ~ 2x to 3x your max used connections after a few days of uptime. However, if your MySQL max connections are more than 200 then make sure to have at least 100 extra connections available. So if max_used_connections is 300 then set max_connections to at least 400. Watch memory usage!!thread_cache_sizeDetermines the number of threads that can be cached and reused by the server. Properly tuning this parameter can help improve the performance of your MySQL server by reducing the overhead of creating new threads and freeing up system resources.To tune this parameter, you can monitor the threads_created and threads_cached status variables and set the value to a reasonable number based on the number of expected concurrent connections. As a general rule, a value of 16 is a good starting point. Then increase gradually until it’s at least 50% of max_connections. For example, if the threads_cached value is 16 and the max_used_connections value is 40 then increase this from 16 to 32. At the same time, as per above advice, if max_used_connections is 40 then your max_connections should be at least 80.table_definition_cacheA MySQL configuration parameter that sets the number of table definitions (metadata) that can be stored in the cache. A high value of table_definition_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of reading the table definition from disk.To tune this parameter, monitor the opened_table_definitions and open_table_definitionsstatus variables, set table_definition_cache to ~ 2x the number of open table definitions and adjust as needed. Consider other factors, such as system memory and query complexity when tuning. .table_open_cacheA MySQL configuration parameter that sets the number of open table objects that can be stored in the cache. A high value of table_open_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of opening tables from disk.To tune this parameter, monitor the opened_tables and open_tables status variables, set table_open_cache to ~ 2x the number of open tables, and adjust as needed. Consider other factors such as memory and query complexity when tuning. Generally table_open_cache and table_definition_cache are set to the same value. The number of open table objects and table definitions are directly related, so setting these two parameters to the same value can ensure that the metadata and open table objects are stored in the cache in a consistent and efficient manner.wait_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on a non-interactive connection before closing it. A high value of wait_timeout can result in increased memory usage and increased # of connections, while a low value can result in frequent disconnections for long-running queries.To tune this parameter, set wait_timeout to the lowest resonable expected duration of non-interactive connections, and adjust as needed. The default value is 28800 seconds. This is way to high in most cases and will consume a lot of system memory by keeping many connections open. I set most of my configs to 30 seconds or less.connect_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for a successful connection to be established before timing out. A high value of connect_timeout can result in increased wait time for clients and increase in max_connections. A low value can result in connection failures for slow or heavily loaded servers.To tune this parameter, set connect_timeout to a reasonable value based on the expected response time of the server. Consider other factors such as network latency, mobile users, and server load when tuning. I set most of my configs to 15 seconds or less. For example, this blog’s mysql connection timeout is set to 5 seconds.interactive_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on an interactive connection before closing it. A high value of interactive_timeout can result in increased memory usage and increased concurrent connetions. A low value can result in frequent disconnections for long-running queries.To tune this parameter, set interactive_timeout to a reasonable value based on the expected duration of your longest-running requests.tmp_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables used by the server. When a query creates a temporary table that exceeds the value of tmp_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set tmp_table_size to a reasonable value based on the available memory and the value of the created_tmp_disk_table variable.max_heap_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables created with the MEMORY storage engine. When a query creates a temporary table that exceeds the value of max_heap_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set max_heap_table_size to the same value as tmp_table_size.Want more tips?For example, Innodb tuning tips, setting open_files_limit, etc. Let me know your interests in the comments section below, or hire me for MySQL optimization.\xa0Additional MySQL performance related articlesMySQL Performance Tuning: Tips, Scripts and Tools.MySQL Performance: Stop hoarding. Drop unused MySQL databases.“MySQL server has gone away” error – Solution(s).Could not increase number of max_open_files to more than… (Solution).Linux server performance: Is disk I/O slowing your application?Tuning MySQL my.cnf? Avoid this common pitfall!\xa0ConclusionIn conclusion, we discussed some common issues with MySQL performance often raised in support requests. The focus was on four specific my.cnf variables frequently responsible for poor database performance and scaling due to a shortage of server memory.It was emphasized that arbitrarily increasing these variables can lead to a decline in MySQL server performance and capacity and that it is important to keep these buffers set to their default values unless there is a specific reason to increase them. Then we covered tuning some additional MySQL performance config lines.A good rule of thumb: if you can’t provide a valid reason for increasing these buffers, keep them set to the default values. This also applies less strictly to all of MySQL’s variables. Be careful when making changes, don’t overwrite your entire my.cnf all at once. Back up everything first, make one or two changes per restart and test for 24 to 48 hours before making another pass. wsrep_mysql_replication_bundle ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20448258519172668, 0.20679712295532227, 0.24968837201595306, 0.1696714460849762, 0.16936053335666656]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=38, param=<re.Match object; span=(1999, 2014), match='max_connections'>, value=<re.Match object; span=(0, 3), match='200'>, recommendation='200', passage='hayden_james@linux\xa0aboutarticlesservicesfeedbacksponsorscontactforumsMySQL Database Performance: Avoid this common mistake March 21, 2023 by Hayden James, in Blog LinuxOne frequent topic of support request emails I receive is MySQL database performance. Clients complain about MySQL using too much server memory, too many MySQL slow queries, the famous Mysql server has gone away errors, and many other MySQL performance-related issues. As such, I wanted to share solutions to some common MySQL configuration mistakes.If you are a DBA, feel free to share your experiences or suggestions in the comments section. I’m referring to four MySQL config variables. These four my.cnf config lines are often responsible for poor MySQL database performance and scaling due to insufficient server memory for incoming connections. This article also applies to MariaDB and Percona drop-in replacements for MySQL.Note: This is an update and follow-up to this article. I’ve added some relevant and more up-to-date information and links, as well as a new section that covers some additional my.cnf performance config tips.\xa0Avoid arbitrarily increasing MySQL per-connection buffers Excerpt of my.cnf edits for a client. (some lines were removed and some blurred to avoid misuse)Who knows where or when this bad practice started. I frequently encounter instances where I log into production servers for the first time and find that the values of virtually every my.cnf variable have been arbitrarily increased without sound reasoning behind the changes.This is never a good practice, especially for four my.cnf variables discussed below. Although increasing the value of some variables can improve performance, these four will almost always degrade MySQL server performance and capacity when increased.The four buffers in question are the\xa0join_buffer_size,\xa0sort_buffer_size,\xa0read_buffer_size and read_rnd_buffer_size.These four buffers are\xa0allocated per connection. For example, a setting of join_buffer_size=1M\xa0with\xa0max_connections=200 will configure MySQL to allocate an additional 1M per connection (1M x 200). The same goes for the other three buffers. Again, all are per connection.A good rule of thumb is that if you can’t provide a valid reason to increase any of these buffers, keep them set to the default values.In nearly all cases, it’s best to keep the defaults by removing or commenting out these four config lines. As connections increase with traffic, queries that need more space than what’s available due to larger buffer settings may trigger paging those buffers to disk. This dramatically slows down your DB server and creates a bottleneck.I’ve often seen significantly improved MySQL performance by simply reverting these buffers to their defaults. Also, read Analyzing Linux server performance with atop.The above screenshot shows MySQL status output two weeks after I made the first my.cnf optimization pass. Now, let’s take a closer look at each of these buffers.\xa0MySQL join_buffer_sizeThe join_buffer_size is allocated for each full join between two tables. From MySQL’s documentation the join_buffer_size is described as: “The minimum size of the buffer that is used for plain index scans, range index scans, and joins that do not use indexes and thus perform full table scans.”MySQL’s documentation goes on to say: “Memory allocation time can cause substantial performance drops if the global size is larger than needed by most queries that use it.” The join buffer is allocated to cache table rows when the join can’t use an index.If your database suffers from many joins performed without indexes, it cannot be solved by increasing join_buffer_size. The problem is “joins performed without indexes.” Thus, the solution for faster joins is to add indexes.\xa0MySQL sort_buffer_sizeUnless you have data indicating otherwise, you should avoid arbitrarily increasing the\xa0sort_buffer_size. Memory here is also assigned per connection!MySQL’s documentation warns: “On Linux, there are thresholds of 256KB and 2MB where larger values may significantly slow down memory allocation, so you should consider staying below one of those values.”Avoid increasing sort_buffer_size above 2M since there is a performance penalty that will eliminate benefits.\xa0MySQL read_buffer_size & read_rnd_buffer_sizeUpdate: Some of you still use MyISAM over InnoDB. MyISAM is based on the old ISAM storage engine. It has many useful extensions, as discussed here. You should consider converting your MySQL tables to the InnoDB storage engine.InnoDB is the default storage engine of MySQL 5.7 and MySQL 8.0. InnoDB features improved performance, rollback and crash-recovery capabilities to protect data. read_buffer_size\xa0Applies generally to MyISAM.Each request that performs a sequential table scan allocates a read buffer. The read_buffer_size\xa0system variable determines the buffer size.Starting from MySQL 8.0.22, the value of select_into_buffer_size overrides the value of read_buffer_size when performing SELECT INTO DUMPFILE and SELECT INTO OUTFILE statements. read_buffer_size\xa0is used for the I/O cache buffer size in all other cases.The read_rnd_buffer_size variable is also used mainly for\xa0MyISAM reads from tables. Again, consider InnoDB or MariaDB’s Aria storage engines. For the past decade, the default values of these buffers have remained the same.\xa0Additional my.cnf Performance config tipsMonitor the appropriate MySQL status variable_name(s) to assist you in tuning the below config lines. An example of viewing the status of MySQL runtime variables. (So I increased max_connections)max_connectionsA MySQL configuration parameter that sets the maximum number of concurrent connections the server can handle. A value that is too large can allocate too much server memory and lead to performance issues, while a low value can result in connection rejections.To tune this parameter, monitor the max_used_connections status variable; try to set this to ~ 2x to 3x your max used connections after a few days of uptime. However, if your MySQL max connections are more than 200 then make sure to have at least 100 extra connections available. So if max_used_connections is 300 then set max_connections to at least 400. Watch memory usage!!thread_cache_sizeDetermines the number of threads that can be cached and reused by the server. Properly tuning this parameter can help improve the performance of your MySQL server by reducing the overhead of creating new threads and freeing up system resources.To tune this parameter, you can monitor the threads_created and threads_cached status variables and set the value to a reasonable number based on the number of expected concurrent connections. As a general rule, a value of 16 is a good starting point. Then increase gradually until it’s at least 50% of max_connections. For example, if the threads_cached value is 16 and the max_used_connections value is 40 then increase this from 16 to 32. At the same time, as per above advice, if max_used_connections is 40 then your max_connections should be at least 80.table_definition_cacheA MySQL configuration parameter that sets the number of table definitions (metadata) that can be stored in the cache. A high value of table_definition_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of reading the table definition from disk.To tune this parameter, monitor the opened_table_definitions and open_table_definitionsstatus variables, set table_definition_cache to ~ 2x the number of open table definitions and adjust as needed. Consider other factors, such as system memory and query complexity when tuning. .table_open_cacheA MySQL configuration parameter that sets the number of open table objects that can be stored in the cache. A high value of table_open_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of opening tables from disk.To tune this parameter, monitor the opened_tables and open_tables status variables, set table_open_cache to ~ 2x the number of open tables, and adjust as needed. Consider other factors such as memory and query complexity when tuning. Generally table_open_cache and table_definition_cache are set to the same value. The number of open table objects and table definitions are directly related, so setting these two parameters to the same value can ensure that the metadata and open table objects are stored in the cache in a consistent and efficient manner.wait_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on a non-interactive connection before closing it. A high value of wait_timeout can result in increased memory usage and increased # of connections, while a low value can result in frequent disconnections for long-running queries.To tune this parameter, set wait_timeout to the lowest resonable expected duration of non-interactive connections, and adjust as needed. The default value is 28800 seconds. This is way to high in most cases and will consume a lot of system memory by keeping many connections open. I set most of my configs to 30 seconds or less.connect_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for a successful connection to be established before timing out. A high value of connect_timeout can result in increased wait time for clients and increase in max_connections. A low value can result in connection failures for slow or heavily loaded servers.To tune this parameter, set connect_timeout to a reasonable value based on the expected response time of the server. Consider other factors such as network latency, mobile users, and server load when tuning. I set most of my configs to 15 seconds or less. For example, this blog’s mysql connection timeout is set to 5 seconds.interactive_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on an interactive connection before closing it. A high value of interactive_timeout can result in increased memory usage and increased concurrent connetions. A low value can result in frequent disconnections for long-running queries.To tune this parameter, set interactive_timeout to a reasonable value based on the expected duration of your longest-running requests.tmp_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables used by the server. When a query creates a temporary table that exceeds the value of tmp_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set tmp_table_size to a reasonable value based on the available memory and the value of the created_tmp_disk_table variable.max_heap_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables created with the MEMORY storage engine. When a query creates a temporary table that exceeds the value of max_heap_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set max_heap_table_size to the same value as tmp_table_size.Want more tips?For example, Innodb tuning tips, setting open_files_limit, etc. Let me know your interests in the comments section below, or hire me for MySQL optimization.\xa0Additional MySQL performance related articlesMySQL Performance Tuning: Tips, Scripts and Tools.MySQL Performance: Stop hoarding. Drop unused MySQL databases.“MySQL server has gone away” error – Solution(s).Could not increase number of max_open_files to more than… (Solution).Linux server performance: Is disk I/O slowing your application?Tuning MySQL my.cnf? Avoid this common pitfall!\xa0ConclusionIn conclusion, we discussed some common issues with MySQL performance often raised in support requests. The focus was on four specific my.cnf variables frequently responsible for poor database performance and scaling due to a shortage of server memory.It was emphasized that arbitrarily increasing these variables can lead to a decline in MySQL server performance and capacity and that it is important to keep these buffers set to their default values unless there is a specific reason to increase them. Then we covered tuning some additional MySQL performance config lines.A good rule of thumb: if you can’t provide a valid reason for increasing these buffers, keep them set to the default values. This also applies less strictly to all of MySQL’s variables. Be careful when making changes, don’t overwrite your entire my.cnf all at once. Back up everything first, make one or two changes per restart and test for 24 to 48 hours before making another pass. wsrep_mysql_replication_bundle ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.023928122594952583, 0.4574962556362152, 0.20133262872695923, 0.16734036803245544, 0.14990268647670746]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=38, param=<re.Match object; span=(1999, 2014), match='max_connections'>, value=<re.Match object; span=(0, 3), match='200'>, recommendation='200', passage='hayden_james@linux\xa0aboutarticlesservicesfeedbacksponsorscontactforumsMySQL Database Performance: Avoid this common mistake March 21, 2023 by Hayden James, in Blog LinuxOne frequent topic of support request emails I receive is MySQL database performance. Clients complain about MySQL using too much server memory, too many MySQL slow queries, the famous Mysql server has gone away errors, and many other MySQL performance-related issues. As such, I wanted to share solutions to some common MySQL configuration mistakes.If you are a DBA, feel free to share your experiences or suggestions in the comments section. I’m referring to four MySQL config variables. These four my.cnf config lines are often responsible for poor MySQL database performance and scaling due to insufficient server memory for incoming connections. This article also applies to MariaDB and Percona drop-in replacements for MySQL.Note: This is an update and follow-up to this article. I’ve added some relevant and more up-to-date information and links, as well as a new section that covers some additional my.cnf performance config tips.\xa0Avoid arbitrarily increasing MySQL per-connection buffers Excerpt of my.cnf edits for a client. (some lines were removed and some blurred to avoid misuse)Who knows where or when this bad practice started. I frequently encounter instances where I log into production servers for the first time and find that the values of virtually every my.cnf variable have been arbitrarily increased without sound reasoning behind the changes.This is never a good practice, especially for four my.cnf variables discussed below. Although increasing the value of some variables can improve performance, these four will almost always degrade MySQL server performance and capacity when increased.The four buffers in question are the\xa0join_buffer_size,\xa0sort_buffer_size,\xa0read_buffer_size and read_rnd_buffer_size.These four buffers are\xa0allocated per connection. For example, a setting of join_buffer_size=1M\xa0with\xa0max_connections=200 will configure MySQL to allocate an additional 1M per connection (1M x 200). The same goes for the other three buffers. Again, all are per connection.A good rule of thumb is that if you can’t provide a valid reason to increase any of these buffers, keep them set to the default values.In nearly all cases, it’s best to keep the defaults by removing or commenting out these four config lines. As connections increase with traffic, queries that need more space than what’s available due to larger buffer settings may trigger paging those buffers to disk. This dramatically slows down your DB server and creates a bottleneck.I’ve often seen significantly improved MySQL performance by simply reverting these buffers to their defaults. Also, read Analyzing Linux server performance with atop.The above screenshot shows MySQL status output two weeks after I made the first my.cnf optimization pass. Now, let’s take a closer look at each of these buffers.\xa0MySQL join_buffer_sizeThe join_buffer_size is allocated for each full join between two tables. From MySQL’s documentation the join_buffer_size is described as: “The minimum size of the buffer that is used for plain index scans, range index scans, and joins that do not use indexes and thus perform full table scans.”MySQL’s documentation goes on to say: “Memory allocation time can cause substantial performance drops if the global size is larger than needed by most queries that use it.” The join buffer is allocated to cache table rows when the join can’t use an index.If your database suffers from many joins performed without indexes, it cannot be solved by increasing join_buffer_size. The problem is “joins performed without indexes.” Thus, the solution for faster joins is to add indexes.\xa0MySQL sort_buffer_sizeUnless you have data indicating otherwise, you should avoid arbitrarily increasing the\xa0sort_buffer_size. Memory here is also assigned per connection!MySQL’s documentation warns: “On Linux, there are thresholds of 256KB and 2MB where larger values may significantly slow down memory allocation, so you should consider staying below one of those values.”Avoid increasing sort_buffer_size above 2M since there is a performance penalty that will eliminate benefits.\xa0MySQL read_buffer_size & read_rnd_buffer_sizeUpdate: Some of you still use MyISAM over InnoDB. MyISAM is based on the old ISAM storage engine. It has many useful extensions, as discussed here. You should consider converting your MySQL tables to the InnoDB storage engine.InnoDB is the default storage engine of MySQL 5.7 and MySQL 8.0. InnoDB features improved performance, rollback and crash-recovery capabilities to protect data. read_buffer_size\xa0Applies generally to MyISAM.Each request that performs a sequential table scan allocates a read buffer. The read_buffer_size\xa0system variable determines the buffer size.Starting from MySQL 8.0.22, the value of select_into_buffer_size overrides the value of read_buffer_size when performing SELECT INTO DUMPFILE and SELECT INTO OUTFILE statements. read_buffer_size\xa0is used for the I/O cache buffer size in all other cases.The read_rnd_buffer_size variable is also used mainly for\xa0MyISAM reads from tables. Again, consider InnoDB or MariaDB’s Aria storage engines. For the past decade, the default values of these buffers have remained the same.\xa0Additional my.cnf Performance config tipsMonitor the appropriate MySQL status variable_name(s) to assist you in tuning the below config lines. An example of viewing the status of MySQL runtime variables. (So I increased max_connections)max_connectionsA MySQL configuration parameter that sets the maximum number of concurrent connections the server can handle. A value that is too large can allocate too much server memory and lead to performance issues, while a low value can result in connection rejections.To tune this parameter, monitor the max_used_connections status variable; try to set this to ~ 2x to 3x your max used connections after a few days of uptime. However, if your MySQL max connections are more than 200 then make sure to have at least 100 extra connections available. So if max_used_connections is 300 then set max_connections to at least 400. Watch memory usage!!thread_cache_sizeDetermines the number of threads that can be cached and reused by the server. Properly tuning this parameter can help improve the performance of your MySQL server by reducing the overhead of creating new threads and freeing up system resources.To tune this parameter, you can monitor the threads_created and threads_cached status variables and set the value to a reasonable number based on the number of expected concurrent connections. As a general rule, a value of 16 is a good starting point. Then increase gradually until it’s at least 50% of max_connections. For example, if the threads_cached value is 16 and the max_used_connections value is 40 then increase this from 16 to 32. At the same time, as per above advice, if max_used_connections is 40 then your max_connections should be at least 80.table_definition_cacheA MySQL configuration parameter that sets the number of table definitions (metadata) that can be stored in the cache. A high value of table_definition_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of reading the table definition from disk.To tune this parameter, monitor the opened_table_definitions and open_table_definitionsstatus variables, set table_definition_cache to ~ 2x the number of open table definitions and adjust as needed. Consider other factors, such as system memory and query complexity when tuning. .table_open_cacheA MySQL configuration parameter that sets the number of open table objects that can be stored in the cache. A high value of table_open_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of opening tables from disk.To tune this parameter, monitor the opened_tables and open_tables status variables, set table_open_cache to ~ 2x the number of open tables, and adjust as needed. Consider other factors such as memory and query complexity when tuning. Generally table_open_cache and table_definition_cache are set to the same value. The number of open table objects and table definitions are directly related, so setting these two parameters to the same value can ensure that the metadata and open table objects are stored in the cache in a consistent and efficient manner.wait_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on a non-interactive connection before closing it. A high value of wait_timeout can result in increased memory usage and increased # of connections, while a low value can result in frequent disconnections for long-running queries.To tune this parameter, set wait_timeout to the lowest resonable expected duration of non-interactive connections, and adjust as needed. The default value is 28800 seconds. This is way to high in most cases and will consume a lot of system memory by keeping many connections open. I set most of my configs to 30 seconds or less.connect_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for a successful connection to be established before timing out. A high value of connect_timeout can result in increased wait time for clients and increase in max_connections. A low value can result in connection failures for slow or heavily loaded servers.To tune this parameter, set connect_timeout to a reasonable value based on the expected response time of the server. Consider other factors such as network latency, mobile users, and server load when tuning. I set most of my configs to 15 seconds or less. For example, this blog’s mysql connection timeout is set to 5 seconds.interactive_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on an interactive connection before closing it. A high value of interactive_timeout can result in increased memory usage and increased concurrent connetions. A low value can result in frequent disconnections for long-running queries.To tune this parameter, set interactive_timeout to a reasonable value based on the expected duration of your longest-running requests.tmp_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables used by the server. When a query creates a temporary table that exceeds the value of tmp_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set tmp_table_size to a reasonable value based on the available memory and the value of the created_tmp_disk_table variable.max_heap_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables created with the MEMORY storage engine. When a query creates a temporary table that exceeds the value of max_heap_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set max_heap_table_size to the same value as tmp_table_size.Want more tips?For example, Innodb tuning tips, setting open_files_limit, etc. Let me know your interests in the comments section below, or hire me for MySQL optimization.\xa0Additional MySQL performance related articlesMySQL Performance Tuning: Tips, Scripts and Tools.MySQL Performance: Stop hoarding. Drop unused MySQL databases.“MySQL server has gone away” error – Solution(s).Could not increase number of max_open_files to more than… (Solution).Linux server performance: Is disk I/O slowing your application?Tuning MySQL my.cnf? Avoid this common pitfall!\xa0ConclusionIn conclusion, we discussed some common issues with MySQL performance often raised in support requests. The focus was on four specific my.cnf variables frequently responsible for poor database performance and scaling due to a shortage of server memory.It was emphasized that arbitrarily increasing these variables can lead to a decline in MySQL server performance and capacity and that it is important to keep these buffers set to their default values unless there is a specific reason to increase them. Then we covered tuning some additional MySQL performance config lines.A good rule of thumb: if you can’t provide a valid reason for increasing these buffers, keep them set to the default values. This also applies less strictly to all of MySQL’s variables. Be careful when making changes, don’t overwrite your entire my.cnf all at once. Back up everything first, make one or two changes per restart and test for 24 to 48 hours before making another pass. wsrep_mysql_replication_bundle ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20448258519172668, 0.20679712295532227, 0.24968837201595306, 0.1696714460849762, 0.16936053335666656]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=38, param=<re.Match object; span=(1999, 2014), match='max_connections'>, value=<re.Match object; span=(0, 3), match='200'>, recommendation='200', passage='hayden_james@linux\xa0aboutarticlesservicesfeedbacksponsorscontactforumsMySQL Database Performance: Avoid this common mistake March 21, 2023 by Hayden James, in Blog LinuxOne frequent topic of support request emails I receive is MySQL database performance. Clients complain about MySQL using too much server memory, too many MySQL slow queries, the famous Mysql server has gone away errors, and many other MySQL performance-related issues. As such, I wanted to share solutions to some common MySQL configuration mistakes.If you are a DBA, feel free to share your experiences or suggestions in the comments section. I’m referring to four MySQL config variables. These four my.cnf config lines are often responsible for poor MySQL database performance and scaling due to insufficient server memory for incoming connections. This article also applies to MariaDB and Percona drop-in replacements for MySQL.Note: This is an update and follow-up to this article. I’ve added some relevant and more up-to-date information and links, as well as a new section that covers some additional my.cnf performance config tips.\xa0Avoid arbitrarily increasing MySQL per-connection buffers Excerpt of my.cnf edits for a client. (some lines were removed and some blurred to avoid misuse)Who knows where or when this bad practice started. I frequently encounter instances where I log into production servers for the first time and find that the values of virtually every my.cnf variable have been arbitrarily increased without sound reasoning behind the changes.This is never a good practice, especially for four my.cnf variables discussed below. Although increasing the value of some variables can improve performance, these four will almost always degrade MySQL server performance and capacity when increased.The four buffers in question are the\xa0join_buffer_size,\xa0sort_buffer_size,\xa0read_buffer_size and read_rnd_buffer_size.These four buffers are\xa0allocated per connection. For example, a setting of join_buffer_size=1M\xa0with\xa0max_connections=200 will configure MySQL to allocate an additional 1M per connection (1M x 200). The same goes for the other three buffers. Again, all are per connection.A good rule of thumb is that if you can’t provide a valid reason to increase any of these buffers, keep them set to the default values.In nearly all cases, it’s best to keep the defaults by removing or commenting out these four config lines. As connections increase with traffic, queries that need more space than what’s available due to larger buffer settings may trigger paging those buffers to disk. This dramatically slows down your DB server and creates a bottleneck.I’ve often seen significantly improved MySQL performance by simply reverting these buffers to their defaults. Also, read Analyzing Linux server performance with atop.The above screenshot shows MySQL status output two weeks after I made the first my.cnf optimization pass. Now, let’s take a closer look at each of these buffers.\xa0MySQL join_buffer_sizeThe join_buffer_size is allocated for each full join between two tables. From MySQL’s documentation the join_buffer_size is described as: “The minimum size of the buffer that is used for plain index scans, range index scans, and joins that do not use indexes and thus perform full table scans.”MySQL’s documentation goes on to say: “Memory allocation time can cause substantial performance drops if the global size is larger than needed by most queries that use it.” The join buffer is allocated to cache table rows when the join can’t use an index.If your database suffers from many joins performed without indexes, it cannot be solved by increasing join_buffer_size. The problem is “joins performed without indexes.” Thus, the solution for faster joins is to add indexes.\xa0MySQL sort_buffer_sizeUnless you have data indicating otherwise, you should avoid arbitrarily increasing the\xa0sort_buffer_size. Memory here is also assigned per connection!MySQL’s documentation warns: “On Linux, there are thresholds of 256KB and 2MB where larger values may significantly slow down memory allocation, so you should consider staying below one of those values.”Avoid increasing sort_buffer_size above 2M since there is a performance penalty that will eliminate benefits.\xa0MySQL read_buffer_size & read_rnd_buffer_sizeUpdate: Some of you still use MyISAM over InnoDB. MyISAM is based on the old ISAM storage engine. It has many useful extensions, as discussed here. You should consider converting your MySQL tables to the InnoDB storage engine.InnoDB is the default storage engine of MySQL 5.7 and MySQL 8.0. InnoDB features improved performance, rollback and crash-recovery capabilities to protect data. read_buffer_size\xa0Applies generally to MyISAM.Each request that performs a sequential table scan allocates a read buffer. The read_buffer_size\xa0system variable determines the buffer size.Starting from MySQL 8.0.22, the value of select_into_buffer_size overrides the value of read_buffer_size when performing SELECT INTO DUMPFILE and SELECT INTO OUTFILE statements. read_buffer_size\xa0is used for the I/O cache buffer size in all other cases.The read_rnd_buffer_size variable is also used mainly for\xa0MyISAM reads from tables. Again, consider InnoDB or MariaDB’s Aria storage engines. For the past decade, the default values of these buffers have remained the same.\xa0Additional my.cnf Performance config tipsMonitor the appropriate MySQL status variable_name(s) to assist you in tuning the below config lines. An example of viewing the status of MySQL runtime variables. (So I increased max_connections)max_connectionsA MySQL configuration parameter that sets the maximum number of concurrent connections the server can handle. A value that is too large can allocate too much server memory and lead to performance issues, while a low value can result in connection rejections.To tune this parameter, monitor the max_used_connections status variable; try to set this to ~ 2x to 3x your max used connections after a few days of uptime. However, if your MySQL max connections are more than 200 then make sure to have at least 100 extra connections available. So if max_used_connections is 300 then set max_connections to at least 400. Watch memory usage!!thread_cache_sizeDetermines the number of threads that can be cached and reused by the server. Properly tuning this parameter can help improve the performance of your MySQL server by reducing the overhead of creating new threads and freeing up system resources.To tune this parameter, you can monitor the threads_created and threads_cached status variables and set the value to a reasonable number based on the number of expected concurrent connections. As a general rule, a value of 16 is a good starting point. Then increase gradually until it’s at least 50% of max_connections. For example, if the threads_cached value is 16 and the max_used_connections value is 40 then increase this from 16 to 32. At the same time, as per above advice, if max_used_connections is 40 then your max_connections should be at least 80.table_definition_cacheA MySQL configuration parameter that sets the number of table definitions (metadata) that can be stored in the cache. A high value of table_definition_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of reading the table definition from disk.To tune this parameter, monitor the opened_table_definitions and open_table_definitionsstatus variables, set table_definition_cache to ~ 2x the number of open table definitions and adjust as needed. Consider other factors, such as system memory and query complexity when tuning. .table_open_cacheA MySQL configuration parameter that sets the number of open table objects that can be stored in the cache. A high value of table_open_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of opening tables from disk.To tune this parameter, monitor the opened_tables and open_tables status variables, set table_open_cache to ~ 2x the number of open tables, and adjust as needed. Consider other factors such as memory and query complexity when tuning. Generally table_open_cache and table_definition_cache are set to the same value. The number of open table objects and table definitions are directly related, so setting these two parameters to the same value can ensure that the metadata and open table objects are stored in the cache in a consistent and efficient manner.wait_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on a non-interactive connection before closing it. A high value of wait_timeout can result in increased memory usage and increased # of connections, while a low value can result in frequent disconnections for long-running queries.To tune this parameter, set wait_timeout to the lowest resonable expected duration of non-interactive connections, and adjust as needed. The default value is 28800 seconds. This is way to high in most cases and will consume a lot of system memory by keeping many connections open. I set most of my configs to 30 seconds or less.connect_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for a successful connection to be established before timing out. A high value of connect_timeout can result in increased wait time for clients and increase in max_connections. A low value can result in connection failures for slow or heavily loaded servers.To tune this parameter, set connect_timeout to a reasonable value based on the expected response time of the server. Consider other factors such as network latency, mobile users, and server load when tuning. I set most of my configs to 15 seconds or less. For example, this blog’s mysql connection timeout is set to 5 seconds.interactive_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on an interactive connection before closing it. A high value of interactive_timeout can result in increased memory usage and increased concurrent connetions. A low value can result in frequent disconnections for long-running queries.To tune this parameter, set interactive_timeout to a reasonable value based on the expected duration of your longest-running requests.tmp_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables used by the server. When a query creates a temporary table that exceeds the value of tmp_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set tmp_table_size to a reasonable value based on the available memory and the value of the created_tmp_disk_table variable.max_heap_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables created with the MEMORY storage engine. When a query creates a temporary table that exceeds the value of max_heap_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set max_heap_table_size to the same value as tmp_table_size.Want more tips?For example, Innodb tuning tips, setting open_files_limit, etc. Let me know your interests in the comments section below, or hire me for MySQL optimization.\xa0Additional MySQL performance related articlesMySQL Performance Tuning: Tips, Scripts and Tools.MySQL Performance: Stop hoarding. Drop unused MySQL databases.“MySQL server has gone away” error – Solution(s).Could not increase number of max_open_files to more than… (Solution).Linux server performance: Is disk I/O slowing your application?Tuning MySQL my.cnf? Avoid this common pitfall!\xa0ConclusionIn conclusion, we discussed some common issues with MySQL performance often raised in support requests. The focus was on four specific my.cnf variables frequently responsible for poor database performance and scaling due to a shortage of server memory.It was emphasized that arbitrarily increasing these variables can lead to a decline in MySQL server performance and capacity and that it is important to keep these buffers set to their default values unless there is a specific reason to increase them. Then we covered tuning some additional MySQL performance config lines.A good rule of thumb: if you can’t provide a valid reason for increasing these buffers, keep them set to the default values. This also applies less strictly to all of MySQL’s variables. Be careful when making changes, don’t overwrite your entire my.cnf all at once. Back up everything first, make one or two changes per restart and test for 24 to 48 hours before making another pass. wsrep_mysql_replication_bundle ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.023928122594952583, 0.4574962556362152, 0.20133262872695923, 0.16734036803245544, 0.14990268647670746]
Choice: 2
Trying update set global max_connections=50
Trying update set global max_connections=100
Trying assigning max_connections to 50
Adding assignment ('max_connections', '50') with weight 4
Assignment ('max_connections', '50') extracted from "hayden_james@linux aboutarticlesservicesfeedbacksponsorscontactforumsMySQL Database Performance: Avoid this common mistake March 21, 2023 by Hayden James, in Blog LinuxOne frequent topic of support request emails I receive is MySQL database performance. Clients complain about MySQL using too much server memory, too many MySQL slow queries, the famous Mysql server has gone away errors, and many other MySQL performance-related issues. As such, I wanted to share solutions to some common MySQL configuration mistakes.If you are a DBA, feel free to share your experiences or suggestions in the comments section. I’m referring to four MySQL config variables. These four my.cnf config lines are often responsible for poor MySQL database performance and scaling due to insufficient server memory for incoming connections. This article also applies to MariaDB and Percona drop-in replacements for MySQL.Note: This is an update and follow-up to this article. I’ve added some relevant and more up-to-date information and links, as well as a new section that covers some additional my.cnf performance config tips. Avoid arbitrarily increasing MySQL per-connection buffers Excerpt of my.cnf edits for a client. (some lines were removed and some blurred to avoid misuse)Who knows where or when this bad practice started. I frequently encounter instances where I log into production servers for the first time and find that the values of virtually every my.cnf variable have been arbitrarily increased without sound reasoning behind the changes.This is never a good practice, especially for four my.cnf variables discussed below. Although increasing the value of some variables can improve performance, these four will almost always degrade MySQL server performance and capacity when increased.The four buffers in question are the join_buffer_size, sort_buffer_size, read_buffer_size and read_rnd_buffer_size.These four buffers are allocated per connection. For example, a setting of join_buffer_size=1M with max_connections=200 will configure MySQL to allocate an additional 1M per connection (1M x 200). The same goes for the other three buffers. Again, all are per connection.A good rule of thumb is that if you can’t provide a valid reason to increase any of these buffers, keep them set to the default values.In nearly all cases, it’s best to keep the defaults by removing or commenting out these four config lines. As connections increase with traffic, queries that need more space than what’s available due to larger buffer settings may trigger paging those buffers to disk. This dramatically slows down your DB server and creates a bottleneck.I’ve often seen significantly improved MySQL performance by simply reverting these buffers to their defaults. Also, read Analyzing Linux server performance with atop.The above screenshot shows MySQL status output two weeks after I made the first my.cnf optimization pass. Now, let’s take a closer look at each of these buffers. MySQL join_buffer_sizeThe join_buffer_size is allocated for each full join between two tables. From MySQL’s documentation the join_buffer_size is described as: “The minimum size of the buffer that is used for plain index scans, range index scans, and joins that do not use indexes and thus perform full table scans.”MySQL’s documentation goes on to say: “Memory allocation time can cause substantial performance drops if the global size is larger than needed by most queries that use it.” The join buffer is allocated to cache table rows when the join can’t use an index.If your database suffers from many joins performed without indexes, it cannot be solved by increasing join_buffer_size. The problem is “joins performed without indexes.” Thus, the solution for faster joins is to add indexes. MySQL sort_buffer_sizeUnless you have data indicating otherwise, you should avoid arbitrarily increasing the sort_buffer_size. Memory here is also assigned per connection!MySQL’s documentation warns: “On Linux, there are thresholds of 256KB and 2MB where larger values may significantly slow down memory allocation, so you should consider staying below one of those values.”Avoid increasing sort_buffer_size above 2M since there is a performance penalty that will eliminate benefits. MySQL read_buffer_size & read_rnd_buffer_sizeUpdate: Some of you still use MyISAM over InnoDB. MyISAM is based on the old ISAM storage engine. It has many useful extensions, as discussed here. You should consider converting your MySQL tables to the InnoDB storage engine.InnoDB is the default storage engine of MySQL 5.7 and MySQL 8.0. InnoDB features improved performance, rollback and crash-recovery capabilities to protect data. read_buffer_size Applies generally to MyISAM.Each request that performs a sequential table scan allocates a read buffer. The read_buffer_size system variable determines the buffer size.Starting from MySQL 8.0.22, the value of select_into_buffer_size overrides the value of read_buffer_size when performing SELECT INTO DUMPFILE and SELECT INTO OUTFILE statements. read_buffer_size is used for the I/O cache buffer size in all other cases.The read_rnd_buffer_size variable is also used mainly for MyISAM reads from tables. Again, consider InnoDB or MariaDB’s Aria storage engines. For the past decade, the default values of these buffers have remained the same. Additional my.cnf Performance config tipsMonitor the appropriate MySQL status variable_name(s) to assist you in tuning the below config lines. An example of viewing the status of MySQL runtime variables. (So I increased max_connections)max_connectionsA MySQL configuration parameter that sets the maximum number of concurrent connections the server can handle. A value that is too large can allocate too much server memory and lead to performance issues, while a low value can result in connection rejections.To tune this parameter, monitor the max_used_connections status variable; try to set this to ~ 2x to 3x your max used connections after a few days of uptime. However, if your MySQL max connections are more than 200 then make sure to have at least 100 extra connections available. So if max_used_connections is 300 then set max_connections to at least 400. Watch memory usage!!thread_cache_sizeDetermines the number of threads that can be cached and reused by the server. Properly tuning this parameter can help improve the performance of your MySQL server by reducing the overhead of creating new threads and freeing up system resources.To tune this parameter, you can monitor the threads_created and threads_cached status variables and set the value to a reasonable number based on the number of expected concurrent connections. As a general rule, a value of 16 is a good starting point. Then increase gradually until it’s at least 50% of max_connections. For example, if the threads_cached value is 16 and the max_used_connections value is 40 then increase this from 16 to 32. At the same time, as per above advice, if max_used_connections is 40 then your max_connections should be at least 80.table_definition_cacheA MySQL configuration parameter that sets the number of table definitions (metadata) that can be stored in the cache. A high value of table_definition_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of reading the table definition from disk.To tune this parameter, monitor the opened_table_definitions and open_table_definitionsstatus variables, set table_definition_cache to ~ 2x the number of open table definitions and adjust as needed. Consider other factors, such as system memory and query complexity when tuning. .table_open_cacheA MySQL configuration parameter that sets the number of open table objects that can be stored in the cache. A high value of table_open_cache can improve performance by reducing the time required to open tables, while a low value can result in increased overhead of opening tables from disk.To tune this parameter, monitor the opened_tables and open_tables status variables, set table_open_cache to ~ 2x the number of open tables, and adjust as needed. Consider other factors such as memory and query complexity when tuning. Generally table_open_cache and table_definition_cache are set to the same value. The number of open table objects and table definitions are directly related, so setting these two parameters to the same value can ensure that the metadata and open table objects are stored in the cache in a consistent and efficient manner.wait_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on a non-interactive connection before closing it. A high value of wait_timeout can result in increased memory usage and increased # of connections, while a low value can result in frequent disconnections for long-running queries.To tune this parameter, set wait_timeout to the lowest resonable expected duration of non-interactive connections, and adjust as needed. The default value is 28800 seconds. This is way to high in most cases and will consume a lot of system memory by keeping many connections open. I set most of my configs to 30 seconds or less.connect_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for a successful connection to be established before timing out. A high value of connect_timeout can result in increased wait time for clients and increase in max_connections. A low value can result in connection failures for slow or heavily loaded servers.To tune this parameter, set connect_timeout to a reasonable value based on the expected response time of the server. Consider other factors such as network latency, mobile users, and server load when tuning. I set most of my configs to 15 seconds or less. For example, this blog’s mysql connection timeout is set to 5 seconds.interactive_timeoutA MySQL configuration parameter that sets the number of seconds the server waits for activity on an interactive connection before closing it. A high value of interactive_timeout can result in increased memory usage and increased concurrent connetions. A low value can result in frequent disconnections for long-running queries.To tune this parameter, set interactive_timeout to a reasonable value based on the expected duration of your longest-running requests.tmp_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables used by the server. When a query creates a temporary table that exceeds the value of tmp_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set tmp_table_size to a reasonable value based on the available memory and the value of the created_tmp_disk_table variable.max_heap_table_sizeA MySQL configuration parameter that sets the maximum size of in-memory temporary tables created with the MEMORY storage engine. When a query creates a temporary table that exceeds the value of max_heap_table_size, the table will be automatically converted to an on-disk table, which can result in decreased performance.To tune this parameter, set max_heap_table_size to the same value as tmp_table_size.Want more tips?For example, Innodb tuning tips, setting open_files_limit, etc. Let me know your interests in the comments section below, or hire me for MySQL optimization. Additional MySQL performance related articlesMySQL Performance Tuning: Tips, Scripts and Tools.MySQL Performance: Stop hoarding. Drop unused MySQL databases.“MySQL server has gone away” error – Solution(s).Could not increase number of max_open_files to more than… (Solution).Linux server performance: Is disk I/O slowing your application?Tuning MySQL my.cnf? Avoid this common pitfall! ConclusionIn conclusion, we discussed some common issues with MySQL performance often raised in support requests. The focus was on four specific my.cnf variables frequently responsible for poor database performance and scaling due to a shortage of server memory.It was emphasized that arbitrarily increasing these variables can lead to a decline in MySQL server performance and capacity and that it is important to keep these buffers set to their default values unless there is a specific reason to increase them. Then we covered tuning some additional MySQL performance config lines.A good rule of thumb: if you can’t provide a valid reason for increasing these buffers, keep them set to the default values. This also applies less strictly to all of MySQL’s variables. Be careful when making changes, don’t overwrite your entire my.cnf all at once. Back up everything first, make one or two changes per restart and test for 24 to 48 hours before making another pass. wsrep_mysql_replication_bundle "
Hint counter: 5
Episode hint counter before: 10
Episode hint counter: 11
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(95, 110), match='max_connections'>, value=<re.Match object; span=(0, 4), match='1250'>, recommendation='1250', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=1250.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20277561247348785, 0.23470382392406464, 0.2442580908536911, 0.15910832583904266, 0.15915419161319733]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(95, 110), match='max_connections'>, value=<re.Match object; span=(0, 4), match='1250'>, recommendation='1250', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=1250.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.022127989679574966, 0.4868924915790558, 0.19467118382453918, 0.1581139713525772, 0.13819433748722076]
Choice: 0
Trying update set global max_connections=2500
Trying update set global max_connections=100
Trying assigning max_connections to 2500
Adding assignment ('max_connections', '2500') with weight 1
Assignment ('max_connections', '2500') extracted from "tmp-table-size = 96M
max-heap-table-size = 96M
key_buffer_size = 64M
# Connections and Threads
max_connections = 1250
thread_cache_size = 8
max_allowed_packet = 64M thread_pool_max_threads "
Hint counter: 6
Episode hint counter before: 11
Episode hint counter: 12
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(149, 164), match='max_connections'>, value=<re.Match object; span=(65, 68), match='150'>, recommendation='larger than the total number of all Zabbix server processes plus 150', passage='Later, we will go through every configuration parameter with our ChatGPT friend, but first, there are two things to remember!Configuration parameter\xa0max_connections\xa0must be larger than the total number of all Zabbix server processes plus 150. You can use the command below to automatically check the number of Zabbix processes and add 150 to that number:egrep "^Start.+=[0-9]" /etc/zabbix/zabbix_server.conf | awk -F "=" \'{s+=$2} END {print s+150}\' max_password_errors ', float_val=150.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1274421215057373, 0.07760956138372421, 0.3626527190208435, 0.16154444217681885, 0.27075114846229553]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(149, 164), match='max_connections'>, value=<re.Match object; span=(65, 68), match='150'>, recommendation='larger than the total number of all Zabbix server processes plus 150', passage='Later, we will go through every configuration parameter with our ChatGPT friend, but first, there are two things to remember!Configuration parameter\xa0max_connections\xa0must be larger than the total number of all Zabbix server processes plus 150. You can use the command below to automatically check the number of Zabbix processes and add 150 to that number:egrep "^Start.+=[0-9]" /etc/zabbix/zabbix_server.conf | awk -F "=" \'{s+=$2} END {print s+150}\' max_password_errors ', float_val=150.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.012601979076862335, 0.5690935850143433, 0.1851271241903305, 0.12315736711025238, 0.11001989245414734]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(149, 164), match='max_connections'>, value=<re.Match object; span=(65, 68), match='150'>, recommendation='larger than the total number of all Zabbix server processes plus 150', passage='Later, we will go through every configuration parameter with our ChatGPT friend, but first, there are two things to remember!Configuration parameter\xa0max_connections\xa0must be larger than the total number of all Zabbix server processes plus 150. You can use the command below to automatically check the number of Zabbix processes and add 150 to that number:egrep "^Start.+=[0-9]" /etc/zabbix/zabbix_server.conf | awk -F "=" \'{s+=$2} END {print s+150}\' max_password_errors ', float_val=150.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1274421215057373, 0.07760956138372421, 0.3626527190208435, 0.16154444217681885, 0.27075114846229553]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(149, 164), match='max_connections'>, value=<re.Match object; span=(65, 68), match='150'>, recommendation='larger than the total number of all Zabbix server processes plus 150', passage='Later, we will go through every configuration parameter with our ChatGPT friend, but first, there are two things to remember!Configuration parameter\xa0max_connections\xa0must be larger than the total number of all Zabbix server processes plus 150. You can use the command below to automatically check the number of Zabbix processes and add 150 to that number:egrep "^Start.+=[0-9]" /etc/zabbix/zabbix_server.conf | awk -F "=" \'{s+=$2} END {print s+150}\' max_password_errors ', float_val=150.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.012601979076862335, 0.5690935850143433, 0.1851271241903305, 0.12315736711025238, 0.11001989245414734]
Choice: 1
Trying update set global max_connections=75
Trying update set global max_connections=100
Trying assigning max_connections to 75
Adding assignment ('max_connections', '75') with weight 2
Assignment ('max_connections', '75') extracted from "Later, we will go through every configuration parameter with our ChatGPT friend, but first, there are two things to remember!Configuration parameter max_connections must be larger than the total number of all Zabbix server processes plus 150. You can use the command below to automatically check the number of Zabbix processes and add 150 to that number:egrep "^Start.+=[0-9]" /etc/zabbix/zabbix_server.conf | awk -F "=" '{s+=$2} END {print s+150}' max_password_errors "
Hint counter: 7
Episode hint counter before: 12
Episode hint counter: 13
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(140, 155), match='max_connections'>, value=<re.Match object; span=(0, 3), match='200'>, recommendation='200', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20448258519172668, 0.20679712295532227, 0.24968837201595306, 0.1696714460849762, 0.16936053335666656]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(140, 155), match='max_connections'>, value=<re.Match object; span=(0, 3), match='200'>, recommendation='200', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.023928122594952583, 0.4574962556362152, 0.20133262872695923, 0.16734036803245544, 0.14990268647670746]
Choice: 0
Trying update set global max_connections=800
Trying update set global max_connections=100
Trying assigning max_connections to 800
Adding assignment ('max_connections', '800') with weight 1
Assignment ('max_connections', '800') extracted from "read_rnd_buffer_size = 512
join_buffer_size = 2048
thread_stack = 512
binlog_cache_size = 64
thread_cache_size = 16
table_open_cache = 2048
max_connections = 200
PHP:
max_children = 4 thread_cache_size "
Hint counter: 8
Episode hint counter before: 13
Episode hint counter: 14
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(67, 82), match='max_connections'>, value=<re.Match object; span=(0, 2), match='20'>, recommendation='20', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=20.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18651802837848663, 0.19193889200687408, 0.25157612562179565, 0.1705176830291748, 0.19944924116134644]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(67, 82), match='max_connections'>, value=<re.Match object; span=(0, 2), match='20'>, recommendation='20', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=20.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.024509061127901077, 0.4811500310897827, 0.19708628952503204, 0.1599201112985611, 0.1373344212770462]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(67, 82), match='max_connections'>, value=<re.Match object; span=(0, 2), match='20'>, recommendation='20', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=20.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18651802837848663, 0.19193889200687408, 0.25157612562179565, 0.1705176830291748, 0.19944924116134644]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(67, 82), match='max_connections'>, value=<re.Match object; span=(0, 2), match='20'>, recommendation='20', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=20.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.024509061127901077, 0.4811500310897827, 0.19708628952503204, 0.1599201112985611, 0.1373344212770462]
Choice: 4
Trying update set global max_connections=20
Trying update set global max_connections=100
Trying assigning max_connections to 20
Adding assignment ('max_connections', '20') with weight 16
Assignment ('max_connections', '20') extracted from "binlog_cache_size = 32
thread_cache_size = 8
table_open_cache = 64
max_connections = 20
PHP:
max_children = 10
start_servers = 2
min_spare_servers = 1
max_spare_servers = 3 binlog_stmt_cache_size "
Hint counter: 9
Episode hint counter before: 14
Episode hint counter: 15
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=63, param=<re.Match object; span=(0, 15), match='max_connections'>, value=<re.Match object; span=(0, 3), match='500'>, recommendation='500', passage='max_connections\n= 500\nmax_user_connections\n= 500\n#table_cache\n= 64\nthread_concurrency\n= 300\ntable_cache\n= 30000\nopen_files_limit\n= 65000\n#innodb_force_recovery =6 max_binlog_stmt_cache_size ', float_val=500.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.2242766171693802, 0.18561743199825287, 0.25007033348083496, 0.17030423879623413, 0.16973133385181427]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=63, param=<re.Match object; span=(0, 15), match='max_connections'>, value=<re.Match object; span=(0, 3), match='500'>, recommendation='500', passage='max_connections\n= 500\nmax_user_connections\n= 500\n#table_cache\n= 64\nthread_concurrency\n= 300\ntable_cache\n= 30000\nopen_files_limit\n= 65000\n#innodb_force_recovery =6 max_binlog_stmt_cache_size ', float_val=500.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.022781977429986, 0.46374940872192383, 0.2040889710187912, 0.16545264422893524, 0.1439269781112671]
Choice: 4
Trying update set global max_connections=1000
Trying update set global max_connections=100
Trying assigning max_connections to 1000
Adding assignment ('max_connections', '1000') with weight 16
Assignment ('max_connections', '1000') extracted from "max_connections
= 500
max_user_connections
= 500
#table_cache
= 64
thread_concurrency
= 300
table_cache
= 30000
open_files_limit
= 65000
#innodb_force_recovery =6 max_binlog_stmt_cache_size "
Hint counter: 10
Episode hint counter before: 15
Episode hint counter: 16
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=1, param=<re.Match object; span=(0, 23), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 2), match='70'>, recommendation='70-80% of the available memory', passage='innodb_buffer_pool_size: Allocate more memory to the InnoDB buffer pool to reduce disk I/O. Typically, this value should be set to at least 70-80% of the available memory.\ninnodb_log_file_size: A larger log file size reduces the need for frequent log rotations, thus improving write performance. However, a log size that is too large might slow down the recovery process after a crash.\nTweak Query Cache Variables innodb_log_buffer_size ', float_val=70.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.12051532417535782, 0.1557127982378006, 0.3688836991786957, 0.1453220099210739, 0.20956619083881378]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=1, param=<re.Match object; span=(0, 23), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 2), match='70'>, recommendation='70-80% of the available memory', passage='innodb_buffer_pool_size: Allocate more memory to the InnoDB buffer pool to reduce disk I/O. Typically, this value should be set to at least 70-80% of the available memory.\ninnodb_log_file_size: A larger log file size reduces the need for frequent log rotations, thus improving write performance. However, a log size that is too large might slow down the recovery process after a crash.\nTweak Query Cache Variables innodb_log_buffer_size ', float_val=70.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.021443508565425873, 0.5487614274024963, 0.17386455833911896, 0.14200177788734436, 0.11392877995967865]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=1, param=<re.Match object; span=(0, 23), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 2), match='70'>, recommendation='70-80% of the available memory', passage='innodb_buffer_pool_size: Allocate more memory to the InnoDB buffer pool to reduce disk I/O. Typically, this value should be set to at least 70-80% of the available memory.\ninnodb_log_file_size: A larger log file size reduces the need for frequent log rotations, thus improving write performance. However, a log size that is too large might slow down the recovery process after a crash.\nTweak Query Cache Variables innodb_log_buffer_size ', float_val=70.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.12051532417535782, 0.1557127982378006, 0.3688836991786957, 0.1453220099210739, 0.20956619083881378]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=1, param=<re.Match object; span=(0, 23), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 2), match='70'>, recommendation='70-80% of the available memory', passage='innodb_buffer_pool_size: Allocate more memory to the InnoDB buffer pool to reduce disk I/O. Typically, this value should be set to at least 70-80% of the available memory.\ninnodb_log_file_size: A larger log file size reduces the need for frequent log rotations, thus improving write performance. However, a log size that is too large might slow down the recovery process after a crash.\nTweak Query Cache Variables innodb_log_buffer_size ', float_val=70.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.021443508565425873, 0.5487614274024963, 0.17386455833911896, 0.14200177788734436, 0.11392877995967865]
Choice: 0
Trying update set global innodb_buffer_pool_size=17
Exception during update: Variable 'innodb_buffer_pool_size' can't be set to the value of '17'
Trying update set global innodb_buffer_pool_size=134217728
Trying assigning innodb_buffer_pool_size to 17
Assignment ('innodb_buffer_pool_size', '17') was rejected
Hint counter: 11
Episode hint counter before: 16
Episode hint counter: 17
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=1, param=<re.Match object; span=(0, 23), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(3, 6), match='80%'>, recommendation='70-80% of the available memory', passage='innodb_buffer_pool_size: Allocate more memory to the InnoDB buffer pool to reduce disk I/O. Typically, this value should be set to at least 70-80% of the available memory.\ninnodb_log_file_size: A larger log file size reduces the need for frequent log rotations, thus improving write performance. However, a log size that is too large might slow down the recovery process after a crash.\nTweak Query Cache Variables innodb_log_buffer_size ', float_val=0.8, val_unit='', hint_type=<HintType.RAM_RATIO: 1>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.12051532417535782, 0.1557127982378006, 0.3688836991786957, 0.1453220099210739, 0.20956619083881378]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=1, param=<re.Match object; span=(0, 23), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(3, 6), match='80%'>, recommendation='70-80% of the available memory', passage='innodb_buffer_pool_size: Allocate more memory to the InnoDB buffer pool to reduce disk I/O. Typically, this value should be set to at least 70-80% of the available memory.\ninnodb_log_file_size: A larger log file size reduces the need for frequent log rotations, thus improving write performance. However, a log size that is too large might slow down the recovery process after a crash.\nTweak Query Cache Variables innodb_log_buffer_size ', float_val=0.8, val_unit='', hint_type=<HintType.RAM_RATIO: 1>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.021443508565425873, 0.5487614274024963, 0.17386455833911896, 0.14200177788734436, 0.11392877995967865]
Choice: 0
Trying update set global innodb_buffer_pool_size=8589934592
Trying update set global innodb_buffer_pool_size=134217728
Exception during update: Another buffer pool resize is already in progress.
Trying assigning innodb_buffer_pool_size to 8589934592
Adding assignment ('innodb_buffer_pool_size', '8589934592') with weight 1
Assignment ('innodb_buffer_pool_size', '8589934592') extracted from "innodb_buffer_pool_size: Allocate more memory to the InnoDB buffer pool to reduce disk I/O. Typically, this value should be set to at least 70-80% of the available memory.
innodb_log_file_size: A larger log file size reduces the need for frequent log rotations, thus improving write performance. However, a log size that is too large might slow down the recovery process after a crash.
Tweak Query Cache Variables innodb_log_buffer_size "
Hint counter: 12
Episode hint counter before: 17
Episode hint counter: 18
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(97, 120), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 3), match='23G'>, recommendation='23G', passage='innodb_stats_on_metadata = off\ninnodb-flush-method = O_DIRECT\ninnodb-flush-log-at-trx-commit = 2\ninnodb_buffer_pool_size = 23G\ninnodb_read_io_threads = 32 innodb_flush_log_at_trx_commit ', float_val=23.0, val_unit='G', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18098114430904388, 0.19943229854106903, 0.23072713613510132, 0.20386049151420593, 0.18499886989593506]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(97, 120), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 3), match='23G'>, recommendation='23G', passage='innodb_stats_on_metadata = off\ninnodb-flush-method = O_DIRECT\ninnodb-flush-log-at-trx-commit = 2\ninnodb_buffer_pool_size = 23G\ninnodb_read_io_threads = 32 innodb_flush_log_at_trx_commit ', float_val=23.0, val_unit='G', hint_type=<HintType.ABSOLUTE: 3>)\n[Restart] MariaDB server shut down!
[Restart] MariaDB server restarted!
\n[Restart] MariaDB server shut down!
[Restart] MariaDB server restarted!

Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.01924968883395195, 0.4707958996295929, 0.1976868361234665, 0.166013702750206, 0.1462538093328476]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(97, 120), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 3), match='23G'>, recommendation='23G', passage='innodb_stats_on_metadata = off\ninnodb-flush-method = O_DIRECT\ninnodb-flush-log-at-trx-commit = 2\ninnodb_buffer_pool_size = 23G\ninnodb_read_io_threads = 32 innodb_flush_log_at_trx_commit ', float_val=23.0, val_unit='G', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18098114430904388, 0.19943229854106903, 0.23072713613510132, 0.20386049151420593, 0.18499886989593506]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(97, 120), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 3), match='23G'>, recommendation='23G', passage='innodb_stats_on_metadata = off\ninnodb-flush-method = O_DIRECT\ninnodb-flush-log-at-trx-commit = 2\ninnodb_buffer_pool_size = 23G\ninnodb_read_io_threads = 32 innodb_flush_log_at_trx_commit ', float_val=23.0, val_unit='G', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.01924968883395195, 0.4707958996295929, 0.1976868361234665, 0.166013702750206, 0.1462538093328476]
Choice: 1
Trying update set global innodb_buffer_pool_size=24696061952
Exception during update: Another buffer pool resize is already in progress.
Trying update set global innodb_buffer_pool_size=8589934592
Exception during update: Another buffer pool resize is already in progress.
Trying assigning innodb_buffer_pool_size to 23G
Assignment ('innodb_buffer_pool_size', '23G') was rejected
Hint counter: 13
Episode hint counter before: 18
Episode hint counter: 19
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(66, 89), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 4), match='4096'>, recommendation='4096', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=4096.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1929043084383011, 0.20756587386131287, 0.27467942237854004, 0.1552993506193161, 0.16955099999904633]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(66, 89), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 4), match='4096'>, recommendation='4096', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=4096.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.029096694663167, 0.4537006616592407, 0.2012118697166443, 0.17119792103767395, 0.14479291439056396]
Choice: 2
Trying update set global innodb_buffer_pool_size=4096
Exception during update: Variable 'innodb_buffer_pool_size' can't be set to the value of '4096'
Trying update set global innodb_buffer_pool_size=8589934592
Exception during update: Another buffer pool resize is already in progress.
Trying assigning innodb_buffer_pool_size to 4096
Assignment ('innodb_buffer_pool_size', '4096') was rejected
Hint counter: 14
Episode hint counter before: 19
Episode hint counter: 20
Hints per episode: 20
Episode finished!
Done flag: True
Finalizing episode!
Weighted hints: defaultdict(<function NlpTuningEnv._finalize_episode.<locals>.<lambda> at 0x7f8767de0790>, {('read_buffer_size', '4096'): 1, ('read_buffer_size', '8192'): 2, ('binlog_cache_size', '256'): 8, ('binlog_cache_size', '8'): 2, ('query_cache_limit', '25M'): 16, ('thread_cache_size', '4'): 21, ('thread_cache_size', '2'): 4, ('max_connections', '50'): 4, ('max_connections', '2500'): 1, ('max_connections', '75'): 2, ('max_connections', '800'): 1, ('max_connections', '20'): 16, ('max_connections', '1000'): 16, ('innodb_buffer_pool_size', '8589934592'): 1})
Selected configurations: [{'read_buffer_size': '8192', 'binlog_cache_size': '256', 'query_cache_limit': '25M', 'thread_cache_size': '4', 'max_connections': '800', 'innodb_buffer_pool_size': '8589934592'}, {'read_buffer_size': '4096', 'binlog_cache_size': '8', 'query_cache_limit': '25M', 'thread_cache_size': '2', 'max_connections': '50', 'innodb_buffer_pool_size': '8589934592'}]
Disconnecting ...
Trying to connect to tpch with user kaltenec
Trying update set session max_execution_time = 1500000
Exception during update: Unknown system variable 'max_execution_time'
Trying update update mariadb.server_cost set cost_value = NULL
Exception during update: Table 'mariadb.server_cost' doesn't exist
Trying update update mariadb.engine_cost set cost_value = NULL
Exception during update: Table 'mariadb.engine_cost' doesn't exist
Trying configuration: {'read_buffer_size': '8192', 'binlog_cache_size': '256', 'query_cache_limit': '25M', 'thread_cache_size': '4', 'max_connections': '800', 'innodb_buffer_pool_size': '8589934592'}
Trying update set global read_buffer_size=8192
Trying update set global binlog_cache_size=256
Trying update set global query_cache_limit=26214400
Trying update set global thread_cache_size=4
Trying update set global max_connections=800
Trying update set global innodb_buffer_pool_size=8589934592
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Reward 46550.724365234375 with {'read_buffer_size': '8192', 'binlog_cache_size': '256', 'query_cache_limit': '25M', 'thread_cache_size': '4', 'max_connections': '800', 'innodb_buffer_pool_size': '8589934592'}
Disconnecting ...
Trying to connect to tpch with user kaltenec
Trying update set session max_execution_time = 1500000
Exception during update: Unknown system variable 'max_execution_time'
Trying update update mariadb.server_cost set cost_value = NULL
Exception during update: Table 'mariadb.server_cost' doesn't exist
Trying update update mariadb.engine_cost set cost_value = NULL
Exception during update: Table 'mariadb.engine_cost' doesn't exist
Trying configuration: {'read_buffer_size': '4096', 'binlog_cache_size': '8', 'query_cache_limit': '25M', 'thread_cache_size': '2', 'max_connections': '50', 'innodb_buffer_pool_size': '8589934592'}
Trying update set global read_buffer_size=4096
Trying update set global binlog_cache_size=8
Trying update set global query_cache_limit=26214400
Trying update set global thread_cache_size=2
Trying update set global max_connections=50
Trying update set global innodb_buffer_pool_size=8589934592
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Reward 46465.338134765625 with {'read_buffer_size': '4096', 'binlog_cache_size': '8', 'query_cache_limit': '25M', 'thread_cache_size': '2', 'max_connections': '50', 'innodb_buffer_pool_size': '8589934592'}
Obtained 46550.724365234375 by configuration {'read_buffer_size': '8192', 'binlog_cache_size': '256', 'query_cache_limit': '25M', 'thread_cache_size': '4', 'max_connections': '800', 'innodb_buffer_pool_size': '8589934592'}
Achieved unscaled reward of 46550.724365234375 using {'read_buffer_size': '8192', 'binlog_cache_size': '256', 'query_cache_limit': '25M', 'thread_cache_size': '4', 'max_connections': '800', 'innodb_buffer_pool_size': '8589934592'}.
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(38, 61), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 4), match='180M'>, recommendation='180M', passage="Mysql need's by default 512MB of RAM.\ninnodb_buffer_pool_size = 180M with this settings you can limit the RAM ussage, a high value is pointless\nMysql is runing on a local server so if you have a ssd on it the access is pretty fast there is no point to use your ram for nothing. sql_slave_skip_counter ", float_val=180.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20210203528404236, 0.19127501547336578, 0.2364121675491333, 0.1605609506368637, 0.20964983105659485]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(38, 61), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 4), match='180M'>, recommendation='180M', passage="Mysql need's by default 512MB of RAM.\ninnodb_buffer_pool_size = 180M with this settings you can limit the RAM ussage, a high value is pointless\nMysql is runing on a local server so if you have a ssd on it the access is pretty fast there is no point to use your ram for nothing. sql_slave_skip_counter ", float_val=180.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20210203528404236, 0.19127501547336578, 0.2364121675491333, 0.1605609506368637, 0.20964983105659485]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(38, 61), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 4), match='180M'>, recommendation='180M', passage="Mysql need's by default 512MB of RAM.\ninnodb_buffer_pool_size = 180M with this settings you can limit the RAM ussage, a high value is pointless\nMysql is runing on a local server so if you have a ssd on it the access is pretty fast there is no point to use your ram for nothing. sql_slave_skip_counter ", float_val=180.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.020154068246483803, 0.43662428855895996, 0.20483645796775818, 0.17478047311306, 0.1636047512292862]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(38, 61), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 4), match='180M'>, recommendation='180M', passage="Mysql need's by default 512MB of RAM.\ninnodb_buffer_pool_size = 180M with this settings you can limit the RAM ussage, a high value is pointless\nMysql is runing on a local server so if you have a ssd on it the access is pretty fast there is no point to use your ram for nothing. sql_slave_skip_counter ", float_val=180.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20210203528404236, 0.19127501547336578, 0.2364121675491333, 0.1605609506368637, 0.20964983105659485]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(38, 61), match='innodb_buffer_pool_size'>, value=<re.Match object; span=(0, 4), match='180M'>, recommendation='180M', passage="Mysql need's by default 512MB of RAM.\ninnodb_buffer_pool_size = 180M with this settings you can limit the RAM ussage, a high value is pointless\nMysql is runing on a local server so if you have a ssd on it the access is pretty fast there is no point to use your ram for nothing. sql_slave_skip_counter ", float_val=180.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.020154068246483803, 0.43662428855895996, 0.20483645796775818, 0.17478047311306, 0.1636047512292862]
Choice: 3
Trying update set global innodb_buffer_pool_size=47185920
Trying update set global innodb_buffer_pool_size=8589934592
Exception during update: Another buffer pool resize is already in progress.
Trying assigning innodb_buffer_pool_size to 45M
Adding assignment ('innodb_buffer_pool_size', '45M') with weight 8
Assignment ('innodb_buffer_pool_size', '45M') extracted from "Mysql need's by default 512MB of RAM.
innodb_buffer_pool_size = 180M with this settings you can limit the RAM ussage, a high value is pointless
Mysql is runing on a local server so if you have a ssd on it the access is pretty fast there is no point to use your ram for nothing. sql_slave_skip_counter "
Hint counter: 15
Episode hint counter before: 0
Episode hint counter: 1
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=11, param=<re.Match object; span=(245, 260), match='key_buffer_size'>, value=<re.Match object; span=(0, 3), match='32M'>, recommendation='32M', passage="The key buffer can improve the access speed to Moodle's SELECT queries. The correct size depends on the size of the index files (.myi) and in Moodle 1.6 or later (without any additional modules and plugins), the recommendation for this value is key_buffer_size = 32M. Ideally you want the database to be reading once from the disk for every 100 requests so monitor that the value is suitable for your install by adjusting the value of key_buffer_size so that the following formulas are true:\nkey_read / key_read_requests < 0.01\nkey_write / key_write_requests <= 1.0 key_buffer_size ", float_val=32.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18291717767715454, 0.17137980461120605, 0.30023810267448425, 0.15002238750457764, 0.19544251263141632]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=11, param=<re.Match object; span=(245, 260), match='key_buffer_size'>, value=<re.Match object; span=(0, 3), match='32M'>, recommendation='32M', passage="The key buffer can improve the access speed to Moodle's SELECT queries. The correct size depends on the size of the index files (.myi) and in Moodle 1.6 or later (without any additional modules and plugins), the recommendation for this value is key_buffer_size = 32M. Ideally you want the database to be reading once from the disk for every 100 requests so monitor that the value is suitable for your install by adjusting the value of key_buffer_size so that the following formulas are true:\nkey_read / key_read_requests < 0.01\nkey_write / key_write_requests <= 1.0 key_buffer_size ", float_val=32.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02246321365237236, 0.4591565728187561, 0.2058204859495163, 0.16968268156051636, 0.14287708699703217]
Choice: 2
Trying update set global key_buffer_size=16777216
Trying update set global key_buffer_size=134217728
Trying assigning key_buffer_size to 16M
Adding assignment ('key_buffer_size', '16M') with weight 4
Assignment ('key_buffer_size', '16M') extracted from "The key buffer can improve the access speed to Moodle's SELECT queries. The correct size depends on the size of the index files (.myi) and in Moodle 1.6 or later (without any additional modules and plugins), the recommendation for this value is key_buffer_size = 32M. Ideally you want the database to be reading once from the disk for every 100 requests so monitor that the value is suitable for your install by adjusting the value of key_buffer_size so that the following formulas are true:
key_read / key_read_requests < 0.01
key_write / key_write_requests <= 1.0 key_buffer_size "
Hint counter: 16
Episode hint counter before: 1
Episode hint counter: 2
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(47, 62), match='key_buffer_size'>, value=<re.Match object; span=(0, 3), match='64M'>, recommendation='64M', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=64.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19450999796390533, 0.15914979577064514, 0.2871057093143463, 0.14859525859355927, 0.21063925325870514]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(47, 62), match='key_buffer_size'>, value=<re.Match object; span=(0, 3), match='64M'>, recommendation='64M', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=64.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.023741085082292557, 0.44100087881088257, 0.21198078989982605, 0.1755017787218094, 0.14777542650699615]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(47, 62), match='key_buffer_size'>, value=<re.Match object; span=(0, 3), match='64M'>, recommendation='64M', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=64.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19450999796390533, 0.15914979577064514, 0.2871057093143463, 0.14859525859355927, 0.21063925325870514]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(47, 62), match='key_buffer_size'>, value=<re.Match object; span=(0, 3), match='64M'>, recommendation='64M', passage='tmp-table-size = 96M\nmax-heap-table-size = 96M\nkey_buffer_size = 64M\n# Connections and Threads\nmax_connections = 1250\nthread_cache_size = 8\nmax_allowed_packet = 64M thread_pool_max_threads ', float_val=64.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.023741085082292557, 0.44100087881088257, 0.21198078989982605, 0.1755017787218094, 0.14777542650699615]
Choice: 4
Trying update set global key_buffer_size=16777216
Trying update set global key_buffer_size=134217728
Trying assigning key_buffer_size to 16M
Adding assignment ('key_buffer_size', '16M') with weight 16
Assignment ('key_buffer_size', '16M') extracted from "tmp-table-size = 96M
max-heap-table-size = 96M
key_buffer_size = 64M
# Connections and Threads
max_connections = 1250
thread_cache_size = 8
max_allowed_packet = 64M thread_pool_max_threads "
Hint counter: 17
Episode hint counter before: 2
Episode hint counter: 3
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(1789, 1804), match='key_buffer_size'>, value=<re.Match object; span=(0, 2), match='8M'>, recommendation='8M/128M/No limit', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=8.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.13929742574691772, 0.2145470678806305, 0.28674599528312683, 0.18182188272476196, 0.17758767306804657]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(1789, 1804), match='key_buffer_size'>, value=<re.Match object; span=(0, 2), match='8M'>, recommendation='8M/128M/No limit', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=8.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.10024014115333557, 0.4005581736564636, 0.20327132940292358, 0.16120778024196625, 0.13472256064414978]
Choice: 2
Trying update set global key_buffer_size=4194304
Trying update set global key_buffer_size=134217728
Trying assigning key_buffer_size to 4M
Adding assignment ('key_buffer_size', '4M') with weight 4
Assignment ('key_buffer_size', '4M') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 18
Episode hint counter before: 3
Episode hint counter: 4
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(1789, 1804), match='key_buffer_size'>, value=<re.Match object; span=(3, 7), match='128M'>, recommendation='8M/128M/No limit', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=128.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.13929742574691772, 0.2145470678806305, 0.28674599528312683, 0.18182188272476196, 0.17758767306804657]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(1789, 1804), match='key_buffer_size'>, value=<re.Match object; span=(3, 7), match='128M'>, recommendation='8M/128M/No limit', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=128.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.10024014115333557, 0.4005581736564636, 0.20327132940292358, 0.16120778024196625, 0.13472256064414978]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(1789, 1804), match='key_buffer_size'>, value=<re.Match object; span=(3, 7), match='128M'>, recommendation='8M/128M/No limit', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=128.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.13929742574691772, 0.2145470678806305, 0.28674599528312683, 0.18182188272476196, 0.17758767306804657]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(1789, 1804), match='key_buffer_size'>, value=<re.Match object; span=(3, 7), match='128M'>, recommendation='8M/128M/No limit', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=128.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.10024014115333557, 0.4005581736564636, 0.20327132940292358, 0.16120778024196625, 0.13472256064414978]
Choice: 2
Trying update set global key_buffer_size=536870912
Trying update set global key_buffer_size=134217728
Trying assigning key_buffer_size to 512M
Adding assignment ('key_buffer_size', '512M') with weight 4
Assignment ('key_buffer_size', '512M') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 19
Episode hint counter before: 4
Episode hint counter: 5
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(0, 15), match='key_buffer_size'>, value=<re.Match object; span=(0, 4), match='1200'>, recommendation='1200', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=1200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18510159850120544, 0.19854989647865295, 0.25001347064971924, 0.1852368712425232, 0.18109816312789917]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(0, 15), match='key_buffer_size'>, value=<re.Match object; span=(0, 4), match='1200'>, recommendation='1200', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=1200.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.01587599329650402, 0.4516242742538452, 0.19539159536361694, 0.16862988471984863, 0.168478325009346]
Choice: 3
Trying update set global key_buffer_size=600
Exception during update: Cannot drop default keycache
Trying update set global key_buffer_size=134217728
Trying assigning key_buffer_size to 600
Assignment ('key_buffer_size', '600') was rejected
Hint counter: 20
Episode hint counter before: 5
Episode hint counter: 6
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(202, 217), match='key_buffer_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18871235847473145, 0.16364289820194244, 0.2578245997428894, 0.17040672898292542, 0.21941344439983368]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(202, 217), match='key_buffer_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.025200868025422096, 0.4661506414413452, 0.19984710216522217, 0.16229088604450226, 0.1465105265378952]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(202, 217), match='key_buffer_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18871235847473145, 0.16364289820194244, 0.2578245997428894, 0.17040672898292542, 0.21941344439983368]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(202, 217), match='key_buffer_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.025200868025422096, 0.4661506414413452, 0.19984710216522217, 0.16229088604450226, 0.1465105265378952]
Choice: 1
Trying update set global key_buffer_size=4
Exception during update: Cannot drop default keycache
Trying update set global key_buffer_size=134217728
Trying assigning key_buffer_size to 4
Assignment ('key_buffer_size', '4') was rejected
Hint counter: 21
Episode hint counter before: 6
Episode hint counter: 7
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(326, 342), match='table_open_cache'>, value=<re.Match object; span=(0, 3), match='512'>, recommendation='512', passage="Adjusting key_buffer_size, and reducing this if you're not using MyISAM Tables, (It's only relevant to have a large key_buffer_size if you're using MyISAM Tables, which by default MariaDB uses InnoDB. General consensus is InnoDB offers better performance as well, so really only use MyISAM if you have a reason to).\nAdjusting table_open_cache (previously called table_cache) - in Performance recommendations under MySQL, it recommends having this as 512 for most Moodle Installations, but I left it at the default MariaDB setting of 2000. lower_case_table_names ", float_val=512.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18853892385959625, 0.17371782660484314, 0.2637619078159332, 0.19082817435264587, 0.18315310776233673]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(326, 342), match='table_open_cache'>, value=<re.Match object; span=(0, 3), match='512'>, recommendation='512', passage="Adjusting key_buffer_size, and reducing this if you're not using MyISAM Tables, (It's only relevant to have a large key_buffer_size if you're using MyISAM Tables, which by default MariaDB uses InnoDB. General consensus is InnoDB offers better performance as well, so really only use MyISAM if you have a reason to).\nAdjusting table_open_cache (previously called table_cache) - in Performance recommendations under MySQL, it recommends having this as 512 for most Moodle Installations, but I left it at the default MariaDB setting of 2000. lower_case_table_names ", float_val=512.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.022273913025856018, 0.45673248171806335, 0.20234665274620056, 0.1712857037782669, 0.14736124873161316]
Choice: 3
Trying update set global table_open_cache=256
Trying update set global table_open_cache=2000
Trying assigning table_open_cache to 256
Adding assignment ('table_open_cache', '256') with weight 8
Assignment ('table_open_cache', '256') extracted from "Adjusting key_buffer_size, and reducing this if you're not using MyISAM Tables, (It's only relevant to have a large key_buffer_size if you're using MyISAM Tables, which by default MariaDB uses InnoDB. General consensus is InnoDB offers better performance as well, so really only use MyISAM if you have a reason to).
Adjusting table_open_cache (previously called table_cache) - in Performance recommendations under MySQL, it recommends having this as 512 for most Moodle Installations, but I left it at the default MariaDB setting of 2000. lower_case_table_names "
Hint counter: 22
Episode hint counter before: 7
Episode hint counter: 8
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(0, 16), match='table_open_cache'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18871235847473145, 0.16364289820194244, 0.2578245997428894, 0.17040672898292542, 0.21941344439983368]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(0, 16), match='table_open_cache'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.025200868025422096, 0.4661506414413452, 0.19984710216522217, 0.16229088604450226, 0.1465105265378952]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(0, 16), match='table_open_cache'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18871235847473145, 0.16364289820194244, 0.2578245997428894, 0.17040672898292542, 0.21941344439983368]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(0, 16), match='table_open_cache'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16', passage='table_open_cache_instances = 16\ntable_open_cache\n= 32012\nopen_files_limit = 65535\nmax_connect_errors = 1000000\n[client]\n# MySQL Client Configuration\n# Client Socket table_open_cache_instances ', float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.025200868025422096, 0.4661506414413452, 0.19984710216522217, 0.16229088604450226, 0.1465105265378952]
Choice: 4
Trying update set global table_open_cache=4
Trying update set global table_open_cache=2000
Trying assigning table_open_cache to 4
Adding assignment ('table_open_cache', '4') with weight 16
Assignment ('table_open_cache', '4') extracted from "table_open_cache_instances = 16
table_open_cache
= 32012
open_files_limit = 65535
max_connect_errors = 1000000
[client]
# MySQL Client Configuration
# Client Socket table_open_cache_instances "
Hint counter: 23
Episode hint counter before: 8
Episode hint counter: 9
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18495632708072662, 0.14171242713928223, 0.2996373772621155, 0.15297187864780426, 0.22072190046310425]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(0, 1), match='1'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02901652827858925, 0.4701266586780548, 0.20297597348690033, 0.16598810255527496, 0.13189274072647095]
Choice: 0
Trying update set global table_open_cache=1
Trying update set global table_open_cache=2000
Trying assigning table_open_cache to 1
Adding assignment ('table_open_cache', '1') with weight 1
Assignment ('table_open_cache', '1') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 24
Episode hint counter before: 9
Episode hint counter: 10
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(2, 3), match='1'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18495632708072662, 0.14171242713928223, 0.2996373772621155, 0.15297187864780426, 0.22072190046310425]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(2, 3), match='1'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02901652827858925, 0.4701266586780548, 0.20297597348690033, 0.16598810255527496, 0.13189274072647095]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(2, 3), match='1'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18495632708072662, 0.14171242713928223, 0.2996373772621155, 0.15297187864780426, 0.22072190046310425]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(2, 3), match='1'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=1.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02901652827858925, 0.4701266586780548, 0.20297597348690033, 0.16598810255527496, 0.13189274072647095]
Choice: 0
Trying update set global table_open_cache=2
Trying update set global table_open_cache=2000
Trying assigning table_open_cache to 2
Adding assignment ('table_open_cache', '2') with weight 1
Assignment ('table_open_cache', '2') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 25
Episode hint counter before: 10
Episode hint counter: 11
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(4, 6), match='64'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18495632708072662, 0.14171242713928223, 0.2996373772621155, 0.15297187864780426, 0.22072190046310425]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=42, param=<re.Match object; span=(5020, 5036), match='table_open_cache'>, value=<re.Match object; span=(4, 6), match='64'>, recommendation='1/1/64', passage='295The second most important parameter is\xa0innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName\nEmail\nWebsite binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.02901652827858925, 0.4701266586780548, 0.20297597348690033, 0.16598810255527496, 0.13189274072647095]
Choice: 1
Trying update set global table_open_cache=256
Trying update set global table_open_cache=2000
Trying assigning table_open_cache to 256
Adding assignment ('table_open_cache', '256') with weight 2
Assignment ('table_open_cache', '256') extracted from "295The second most important parameter is innodb_buffer_pool_size, which determines how much memory can MySQL get for caching InnoDB tables and index data. This is the most important parameter in the configuration for a performance boost! You should set that parameter to 70% of system memory if you have dedicated server for the database.I didn’t have any problems with memory, but if your Zabbix server crashes because of lack of memory, reduce “innodb_buffer_pool_size” and restart MySQL server.Explaining Database Configuration ParametersI asked ChatGPT to describe every parameter, defining its purpose, and providing the min/default/max possible values, and I must say it looks very good. If you notice any errors, please let me know in the comments section. Thanks!a) Performance and Optimizationskip_name_resolve:Purpose: Disables DNS name resolution during client connections, improving performance when IP addresses are used.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).skip-performance-schema:Purpose: Disables the Performance Schema, which provides performance-related monitoring and statistics.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).optimizer_switch:Purpose: Enables or disables specific query optimization switches. In this case, it sets ‘index_condition_pushdown’ to ‘off’.Min/Default/Max Value: Not applicable; it depends on the optimization switches available.tmp-table-size:Purpose: Sets the maximum size of temporary tables in memory for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).max-heap-table-size:Purpose: Sets the maximum size of MEMORY (HEAP) storage engine tables for each session.Min/Default/Max Value: 0/16M/No limit (memory available to the server).key_buffer_size:Purpose: Sets the size of the key buffer used for index blocks for MyISAM tables.Min/Default/Max Value: 8M/128M/No limit (memory available to the server).b) Connections and Threadsmax_connections:Purpose: Limits the maximum number of simultaneous client connections.Min/Default/Max Value: 1/151/100000thread_cache_size:Purpose: Sets the number of threads MySQL can keep waiting in a cache to reuse for client connections.Min/Default/Max Value: 0/9/100000max_allowed_packet:Purpose: Sets the maximum size of a packet or a BLOB/TEXT field sent to or received from the server.Min/Default/Max Value: 1024/16M/1073741824 (1GB)c) InnoDB Configurationinnodb-log-file-size:Purpose: Sets the size of each InnoDB log file.Min/Default/Max Value: 5M/48M/Unlimited (limited by the file system)innodb-log-buffer-size:Purpose: Sets the size of the buffer used for InnoDB redo log entries.Min/Default/Max Value: 1M/16M/Unlimited (limited by the memory available to the server)innodb-file-per-table:Purpose: Enables or disables the use of a separate tablespace file for each InnoDB table.Min/Default/Max Value: Not applicable; it’s a boolean parameter (true/false).innodb_buffer_pool_instances:Purpose: Sets the number of InnoDB buffer pool instances to divide the buffer pool into for multi-threaded performance.Min/Default/Max Value: 1/8/64innodb_old_blocks_time:Purpose: Specifies how long in milliseconds an InnoDB block remains in the “old” sublist before being moved to the “new” sublist.Min/Default/Max Value: 1000/1000/Unlimitedinnodb_stats_on_metadata:Purpose: Enables or disables automatic InnoDB statistics gathering during metadata statements.Min/Default/Max Value: Not applicable; it’s a boolean parameter (on/off).innodb-flush-method:Purpose: Specifies the method used to flush data to the InnoDB data files.Min/Default/Max Value: Not specified; depends on the available flush methods.innodb-flush-log-at-trx-commit:Purpose: Controls how InnoDB flushes the log buffer to the log file on each transaction commit.Min/Default/Max Value: 0/1/2innodb_buffer_pool_size:Purpose: Sets the size of the InnoDB buffer pool, which holds data and indexes for InnoDB tables.Min/Default/Max Value: 128M/128M/Unlimited (limited by the memory available to the server)innodb_read_io_threads:Purpose: Sets the number of background InnoDB I/O threads for read operations.Min/Default/Max Value: 1/4/64innodb_write_io_threads:Purpose: Sets the number of background InnoDB I/O threads for write operations.Min/Default/Max Value: 1/4/64innodb_io_capacity:Purpose: Sets the number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 100/200/2**64-1innodb_io_capacity_max:Purpose: Sets the maximum number of I/O operations per second the InnoDB background I/O thread can perform.Min/Default/Max Value: 2000/2000/2**64-1d) Timeoutsconnect_timeout:Purpose: Sets the number of seconds the server waits for a client to establish a connection before terminating it.Min/Default/Max Value: 2/10/31536000 (1 year)wait_timeout:Purpose: Sets the number of seconds the server waits for activity on an interactive connection before closing it.Min/Default/Max Value: 2/28800/31536000 (1 year)e) Caches and Limitstable_open_cache_instances:Purpose: Sets the number of table cache instances to divide the table cache into for multi-threaded performance.Min/Default/Max Value: 1/1/64table_open_cachePurpose: The number of open tables for all threads.Min/Default/Max Value: 1/4000/524288open_files_limit:Purpose: Limits the maximum number of files that MySQL can keep open.Min/Default/Max Value: 1024/65535/Unlimitedmax_connect_errors:Purpose: Limits the number of interrupted connection attempts a host can make to the server.Min/Default/Max Value: 1/100/18446744073709551615 (unlimited)Categories ZabbixInstall Zabbix-Proxy on Debian 11 in 10 minutes!Raspberry Pi SNMP monitoring: Install & enable Agent (server)4 thoughts on “MySQL / MariaDB Configuration Tips: Boost Zabbix Database!”Mark2023-08-22 at 12:35 PMAccording to docs, “index_condition_pushdown” optimizer switch “can reduce the number of times the storage engine must access the base table and the number of times the MySQL server must access the storage engine”. Why did you turn it off?ReplyAldin Osmanagic2023-09-04 at 11:09 PMHi, Mark,This was a workaround for some Zabbix slow query problems. Please check this Zabbix trouble ticket at https://support.zabbix.com/browse/ZBX-10652 and read the last comment. Maybe this is no longer needed, but I’m not sure, so I left it.RegardsAldinReplyfikrat2023-08-09 at 11:52 AMhi sirI want to deploy zabbix server for 7000 host.can I do that.what is the configration I have to changeReplyAldin Osmanagic2023-08-14 at 2:24 PMIt all depends on how many items (metrics) you will have, the intervals for those items, and whether you have a fast disk (SSD)ReplyLeave a Comment Cancel replyCommentName
Email
Website binlog_stmt_cache_size "
Hint counter: 26
Episode hint counter before: 11
Episode hint counter: 12
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(116, 132), match='table_open_cache'>, value=<re.Match object; span=(0, 4), match='2048'>, recommendation='2048', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=2048.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.17999409139156342, 0.20450188219547272, 0.2764931619167328, 0.1695912778377533, 0.1694195717573166]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(116, 132), match='table_open_cache'>, value=<re.Match object; span=(0, 4), match='2048'>, recommendation='2048', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=2048.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.025632193312048912, 0.44854864478111267, 0.20763951539993286, 0.17194095253944397, 0.14623866975307465]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(116, 132), match='table_open_cache'>, value=<re.Match object; span=(0, 4), match='2048'>, recommendation='2048', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=2048.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.17999409139156342, 0.20450188219547272, 0.2764931619167328, 0.1695912778377533, 0.1694195717573166]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(116, 132), match='table_open_cache'>, value=<re.Match object; span=(0, 4), match='2048'>, recommendation='2048', passage='read_rnd_buffer_size = 512\njoin_buffer_size = 2048\nthread_stack = 512\nbinlog_cache_size = 64\nthread_cache_size = 16\ntable_open_cache = 2048\nmax_connections = 200\nPHP:\nmax_children = 4 thread_cache_size ', float_val=2048.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.025632193312048912, 0.44854864478111267, 0.20763951539993286, 0.17194095253944397, 0.14623866975307465]
Choice: 4
Trying update set global table_open_cache=512
Trying update set global table_open_cache=2000
Trying assigning table_open_cache to 512
Adding assignment ('table_open_cache', '512') with weight 16
Assignment ('table_open_cache', '512') extracted from "read_rnd_buffer_size = 512
join_buffer_size = 2048
thread_stack = 512
binlog_cache_size = 64
thread_cache_size = 16
table_open_cache = 2048
max_connections = 200
PHP:
max_children = 4 thread_cache_size "
Hint counter: 27
Episode hint counter before: 12
Episode hint counter: 13
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(45, 61), match='table_open_cache'>, value=<re.Match object; span=(0, 2), match='64'>, recommendation='64', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20224447548389435, 0.18172581493854523, 0.2561816871166229, 0.15085653960704803, 0.20899151265621185]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(45, 61), match='table_open_cache'>, value=<re.Match object; span=(0, 2), match='64'>, recommendation='64', passage='binlog_cache_size = 32\nthread_cache_size = 8\ntable_open_cache = 64\nmax_connections = 20\nPHP:\nmax_children = 10\nstart_servers = 2\nmin_spare_servers = 1\nmax_spare_servers = 3 binlog_stmt_cache_size ', float_val=64.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.027772024273872375, 0.460867315530777, 0.20801353454589844, 0.16750642657279968, 0.13584065437316895]
Choice: 2
Trying update set global table_open_cache=128
Trying update set global table_open_cache=2000
Trying assigning table_open_cache to 128
Adding assignment ('table_open_cache', '128') with weight 4
Assignment ('table_open_cache', '128') extracted from "binlog_cache_size = 32
thread_cache_size = 8
table_open_cache = 64
max_connections = 20
PHP:
max_children = 10
start_servers = 2
min_spare_servers = 1
max_spare_servers = 3 binlog_stmt_cache_size "
Hint counter: 28
Episode hint counter before: 13
Episode hint counter: 14
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(360, 376), match='query_cache_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16 or so', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18521332740783691, 0.1852453649044037, 0.28911828994750977, 0.15424436330795288, 0.18617865443229675]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(360, 376), match='query_cache_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16 or so', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.028563059866428375, 0.50733482837677, 0.1963784247636795, 0.14746752381324768, 0.12025613337755203]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(360, 376), match='query_cache_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16 or so', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.18521332740783691, 0.1852453649044037, 0.28911828994750977, 0.15424436330795288, 0.18617865443229675]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(360, 376), match='query_cache_size'>, value=<re.Match object; span=(0, 2), match='16'>, recommendation='16 or so', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=16.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.028563059866428375, 0.50733482837677, 0.1963784247636795, 0.14746752381324768, 0.12025613337755203]
Choice: 2
Trying update set global query_cache_size=8
Trying update set global query_cache_size=1048576
Trying assigning query_cache_size to 8
Adding assignment ('query_cache_size', '8') with weight 4
Assignment ('query_cache_size', '8') extracted from "Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).
Adjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size "
Hint counter: 29
Episode hint counter before: 14
Episode hint counter: 15
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(23, 39), match='query_cache_size'>, value=<re.Match object; span=(0, 2), match='50'>, recommendation='50', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=50.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.19981148838996887, 0.21986037492752075, 0.2630220055580139, 0.16092373430728912, 0.15638239681720734]
Choice: 0
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(23, 39), match='query_cache_size'>, value=<re.Match object; span=(0, 2), match='50'>, recommendation='50', passage='key_buffer_size = 1200\nquery_cache_size = 50\ntmp_table_size = 128\ninnodb_buffer_pool_size = 4096\ninnodb_log_buffer_size = 32\nsort_buffer_size = 2048\nread_buffer_size = 256 key_buffer_size ', float_val=50.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.03255493938922882, 0.4847303330898285, 0.1944613754749298, 0.1586245894432068, 0.1296287328004837]
Choice: 1
Trying update set global query_cache_size=12
Trying update set global query_cache_size=1048576
Trying assigning query_cache_size to 12
Adding assignment ('query_cache_size', '12') with weight 2
Assignment ('query_cache_size', '12') extracted from "key_buffer_size = 1200
query_cache_size = 50
tmp_table_size = 128
innodb_buffer_pool_size = 4096
innodb_log_buffer_size = 32
sort_buffer_size = 2048
read_buffer_size = 256 key_buffer_size "
Hint counter: 30
Episode hint counter before: 15
Episode hint counter: 16
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(223, 239), match='query_cache_size'>, value=<re.Match object; span=(0, 1), match='0'>, recommendation='0', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=0.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20856523513793945, 0.2019384503364563, 0.27009207010269165, 0.17301714420318604, 0.14638707041740417]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(223, 239), match='query_cache_size'>, value=<re.Match object; span=(0, 1), match='0'>, recommendation='0', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=0.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.04412984102964401, 0.44440340995788574, 0.20087464153766632, 0.16065354645252228, 0.14993849396705627]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=52, param=<re.Match object; span=(223, 239), match='query_cache_size'>, value=<re.Match object; span=(0, 1), match='0'>, recommendation='0', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=0.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.20856523513793945, 0.2019384503364563, 0.27009207010269165, 0.17301714420318604, 0.14638707041740417]
Choice: 1
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=52, param=<re.Match object; span=(223, 239), match='query_cache_size'>, value=<re.Match object; span=(0, 1), match='0'>, recommendation='0', passage="The whole problem is the number of cores. I advise you to install at least 2 CPU cores.\nGiven the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.\nMySQL:\nkey_buffer_size = 16\nquery_cache_size = 0\ntmp_table_size = 32 thread_cache_size ", float_val=0.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.04412984102964401, 0.44440340995788574, 0.20087464153766632, 0.16065354645252228, 0.14993849396705627]
Choice: 3
Trying update set global query_cache_size=0
Trying update set global query_cache_size=1048576
Trying assigning query_cache_size to 0
Adding assignment ('query_cache_size', '0') with weight 8
Assignment ('query_cache_size', '0') extracted from "The whole problem is the number of cores. I advise you to install at least 2 CPU cores.
Given the limitations of iron, the result is very good. For personal projects or a blog, that's the thing.
MySQL:
key_buffer_size = 16
query_cache_size = 0
tmp_table_size = 32 thread_cache_size "
Hint counter: 31
Episode hint counter before: 16
Episode hint counter: 17
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=63, param=<re.Match object; span=(54, 70), match='query_cache_size'>, value=<re.Match object; span=(0, 4), match='300M'>, recommendation='300M', passage='# * Query Cache Configuration\nquery_cache_limit\n= 50M\nquery_cache_size\n= 300M\n# * Logging and Replication\n# * InnoDB\n# InnoDB is enabled by default with a 10MB datafile in /var/lib/mysql/. query_cache_limit ', float_val=300.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.16972294449806213, 0.1636090725660324, 0.28496333956718445, 0.17855490744113922, 0.2031497359275818]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=63, param=<re.Match object; span=(54, 70), match='query_cache_size'>, value=<re.Match object; span=(0, 4), match='300M'>, recommendation='300M', passage='# * Query Cache Configuration\nquery_cache_limit\n= 50M\nquery_cache_size\n= 300M\n# * Logging and Replication\n# * InnoDB\n# InnoDB is enabled by default with a 10MB datafile in /var/lib/mysql/. query_cache_limit ', float_val=300.0, val_unit='M', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.01771782524883747, 0.43009284138679504, 0.20850959420204163, 0.18484938144683838, 0.15883034467697144]
Choice: 2
Trying update set global query_cache_size=314572800
Trying update set global query_cache_size=1048576
Trying assigning query_cache_size to 300M
Adding assignment ('query_cache_size', '300M') with weight 4
Assignment ('query_cache_size', '300M') extracted from "# * Query Cache Configuration
query_cache_limit
= 50M
query_cache_size
= 300M
# * Logging and Replication
# * InnoDB
# InnoDB is enabled by default with a 10MB datafile in /var/lib/mysql/. query_cache_limit "
Hint counter: 32
Episode hint counter before: 17
Episode hint counter: 18
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=11, param=<re.Match object; span=(343, 367), match='query_cache_min_res_unit'>, value=<re.Match object; span=(0, 2), match='2K'>, recommendation='2K. max_binlog_stmt_cache_size', passage='If you are able, the MySQLTuner tool can be run against your MySQL server and will calculate appropriate configuration values for most of the following settings based on your current load, status and variables automatically.\nEnable the query cache with\nquery_cache_type = 1.\nFor most Moodle installs, set the following:\nquery_cache_size = 36M\nquery_cache_min_res_unit = 2K. max_binlog_stmt_cache_size ', float_val=2.0, val_unit='K', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1023973599076271, 0.10131178051233292, 0.37586623430252075, 0.2043144553899765, 0.21611016988754272]
Choice: 3
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=11, param=<re.Match object; span=(343, 367), match='query_cache_min_res_unit'>, value=<re.Match object; span=(0, 2), match='2K'>, recommendation='2K. max_binlog_stmt_cache_size', passage='If you are able, the MySQLTuner tool can be run against your MySQL server and will calculate appropriate configuration values for most of the following settings based on your current load, status and variables automatically.\nEnable the query cache with\nquery_cache_type = 1.\nFor most Moodle installs, set the following:\nquery_cache_size = 36M\nquery_cache_min_res_unit = 2K. max_binlog_stmt_cache_size ', float_val=2.0, val_unit='K', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.01548533234745264, 0.5477354526519775, 0.17416539788246155, 0.14326906204223633, 0.11934469640254974]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Decision: Deciding adaption of TuningHint(doc_id=11, param=<re.Match object; span=(343, 367), match='query_cache_min_res_unit'>, value=<re.Match object; span=(0, 2), match='2K'>, recommendation='2K. max_binlog_stmt_cache_size', passage='If you are able, the MySQLTuner tool can be run against your MySQL server and will calculate appropriate configuration values for most of the following settings based on your current load, status and variables automatically.\nEnable the query cache with\nquery_cache_type = 1.\nFor most Moodle installs, set the following:\nquery_cache_size = 36M\nquery_cache_min_res_unit = 2K. max_binlog_stmt_cache_size ', float_val=2.0, val_unit='K', hint_type=<HintType.ABSOLUTE: 3>)\n[Restart] MariaDB server shut down!
[Restart] MariaDB server restarted!

Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1023973599076271, 0.10131178051233292, 0.37586623430252075, 0.2043144553899765, 0.21611016988754272]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=11, param=<re.Match object; span=(343, 367), match='query_cache_min_res_unit'>, value=<re.Match object; span=(0, 2), match='2K'>, recommendation='2K. max_binlog_stmt_cache_size', passage='If you are able, the MySQLTuner tool can be run against your MySQL server and will calculate appropriate configuration values for most of the following settings based on your current load, status and variables automatically.\nEnable the query cache with\nquery_cache_type = 1.\nFor most Moodle installs, set the following:\nquery_cache_size = 36M\nquery_cache_min_res_unit = 2K. max_binlog_stmt_cache_size ', float_val=2.0, val_unit='K', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.01548533234745264, 0.5477354526519775, 0.17416539788246155, 0.14326906204223633, 0.11934469640254974]
Choice: 2
Trying update set global query_cache_min_res_unit=8192
Trying update set global query_cache_min_res_unit=4096
Trying assigning query_cache_min_res_unit to 8K
Adding assignment ('query_cache_min_res_unit', '8K') with weight 4
Assignment ('query_cache_min_res_unit', '8K') extracted from "If you are able, the MySQLTuner tool can be run against your MySQL server and will calculate appropriate configuration values for most of the following settings based on your current load, status and variables automatically.
Enable the query cache with
query_cache_type = 1.
For most Moodle installs, set the following:
query_cache_size = 36M
query_cache_min_res_unit = 2K. max_binlog_stmt_cache_size "
Hint counter: 33
Episode hint counter before: 18
Episode hint counter: 19
Hints per episode: 20
Done flag: False
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(497, 521), match='query_cache_min_res_unit'>, value=<re.Match object; span=(0, 4), match='4096'>, recommendation='4096 (4KB).', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=4096.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1934792846441269, 0.12025752663612366, 0.3037382960319519, 0.15213847160339355, 0.23038634657859802]
Choice: 4
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(497, 521), match='query_cache_min_res_unit'>, value=<re.Match object; span=(0, 4), match='4096'>, recommendation='4096 (4KB).', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=4096.0, val_unit='', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.028957035392522812, 0.4735428988933563, 0.2037220150232315, 0.16191641986370087, 0.13186153769493103]
Choice: 3
Trying update set global query_cache_min_res_unit=16384
Trying update set global query_cache_min_res_unit=4096
Trying assigning query_cache_min_res_unit to 16384
Adding assignment ('query_cache_min_res_unit', '16384') with weight 8
Assignment ('query_cache_min_res_unit', '16384') extracted from "Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).
Adjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size "
Hint counter: 34
Episode hint counter before: 19
Episode hint counter: 20
Hints per episode: 20
Episode finished!
Done flag: True
Finalizing episode!
Weighted hints: defaultdict(<function NlpTuningEnv._finalize_episode.<locals>.<lambda> at 0x7f8767de0700>, {('innodb_buffer_pool_size', '45M'): 8, ('key_buffer_size', '16M'): 20, ('key_buffer_size', '4M'): 4, ('key_buffer_size', '512M'): 4, ('table_open_cache', '256'): 10, ('table_open_cache', '4'): 16, ('table_open_cache', '1'): 1, ('table_open_cache', '2'): 1, ('table_open_cache', '512'): 16, ('table_open_cache', '128'): 4, ('query_cache_size', '8'): 4, ('query_cache_size', '12'): 2, ('query_cache_size', '0'): 8, ('query_cache_size', '300M'): 4, ('query_cache_min_res_unit', '8K'): 4, ('query_cache_min_res_unit', '16384'): 8})
Selected configurations: [{'innodb_buffer_pool_size': '45M', 'key_buffer_size': '16M', 'table_open_cache': '256', 'query_cache_size': '12', 'query_cache_min_res_unit': '16384'}, {'innodb_buffer_pool_size': '45M', 'key_buffer_size': '512M', 'table_open_cache': '512', 'query_cache_size': '300M', 'query_cache_min_res_unit': '8K'}]
Disconnecting ...
Trying to connect to tpch with user kaltenec
Trying update set session max_execution_time = 1500000
Exception during update: Unknown system variable 'max_execution_time'
Trying update update mariadb.server_cost set cost_value = NULL
Exception during update: Table 'mariadb.server_cost' doesn't exist
Trying update update mariadb.engine_cost set cost_value = NULL
Exception during update: Table 'mariadb.engine_cost' doesn't exist
Trying configuration: {'innodb_buffer_pool_size': '45M', 'key_buffer_size': '16M', 'table_open_cache': '256', 'query_cache_size': '12', 'query_cache_min_res_unit': '16384'}\n[Restart] MariaDB server shut down!
[Restart] MariaDB server restarted!

Trying update set global innodb_buffer_pool_size=47185920
Trying update set global key_buffer_size=16777216
Trying update set global table_open_cache=256
Trying update set global query_cache_size=12
Trying update set global query_cache_min_res_unit=16384
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 185964.53271484375
Achieved with configuration: {'max_connections': 2000, 'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 4}
Reward -151528.81860351562 with {'innodb_buffer_pool_size': '45M', 'key_buffer_size': '16M', 'table_open_cache': '256', 'query_cache_size': '12', 'query_cache_min_res_unit': '16384'}
Disconnecting ...
Trying to connect to tpch with user kaltenec
Trying update set session max_execution_time = 1500000
Exception during update: Unknown system variable 'max_execution_time'
Trying update update mariadb.server_cost set cost_value = NULL
Exception during update: Table 'mariadb.server_cost' doesn't exist
Trying update update mariadb.engine_cost set cost_value = NULL
Exception during update: Table 'mariadb.engine_cost' doesn't exist
Trying configuration: {'innodb_buffer_pool_size': '45M', 'key_buffer_size': '512M', 'table_open_cache': '512', 'query_cache_size': '300M', 'query_cache_min_res_unit': '8K'}
Trying update set global innodb_buffer_pool_size=47185920
Trying update set global key_buffer_size=536870912
Trying update set global table_open_cache=512
Trying update set global query_cache_size=314572800
Trying update set global query_cache_min_res_unit=8192
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 210710.92797851562
Achieved with configuration: {'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 256, 'query_cache_size': 12, 'query_cache_min_res_unit': 16384}
Reward -150441.77905273438 with {'innodb_buffer_pool_size': '45M', 'key_buffer_size': '512M', 'table_open_cache': '512', 'query_cache_size': '300M', 'query_cache_min_res_unit': '8K'}
Obtained 0 by configuration {}
Achieved unscaled reward of 0 using {}.
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(497, 521), match='query_cache_min_res_unit'>, value=<re.Match object; span=(6, 9), match='4KB'>, recommendation='4096 (4KB).', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=4.0, val_unit='KB', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1934792846441269, 0.12025752663612366, 0.3037382960319519, 0.15213847160339355, 0.23038634657859802]
--- Tuning Updates ---
Minimal time (ms): 12197.716796875
Achieved with configuration: {'thread_cache_size': 32, 'max_connections': 5000, 'innodb_buffer_pool_size': 5368709120, 'key_buffer_size': 536870912}
Maximal time (ms): 210710.92797851562
Achieved with configuration: {'innodb_buffer_pool_size': 47185920, 'key_buffer_size': 16777216, 'table_open_cache': 256, 'query_cache_size': 12, 'query_cache_min_res_unit': 16384}
Decision: Deciding adaption of TuningHint(doc_id=15, param=<re.Match object; span=(497, 521), match='query_cache_min_res_unit'>, value=<re.Match object; span=(6, 9), match='4KB'>, recommendation='4096 (4KB).', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=4.0, val_unit='KB', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['Decrease recommendation strongly', 'Decrease recommendation', 'Use recommendation', 'Increase recommendation', 'Increase recommendation strongly']
Scores: [0.1934792846441269, 0.12025752663612366, 0.3037382960319519, 0.15213847160339355, 0.23038634657859802]
Choice: 2
Done flag: False
Decision: Deciding weight of TuningHint(doc_id=15, param=<re.Match object; span=(497, 521), match='query_cache_min_res_unit'>, value=<re.Match object; span=(6, 9), match='4KB'>, recommendation='4096 (4KB).', passage="Adjusting the query_cache - this differs from MySQL where by default it is disabled in MariaDB. Enabling it may even reduce performance if it isn't needed, as per the docs. I unfortunately don't know enough about how Moodle uses the database as to whether it is better to have this on or off these days, so went with the MySQL recommendation of On, but with a query_cache_size of 64M (seems to be the recommendation of many other sites, as memory is plentiful these days). I did however leave the query_cache_min_res_unit with the default of 4096 (4KB).\nAdjusting the thread_cache_size - as mentioned on the page, normally this doesn't have a huge effect on things, so leaving it as default (256) doesn't seem to do too much damage. Other sites however recommend setting this at a value of 16 or so - the best thing would be to test it in your setup as recommended, and see what works best. I also tried a setting of 16 to no real noticeable difference on a small Moodle site. query_cache_size ", float_val=4.0, val_unit='KB', hint_type=<HintType.ABSOLUTE: 3>)
Choices: ['This hint is not important.', 'This hint is somewhat important.', 'This hint is quite important.', 'This hint is very important.', 'This hint is super important.']
Scores: [0.028957035392522812, 0.4735428988933563, 0.2037220150232315, 0.16191641986370087, 0.13186153769493103]
